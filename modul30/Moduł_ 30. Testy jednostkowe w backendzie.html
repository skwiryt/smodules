<!DOCTYPE html>
<!-- saved from url=(0051)https://kodilla.com/pl/bootcamp-module/407/279/5935 -->
<html lang="pl" class=""><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="ahrefs-site-verification" content="c2d3c04b9f125c5b8c98d89f738d343f69d841f035150344a932150235c5639a">
    
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="csrf-token" content="RtYZFGj83q4iSrSPWWX0bG3bzYwVu4VNaOaoyGGq">

<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="https://kodilla.com/static/img/icons/apple-touch-icon-60x60.png?00000">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="https://kodilla.com/static/img/icons/apple-touch-icon-76x76.png?00000">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="https://kodilla.com/static/img/icons/apple-touch-icon-120x120.png?00000">
<link rel="apple-touch-icon" type="image/png" sizes="152x152" href="https://kodilla.com/static/img/icons/apple-touch-icon-152x152.png?00000">
<link rel="icon" type="image/png" sizes="32x32" href="https://kodilla.com/static/img/icons/favicon-32x32.png?00000">
<link rel="icon" type="image/png" sizes="96x96" href="https://kodilla.com/static/img/icons/favicon-96x96.png?00000">
<link rel="icon" type="image/png" sizes="16x16" href="https://kodilla.com/static/img/icons/favicon-16x16.png?00000">

    <link rel="canonical" href="https://kodilla.com/pl/bootcamp-module/407/279/5935">

    <meta name="robots" content="noindex, follow">
    <title>    Moduł: 30. Testy jednostkowe w backendzie
</title>
        <script type="text/javascript" src="./Moduł_ 30. Testy jednostkowe w backendzie_files/saved_resource"></script><script type="text/javascript" async="" src="./Moduł_ 30. Testy jednostkowe w backendzie_files/js"></script><script type="text/javascript" async="" id="inspsync" src="./Moduł_ 30. Testy jednostkowe w backendzie_files/inspectlet.js"></script><script type="text/javascript" async="" src="./Moduł_ 30. Testy jednostkowe w backendzie_files/saved_resource(1)"></script><script async="" src="./Moduł_ 30. Testy jednostkowe w backendzie_files/tfa.js" id="tb_tfa_script"></script><script type="text/javascript" async="" src="./Moduł_ 30. Testy jednostkowe w backendzie_files/insight.min.js"></script><script type="text/javascript" async="" src="./Moduł_ 30. Testy jednostkowe w backendzie_files/analytics.js"></script><script type="text/javascript" async="" src="./Moduł_ 30. Testy jednostkowe w backendzie_files/analytics.js"></script><script type="text/javascript" async="" src="./Moduł_ 30. Testy jednostkowe w backendzie_files/js(1)"></script><script async="" src="./Moduł_ 30. Testy jednostkowe w backendzie_files/gtm.js"></script><script src="./Moduł_ 30. Testy jednostkowe w backendzie_files/389137334769464" async=""></script><script async="" src="./Moduł_ 30. Testy jednostkowe w backendzie_files/fbevents.js"></script><script src="./Moduł_ 30. Testy jednostkowe w backendzie_files/sdk.js" async="" crossorigin="anonymous"></script><script id="facebook-jssdk" src="./Moduł_ 30. Testy jednostkowe w backendzie_files/sdk(1).js"></script><script src="./Moduł_ 30. Testy jednostkowe w backendzie_files/diffuser.js" async=""></script><script>document.documentElement.classList.remove("no-js")</script>
<script src="./Moduł_ 30. Testy jednostkowe w backendzie_files/yall.min.js"></script>
<link rel="stylesheet" href="./Moduł_ 30. Testy jednostkowe w backendzie_files/bootstrap.min.css" as="style" onload="this.rel=&#39;stylesheet&#39;">
<link href="./Moduł_ 30. Testy jednostkowe w backendzie_files/font-awesome.min.css" rel="stylesheet">
<link rel="stylesheet" href="./Moduł_ 30. Testy jednostkowe w backendzie_files/main-b3cf79332c.css" as="style" onload="this.rel=&#39;stylesheet&#39;">
            
    <link href="./Moduł_ 30. Testy jednostkowe w backendzie_files/prism.min.css" rel="stylesheet">

    <link href="./Moduł_ 30. Testy jednostkowe w backendzie_files/bootcamp-6d0888d826.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="./Moduł_ 30. Testy jednostkowe w backendzie_files/perfect-scrollbar.css">
    <link rel="stylesheet" href="./Moduł_ 30. Testy jednostkowe w backendzie_files/jquery.fancybox.min.css" type="text/css" media="screen">
    <link href="https://kodilla.com/static/css/libs/bootstrap-datetimepicker.min.css?00000">
    <link rel="stylesheet" href="./Moduł_ 30. Testy jednostkowe w backendzie_files/content.css">

<script async="" src="./Moduł_ 30. Testy jednostkowe w backendzie_files/hotjar-2404285.js"></script><script src="./Moduł_ 30. Testy jednostkowe w backendzie_files/OneSignalPageSDKES6.js" async=""></script><style type="text/css">.fancybox-margin{margin-right:15px;}</style><script async="" src="./Moduł_ 30. Testy jednostkowe w backendzie_files/modules.2ec2062e86adda67b2fe.js" charset="utf-8"></script><style type="text/css">iframe#_hjRemoteVarsFrame {display: none !important; width: 1px !important; height: 1px !important; opacity: 0 !important; pointer-events: none !important;}</style><link href="./Moduł_ 30. Testy jednostkowe w backendzie_files/esw.min.css" type="text/css" rel="stylesheet"><style id="inert-style">
[inert] {
	pointer-events: none;
	cursor: default;
}

[inert], [inert] * {
	user-select: none;
	-webkit-user-select: none;
	-moz-user-select: none;
	-ms-user-select: none;
}
</style><script type="text/javascript" charset="utf-8" src="./Moduł_ 30. Testy jednostkowe w backendzie_files/saved_resource(2)" async=""></script><style type="text/css" data-fbcssmodules="css:fb.css.base css:fb.css.dialog css:fb.css.iframewidget css:fb.css.customer_chat_plugin_iframe">.fb_hidden{position:absolute;top:-10000px;z-index:10001}.fb_reposition{overflow:hidden;position:relative}.fb_invisible{display:none}.fb_reset{background:none;border:0;border-spacing:0;color:#000;cursor:auto;direction:ltr;font-family:"lucida grande", tahoma, verdana, arial, sans-serif;font-size:11px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:1;margin:0;overflow:visible;padding:0;text-align:left;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;visibility:visible;white-space:normal;word-spacing:normal}.fb_reset>div{overflow:hidden}@keyframes fb_transform{from{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}.fb_animate{animation:fb_transform .3s forwards}
.fb_dialog{background:rgba(82, 82, 82, .7);position:absolute;top:-10000px;z-index:10001}.fb_dialog_advanced{border-radius:8px;padding:10px}.fb_dialog_content{background:#fff;color:#373737}.fb_dialog_close_icon{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 0 transparent;cursor:pointer;display:block;height:15px;position:absolute;right:18px;top:17px;width:15px}.fb_dialog_mobile .fb_dialog_close_icon{left:5px;right:auto;top:5px}.fb_dialog_padding{background-color:transparent;position:absolute;width:1px;z-index:-1}.fb_dialog_close_icon:hover{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -15px transparent}.fb_dialog_close_icon:active{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -30px transparent}.fb_dialog_iframe{line-height:0}.fb_dialog_content .dialog_title{background:#6d84b4;border:1px solid #365899;color:#fff;font-size:14px;font-weight:bold;margin:0}.fb_dialog_content .dialog_title>span{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yd/r/Cou7n-nqK52.gif) no-repeat 5px 50%;float:left;padding:5px 0 7px 26px}body.fb_hidden{height:100%;left:0;margin:0;overflow:visible;position:absolute;top:-10000px;transform:none;width:100%}.fb_dialog.fb_dialog_mobile.loading{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ya/r/3rhSv5V8j3o.gif) white no-repeat 50% 50%;min-height:100%;min-width:100%;overflow:hidden;position:absolute;top:0;z-index:10001}.fb_dialog.fb_dialog_mobile.loading.centered{background:none;height:auto;min-height:initial;min-width:initial;width:auto}.fb_dialog.fb_dialog_mobile.loading.centered #fb_dialog_loader_spinner{width:100%}.fb_dialog.fb_dialog_mobile.loading.centered .fb_dialog_content{background:none}.loading.centered #fb_dialog_loader_close{clear:both;color:#fff;display:block;font-size:18px;padding-top:20px}#fb-root #fb_dialog_ipad_overlay{background:rgba(0, 0, 0, .4);bottom:0;left:0;min-height:100%;position:absolute;right:0;top:0;width:100%;z-index:10000}#fb-root #fb_dialog_ipad_overlay.hidden{display:none}.fb_dialog.fb_dialog_mobile.loading iframe{visibility:hidden}.fb_dialog_mobile .fb_dialog_iframe{position:sticky;top:0}.fb_dialog_content .dialog_header{background:linear-gradient(from(#738aba), to(#2c4987));border-bottom:1px solid;border-color:#043b87;box-shadow:white 0 1px 1px -1px inset;color:#fff;font:bold 14px Helvetica, sans-serif;text-overflow:ellipsis;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0;vertical-align:middle;white-space:nowrap}.fb_dialog_content .dialog_header table{height:43px;width:100%}.fb_dialog_content .dialog_header td.header_left{font-size:12px;padding-left:5px;vertical-align:middle;width:60px}.fb_dialog_content .dialog_header td.header_right{font-size:12px;padding-right:5px;vertical-align:middle;width:60px}.fb_dialog_content .touchable_button{background:linear-gradient(from(#4267B2), to(#2a4887));background-clip:padding-box;border:1px solid #29487d;border-radius:3px;display:inline-block;line-height:18px;margin-top:3px;max-width:85px;padding:4px 12px;position:relative}.fb_dialog_content .dialog_header .touchable_button input{background:none;border:none;color:#fff;font:bold 12px Helvetica, sans-serif;margin:2px -12px;padding:2px 6px 3px 6px;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog_content .dialog_header .header_center{color:#fff;font-size:16px;font-weight:bold;line-height:18px;text-align:center;vertical-align:middle}.fb_dialog_content .dialog_content{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/y9/r/jKEcVPZFk-2.gif) no-repeat 50% 50%;border:1px solid #4a4a4a;border-bottom:0;border-top:0;height:150px}.fb_dialog_content .dialog_footer{background:#f5f6f7;border:1px solid #4a4a4a;border-top-color:#ccc;height:40px}#fb_dialog_loader_close{float:left}.fb_dialog.fb_dialog_mobile .fb_dialog_close_icon{visibility:hidden}#fb_dialog_loader_spinner{animation:rotateSpinner 1.2s linear infinite;background-color:transparent;background-image:url(https://static.xx.fbcdn.net/rsrc.php/v3/yD/r/t-wz8gw1xG1.png);background-position:50% 50%;background-repeat:no-repeat;height:24px;width:24px}@keyframes rotateSpinner{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
.fb_iframe_widget{display:inline-block;position:relative}.fb_iframe_widget span{display:inline-block;position:relative;text-align:justify}.fb_iframe_widget iframe{position:absolute}.fb_iframe_widget_fluid_desktop,.fb_iframe_widget_fluid_desktop span,.fb_iframe_widget_fluid_desktop iframe{max-width:100%}.fb_iframe_widget_fluid_desktop iframe{min-width:220px;position:relative}.fb_iframe_widget_lift{z-index:1}.fb_iframe_widget_fluid{display:inline}.fb_iframe_widget_fluid span{width:100%}
.fb_mpn_mobile_landing_page_slide_out{animation-duration:200ms;animation-name:fb_mpn_landing_page_slide_out;transition-timing-function:ease-in}.fb_mpn_mobile_landing_page_slide_out_from_left{animation-duration:200ms;animation-name:fb_mpn_landing_page_slide_out_from_left;transition-timing-function:ease-in}.fb_mpn_mobile_landing_page_slide_up{animation-duration:500ms;animation-name:fb_mpn_landing_page_slide_up;transition-timing-function:ease-in}.fb_mpn_mobile_bounce_in{animation-duration:300ms;animation-name:fb_mpn_bounce_in;transition-timing-function:ease-in}.fb_mpn_mobile_bounce_out{animation-duration:300ms;animation-name:fb_mpn_bounce_out;transition-timing-function:ease-in}.fb_mpn_mobile_bounce_out_v2{animation-duration:300ms;animation-name:fb_mpn_fade_out;transition-timing-function:ease-in}.fb_customer_chat_bounce_in_v2{animation-duration:300ms;animation-name:fb_bounce_in_v2;transition-timing-function:ease-in}.fb_customer_chat_bounce_in_from_left{animation-duration:300ms;animation-name:fb_bounce_in_from_left;transition-timing-function:ease-in}.fb_customer_chat_bounce_out_v2{animation-duration:300ms;animation-name:fb_bounce_out_v2;transition-timing-function:ease-in}.fb_customer_chat_bounce_out_from_left{animation-duration:300ms;animation-name:fb_bounce_out_from_left;transition-timing-function:ease-in}.fb_customer_chat_bubble_animated_no_badge{box-shadow:0 3px 12px rgba(0, 0, 0, .15);transition:box-shadow 150ms linear}.fb_customer_chat_bubble_animated_no_badge:hover{box-shadow:0 5px 24px rgba(0, 0, 0, .3)}.fb_customer_chat_bubble_animated_with_badge{box-shadow:-5px 4px 14px rgba(0, 0, 0, .15);transition:box-shadow 150ms linear}.fb_customer_chat_bubble_animated_with_badge:hover{box-shadow:-5px 8px 24px rgba(0, 0, 0, .2)}.fb_invisible_flow{display:inherit;height:0;overflow-x:hidden;width:0}.fb_new_ui_mobile_overlay_active{overflow:hidden}@keyframes fb_mpn_landing_page_slide_in{0%{border-radius:50%;margin:0 24px;width:60px}40%{border-radius:18px}100%{margin:0 12px;width:100% - 24px}}@keyframes fb_mpn_landing_page_slide_in_from_left{0%{border-radius:50%;left:12px;margin:0 24px;width:60px}40%{border-radius:18px}100%{left:12px;margin:0 12px;width:100% - 24px}}@keyframes fb_mpn_landing_page_slide_out{0%{margin:0 12px;width:100% - 24px}60%{border-radius:18px}100%{border-radius:50%;margin:0 24px;width:60px}}@keyframes fb_mpn_landing_page_slide_out_from_left{0%{left:12px;width:100% - 24px}60%{border-radius:18px}100%{border-radius:50%;left:12px;width:60px}}@keyframes fb_mpn_landing_page_slide_up{0%{bottom:0;opacity:0}100%{bottom:24px;opacity:1}}@keyframes fb_mpn_bounce_in{0%{opacity:.5;top:100%}100%{opacity:1;top:0}}@keyframes fb_mpn_fade_out{0%{bottom:30px;opacity:1}100%{bottom:0;opacity:0}}@keyframes fb_mpn_bounce_out{0%{opacity:1;top:0}100%{opacity:.5;top:100%}}@keyframes fb_bounce_in_v2{0%{opacity:0;transform:scale(0, 0);transform-origin:bottom right}50%{transform:scale(1.03, 1.03);transform-origin:bottom right}100%{opacity:1;transform:scale(1, 1);transform-origin:bottom right}}@keyframes fb_bounce_in_from_left{0%{opacity:0;transform:scale(0, 0);transform-origin:bottom left}50%{transform:scale(1.03, 1.03);transform-origin:bottom left}100%{opacity:1;transform:scale(1, 1);transform-origin:bottom left}}@keyframes fb_bounce_out_v2{0%{opacity:1;transform:scale(1, 1);transform-origin:bottom right}100%{opacity:0;transform:scale(0, 0);transform-origin:bottom right}}@keyframes fb_bounce_out_from_left{0%{opacity:1;transform:scale(1, 1);transform-origin:bottom left}100%{opacity:0;transform:scale(0, 0);transform-origin:bottom left}}@keyframes fb_bounce_out_v2_mobile_chat_started{0%{opacity:1;top:0}100%{opacity:0;top:20px}}@keyframes fb_customer_chat_bubble_bounce_in_animation{0%{bottom:6pt;opacity:0;transform:scale(0, 0);transform-origin:center}70%{bottom:18pt;opacity:1;transform:scale(1.2, 1.2)}100%{transform:scale(1, 1)}}@keyframes slideInFromBottom{0%{opacity:.1;transform:translateY(100%)}100%{opacity:1;transform:translateY(0)}}@keyframes slideInFromBottomDelay{0%{opacity:0;transform:translateY(100%)}97%{opacity:0;transform:translateY(100%)}100%{opacity:1;transform:translateY(0)}}</style><script type="text/javascript" charset="utf-8" src="./Moduł_ 30. Testy jednostkowe w backendzie_files/t_prism_sitemessages.php" async=""></script></head>
<body class="student callus-enabled" cz-shortcut-listen="true">
<!-- Facebook Pixel Code -->
<noscript><img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=389137334769464&ev=PageView&noscript=1"/></noscript>
<!-- End Facebook Pixel Code -->
<script>
    document.getElementsByTagName('body')[0].classList.remove('no-js');
    if ( window.isDifferentZone ) {
        document.querySelector('body').classList.add('time-conversion-applied');
    }
    if ( window.hasWrongTime ) {
        document.querySelector('body').classList.add('wrong-hour');
    }
</script>

    <nav class="navbar-main hidden-sm-down dark navbar">
    <div class="nav-container">
        <div class="navbar-header clearfix">
            <button class="navbar-toggler hidden-md-up pull-right" type="button" data-toggle="collapse" data-target="#collapsingNavbarUpper"><i class="fa fa-bars"></i></button>
        </div>
        <div class="collapse navbar-toggleable-sm container" id="collapsingNavbarUpper">
            <ul class="nav navbar-nav navbar-nav-left">
                                    <li class="nav-item nav-contact">
    <span>Skontaktuj się z nami:</span>
    <a href="mailto:support@kodilla.com">
        <i class="fa fa-envelope-o"></i>
        support@kodilla.com
    </a>
    <span>lub</span>
    <a href="javascript:openChat();">
        <i class="fa fa-comments"></i>
        porozmawiaj na czacie
    </a>
</li>
                                </ul>
            <ul class="nav navbar-nav pull-right">
                                <li class="nav-item">
                    <a href="https://kodilla.com/pl/informator" class="nav-link" target="_blank">
        Informator
    </a>
                </li>
                <li class="nav-item hidden-sm-down">
    <a href="https://kodilla.com/pl/account" class="nav-link">Konto</a>
</li>
        <li class="nav-item">
    <a class="analytics-track nav-link nav-link-accent" data-event="account_logout" href="https://kodilla.com/pl/sign-out">Wyloguj</a>
</li>
                            </ul>
        </div>
    </div>
</nav>
<nav class="navbar-main light navbar">
    <div class="container clearfix">
        <a class="navbar-brand" href="https://kodilla.com/pl">
            <img src="./Moduł_ 30. Testy jednostkowe w backendzie_files/kodilla-nav-logo.svg" alt="Kodilla - szkoła programowania">
        </a>
        <span class="contact-us-button-container"></span>
        <button class="navbar-toggler pull-right collapsed" type="button" data-toggle="collapse" data-target="#navbar-main">
            <i class="fa fa-bars navbar-ico-open"></i>
            <i class="fa fa-times navbar-ico-close"></i>
        </button>
        <ul id="navbar-main" class="nav navbar-nav pull-right collapse">
            <li class="nav-item hidden-sm-down">
    <a class="dropdown-toggle nav-link" href="https://kodilla.com/pl/poznaj-nasze-bootcampy">
        Szkolenia Bootcamp
    </a>
    <ul class="bootcamp-list">
                    <li class="list-sub list-sub-fe">
                <img src="./Moduł_ 30. Testy jednostkowe w backendzie_files/menu_fer.svg" class="menu-svg" width="32px" height="32px" title="menu_fer_logo">
                <a href="https://kodilla.com/pl/bootcamp/front-end">
                    <h4 class="bootcamp-name">Front-end: React</h4>
                    <p>Naucz się tworzyć front-end aplikacji w 4 miesiące</p>
                </a>
            </li>
            <li class="list-sub">
                <img src="./Moduł_ 30. Testy jednostkowe w backendzie_files/menu_wd.svg" class="menu-svg" width="32px" height="32px" title="menu_wd_logo">
                <a href="https://kodilla.com/pl/bootcamp/webdeveloper?type=wdp">
                    <h4 class="bootcamp-name">Web Developer</h4>
                    <p>Naucz&nbsp;się tworzyć aplikacje internetowe od&nbsp;podstaw</p>
                    <span class="bootcamp-label">FRONT-END i BACK-END</span>
                </a>
            </li>

            <li class="list-sub">
                <img src="./Moduł_ 30. Testy jednostkowe w backendzie_files/menu_java.svg" class="menu-svg" width="32px" height="32px" title="menu_java_logo">
                <a href="https://kodilla.com/pl/bootcamp/java?type=jdp">
                    <h4 class="bootcamp-name">Java Developer</h4>
                    <p>Poznaj najpopularniejszy na&nbsp;świecie język programowania od&nbsp;zera</p>
                </a>
            </li>
            <li class="list-sub">
                <img src="./Moduł_ 30. Testy jednostkowe w backendzie_files/menu_python.svg" class="menu-svg" width="32px" height="32px" title="menu_python_logo">
                <a href="https://kodilla.com/pl/bootcamp/python">
                    <h4 class="bootcamp-name">Python Developer</h4>
                    <p>Zdobądź kompetencje do tworzenia rozwiązań webowych</p>
                </a>
            </li>
            <li class="list-sub">
                <img src="./Moduł_ 30. Testy jednostkowe w backendzie_files/menu_tester.svg" class="menu-svg" width="32px" height="32px" title="menu_tester_logo">
                <a href="https://kodilla.com/pl/bootcamp/tester-automatyzujacy">
                    <h4 class="bootcamp-name">Tester Automatyzujący</h4>
                    <p>Poznaj podstawy testowania automatycznego w Javie</p>
                </a>
            </li>
            <li class="list-sub">
                <img src="./Moduł_ 30. Testy jednostkowe w backendzie_files/menu_game.svg" class="menu-svg" width="32px" height="32px" title="menu_mage_logo">
                <a href="https://kodilla.com/pl/bootcamp/game-dev">
                    <h4 class="bootcamp-name">Mobile Game Developer</h4>
                    <p>Zdobądź kompetencje do tworzenia gier</p>
                    <span class="bootcamp-label">nowość</span>
                </a>
            </li>
            </ul>
</li>

                        <li class="nav-item hidden-sm-down">
    <a class="dropdown-toggle nav-link" href="https://kodilla.com/pl/szkolenia-pro">
        Szkolenia Pro
    </a>
    <ul>
        <li><a href="https://kodilla.com/pl/szkolenia-pro/mikroserwisy" class="nav-link">Mikroserwisy w Javie</a></li>
        <li><a href="https://kodilla.com/pl/szkolenia-pro/spring-hibernate" class="nav-link">Spring i Hibernate</a></li>
        <li><a href="https://kodilla.com/pl/szkolenia-pro/wielowatkowosc" class="nav-link">Wielowątkowość w Javie</a></li>
        <li><a href="https://kodilla.com/pl/szkolenia-pro/django" class="nav-link">Aplikacje webowe z Django</a></li>
        <li><a href="https://kodilla.com/pl/szkolenia-pro/wizualizacja-danych" class="nav-link">Analiza danych w Pythonie</a></li>
        <li><a href="https://kodilla.com/pl/szkolenia-pro/machine-learning" class="nav-link">Podstawy Machine Learning</a></li>
        <li><a href="https://kodilla.com/pl/szkolenia-pro/bigdata-pyspark" class="nav-link">Big Data z PySpark</a></li>
        <li><a href="https://kodilla.com/pl/szkolenia-pro/automatyzacja-testow" class="nav-link">Automatyzacja testów</a></li>
        <li><a href="https://kodilla.com/pl/szkolenia-pro/vanilla-js" class="nav-link">Advanced Vanilla JS</a></li>
        <li><a href="https://kodilla.com/pl/szkolenia-pro/typescript" class="nav-link">TypeScript - kurs praktyczny</a></li>
        <li><a href="https://kodilla.com/pl/szkolenia-pro/vue3" class="nav-link">Vue3 - kompletny przewodnik</a></li>
        <li><a href="https://kodilla.com/pl/szkolenia-pro/zaawansowany-backend" class="nav-link">Backend zaawansowany</a></li>
    </ul>
</li>
            <li class="nav-item hidden-sm-down">
    <a class="dropdown-toggle nav-link">
        Strefa kursanta
    </a>
    <ul>
                    <li><a href="https://kodilla.com/pl/bootcamp-dashboard/407" class="nav-link">Bootcamp WD PLUS 2020-12</a></li>
                    <li><a class="nav-link" href="https://kodilla.com/pl/kursy">Samodzielne kursy</a></li>
                    <li><a class="nav-link" href="https://chat.kodilla.com/" target="_blank">Komunikator</a></li>
                    <li><a class="nav-link" href="https://kodilla.com/pl/projects">Moje projekty</a></li>
    </ul>
</li>
                            <li class="nav-item hidden-sm-down">
    <a class="dropdown-toggle nav-link">
        O nas
    </a>
    <ul class="about-us">
        <li><a href="https://kodilla.com/pl/mentorzy" class="nav-link">Mentorzy</a></li>
        <li><a href="https://kodilla.com/pl/zespol" class="nav-link">Zespół Kodilli</a></li>
        <li><a href="https://kodilla.com/pl/o-nas" class="nav-link">O firmie</a></li>
    </ul>
</li>
                                                                    <li class="nav-item hidden-md-up nav-group">
    <span class="mobile-menu-separator">Szkolenia Bootcamp</span>
    <ul>
                    <li class="nav-item list-sub-fe">
                <a class="nav-link nav-link-with-label" href="https://kodilla.com/pl/bootcamp/front-end">Bootcamp Front-end: React
                </a>
            </li>
                <li class="nav-item">
            <a class="nav-link nav-link-with-label" href="https://kodilla.com/pl/bootcamp/webdeveloper">Bootcamp Web Developer
                <span class="bootcamp-label">FRONT-END i BACK-END</span>
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="https://kodilla.com/pl/bootcamp/java">Bootcamp Java</a>
        </li>
        <li class="nav-item list-sub-fe">
            <a class="nav-link nav-link-with-label" href="https://kodilla.com/pl/bootcamp/tester-automatyzuj%C4%85cy">Bootcamp Tester Automatyzujący
            </a>
        </li>
        <li class="nav-item list-sub-fe">
            <a class="nav-link nav-link-with-label" href="https://kodilla.com/pl/bootcamp/python">Python Developer
            </a>
        </li>
        <li class="nav-item list-sub-fe">
            <a class="nav-link nav-link-with-label" href="https://kodilla.com/pl/bootcamp/game-dev">Mobile Game Developer
                <span class="bootcamp-label">nowość</span>
            </a>
        </li>
    </ul>
</li>
<li class="nav-item hidden-md-up nav-group">
    <a class="nav-link-bold" href="https://kodilla.com/pl/szkolenia-pro">Szkolenia Pro</a>
</li>
            <li class="nav-item hidden-md-up nav-group">
            <span class="mobile-menu-separator">Strefa kursanta</span>
            <ul>
                <li class="nav-item ">
                                            <a class="nav-link" href="https://kodilla.com/pl/bootcamp-dashboard/407">
                            Bootcamp   WD PLUS 2020-12
                        </a>
                                    </li>
                <li class="nav-item ">
                    <a class="nav-link" href="https://kodilla.com/pl/kursy">Samodzielne kursy</a>
                </li>
                                    <li class="nav-item ">
                        <a class="nav-link" href="https://chat.kodilla.com/" target="_blank">Komunikator</a>
                    </li>
                                <li class="nav-item">
                    <a class="nav-link" href="https://kodilla.com/pl/projects">Moje projekty</a>
                </li>
            </ul>
        </li>
    
        
            <li class="nav-item hidden-md-up nav-group">
            <span class="mobile-menu-separator">O nas</span>
            <ul>
                <li class="nav-item">
                    <a href="https://kodilla.com/pl/mentorzy" class="nav-link">Mentorzy</a>
                </li>
                <li class="nav-item">
                    <a href="https://kodilla.com/pl/zespol" class="nav-link">Zespół Kodilli</a>
                </li>
                <li class="nav-item">
                    <a href="https://kodilla.com/pl/o-nas" class="nav-link">O firmie</a>
                </li>
            </ul>
        </li>
    
<li class="nav-item hidden-md-up nav-group">
    <span class="mobile-menu-separator">Pozostałe</span>
    <ul>
                                        
        <li class="nav-item">
            <a href="https://kodilla.com/pl/informator" class="nav-link" target="_blank">
        Informator
    </a>
        </li>
    </ul>

</li>

    <li class="nav-item hidden-md-up">
        <a class="nav-link" href="https://kodilla.com/pl/account">Konto</a>
    </li>
    <li class="nav-item hidden-md-up">
        <a class="nav-link analytics-track" data-event="account_logout" href="https://kodilla.com/pl/sign-out">Wyloguj</a>
    </li>

        
    <li class="nav-item hidden-md-up nav-group">
        <span class="mobile-menu-separator">Skontaktuj się z nami</span>
        <ul>
            <li class="nav-item">
                <a href="mailto:support@kodilla.com" class="nav-link">
                    <i class="fa fa-envelope-o"></i>
                    support@kodilla.com
                </a>
            </li>
            <li class="nav-item">
                <a href="javascript:openChat();" class="nav-link">
                    <i class="fa fa-comments"></i>
                    <span>Porozmawiaj na czacie</span>
                </a>
            </li>
        </ul>
    </li>
        </ul>
    </div>
</nav>
<main class="bootcamp module page-height-fix" id="bootcamp-module">
    <div class="aside-toggle hidden-md-up">
        <button class="navbar-toggler pull-left collapsed" type="button" data-toggle="collapse" data-target="#aside-sticky" aria-expanded="false">
            <i class="fa fa-bars navbar-ico-open"></i>
            <i class="fa fa-times navbar-ico-close"></i>
        </button>
    </div>
    <div class="table-of-contents aside-sticky collapsed collapse" id="aside-sticky">
        <section class="container">
            <div class="row">
                <aside class="module-nav col-md-4 col-md-offset-8">
                    <section class="card">
                        <div class="card-header">
                            <h4 class="card-title">Spis treści modułu</h4>
                        </div>
                        <ul class="list-group list-group-flush ps-container ps-theme-default ps-active-y" data-ps-id="d6cf9492-0d70-9862-7700-ee3826a6fe38">
                                                        <li class="list-group-item completed">
                                <a href="https://kodilla.com/pl/bootcamp-module/407/279/5935#submodule-1168" class="clearfix">
                                    <p>30.1. Pierwsze testy</p>
                                    <i class="fa fa-check-circle-o"></i>
                                    <i class="fa fa-play-circle-o"></i>
                                    <i class="fa fa-send-o"></i>
                                    <i class="fa fa-exclamation-circle"></i>
                                </a>
                            </li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/279/5935#301-pierwsze-testy-pierwsze-kroki" class="clearfix">Pierwsze kroki</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/279/5935#301-pierwsze-testy-pierwszy-testy" class="clearfix">Pierwszy testy</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/279/5935#301-pierwsze-testy-kolejne-testy" class="clearfix">Kolejne testy</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/279/5935#301-pierwsze-testy-podsumowanie" class="clearfix">Podsumowanie</a></li><li class="list-group-item list-group-flush sub task"><a href="https://kodilla.com/pl/bootcamp-module/407/279/5935#301-pierwsze-testy-zadanie-wiecej-praktyki" class="clearfix">Zadanie: więcej praktyki</a></li>
                                                        <li class="list-group-item completed">
                                <a href="https://kodilla.com/pl/bootcamp-module/407/279/5935#submodule-1169" class="clearfix">
                                    <p>30.2. Testowanie modeli Mongoose</p>
                                    <i class="fa fa-check-circle-o"></i>
                                    <i class="fa fa-play-circle-o"></i>
                                    <i class="fa fa-send-o"></i>
                                    <i class="fa fa-exclamation-circle"></i>
                                </a>
                            </li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/279/5935#302-testowanie-modeli-mongoose-zanim-przejdziemy-dalej" class="clearfix">Zanim przejdziemy dalej...</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/279/5935#302-testowanie-modeli-mongoose-testujemy-pierwszy-model" class="clearfix">Testujemy pierwszy model</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/279/5935#302-testowanie-modeli-mongoose-kolejny-test" class="clearfix">Kolejny test</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/279/5935#302-testowanie-modeli-mongoose-wieksza-wymagania-wiecej-testow" class="clearfix">Większa wymagania = więcej testów</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/279/5935#302-testowanie-modeli-mongoose-ostatni-test" class="clearfix">Ostatni test</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/279/5935#302-testowanie-modeli-mongoose-podsumowanie" class="clearfix">Podsumowanie</a></li><li class="list-group-item list-group-flush sub task"><a href="https://kodilla.com/pl/bootcamp-module/407/279/5935#302-testowanie-modeli-mongoose-zadanie-testujemy-kolejny-model" class="clearfix">Zadanie: testujemy kolejny model</a></li>
                                                        <li class="list-group-item completed">
                                <a href="https://kodilla.com/pl/bootcamp-module/407/279/5935#submodule-1170" class="clearfix">
                                    <p>30.3. Testowanie operacji CRUD</p>
                                    <i class="fa fa-check-circle-o"></i>
                                    <i class="fa fa-play-circle-o"></i>
                                    <i class="fa fa-send-o"></i>
                                    <i class="fa fa-exclamation-circle"></i>
                                </a>
                            </li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/279/5935#303-testowanie-operacji-crud-przygotowania" class="clearfix">Przygotowania</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/279/5935#303-testowanie-operacji-crud-polaczenie-z-baza-danych" class="clearfix">Połączenie z bazą danych</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/279/5935#303-testowanie-operacji-crud-read" class="clearfix">Read</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/279/5935#303-testowanie-operacji-crud-create" class="clearfix">Create</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/279/5935#303-testowanie-operacji-crud-update" class="clearfix">Update</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/279/5935#303-testowanie-operacji-crud-delete" class="clearfix">Delete</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/279/5935#303-testowanie-operacji-crud-podsumowanie" class="clearfix">Podsumowanie</a></li><li class="list-group-item list-group-flush sub task"><a href="https://kodilla.com/pl/bootcamp-module/407/279/5935#303-testowanie-operacji-crud-zadanie-testujemy-kolejny-model" class="clearfix">Zadanie: testujemy kolejny model</a></li>
                                                        <li class="list-group-item completed">
                                <a href="https://kodilla.com/pl/bootcamp-module/407/279/5935#submodule-1171" class="clearfix">
                                    <p>30.4. Testowanie endpointów</p>
                                    <i class="fa fa-check-circle-o"></i>
                                    <i class="fa fa-play-circle-o"></i>
                                    <i class="fa fa-send-o"></i>
                                    <i class="fa fa-exclamation-circle"></i>
                                </a>
                            </li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/279/5935#304-testowanie-endpointow-lokalizacja-testow" class="clearfix">Lokalizacja testów</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/279/5935#304-testowanie-endpointow-get" class="clearfix">GET</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/279/5935#304-testowanie-endpointow-post" class="clearfix">POST</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/279/5935#304-testowanie-endpointow-put" class="clearfix">PUT</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/279/5935#304-testowanie-endpointow-podsumowanie" class="clearfix">Podsumowanie</a></li><li class="list-group-item list-group-flush sub task"><a href="https://kodilla.com/pl/bootcamp-module/407/279/5935#304-testowanie-endpointow-zadanie-ostatni-test" class="clearfix">Zadanie: ostatni test</a></li>
                                                        <li class="list-group-item completed">
                                <a href="https://kodilla.com/pl/bootcamp-module/407/279/5935#submodule-1172" class="clearfix">
                                    <p>30.5. Testy w praktyce</p>
                                    <i class="fa fa-check-circle-o"></i>
                                    <i class="fa fa-play-circle-o"></i>
                                    <i class="fa fa-send-o"></i>
                                    <i class="fa fa-exclamation-circle"></i>
                                </a>
                            </li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/279/5935#305-testy-w-praktyce-opcja-1-wiecej-koncertow" class="clearfix">Opcja 1 – więcej koncertów</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/279/5935#305-testy-w-praktyce-opcja-2-ilosc-wolnych-miejsc" class="clearfix">Opcja 2 – ilość wolnych miejsc</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/279/5935#305-testy-w-praktyce-opcja-3-popraw-podstrony-prices" class="clearfix">Opcja 3 – popraw podstrony "Prices"</a></li><li class="list-group-item list-group-flush sub task"><a href="https://kodilla.com/pl/bootcamp-module/407/279/5935#305-testy-w-praktyce-zadanie-gotowe" class="clearfix">Zadanie: gotowe!</a></li>
                                                        <li class="list-group-item completed">
                                <a href="https://kodilla.com/pl/bootcamp-module/407/279/5935#submodule-1173" class="clearfix">
                                    <p>30.6. Podsumowanie</p>
                                    <i class="fa fa-check-circle-o"></i>
                                    <i class="fa fa-play-circle-o"></i>
                                    <i class="fa fa-send-o"></i>
                                    <i class="fa fa-exclamation-circle"></i>
                                </a>
                            </li>
                                                        <li class="list-group-item completed">
                                <a href="https://kodilla.com/pl/bootcamp-module/407/279/5935#submodule-1174" class="clearfix">
                                    <p>30.7. Quiz powtórkowy</p>
                                    <i class="fa fa-check-circle-o"></i>
                                    <i class="fa fa-play-circle-o"></i>
                                    <i class="fa fa-send-o"></i>
                                    <i class="fa fa-exclamation-circle"></i>
                                </a>
                            </li>
                                                    <div class="ps-scrollbar-x-rail" style="left: 0px; bottom: 3px;"><div class="ps-scrollbar-x" tabindex="0" style="left: 0px; width: 0px;"></div></div><div class="ps-scrollbar-y-rail" style="top: 0px; height: 606px; right: 3px;"><div class="ps-scrollbar-y" tabindex="0" style="top: 0px; height: 202px;"></div></div></ul>
                        <div class="card-block text-center">
                                                                                                <a href="https://kodilla.com/pl/bootcamp-dashboard/407">Powrót do dashboardu</a>
                                                                                    </div>
                    </section>
                </aside>
            </div>
        </section>
    </div>
    <section class="container module-content">
        <div class="row">
            <main class="col-md-8">
                <section class="card">
                    <div class="card-block module-header clearfix  completed ">
                        <h1 class="card-title">30. Testy jednostkowe w backendzie</h1>
                                                <i class="fa fa-bookmark fa-3x" aria-hidden="true"></i>
                    </div>
                                        <div class="card-block challenge">
                        <h3>Wyzwania:</h3>
                        <ul>
<li>poznasz task runner Mocha oraz bibliotekę asercji Chai,</li>
<li>nauczysz się jak testować modele Mongoose,</li>
<li>dowiesz się, w jaki sposób zautomatyzować testowanie endpointów.</li>
</ul>
<p>Poprzedni moduł zakończyliśmy wnioskiem, że im większy staje się nasz kod, tym mniej pewni jesteśmy jego działania. Dokładnie taki sam problem mieliśmy już po stronie klienta. Dopóki pisaliśmy proste i małe aplikacje, często wystarczały nam dwa lub trzy testy przeprowadzane "ręcznie". Wchodziliśmy do podglądu aplikacji i sprawdzaliśmy, czy wszystko gra, testując najpierw proste działania, a potem ekstremalne sytuacje – na przykład takie, w których celowo wpisywaliśmy niepoprawne dane do formularza. Metoda ta była prosta, ale skuteczna, bo dawała pewność co do działania aplikacji. Kiedy jednak kod się rozrastał i powiększała się liczba funkcjonalności, takiej pewności brakowało, zwłaszcza że mała zmiana w jednym miejscu mogła wpływać na działanie innego elementu. Wtedy z pomocą przyszły nam testy automatyczne i narzędzie o nazwie Jest. Tak samo będzie z testami w backendzie.</p>
<p>Gdy aplikacje były proste, do sprawdzenia poprawności ich działania wystarczyły Postman i MongoDB Compass. Kiedy jednak kod się rozrasta, sytuacja się zmienia, bo ciągłe sięganie do narzędzi, po każdej większej zmianie, staje się czasochłonne, a nawet irytujące. Dlatego także i tutaj korzystanie z testów automatycznych jest po prostu koniecznością.</p>
<p>Choć sama idea i składnia jest bardzo podobna (task runnera <strong>Mocha</strong> z paczką asercji <strong>Chai</strong> używa się prawie identycznie jak Jesta), to trochę inny będzie cel testów.</p>
<p>Przede wszystkim u nas serwer najczęściej pełni tylko rolę pośrednika w kontakcie z innym serwerem (serwer API) lub między klientami (WebSocket). Nawet w naszym większym przykładzie z witryną festiwalu, endpointy miały za zadanie tylko kontaktować się z bazą danych i zwracać jakiś rezultat klientowi. Nie mamy tutaj zatem ogromu funkcji i relacji, jak to było po stronie klienta. Tym samym raczej <strong>rzadko będziesz mieć okazję tworzyć testy samych pojedynczych funkcji</strong>.</p>
<p>Zamiast tego, kiedy mówimy o testowaniu backendu, mamy raczej na myśli <strong>weryfikowanie modeli Mongoose</strong>, <strong>kontrolę operacji CRUD</strong> oraz <strong>sprawdzanie działania endpointów</strong>. Ewentualnie jeśli jest taka potrzeba, <strong>możemy testować również działanie WebSocketów</strong>, a więc czy serwer dobrze reaguje na zdarzenia i poprawnie je emituje. Niemniej jednak testowanie WebSocketów nie będzie tematem tego modułu.</p>
<p>Na dobrą sprawę, będziemy więc oczekiwać od tych testów dokładnie tego, co robiliśmy dotychczas sami, tylko że teraz będzie się to odbywało automatycznie.</p>

                    </div>
                                    </section>
                                    
                <section id="submodule-1168" class="card submodule completed" data-bootcamp-user-submodule-id="668563">
                <!-- klasy dla section: completed current comments -->
                    <div class="card-block submodule-header clearfix">
                        <i class="fa fa-check-circle-o fa-2x"></i>
                        <i class="fa fa-play-circle-o fa-2x"></i>
                        <i class="fa fa-exclamation-circle fa-2x"></i>
                        <i class="fa fa-send-o fa-2x"></i>
                        <h2 class="bootcamp-submodule-name">30.1. <span>Pierwsze testy</span></h2>
                                            </div>
                    <div class="card-block">
                        <div class="submodule-content">
                            <p></p>
<div class="bc-note alert-success">
<h4 class="alert-heading text-center">Czas przygotować CV, LinkedIn i portfolio!</h4>
<p>Nadszedł czas na rozpoczęcie prac nad Twoim CV, LinkedIn i portfolio. Aby przygotować je jak najlepiej, wejdź na <a href="https://kodilla.com/pl/kontakt-doradca-hr" target="_blank">stronę kontaktu z Doradcą</a> i wybierz swojego Doradcę HR oraz spotkanie (CV/LinkedIn - 30 min). Pamiętaj, aby podać swoje imię i nazwisko podczas rezerwacji!</p>
</div>
<p></p>
<p>Poprzednie moduły zaczynaliśmy od dawki teorii. Czasem było to dłuższe wprowadzenie, innym razem krótsze, ale zawsze tłumaczyliśmy, co tak naprawdę będzie tematem naszej pracy. W tej chwili jednak od razu przejdziemy do zadań praktycznych.</p>
<p>Dlaczego? Idea testów nie jest już dla Ciebie niczym nowym, wiesz, po co są nam potrzebne, kiedy warto z nich korzystać i na jakie kategorie je dzielimy. Jeśli uważasz, że słabo pamiętasz tamten materiał, po prostu przeglądnij go jeszcze raz na spokojnie. Prawdopodobnie nie będzie to jednak konieczne. Nawet jeśli wydaje Ci się, że pamięć Cię zawodzi, to pisanie testów jest na tyle intuicyjne, że po kilku przykładach z niniejszego modułu, poczujesz się znowu jak u siebie w domu.</p>
<p>Nie musimy też wprowadzać Cię jakoś szczególnie w nowe narzędzia (Mocha i Chai). Tak naprawdę korzystanie z nich będzie wręcz identyczne jak z pakietu Jest. Oczywiście tym razem testujemy trochę inne rzeczy, więc mogą pojawić się drobne różnice (a raczej nowości), ale będziemy je tłumaczyć na bieżąco.</p>
<p>Zatem, do dzieła!</p>
<h3 id="301-pierwsze-testy-pierwsze-kroki">Pierwsze kroki</h3>
<p>Na początku stwierdziliśmy, że testy jednostkowe samych funkcji nie są zbyt często stosowane w backendzie, zwłaszcza jeśli większość logiki jest przechowywana po stronie aplikacji klienckiej (tak było też najczęściej u nas). Mimo to właśnie od testów tego typu zaczniemy. Zrobimy to z dwóch powodów – po pierwsze, najprawdopodobniej prędzej czy później będziesz mieć potrzebę, aby taki kod testować, a po drugie, to coś, co już robiliśmy po stronie klienta, więc powinno Ci być łatwiej odnaleźć się w temacie i przypomnieć sobie podstawowe idee.</p>
<p>Nasz przykład jest bardzo prosty. Otrzymamy gotowy zaczątek projektu serwera API, który będzie w stanie się uruchamiać, choć nie obsłuży jeszcze żadnych endpointów. Nie jest to dla nas problemem, bo zajmiemy się wyłącznie plikiem <code>cutText.js</code>, a dokładnie gotową funkcją, która jest w nim przechowywana. Naszym zadaniem będzie jej przetestowanie.</p>
<p>Całość możesz pobrać pod <a href="https://uploads.kodilla.com/bootcamp/wdp/30.testing/BooksApi.zip" target="_blank">poniższym linkiem</a>.</p>
<p>Zacznij od rozpakowania paczki i zainicjowania projektu (<code>yarn init</code>).</p>
<p>Struktura nie jest skomplikowana. Plik <code>server.js</code> służy do inicjacji serwera, a w folderze <code>utils</code> przechowywane są funkcje pomocnicze, których jeszcze nie używamy, ale wkrótce będziemy i dlatego musimy przygotować do nich testy. W samym katalogu <code>utils</code> są dwa pliki z funkcjami.</p>
<p>Otwórz <code>cutText.js</code> i przeanalizuj działanie tego kodu:</p>
<pre class=" language-js"><code class=" language-js">exports<span class="token punctuation">.</span><span class="token method-variable function-variable method function property-access">default</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">content<span class="token punctuation">,</span> maxLength</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">if</span><span class="token punctuation">(</span>content<span class="token punctuation">.</span><span class="token property-access">length</span> <span class="token operator">&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword control-flow">return</span> <span class="token string">'Error'</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">if</span><span class="token punctuation">(</span>content<span class="token punctuation">.</span><span class="token property-access">length</span> <span class="token operator">&lt;=</span> maxLength<span class="token punctuation">)</span> <span class="token keyword control-flow">return</span> content<span class="token punctuation">;</span>
  <span class="token keyword control-flow">return</span> content<span class="token punctuation">.</span><span class="token method function property-access">substr</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> content<span class="token punctuation">.</span><span class="token method function property-access">lastIndexOf</span><span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">,</span> maxLength<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'...'</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
<p>Idea jest prosta. Funkcja przyjmuje dwa argumenty – <code>content</code> i <code>maxLength</code>. Pierwszy po prostu przekazuje treść do skrócenia, a drugi informuje, jak długi ma być tekst już po przycięciu.</p>
<p>Samo działanie też nie jest skomplikowane. Jeśli treści nie ma, funkcja zwróci <code>Error</code>. W przypadku, gdy <code>maxLength</code>, a więc założony nowy rozmiar, jest większy lub równy aktualnej długości tekstu, pozostawiamy go bez zmian, nie ma wtedy bowiem czego przycinać. W innej sytuacji zwracany jest odpowiednio skrócony tekst. Co istotne – funkcja nie przycina treści na ślepo. Jeśli koniec tekstu byłby wewnątrz jakiegoś słowa, to utniemy całość trochę wcześniej, dokładnie przed tym niepełnym słowem, a więc np. <code>cutText('Up to the hill!', 8)</code> nie zwróci <code>Up to th</code>, lecz <code>Up to</code>. Na końcu przyciętego tekstu dodatkowo dodawany jest jeszcze wielokropek (<code>...</code>).</p>
<p>Konkretny kod nie jest dla nas najważniejszy, wiemy jednak czego mamy od tej funkcji oczekiwać. Przed samymi testami, pozostał jeszcze tylko jeden krok, a mianowicie musimy pobrać task runner oraz bibliotekę asercji, które nam pomogą.</p>
<p>Tym razem skorzystamy z zestawu <strong>Mocha i Chai</strong>. Zapytasz – a czy nie można by użyć Jesta? Cóż, w teorii tak. Pamiętaj jednak, że to framework stworzony specjalnie z myślą o testowaniu frontendu, przez co ma pewne braki i ograniczenia w innych obszarach. Mocha i Chai są narzędziami przygotowanymi zarówno do pracy po stronie klienta, jak i serwera.</p>
<p>Przejdźmy więc do instalacji:</p>
<pre class=" language-markup"><code class=" language-markup">yarn add mocha@6.2.1 chai@4.2.0</code></pre>
<div class="bc-note alert-success">
<h4 class="alert-heading text-center">Mocha + Chai vs Jest</h4>
<p>Przy okazji wyjaśnijmy jedną rzecz. Dlaczego w przypadku Jesta potrzebowaliśmy tylko jednej paczki, a tutaj konieczne są aż dwie?</p>
<p>Mocha jest wyłącznie task runnerem. Oznacza to, że potrafi obsługiwać skrypty z testami na tyle, żeby je uruchomić oraz rozumieć składnię ich opisów. Nie zawiera jednak funkcji asercji do łatwego sprawdzania poprawności tego, co otrzymaliśmy w <code>received</code>, względem tego, czego oczekiwaliśmy (<code>expected</code>). Nie mamy tu więc zestawu funkcji typu <code>.toBe</code>, czy <code>exists</code>, które możesz pamiętać z Jesta. Wszystko musielibyśmy sprawdzać za pomocą czystego JS-a lub ewentualnie przy użyciu biblioteki <code>assert</code> wbudowanej w Node.js, która cóż... nie jest specjalnie przyjazna w pracy.</p>
<p>Dlatego też sięgając po Mochę, od razu instalujemy bibliotekę asercji. Może to być <strong>should.js</strong>, <strong>expect.js</strong>, czy właśnie <strong>chai.js</strong>. Każda będzie działać w gruncie rzeczy tak samo. My wybraliśmy tę trzecią z racji jej dużej popularności.</p>
<p>Zatem dlaczego Jest nie potrzebuje podobnego zabiegu? Ponieważ <strong>Jest to nie tylko task runner, ale również biblioteka asercji</strong>. A żeby być bardziej precyzyjnym – to task runner, który ma domyślnie wbudowaną własną bibliotekę asercji, przez co jest samowystarczalny.</p>
</div>
<p>Od razu możemy przygotować task w <code>package.json</code>, który będzie uruchamiać nasze testy. Pamiętasz, jak wyglądało to w Jest? Bardzo prosto – stosowaliśmy komendę <code>jest</code>. Tutaj będzie podobnie, wystarczy użycie <code>mocha</code>.</p>
<pre class=" language-js"><code class=" language-js"><span class="token string">"test"</span><span class="token operator">:</span> <span class="token string">"mocha"</span></code></pre>
<p>Warto jednak skorzystać jeszcze z opcji <code>--watch</code>, która zapewni nam ponowne przetestowanie kodu w przypadku jakichkolwiek zmian.</p>
<pre class=" language-js"><code class=" language-js"><span class="token string">"test"</span><span class="token operator">:</span> <span class="token string">"mocha --watch"</span></code></pre>
<h3 id="301-pierwsze-testy-pierwszy-testy">Pierwszy testy</h3>
<p>Przejdźmy już do samych testów. Zacznijmy od utworzenia pliku, w którym będziemy je przechowywać.</p>
<p>Domyślnie Mocha szuka plików z testami w folderze <code>test</code> w głównym katalogu. Taka opcja sprawdza się, gdy piszemy np. testy integracyjne albo testy samego API. Nie są one kojarzone z jednym plikiem czy funkcjonalnością, zatem wydzielenie osobnego folderu wydaje się bardzo dobrym pomysłem.</p>
<p>Sytuacja wygląda trochę inaczej w przypadku testów jednostkowych. Tutaj lepiej trzymać pliki z testami bliżej plików z funkcjami, których się tyczą.</p>
<p>Na szczęście Mocha pozwala łatwo dodać taką funkcjonalność. Wystarczy, że zmodyfikujemy nasz task <code>test</code>.</p>
<pre class=" language-js"><code class=" language-js"><span class="token string">"test"</span><span class="token operator">:</span> <span class="token string">"mocha --watch \"./{,!(node_modules|client)/**/}*.test.js\""</span></code></pre>
<p>Taki skrypt powinien wyszukiwać wszystkie pliki w naszym katalogu, których rozszerzenie to <code>.test.js</code> – nieważne, czy są w folderze <code>test</code>, czy może <code>utils</code>. Przy okazji jednak ustalamy, że nie chcemy przeszukiwać katalogu <code>node_modules</code>, ani katalogu <code>client</code>.</p>
<p>Pierwszy problem mamy więc z głowy. Przejdźmy teraz do katalogu <code>utils</code>. Utwórz w nim nowy folder <code>test</code>, a w nim plik – <code>cutText.test.js</code>, w którym będziemy zapisywać testy. Oczywiście to tylko nasza konwencja. Równie dobrze moglibyśmy trzymać go obok plików z samymi funkcjami, jednak w przypadku większej ich ilości, zrobiłby się spory bałagan.</p>
<h4>Założenia</h4>
<p>Przejdź teraz do tego pliku. Czas zastanowić się jakie testy będą nam potrzebne. Biorąc pod uwagę założenia działania tej funkcji, lista wymagań mogłaby być następująca:</p>
<ul>
<li>Jeśli argument <code>content</code> nie jest stringiem, to funkcja powinna zwrócić <code>Error</code>.</li>
<li>Jeśli długość tekstu w <code>content</code> jest równa 0, to funkcja powinna zwrócić <code>Error</code>.</li>
<li>Jeśli <code>maxLength</code> nie jest liczbą, to funkcja powinna zwrócić <code>Error</code>.</li>
<li>Jeśli <code>maxLength</code> jest mniejsze od zera lub równe zero, to funkcja powinna zwrócić <code>Error</code>.</li>
<li>Jeśli <code>content</code> i <code>maxLength</code> są poprawne i <code>maxLength</code> jest większe lub równe <code>content.length</code>, to funkcja powinna zwrócić <code>content</code> bez żadnych zmian.</li>
<li>Jeśli <code>content</code> i <code>maxLength</code> są poprawne i <code>maxLength</code> jest mniejsze od <code>content.length</code>, to funkcja powinna zwrócić tekst przycięty do <code>maxLength</code> ilości znaków. Przy czym przycięcie nie może nastąpić w środku słowa. Jeśli miałoby tak być, to funkcja powinna zwrócić tekst przycięty przed tym niepełnym słowem.</li>
<li>Jeśli <code>content</code> i <code>maxLength</code> są poprawne i <code>maxLength</code> jest mniejsze od <code>content.length</code>, to funkcja powinna zwrócić na końcu tekstu <code>...</code>.</li>
</ul>
<p>Lista jest stosunkowo długa jak na tak małą funkcję, ale z drugiej strony musi wyczerpać temat i dać nam pewność, że kod nigdy nas nie zawiedzie. Same testy nie powinny być za to bardzo skomplikowane. Zauważ, że będziemy sprawdzać dość proste przypadki. Dzięki temu masz szansę, aby w przyjazny i szybki sposób przypomnieć sobie, jak testowanie w ogóle wygląda.</p>
<h4>Bierzemy się do pracy</h4>
<p>Na początku pliku <code>cutText.test.js</code> zaimportuj funkcję <code>cutText</code>:</p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> cutText <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../cutText.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Musimy to zrobić, jeśli chcemy ją sprawdzić.</p>
<p>Co dalej? Jak zapewne pamiętasz, w Jest stworzylibyśmy blok <code>describe</code>, a następnie zapisywalibyśmy pojedyncze testy w <code>it</code>. Mamy dla Ciebie dobrą wiadomość – tutaj wygląda to dokładnie tak samo.</p>
<p>Zacznijmy więc od dodania bloku <code>describe</code>, a następnie pierwszego <code>it</code> dla testu numer jeden.</p>
<pre class=" language-js"><code class=" language-js"><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'CutText'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>

  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should return an error if "content" arg is not a string'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>

  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Wygląda znajomo, prawda?</p>
<p>Teraz przejdźmy do testu.</p>
<pre class=" language-js"><code class=" language-js"><span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should return an error if "content" arg is not a string'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">expect</span><span class="token punctuation">(</span><span class="token function">cutText</span><span class="token punctuation">(</span><span class="token keyword nil">undefined</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">to</span><span class="token punctuation">.</span><span class="token method function property-access">equal</span><span class="token punctuation">(</span><span class="token string">'Error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span><span class="token function">cutText</span><span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">to</span><span class="token punctuation">.</span><span class="token method function property-access">equal</span><span class="token punctuation">(</span><span class="token string">'Error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span><span class="token function">cutText</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">to</span><span class="token punctuation">.</span><span class="token method function property-access">equal</span><span class="token punctuation">(</span><span class="token string">'Error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span><span class="token function">cutText</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">to</span><span class="token punctuation">.</span><span class="token method function property-access">equal</span><span class="token punctuation">(</span><span class="token string">'Error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span><span class="token function">cutText</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">to</span><span class="token punctuation">.</span><span class="token method function property-access">equal</span><span class="token punctuation">(</span><span class="token string">'Error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Jak widzisz, same asercje też niewiele się różnią. Nazewnictwo metod jest trochę inne, ale równie intuicyjne. Mimo innego task runnera możesz poczuć się więc jak u siebie w domu.</p>
<p>Sam test nie jest skomplikowany. Sprawdza po prostu funkcję <code>cutText</code> w sytuacjach, kiedy typ argumentu <code>content</code> będzie inny niż string. Oprócz standardowych typów, jak <code>number</code> czy <code>object</code>, przy okazji kontrolujemy też <code>undefined</code>. Tym samym upewniamy się, czy funkcja zwróci <code>Error</code> również wtedy, kiedy argument będzie zwyczajnie pusty.</p>
<p>Co do drugiego argumentu, który u nas zawsze jest równy <code>20</code>, komentarz wydaje się zbędny. Przekazujemy po prostu pierwszą lepszą poprawną wartość tego argumentu, aby zawsze był prawidłowy. Jego brak mógłby sfałszować wyniki testu. Pomyśl, co by było, gdyby np. funkcję napisano tak, że sprawdzałaby tylko drugi argument i przy jego braku zwracała <code>Error</code>, a pierwszego już nie. Test <code>cutText(20)</code> dałby nam wtedy "niby" poprawny tekst <code>Error</code>, mimo tego, że w takiej sytuacji byłoby to efektem nie tyle dobrej reakcji na błędny <code>content</code>, co raczej na brak drugiego argumentu. Nie chcemy takich sytuacji.</p>
<p>Uruchom teraz task <code>test</code>.</p>
<a href="./Moduł_ 30. Testy jednostkowe w backendzie_files/Test1.png" class="img-modal-group"><img src="./Moduł_ 30. Testy jednostkowe w backendzie_files/Test1.png" alt="image" style="width: auto;"></a>
<p>Oj, nie tego się spodziewaliśmy. Co ciekawe jednak błąd wskazuje nie tyle problem z przejściem testu przez <code>cutText</code>, ale z samą funkcją <code>expect</code>. Skąd ten komunikat?</p>
<p>Wspominaliśmy, że Jest ma wbudowaną bibliotekę asercji, ale w przypadku Mochy jest inaczej. Widzimy, że potrafiła poradzić sobie z <code>describe</code> czy <code>it</code>, ale funkcje asercji to już nie jej bajka. Zdawaliśmy sobie z tego sprawę i właśnie po to pobraliśmy również Chai, wystarczy więc ją poprawnie zaimportować.</p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> expect <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'chai'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">expect</span><span class="token punctuation">;</span></code></pre>
<p>Teraz <code>test</code> powinien zadziałać już poprawnie.</p>
<a href="./Moduł_ 30. Testy jednostkowe w backendzie_files/Test2.png" class="img-modal-group"><img src="./Moduł_ 30. Testy jednostkowe w backendzie_files/Test2.png" alt="image" style="width: auto;"></a>
<p>Task faktycznie działa już dobrze, test również, ale jak widać, funkcja nie jest w stanie go pozytywnie przejść. Okazuje się, że nie tylko nie zwraca nam komunikatu <code>Error</code> w każdym ze sprawdzanych przypadków, ale do tego jeszcze zwyczajnie się "wysypuje". Jak widać, decyzja o przetestowaniu tej funkcji była bardzo dobra.</p>
<p>Twoim zadaniem jest więc naprawienie teraz tej funkcji, tak aby spełniała wymagania testu.</p>
<p class="text-center">
  <span class="collapse-toggles">
    <a href="https://kodilla.com/pl/bootcamp-module/407/279/5935#collapse-PW70As9Br-toggle" class="btn btn-primary collapsed" data-toggle="collapse">Pokaż odpowiedź</a>
    <a href="https://kodilla.com/pl/bootcamp-module/407/279/5935#collapse-PW70As9Br-toggle" class="btn btn-primary collapsed" data-toggle="collapse">Ukryj odpowiedź</a>
  </span>
</p>
<div id="collapse-PW70As9Br-toggle" class="collapse">
<pre class=" language-js"><code class=" language-js"><span class="token keyword control-flow">if</span><span class="token punctuation">(</span><span class="token keyword">typeof</span> content <span class="token operator">!==</span> <span class="token string">'string'</span><span class="token punctuation">)</span> <span class="token keyword control-flow">return</span> <span class="token string">'Error'</span><span class="token punctuation">;</span></code></pre>
<p>Wystarczy dodać warunek, który w przypadku wykrycia, że <code>content</code> jest czymś innym niż <code>string</code>, zwróci <code>Error</code>.</p>
</div>
<p>Po zmianach ponownie sprawdź konsolę. Jeśli wszystko poszło dobrze, to naszym oczom ukaże się taki widok:</p>
<a href="./Moduł_ 30. Testy jednostkowe w backendzie_files/Test3.png" class="img-modal-group"><img src="./Moduł_ 30. Testy jednostkowe w backendzie_files/Test3.png" alt="image" style="width: auto;"></a>
<p>Dokładnie na to czekaliśmy!</p>
<p>Pierwszy test jest już gotowy, a funkcja pozytywnie go przechodzi. W teorii robimy coś nowego, ale musisz przyznać, że można mieć małe <em>déjà vu</em>. Wszystko wygląda prawie tak samo, jak testy przeprowadzane w module o frontendzie.</p>
<h3 id="301-pierwsze-testy-kolejne-testy">Kolejne testy</h3>
<h4>Test 2</h4>
<p>Skoro tak dobrze poszło nam z pierwszym, możemy iść dalej. Test numer dwa brzmi tak: jeśli długość tekstu <code>content</code> jest równa 0, to funkcja powinna zwrócić <code>Error</code>.</p>
<p>Tutaj skrypt będzie o wiele krótszy:</p>
<pre class=" language-js"><code class=" language-js"><span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should return an error if "content" arg length is 0'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">expect</span><span class="token punctuation">(</span><span class="token function">cutText</span><span class="token punctuation">(</span><span class="token string">''</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">to</span><span class="token punctuation">.</span><span class="token method function property-access">equal</span><span class="token punctuation">(</span><span class="token string">'Error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Funkcja powinna przejść go pozytywnie, nawet bez żadnych zmian.</p>
<h4>Test 3</h4>
<p>Przypomnijmy założenie: jeśli <code>maxLength</code> nie jest liczbą, to funkcja powinna zwrócić <code>Error</code>.</p>
<p>Test jest podobny do tego, od którego zaczęliśmy, z tym że teraz to pierwszy parametr będzie miał ustawioną poprawną wartość.</p>
<pre class=" language-js"><code class=" language-js"><span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should return an error if "maxLength" arg is not a number'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">expect</span><span class="token punctuation">(</span><span class="token function">cutText</span><span class="token punctuation">(</span><span class="token string">'Lorem Ipsum'</span><span class="token punctuation">,</span> <span class="token keyword nil">undefined</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">to</span><span class="token punctuation">.</span><span class="token method function property-access">equal</span><span class="token punctuation">(</span><span class="token string">'Error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span><span class="token function">cutText</span><span class="token punctuation">(</span><span class="token string">'Lorem Ipsum'</span><span class="token punctuation">,</span> <span class="token string">'abc'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">to</span><span class="token punctuation">.</span><span class="token method function property-access">equal</span><span class="token punctuation">(</span><span class="token string">'Error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span><span class="token function">cutText</span><span class="token punctuation">(</span><span class="token string">'Lorem Ipsum'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">to</span><span class="token punctuation">.</span><span class="token method function property-access">equal</span><span class="token punctuation">(</span><span class="token string">'Error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span><span class="token function">cutText</span><span class="token punctuation">(</span><span class="token string">'Lorem Ipsum'</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">to</span><span class="token punctuation">.</span><span class="token method function property-access">equal</span><span class="token punctuation">(</span><span class="token string">'Error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span><span class="token function">cutText</span><span class="token punctuation">(</span><span class="token string">'Lorem Ipsum'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">to</span><span class="token punctuation">.</span><span class="token method function property-access">equal</span><span class="token punctuation">(</span><span class="token string">'Error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Tym razem jednak funkcja znowu nie podoła.</p>
<a href="./Moduł_ 30. Testy jednostkowe w backendzie_files/Test4.png" class="img-modal-group"><img src="./Moduł_ 30. Testy jednostkowe w backendzie_files/Test4.png" alt="image" style="width: auto; max-width: 50%;"></a>
<p>Ponownie musimy ją odpowiednio zmodyfikować. Tym razem poradzisz sobie bez naszej pomocy, prawda? ;)</p>
<h4>Test 4</h4>
<p>Założenie brzmi: jeśli <code>maxLength</code> jest mniejsze od zera lub równe zero, to funkcja powinna zwrócić <code>Error</code>.</p>
<p>Test ponownie będzie krótki...</p>
<pre class=" language-js"><code class=" language-js"><span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should return an error if "maxLength" is lower or equal 0'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">expect</span><span class="token punctuation">(</span><span class="token function">cutText</span><span class="token punctuation">(</span><span class="token string">'Lorem Ipsum'</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">to</span><span class="token punctuation">.</span><span class="token method function property-access">equal</span><span class="token punctuation">(</span><span class="token string">'Error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span><span class="token function">cutText</span><span class="token punctuation">(</span><span class="token string">'Lorem Ipsum'</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">to</span><span class="token punctuation">.</span><span class="token method function property-access">equal</span><span class="token punctuation">(</span><span class="token string">'Error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Funkcja niestety go nie przejdzie.</p>
<p>W tym miejscu warto już zwrócić uwagę, jak bardzo testy potrafią nam pomóc. Kiedy po raz pierwszy analizowaliśmy funkcję <code>cutText</code>, wydawało się, że jest ona napisana w naprawdę sensowny sposób. Tymczasem okazuje się, że ma wiele dziur i bardzo łatwo można ją doprowadzić do stanu "wysypania się". Na szczęście, dzięki testom, powoli to zmieniamy.</p>
<h4>Test 5</h4>
<p>Jeśli <code>content</code> i <code>maxLength</code> są poprawne i <code>maxLength</code> jest większe lub równe <code>content.length</code>, to funkcja powinna zwrócić <code>content</code> bez żadnych zmian.</p>
<p>Sprawdzimy tutaj dwa przypadki: kiedy <code>maxLength</code> jest większy niż długość <code>content</code> i kiedy obie wartości są równe.</p>
<pre class=" language-js"><code class=" language-js"><span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should return "content" without changes if proper args'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">expect</span><span class="token punctuation">(</span><span class="token function">cutText</span><span class="token punctuation">(</span><span class="token string">'Lorem Ipsum'</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">to</span><span class="token punctuation">.</span><span class="token method function property-access">equal</span><span class="token punctuation">(</span><span class="token string">'Lorem Ipsum'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span><span class="token function">cutText</span><span class="token punctuation">(</span><span class="token string">'Lorem Ipsum'</span><span class="token punctuation">,</span> <span class="token number">11</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">to</span><span class="token punctuation">.</span><span class="token method function property-access">equal</span><span class="token punctuation">(</span><span class="token string">'Lorem Ipsum'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Akurat tutaj funkcja zadziała poprawnie.</p>
<h4>Ostatnie testy</h4>
<p>Zostały nam jeszcze tylko dwa testy:</p>
<ul>
<li>Jeśli <code>content</code> i <code>maxLength</code> są poprawne i <code>maxLength</code> jest mniejsze od <code>content.length</code>, to funkcja powinna zwrócić tekst przycięty do <code>maxLength</code> ilości znaków. Przy czym przycięcie nie może nastąpić w środku słowa. Jeśli miałoby tak być, to funkcja powinna zwrócić tekst przycięty przed tym niepełnym słowem.</li>
<li>Jeśli <code>content</code> i <code>maxLength</code> są poprawne i <code>maxLength</code> jest mniejsze od <code>content.length</code>, to funkcja powinna zwrócić na końcu tekstu <code>...</code>.</li>
</ul>
<p>Połączmy je w jeden:</p>
<pre class=" language-js"><code class=" language-js"><span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should return good cut "content" if proper args'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">expect</span><span class="token punctuation">(</span><span class="token function">cutText</span><span class="token punctuation">(</span><span class="token string">'Lorem Ipsum dolor sit amet'</span><span class="token punctuation">,</span> <span class="token number">14</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">to</span><span class="token punctuation">.</span><span class="token method function property-access">equal</span><span class="token punctuation">(</span><span class="token string">'Lorem Ipsum...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span><span class="token function">cutText</span><span class="token punctuation">(</span><span class="token string">'Lorem Ipsum dolor sit amet'</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">to</span><span class="token punctuation">.</span><span class="token method function property-access">equal</span><span class="token punctuation">(</span><span class="token string">'Lorem...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span><span class="token function">cutText</span><span class="token punctuation">(</span><span class="token string">'Lorem Ipsum dolor sit amet'</span><span class="token punctuation">,</span> <span class="token number">17</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">to</span><span class="token punctuation">.</span><span class="token method function property-access">equal</span><span class="token punctuation">(</span><span class="token string">'Lorem Ipsum dolor...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Sprawdzamy tu dwie możliwości – kiedy przycinamy tekst pomiędzy i w środku słowa. W tej drugiej sytuacji <code>cutText</code> powinna zwrócić tekst przycięty, ale jeszcze z całym ostatnim wyrazem.</p>
<p>Funkcja przejdzie ten test pozytywnie.</p>
<a href="./Moduł_ 30. Testy jednostkowe w backendzie_files/Test5.png" class="img-modal-group"><img src="./Moduł_ 30. Testy jednostkowe w backendzie_files/Test5.png" alt="image" style="width: auto; max-width: 50%;"></a>
<h3 id="301-pierwsze-testy-podsumowanie">Podsumowanie</h3>
<p>Jak widzisz, pomimo nowego materiału, nie było tu zbyt wielu nowości. Testy w backendzie są nieodzowne, a skoro ich pisanie jest równie intuicyjne, jak po stronie klienta, grzechem byłoby się w tym temacie nie rozwinąć.</p>

                        </div>
                    </div>
                                        <div class="card-block task-card">
                        <h3 id="301-pierwsze-testy-zadanie-wiecej-praktyki">Zadanie: <span class="task-title">więcej praktyki</span></h3>
                        <div class="task-content">
                            <p>Czas na małą dawkę praktyki. Twoim zadaniem będzie napisanie testów do funkcji <code>formatFullname</code>, którą znajdziesz w <code>utils/formatFullname.js</code>.</p>
<p>Wygląda ona następująco:</p>
<pre class=" language-js"><code class=" language-js">exports<span class="token punctuation">.</span><span class="token method-variable function-variable method function property-access">default</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">fullName</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span> firstName<span class="token punctuation">,</span> lastName <span class="token punctuation">]</span> <span class="token operator">=</span> fullName<span class="token punctuation">.</span><span class="token method function property-access">split</span><span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">if</span><span class="token punctuation">(</span><span class="token operator">!</span>firstName <span class="token operator">||</span> <span class="token operator">!</span>lastName<span class="token punctuation">)</span> <span class="token keyword control-flow">return</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">return</span> firstName<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token property-access">toUpperCase</span> <span class="token operator">+</span> firstName<span class="token punctuation">.</span><span class="token method function property-access">slice</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> lastName<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token property-access">toUpperCase</span> <span class="token operator">+</span> lastName<span class="token punctuation">.</span><span class="token method function property-access">slice</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">toLowerCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
<p>Kod powinien działać dość prosto. W założeniu funkcja ma przyjmować jeden argument (<code>fullName</code>), który musi być stringiem w formacie <code>&lt;firstname&gt; &lt;lastname&gt;</code> (np. <code>John Doe</code>). Funkcja nie powinna zakładać z góry, że wielkość liter jest poprawna, a zatem <code>fullName</code> może wyglądać np. tak <code>jOHn dOE</code>.</p>
<p>Zadaniem skryptu jest poprawienie właśnie takich błędnych przypadków – nie ważne, jaka będzie wielkość poszczególnych otrzymanych liter, zwrócony ma zostać właściwy zapis. Zatem <code>amanda doe</code> zostanie zmienione na <code>Amanda Doe</code>, <code>JOHN DOE</code> lub <code>JOHN doE</code> na <code>John Doe</code> itd.</p>
<p>Dodatkowo:</p>
<ul>
<li>jeśli nie podano nic, to funkcja powinna zwrócić tekst <code>Error</code>,</li>
<li>jeśli podano coś innego niż string, to funkcja powinna zwrócić tekst <code>Error</code>,</li>
<li>jeśli format otrzymanych danych jest inny niż <code>&lt;firstname&gt; &lt;lastname&gt;</code>, czyli np. podano coś więcej po kolejnej spacji (<code>John Doe Test</code>) albo podano tylko imię lub tylko nazwisko (np. tylko <code>John</code>), to funkcja również powinna zwrócić <code>Error</code>.</li>
</ul>
<p>Cały proces będzie oczywiście taki sam jak w przypadku <code>cutText</code>.</p>
<ol>
<li>Zacznij od stworzenia pliku <code>formatFullname.test.js</code> w folderze <code>utils/test</code>.</li>
<li>Następnie zastanów się, co warto przetestować, oczywiście biorąc pod uwagę listę założeń.</li>
<li>W kolejnym kroku napisz po kolei każdy z testów. Pamiętaj, że funkcja nie zawsze przejdzie je poprawnie. W takich wypadkach odpowiednio ją na bieżąco modyfikuj.</li>
<li>Gdy funkcja zaliczy wszystkie założone testy, zadanie będzie gotowe.</li>
</ol>
<p>Powodzenia!</p>

                        </div>
                    </div>
                                        <div class="card-block submodule-footer clearfix  completed ">
                                                <div class="clearfix">
                                                                                <a href="https://kodilla.com/pl/bootcamp-task/407/668563" target="_blank" class="btn btn-info-outline">Podgląd zadania</a>
                            <form target="_blank" class="form-inline project-link-form">
                                <div class="form-group">
                                    <input type="text" name="link" class="form-control" value="https://github.com/skwiryt/booksApi">
                                </div>
                                <button type="submit" class="btn  btn-primary ">Wyślij link <i class="fa fa-check"></i></button>
                            </form>
                                                                                                    </div>
                    </div>
                </section>
                                    
                <section id="submodule-1169" class="card submodule completed" data-bootcamp-user-submodule-id="668564">
                <!-- klasy dla section: completed current comments -->
                    <div class="card-block submodule-header clearfix">
                        <i class="fa fa-check-circle-o fa-2x"></i>
                        <i class="fa fa-play-circle-o fa-2x"></i>
                        <i class="fa fa-exclamation-circle fa-2x"></i>
                        <i class="fa fa-send-o fa-2x"></i>
                        <h2 class="bootcamp-submodule-name">30.2. <span>Testowanie modeli Mongoose</span></h2>
                                            </div>
                    <div class="card-block">
                        <div class="submodule-content">
                            <p>Pierwszy submoduł nie przyniósł wielu nowości. Używaliśmy innego task runnera, ale jego działanie było wręcz identyczne, jak w znanych nam już&nbsp;narzędziach.</p>
<p>Backend to jednak także funkcjonalności, których we frontendzie nie uświadczymy, np. obsługa endpointów czy też współpraca z bazą danych. Testowaniem właśnie tych części naszej aplikacji będziemy się&nbsp;od teraz zajmować.</p>
<p>Jako pierwsze weźmiemy na warsztat modele Mongoose i sprawdzimy, czy schematy struktury danych, które w nich wykorzystujemy, faktycznie dobrze walidują wprowadzane informacje. Może Ci się wydawać, że takie testy są zbędne, bo same schematy są najczęściej dość małe i błędy nie zdarzają się zbyt często. Wbrew pozorom, taka weryfikacja poprawnego działania może być całkiem przydatna.</p>
<p>Po pierwsze, testy są w stanie sprawdzić w praktyce, jak model poradzi sobie z próbą dodawania różnych danych – nie tylko poprawnych, ale również wadliwych. Dzięki temu bardzo łatwo będziemy mogli zauważyć ewentualne luki w naszym schemacie struktury danych. Na przykład może okazać się, że zapomnieliśmy o dodaniu dla któregoś z atrybutów opcji <code>required</code>, przez co model pozwalałby na wprowadzanie niepełnych danych. Łatwo moglibyśmy też wykryć błędne przygotowanie referencji. Mamy więc pierwszą zaletę, <strong>jesteśmy w stanie szybko naprawić ewentualne niedoskonałości schematu struktury danych</strong>.</p>
<p>Po drugie, w czasie pracy nad aplikacją, bardzo często modyfikujemy nasze schematy, a wtedy łatwo o ich popsucie. Ma to miejsce zwłaszcza, jeśli przed przystąpieniem do prac nie zaplanujemy odpowiednio struktury bazy danych. <strong>Testy pozwalają nam na bieżąco kontrolować poprawność schematów</strong>.</p>
<div class="bc-note alert-success">
<h4 class="alert-heading text-center">Nie tylko schematy...</h4>
<p>Na razie mówimy tylko o sprawdzeniu poprawności walidacji z użyciem schematów, więc to bardziej testy samych schematów niż modeli.</p>
<p>Niemniej jednak testowanie modeli powinno być czymś więcej. Warto sprawdzać np. czy wszystkie operacje CRUD będą działać poprawnie. Jest bowiem możliwe, że przy wybraniu złych uprawnień dla użytkownika, dana operacja (np. <code>deleteOne</code> czy <code>updateOne</code>), zamiast zmodyfikować kolekcję, zwróci błąd. Warto też wiedzieć, że oprócz wbudowanych metod, do modeli możemy dodawać własne. W takiej sytuacji nasze testy będą jeszcze bardziej rozbudowane.</p>
<p>W tym submodule nie będziemy jednak poruszać kwestii testowania metod. Na razie zajmiemy się tylko sprawdzeniem poprawności walidacji z naszymi schematami.</p>
</div>
<h3 id="302-testowanie-modeli-mongoose-zanim-przejdziemy-dalej">Zanim przejdziemy dalej...</h3>
<p>Sprawdzimy poprawność działania naszej aplikacji z poprzedniego modułu, czyli serwera API, który współpracował z bazą danych <code>companyDB</code>. Odnajdź ten projekt.</p>
<p>Nie używaliśmy w nim jeszcze Mochy ani Chai, pobierz je więc teraz:</p>
<pre class=" language-js"><code class=" language-js">yarn add mocha@<span class="token number">6.2</span><span class="token number">.1</span> chai@<span class="token number">4.2</span><span class="token number">.0</span></code></pre>
<p>Dodaj również nowy task do <code>package.json</code>:</p>
<pre class=" language-js"><code class=" language-js"><span class="token string">"test"</span><span class="token operator">:</span> <span class="token string">"mocha --watch \"./**/*.test.js\""</span></code></pre>
<p>Czas zastanowić się, gdzie będziemy przechowywać nasze testy dla modeli. Moglibyśmy np. w folderze <code>test</code> w głównym katalogu projektu, albo w <code>models/test</code>, trochę bliżej samych modeli. Nie narzucamy żadnego pomysłu, możesz wykorzystać dowolny z nich. W materiale będziemy jednak trzymać się tej drugiej idei, bo zaproponowaliśmy ją już przy poprzednim zadaniu.</p>
<p>Wejdź więc do katalogu <code>models</code> i utwórz nowy folder – <code>test</code>.</p>
<h3 id="302-testowanie-modeli-mongoose-testujemy-pierwszy-model">Testujemy pierwszy model</h3>
<p>Zaczniemy od testów do najmniejszego z naszych modeli – <code>Department</code>. Utwórz więc teraz nowy plik w folderze <code>test</code> i nazwij go <code>department.test.js</code>.</p>
<p>Zanim przejdziemy dalej, spójrzmy na ten model, a przede wszystkim na schemat struktury danych:</p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> mongoose <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mongoose'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> departmentSchema <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">mongoose<span class="token punctuation">.</span>Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token known-class-name class-name">String</span><span class="token punctuation">,</span> required<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span><span class="token property-access">exports</span> <span class="token operator">=</span> mongoose<span class="token punctuation">.</span><span class="token method function property-access">model</span><span class="token punctuation">(</span><span class="token string">'Department'</span><span class="token punctuation">,</span> departmentSchema<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Tak naprawdę mamy tutaj tylko jeden atrybut, który warto wziąć pod uwagę przy testach, bo <code>_id</code> jest nadawany przez MongoDB automatycznie, możemy więc założyć, że będzie poprawny. Chodzi oczywiście o <code>name</code>.</p>
<p>Co dokładnie warto sprawdzić? Przede wszystkim, czy Mongoose pozwoli na dodawanie nowego dokumentu bez tego atrybutu albo z błędną jego wartością. Warto też zweryfikować, czy jeśli wpiszemy <code>name</code> poprawnie, to nie dostaniemy żadnego błędu. I... tyle.</p>
<p>Przejdźmy więc do rzeczy. Dodaj do pliku <code>department.test.js</code> nowy blok <code>describe</code> oraz <code>it</code>. Na razie zajmiemy się pierwszym testem. Będziemy sprawdzać, czy Mongoose zwróci nam błąd, jeśli spróbujemy dodać nowy dokument bez atrybutu <code>name</code>.</p>
<pre class=" language-js"><code class=" language-js"><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'Department'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>

  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should throw an error if no "name" arg'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>

  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Żeby napisać ten test, jak i kolejne, potrzebujemy dostępu do modelu <code>Department</code>. Zaimportuj go na samej górze pliku.</p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> <span class="token maybe-class-name">Department</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../department.model.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Naturalnie ponownie skorzystamy z metody <code>expect</code> z pakietu <code>chai</code>.</p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> expect <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'chai'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">expect</span><span class="token punctuation">;</span></code></pre>
<p>Teraz wróćmy już do naszego testu. Jak możemy go napisać? Sytuacją, którą zasymulujemy, będzie po prostu dodanie nowego dokumentu do kolekcji:</p>
<pre class=" language-js"><code class=" language-js"><span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should throw an error if no "name" arg'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> dep <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Department</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// create new Department, but don't set `name` attr value</span>

  dep<span class="token punctuation">.</span><span class="token method function property-access">validate</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span><span class="token property-access">errors</span><span class="token punctuation">.</span><span class="token property-access">name</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">to</span><span class="token punctuation">.</span><span class="token property-access">exist</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Na samym początku staramy się tworzyć nowy dokument na bazie modelu <code>Department</code>.</p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> dep <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Department</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// create new Department, but don't set `name` attr value</span></code></pre>
<p>Oczywiście celowo nie ustalamy wartości dla <code>name</code>, by sprawdzić, czy Mongoose zwróci nam w takiej sytuacji błąd.</p>
<p>Ciekawszy będzie kod poniżej.</p>
<pre class=" language-js"><code class=" language-js">dep<span class="token punctuation">.</span><span class="token method function property-access">validate</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span><span class="token property-access">errors</span><span class="token punctuation">.</span><span class="token property-access">name</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">to</span><span class="token punctuation">.</span><span class="token property-access">exist</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Do zapisania dokumentu w kolekcji, zawsze używaliśmy funkcji <code>save</code>, a tym razem tego nie robimy. Dlaczego?</p>
<p>Zauważ, że zaimportowaliśmy model, ale w żadnym miejscu nie utworzyliśmy połączenia z bazą danych. Tym samym użycie <code>save</code> nie ma sensu – nie moglibyśmy zapisać danych do kolekcji, skoro nie mamy zainicjowanego połączenia z bazą i otrzymywalibyśmy fałszywy błąd. Test, zamiast sygnalizować niewłaściwą walidację, wykazywałby problem, ale z powodu braku połączenia z bazą danych.</p>
<p>Zastosowaliśmy więc inne rozwiązanie. Przed dodaniem danych, <code>save</code> korzysta z metody <code>validate</code>, dla której brak połączenia z bazą nie jest problemem. Ta funkcja ma na celu zweryfikowanie danych zgodnie ze schematem, więc nie potrzebujemy już samego <code>save</code>.</p>
<p>Jej działanie jest dość proste – sprawdza po kolei każdy atrybut i jeśli zauważy jakiś błąd, zapisuje go w obiekcie <code>errors</code>, pod nazwą tego atrybutu. Po procesie walidacji całość jest po prostu zwracana w funkcji callback. Co istotne dla nas, jeśli wiemy, że w <code>errors</code> są zapisywane informacje tylko dla błędnych atrybutów, to jesteśmy w stanie łatwo ustalić, który jest wadliwy. Na przykład, jeśli <code>errors.name</code> nie istnieje, możemy założyć, że sprawdzono go i nie doszukano się błędów. Jeśli jednak występuje, to wiemy już, że coś było nie tak. W <code>errors</code> są oczywiście przechowywane dokładne komunikaty o błędach, ale nam wystarczy sprawdzenie, czy w ogóle się&nbsp;pojawiły.</p>
<p>Stąd też nasz łatwy test:</p>
<pre class=" language-js"><code class=" language-js"><span class="token function">expect</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span><span class="token property-access">errors</span><span class="token punctuation">.</span><span class="token property-access">name</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">to</span><span class="token punctuation">.</span><span class="token property-access">exist</span><span class="token punctuation">;</span></code></pre>
<p>Sprawdzamy po prostu, czy Mongoose zapisał przy walidacji, że pod <code>name</code> był błąd.</p>
<p>Uruchom teraz nasz task <code>test</code> i zobacz, co pojawi się w konsoli.</p>
<a href="./Moduł_ 30. Testy jednostkowe w backendzie_files/Test6.png" class="img-modal-group"><img src="./Moduł_ 30. Testy jednostkowe w backendzie_files/Test6.png" alt="image" style="width: auto;"></a>
<p>Test udało się przejść pozytywnie!</p>
<div class="bc-note alert-warning">
<h4 class="alert-heading text-center">Uwaga!</h4>
<p>Możesz zauważyć, że w przypadku zmian w pliku z testami i uruchomienia ich automatycznie od nowa przez Mochę, otrzymujemy błąd.</p>
<pre class=" language-markup"><code class=" language-markup">OverwriteModelError: Cannot overwrite `Department` model once compiled.</code></pre>
<p>Jak widzisz, Mocha zwyczajnie nie radzi sobie z użyciem tego samego modelu po raz kolejny. Sytuację da się łatwo naprawić. Wystarczy, że będziemy "czyścić" nasze modele po każdorazowym wykonaniu testów. Możemy do tego użyć hooka <code>after</code>:</p>
<pre class=" language-js"><code class=" language-js"><span class="token function">after</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  mongoose<span class="token punctuation">.</span><span class="token property-access">models</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Dzięki temu, odświeżenie testów nie będzie powodowało błędu, mimo ponownej inicjacji modelu. Pamiętaj też o zaimportowaniu <code>mongoose</code> za pomocą&nbsp;<code>require</code>.</p>
</div>
<h3 id="302-testowanie-modeli-mongoose-kolejny-test">Kolejny test</h3>
<p>Czas na test numer 2. Warto sprawdzić, jak poradzi sobie nasz model, gdy jako <code>name</code> podamy wartości innego typu niż string. Całość będzie wyglądała analogicznie. Znowu stworzymy dokumenty na bazie modelu <code>Department</code> i będziemy sprawdzać, czy ich walidacja zapisze komunikat o błędzie do <code>errors.name</code>. Tym razem jednak musimy przetestować więcej niż jeden przypadek, warto więc skorzystać z tablicy.</p>
<pre class=" language-js"><code class=" language-js"><span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should throw an error if "name" is not a string'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>

  <span class="token keyword">const</span> cases <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> name <span class="token keyword">of</span> cases<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> dep <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Department</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    dep<span class="token punctuation">.</span><span class="token method function property-access">validate</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">expect</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span><span class="token property-access">errors</span><span class="token punctuation">.</span><span class="token property-access">name</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">to</span><span class="token punctuation">.</span><span class="token property-access">exist</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token punctuation">}</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Test powinien przejść pomyślnie.</p>
<p>Może Cię zdziwić brak testów dla przykładowej wartości typu <code>Number</code>. Ma to swoje wyjaśnienie w tym, jak Mongoose działa. Jeśli oczekujemy na <code>String</code>, a przekazywana wartość to liczba, Mongoose stara się przekonwertować ją do tekstu, czyli np. <code>5</code> zapisze się w bazie jako <code>"5"</code>. Tym samym sprawdzenie, czy model wyrzuci błąd dla jakiejś liczby, nie ma sensu, bo wiemy już teraz, że tego nie zrobi. Nie musisz się jednak martwić, liczba zostanie zapisana w bazie jako string.</p>
<div class="bc-note alert-info">
<h4 class="alert-heading text-center">Walidacja <code>Number</code></h4>
<p>A co jeśli chcielibyśmy, aby wartości liczbowe od razu powodowały błąd? Istnieje możliwość nałożenia odpowiedniego wymagania w samym schemacie (trochę więcej o tym za chwilę), ale nie będziemy tego robić w naszym przykładzie.</p>
</div>
<h3 id="302-testowanie-modeli-mongoose-wieksza-wymagania-wiecej-testow">Większa wymagania = więcej testów</h3>
<p>Warto wiedzieć, że oprócz ustalenia w schematach nazw atrybutów czy ich typów, istnieje jeszcze możliwość nałożenia dokładniejszych wymagań. Możemy ustawić np. jaka jest minimalna (<code>min</code>) lub maksymalna wartość (<code>max</code>) atrybutu liczbowego, albo limity dla długości atrybutów tekstowych (<code>minlength</code> i <code>maxlength</code>). Możemy również dodawać własne funkcje, które służyłyby jeszcze większemu ograniczeniu wybranych atrybutów, na przykład sprawdzałyby, czy nasza wprowadzana wartość nie jest czasem liczbą (patrz: wcześniejszy test).</p>
<p>W naszym <code>department.model.js</code> moglibyśmy użyć np. <code>minlength</code> i <code>maxlength</code>:</p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> departmentSchema <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">mongoose<span class="token punctuation">.</span>Schema</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token punctuation">{</span> type<span class="token operator">:</span> <span class="token known-class-name class-name">String</span><span class="token punctuation">,</span> required<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> minlength<span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span> maxlength<span class="token operator">:</span> <span class="token number">20</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Wykonaj taką modyfikację w swoim modelu. Od teraz nazwa działu musi mieć 5 lub więcej znaków, ale nie może przekroczyć 20.</p>
<p>W przypadku takich modeli warto sprawdzić dodatkowe wymagania. Dodamy więc kolejny test. Na szczęście nie będzie to wcale trudne, ponownie wystarczy użycie funkcji <code>validate</code>.</p>
<p>Spróbuj wykonać ten test bez naszej pomocy, wzorując się na wcześniejszych przykładach.</p>
<p class="text-center">
  <span class="collapse-toggles">
    <a href="https://kodilla.com/pl/bootcamp-module/407/279/5935#collapse-ewNWRYHlZ-toggle" class="btn btn-primary collapsed" data-toggle="collapse">Pokaż odpowiedź</a>
    <a href="https://kodilla.com/pl/bootcamp-module/407/279/5935#collapse-ewNWRYHlZ-toggle" class="btn btn-primary collapsed" data-toggle="collapse">Ukryj odpowiedź</a>
  </span>
</p>
<div id="collapse-ewNWRYHlZ-toggle" class="collapse">
<pre class=" language-js"><code class=" language-js"><span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should throw an error if "name" is too short or too long'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>

  <span class="token keyword">const</span> cases <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Abc'</span><span class="token punctuation">,</span> <span class="token string">'abcd'</span><span class="token punctuation">,</span> <span class="token string">'Lorem Ipsum, Lorem Ip'</span><span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token comment">// we test various cases, some of them are too short, some of them are too long</span>
  <span class="token keyword control-flow">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> name <span class="token keyword">of</span> cases<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> dep <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Department</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    dep<span class="token punctuation">.</span><span class="token method function property-access">validate</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">expect</span><span class="token punctuation">(</span>err<span class="token punctuation">.</span><span class="token property-access">errors</span><span class="token punctuation">.</span><span class="token property-access">name</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">to</span><span class="token punctuation">.</span><span class="token property-access">exist</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token punctuation">}</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
</div>
<h3 id="302-testowanie-modeli-mongoose-ostatni-test">Ostatni test</h3>
<p>Czas na ostatni test. Wiemy już, że w przypadku błędnego <code>name</code> albo przy braku tego atrybutu, Mongoose zwróci błąd. Warto upewnić się jeszcze, czy błędu nie będzie, jeśli wszystko wpiszemy dobrze.</p>
<p>Spróbuj stworzyć taki test bez naszej pomocy.</p>
<p class="text-center">
  <span class="collapse-toggles">
    <a href="https://kodilla.com/pl/bootcamp-module/407/279/5935#collapse-gHmHk08zgE-toggle" class="btn btn-primary collapsed" data-toggle="collapse">Pokaż odpowiedź</a>
    <a href="https://kodilla.com/pl/bootcamp-module/407/279/5935#collapse-gHmHk08zgE-toggle" class="btn btn-primary collapsed" data-toggle="collapse">Ukryj odpowiedź</a>
  </span>
</p>
<div id="collapse-gHmHk08zgE-toggle" class="collapse">
<pre class=" language-js"><code class=" language-js"><span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should not throw an error if "name" is okay'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>

  <span class="token keyword">const</span> cases <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'Management'</span><span class="token punctuation">,</span> <span class="token string">'Human Resources'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> name <span class="token keyword">of</span> cases<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> dep <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Department</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    dep<span class="token punctuation">.</span><span class="token method function property-access">validate</span><span class="token punctuation">(</span><span class="token parameter">err</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token function">expect</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">to</span><span class="token punctuation">.</span><span class="token property-access">not</span><span class="token punctuation">.</span><span class="token property-access">exist</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token punctuation">}</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Naturalnie tym razem nie chcemy, aby jakikolwiek błąd się pojawił, stąd też <code>to.not.exist</code> zamiast <code>to.exist</code>.</p>
</div>
<p>Jeśli udało Ci się napisać wszystkie testy poprawnie, powinniśmy zobaczyć w konsoli przyjazny widok:</p>
<a href="./Moduł_ 30. Testy jednostkowe w backendzie_files/Test7.png" class="img-modal-group"><img src="./Moduł_ 30. Testy jednostkowe w backendzie_files/Test7.png" alt="image" style="width: auto;"></a>
<p>Tym samym testowanie pierwszego modelu możemy uznać za zakończone. Nie było to aż takie trudne, prawda? :)</p>
<h3 id="302-testowanie-modeli-mongoose-podsumowanie">Podsumowanie</h3>
<p>Jak widzisz testowanie schematów Mongoose, mimo tego, że było nowością, nie sprawiło nam wielu problemów, choć okazało się mniej intuicyjne niż testowanie zwykłych funkcji z pierwszego submodułu.</p>
<p>Niemniej jednak wszystkie te zabiegi to trochę za mało, by dać nam wystarczającą pewność co do działania aplikacji. Chcielibyśmy wiedzieć, czy dane przy <code>save</code> faktycznie dodają się do bazy, oraz czy po użyciu <code>delete</code> rzeczywiście ich się&nbsp;pozbywamy. Tym zajmiemy się jednak już w kolejnym submodule.</p>

                        </div>
                    </div>
                                        <div class="card-block task-card">
                        <h3 id="302-testowanie-modeli-mongoose-zadanie-testujemy-kolejny-model">Zadanie: <span class="task-title">testujemy kolejny model</span></h3>
                        <div class="task-content">
                            <p>Czas na przećwiczenie nowych umiejętności. Testy dla modelu <code>Department</code> napisaliśmy razem, a Twoim zadaniem będzie przygotowanie ich dla <code>Employee</code>.</p>
<p>Wszystkie testy przechowuj w <code>models/test/employee.test.js</code>. Przy ich pisaniu możesz wzorować się na tym, jak sprawdzaliśmy model <code>Department</code>.</p>
<p>W razie problemów skorzystaj również z dokumentacji <a href="https://www.chaijs.com/" target="_blank">Chai.js</a>.</p>
<div class="bc-note alert-info">
<h4 class="alert-heading text-center">Uwaga!</h4>
<p>Podczas pisania testów dla <code>Department</code>, zmodyfikowaliśmy lekko nasz schemat, aby sprawdzał również długość <code>name</code>. Zrobiliśmy to tylko po to, aby pokazać Ci, że testy dla takich przypadków będą równie intuicyjne. W modelu <code>Employee</code> nie musisz już jednak wykonywać takich operacji. Schemat struktury danych nie powinien być modyfikowany, a testy niech go sprawdzają w takiej formie, w jakiej jest aktualnie.</p>
</div>

                        </div>
                    </div>
                                        <div class="card-block submodule-footer clearfix  completed ">
                                                <div class="clearfix">
                                                                                <a href="https://kodilla.com/pl/bootcamp-task/407/668564" target="_blank" class="btn btn-info-outline">Podgląd zadania</a>
                            <form target="_blank" class="form-inline project-link-form">
                                <div class="form-group">
                                    <input type="text" name="link" class="form-control" value="https://github.com/skwiryt/companyApp">
                                </div>
                                <button type="submit" class="btn  btn-primary ">Wyślij link <i class="fa fa-check"></i></button>
                            </form>
                                                                                                    </div>
                    </div>
                </section>
                                    
                <section id="submodule-1170" class="card submodule completed" data-bootcamp-user-submodule-id="668565">
                <!-- klasy dla section: completed current comments -->
                    <div class="card-block submodule-header clearfix">
                        <i class="fa fa-check-circle-o fa-2x"></i>
                        <i class="fa fa-play-circle-o fa-2x"></i>
                        <i class="fa fa-exclamation-circle fa-2x"></i>
                        <i class="fa fa-send-o fa-2x"></i>
                        <h2 class="bootcamp-submodule-name">30.3. <span>Testowanie operacji CRUD</span></h2>
                                            </div>
                    <div class="card-block">
                        <div class="submodule-content">
                            <p>Testowanie schematu struktur danych to dobra praktyka zapewnia nas bowiem, że Mongoose będzie w stanie dbać o poprawność informacji wprowadzanych do bazy.</p>
<p>Niemniej jednak w żaden sposób nie daje nam to gwarancji, że sama komunikacja działa bez zarzutów. Na przykład może okazać się, że z jakiegoś powodu metoda <code>.save</code>, mimo użycia poprawnych danych, nie doda dokumentu do bazy, albo metoda <code>updateOne</code> niepoprawnie ją zaktualizuje itd. Mogą pojawić się też inne problemy, np. w sytuacji, gdy mamy dwie kolekcje, które są ze sobą jakoś powiązane (wykorzystują <code>ref</code>). Warto wtedy sprawdzić, czy <code>find</code> wraz z <code>populate</code>, faktycznie zwróci poprawne dane.</p>
<p>W tym submodule zajmiemy się właśnie takimi przypadkami i testami działania metod CRUD.</p>
<h3 id="303-testowanie-operacji-crud-przygotowania">Przygotowania</h3>
<p>Wciąż pracujemy na przykładzie z poprzedniego submodułu.</p>
<p>Na początku zastanówmy się, gdzie będziemy przechowywać nowe testy. Od razu do głowy przychodzą dwa pomysły – skoro w folderze <code>models</code> trzymaliśmy testy struktur danych modeli, to może jest to również dobre miejsce do przechowywania testów ich metod? Drugi pomysł byłby kompletnie inny. Będziemy testować operacje CRUD, więc będzie to zestaw całkiem nowych, odrębnych testów, a zatem może warto trzymać je w katalogu głównym, w podfolderze <code>test</code>?</p>
<p>Znowu nie będziemy narzucać żadnego z pomysłów, niemniej jednak dla ułatwienia znajdowania plików (krótsze ścieżki), w niniejszym submodule postawimy na pierwszą ideę.</p>
<p>Zaczniemy od testowania modelu <code>Department</code>. Wejdź teraz do folderu <code>models/test</code> i utwórz tam nowy plik – <code>department.crud.test.js</code>. Oczywiście taka nazwa to tylko nasz wybór, końcówka <code>crud.test.js</code> ma po prostu w założeniu pomagać w łatwej identyfikacji właściwych plików.</p>
<p>Otwórz go teraz i zacznij od zaimportowania modelu <code>Department</code> oraz metody <code>expect</code> z pakietu Chai. Utwórz również blok <code>describe</code>.</p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> <span class="token maybe-class-name">Department</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../department.model'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> expect <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'chai'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">expect</span><span class="token punctuation">;</span>

<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'Department'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Skoro będziemy korzystać z modelu, to warto przygotować też blok <code>after</code>, w którym będziemy "kasować" model, gdy już go nie potrzebujemy. Jak zapewne pamiętasz z poprzedniego submodułu, jest to konieczne, aby Mocha w trybie <code>--watch</code> mogła obsługiwać go poprawnie.</p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> <span class="token maybe-class-name">Department</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../department.model'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> expect <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'chai'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">expect</span><span class="token punctuation">;</span>

<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'Department'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>

  <span class="token function">after</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
    mongoose<span class="token punctuation">.</span><span class="token property-access">models</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<h3 id="303-testowanie-operacji-crud-polaczenie-z-baza-danych">Połączenie z bazą danych</h3>
<p>Zanim przejdziemy dalej, musimy się na chwilę zatrzymać. W poprzednim submodule nie potrzebowaliśmy połączenia z bazą danych, bo testowaliśmy tylko samo działanie schematów. Tutaj będzie inaczej – chcemy sprawdzać, czy wykorzystanie metod CRUD faktycznie odnosi pożądany skutek.</p>
<p>Jednak, czy aby na pewno chcemy pracować na prawdziwej bazie – dodawać dane, usuwać je i modyfikować w naszych kolekcjach? Niekoniecznie, jeśli z jakiegoś powodu zależy Ci na integralności tych danych. Dobrym wyjściem może być użycie jakiejś paczki, która pozwoli nam na testowanie metod CRUD, bez faktycznej modyfikacji naszej bazy danych.</p>
<p>Na rynku istnieje kilka pakietów, które funkcjonują w ten sposób, a jeden z nich to <strong>mongodb-memory-server</strong>. Jego działanie jest bardzo sprytne – pozwala na utworzenie tymczasowej bazy danych i użycie jej przy połączeniu. Co istotne, jest ona kreowana w dokładnie taki sam sposób jak  "normalne". Wszystkie operacje, które będziemy wykonywać na tej kopii, będą więc działały dokładnie tak samo, jak na oryginale. Różnica jest tylko taka, że jej zawartość będzie przechowywana w pamięci systemu i zostanie skasowana po zakończeniu działania testów. Tym samym otrzymujemy możliwość sprawdzenia działania odpowiednich metod w "warunkach bojowych", bez nienaruszania oryginalnych danych. Brzmi ciekawie, prawda?</p>
<h4>Instalacja paczki</h4>
<p>Zacznij od zainstalowania tej paczki:</p>
<pre class=" language-js"><code class=" language-js">yarn add mongodb<span class="token operator">-</span>memory<span class="token operator">-</span>server</code></pre>
<h4>Przygotowanie połączenia</h4>
<p>Czas na przygotowanie połączenia.</p>
<p>Zacznij od zaimportowania funkcji do tworzenia testowej bazy danych:</p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> <span class="token maybe-class-name">MongoMemoryServer</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mongodb-memory-server'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access"><span class="token maybe-class-name">MongoMemoryServer</span></span><span class="token punctuation">;</span></code></pre>
<p>Przyda się też Mongoose:</p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> mongoose <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'mongoose'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Potrzebujemy jej, bo w końcu tworzymy połączenie. Owszem, baza będzie testowa, ale samo połączenie prawdziwe.</p>
<p>Następnie dodaj do bloku <code>describe</code>, hook <code>before</code>.</p>
<pre class=" language-js"><code class=" language-js"><span class="token function">before</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>

  <span class="token keyword control-flow">try</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> fakeDB <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MongoMemoryServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> uri <span class="token operator">=</span> <span class="token keyword control-flow">await</span> fakeDB<span class="token punctuation">.</span><span class="token method function property-access">getConnectionString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    mongoose<span class="token punctuation">.</span><span class="token method function property-access">connect</span><span class="token punctuation">(</span>uri<span class="token punctuation">,</span> <span class="token punctuation">{</span> useNewUrlParser<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> useUnifiedTopology<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token punctuation">}</span> <span class="token keyword control-flow">catch</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span>err<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Jak widzisz, kod jest dość krótki.</p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> fakeDB <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MongoMemoryServer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Na początku tworzymy nową testową bazę danych. Warto jednak wiedzieć, że mamy możliwość założenia nawet kilku takich "oszukanych" baz na raz.</p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> uri <span class="token operator">=</span> <span class="token keyword control-flow">await</span> fakeDB<span class="token punctuation">.</span><span class="token method function property-access">getConnectionString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Następnie pobieramy adres tej bazy. Domyślnie paczka tworzy ją pod adresem <code>127.0.0.1</code> i łączy się za pomocą pierwszego lepszego wolnego portu. Te opcje można jednak w razie potrzeby zmienić.</p>
<pre class=" language-js"><code class=" language-js">mongoose<span class="token punctuation">.</span><span class="token method function property-access">connect</span><span class="token punctuation">(</span>uri<span class="token punctuation">,</span> <span class="token punctuation">{</span> useNewUrlParser<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> useUnifiedTopology<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Na końcu łączymy się z naszą bazą przy użyciu znanej Ci już funkcji <code>mongoose.connect</code>, a jako adres przekazujemy oczywiście <code>fakeDB</code>. Paczka <code>mongodb-memory-server</code> oferuje również funkcję do zakończenia działania naszej bazy, ale nie musimy tego robić. Gdy proces testowania się zakończy, baza i tak usunie się automatycznie.</p>
<p>Dlaczego całość jest schowana w hooku <code>before</code>? Dlatego, że chcemy, aby testy uruchomiły się dopiero wtedy, kiedy mamy pewność, że połączenie jest gotowe.</p>
<div class="bc-note alert-warning">
<h4 class="alert-heading text-center">Uwaga!</h4>
<p>Tryb <code>--watch</code> w pakiecie Mocha niezbyt dobrze radzi sobie z obsługą testowej bazy danych. Zresztą, jego wady ujawniły się już wcześniej, gdy mieliśmy problem z duplikowaniem modelu. Bierze się to stąd, że <code>--watch</code> uruchamia testy od nowa, ale tak naprawdę nie kończy całego procesu. Możemy to jednak obejść, sami tworząc task do obserwacji plików z testami.</p>
<p>Idea jest dość prosta. Wykorzystamy tutaj znaną Ci już paczkę <code>onChange</code>. Stworzymy dwa taski – jeden uruchomi Mochę tylko raz, a drugi, za pomocą <code>onChange</code>, będzie obserwował pliki z testami i kiedy wykryje jakąś zmianę, uruchomi task pierwszy.</p>
<p>Będzie to wyglądało następująco:</p>
<pre class=" language-js"><code class=" language-js"><span class="token string">"test"</span><span class="token operator">:</span> <span class="token string">"mocha \"./{,!(node_modules)/**/}*.test.js\""</span><span class="token punctuation">,</span>
<span class="token string">"test:watch"</span><span class="token operator">:</span> <span class="token string">"onchange \"./**/*.js\" -i -k -- yarn test"</span></code></pre>
<p><code>test</code> służy do jednorazowego uruchomienia testów, a <code>test:watch</code> uruchamia je raz na początku (dba o to flaga <code>i</code>/<code>--initial</code>) oraz za każdym razem, kiedy wykryje zmianę w jakimkolwiek pliku z testami. Flaga <code>-k</code> (<code>--kill</code>) zapewnia nas, że po zakończeniu testów każdorazowo ten proces jest "zabijany".</p>
<p>Oczywiście, żeby <code>test:watch</code> mógł działać, musisz pobrać do swojego projektu paczkę <code>onChange</code>.</p>
<pre class=" language-js"><code class=" language-js">yarn add onchange@<span class="token number">6.1</span><span class="token number">.0</span></code></pre>
<p>Od tej chwili Mocha nie powinna sprawiać nam przy pracy z Mongoose żadnych problemów. Do tego, możesz usunąć ze swoich testów bloki <code>after</code>, które zajmowały się zerowaniem modeli. Nie będziemy już ich potrzebować.</p>
</div>
<h3 id="303-testowanie-operacji-crud-read">Read</h3>
<p>Zaczniemy od przetestowania metod do pobierania danych, sprawdzimy więc <code>find</code> oraz <code>findOne</code>.</p>
<p>W tym celu stworzymy wewnątrz kolejny blok <code>describe</code>, co pomoże rozdzielić poszczególne grupy testów od siebie. Chcemy, aby testy do wybierania danych były w jednym miejscu, a do usuwania w innym.</p>
<p>Od razu przygotujemy też blok <code>it</code>.</p>
<pre class=" language-js"><code class=" language-js"><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'Reading data'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>

  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should return all the data with "find" method'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>

  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Zaczniemy od najprostszego testu. Sprawdzimy, czy <code>find</code> bez żadnych parametrów, zwróci nam po prostu wszystkie dane.</p>
<p>By to zweryfikować, potrzebujemy jakichś testowych danych. Bez nich nie będziemy wiedzieć, czy otrzymaliśmy pustą tablicę, bo kolekcja naprawdę była pusta, czy może po prostu natrafiliśmy na jakiś błąd.</p>
<p>Co istotne, nie tylko pierwszy test z tego bloku musi mieć dostęp do jakichś danych, podobnie będzie w przypadku np. <code>findOne</code>. Tym samym, zamiast organizować je tylko wewnątrz pierwszego <code>it</code>, kod, który się tym zajmie, będziemy przechowywać w bloku <code>before</code> całej grupy testów <code>Reading data</code>.</p>
<pre class=" language-js"><code class=" language-js"><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'Reading data'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>

  <span class="token function">before</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> testDepOne <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Department</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'Department #1'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">await</span> testDepOne<span class="token punctuation">.</span><span class="token method function property-access">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token keyword">const</span> testDepTwo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Department</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'Department #2'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword control-flow">await</span> testDepTwo<span class="token punctuation">.</span><span class="token method function property-access">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should return all the data with "find" method'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>

  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Dzięki temu mamy gwarancję, że zanim którykolwiek test z tej grupy zostanie uruchomiony, dane będą już dostępne. Oczywiście celowo wprowadziliśmy poprawne informacje – zakładamy, że nie spowodują błędu, bo sprawdzaniem takich przypadków zajmowaliśmy się już wcześniej.</p>
<p>Przejdźmy teraz do samego testu. Jak najłatwiej możemy sprawdzić, czy wszystko gra? Wystarczy, że spróbujemy pobrać dane i ustalimy, czy ich liczba to dwa. Nie musimy weryfikować samych danych ani sprawdzać, czy otrzymaliśmy dokument z dobrymi atrybutami – to również testowaliśmy w poprzednim submodule.</p>
<pre class=" language-js"><code class=" language-js"><span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should return all the data with "find" method'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> departments <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token maybe-class-name">Department</span><span class="token punctuation">.</span><span class="token method function property-access">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> expectedLength <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>departments<span class="token punctuation">.</span><span class="token property-access">length</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">to</span><span class="token punctuation">.</span><span class="token property-access">be</span><span class="token punctuation">.</span><span class="token method function property-access">equal</span><span class="token punctuation">(</span>expectedLength<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Przyznaj, że kod jest dość logiczny. Szukamy wszystkich danych, a potem sprawdzamy, czy ich ilość jest zgodna z założeniami. Wiemy, że nasza baza ma dwa dokumenty w tej kolekcji, więc ta liczba powinna się zgadzać.</p>
<p>Warto zweryfikować również pobieranie jednego elementu. Atrybut <code>_id</code> jest w naszej bazie nadawany automatycznie, więc raczej nie ma sensu sprawdzanie, czy da się znaleźć coś właśnie po nim. Możemy za to przetestować <code>name</code>.</p>
<pre class=" language-js"><code class=" language-js"><span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should return a proper document by "name" with "findOne" method'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> department <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token maybe-class-name">Department</span><span class="token punctuation">.</span><span class="token method function property-access">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'Department #1'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> expectedName <span class="token operator">=</span> <span class="token string">'Department #1'</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>department<span class="token punctuation">.</span><span class="token property-access">name</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">to</span><span class="token punctuation">.</span><span class="token property-access">be</span><span class="token punctuation">.</span><span class="token method function property-access">equal</span><span class="token punctuation">(</span><span class="token string">'Department #1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Ponownie kod nie jest zbyt skomplikowany. Szukamy w kolekcji jednego z naszych dokumentów, a następnie sprawdzając atrybut <code>name</code> ustalamy, czy otrzymaliśmy prawidłowy.</p>
<p>Analogicznie jesteśmy w stanie testować kolejne atrybuty, choć akurat <code>Department</code> ma tylko jeden. Najczęściej kolekcje mają ich więcej, moglibyśmy zatem sprawdzić od razu wszystkie atrybuty w jednym teście.</p>
<p>Na końcu warto zrobić jeszcze jedną rzecz. Nie chcemy, aby zmiany poczynione w bazie danych, były widoczne również w kolejnych testach. Wtedy bowiem, nawet zwykła zmiana ich kolejności, mogłaby powodować wadliwe działanie. Bezpieczniej będzie przygotowywać bazę osobno dla każdej grupy testów, dlatego też po sprawdzeniu <em>Read</em> warto wyzerować dane w kolekcji <code>Document</code>.</p>
<p>Dodaj więc do bloku <code>Reading data</code> następujący hook <code>after</code>:</p>
<pre class=" language-js"><code class=" language-js"><span class="token function">after</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">await</span> <span class="token maybe-class-name">Department</span><span class="token punctuation">.</span><span class="token method function property-access">deleteMany</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Czas sprawdzić, czy nasze testy działają poprawnie. Odpal task <code>test</code> lub <code>test:watch</code> i zobacz, jaki jest rezultat.</p>
<a href="./Moduł_ 30. Testy jednostkowe w backendzie_files/Test8.png" class="img-modal-group"><img src="./Moduł_ 30. Testy jednostkowe w backendzie_files/Test8.png" alt="image" style="width: auto;"></a>
<h3 id="303-testowanie-operacji-crud-create">Create</h3>
<p>Musimy przekonać się, czy możemy poprawnie dodawać nowe dane do kolekcji, zajmiemy się więc metodą <code>save</code>.</p>
<p>Ponownie będziemy weryfikować tylko to, czy w przypadku poprawnych danych, dokument zostanie zapisany do kolekcji. Nie musimy jeszcze raz sprawdzać sytuacji, w której podano błędne informacje.</p>
<p>Bierzmy się do pracy. Pod <code>Reading data</code>, utwórz nowy blok – <code>Creating data</code>, a wewnątrz <code>it</code>.</p>
<pre class=" language-js"><code class=" language-js"><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'Creating data'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>

  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should insert new document with "insertOne" method'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>

  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Tym razem nie musimy wykorzystywać hooka <code>before</code> i przygotowywać w jakiś sposób bazy danych, bo fakt, że jest pusta, wcale nam nie przeszkadza.</p>
<p>Jak będzie wyglądał ten test? Podobnie do dwóch poprzednich przypadków – też jest intuicyjny. Postaramy się dodać nowy element, a potem po prostu sprawdzić, czy istnieje w naszej kolekcji.</p>
<pre class=" language-js"><code class=" language-js"><span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should insert new document with "insertOne" method'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> department <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Department</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'Department #1'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">await</span> department<span class="token punctuation">.</span><span class="token method function property-access">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> savedDepartment <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token maybe-class-name">Department</span><span class="token punctuation">.</span><span class="token method function property-access">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'Department #1'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>savedDepartment<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">to</span><span class="token punctuation">.</span><span class="token property-access">not</span><span class="token punctuation">.</span><span class="token property-access">be</span><span class="token punctuation">.</span><span class="token keyword null nil">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Czy wszystko jest tutaj dla Ciebie jasne? Dodajemy nowy element do kolekcji, następnie staramy się go odnaleźć, a na końcu sprawdzamy, czy się to udało.
Jeśli szukanie się nie powiedzie, <code>findOne</code> zwróci <code>null</code>. Polecenie <code>to.not.be.null</code> sprawdza, czy dostaliśmy coś innego niż <code>null</code>, ponieważ będzie to oznaczało, że otrzymaliśmy dokument.</p>
<p>Całość możemy kodować prościej, wykorzystując <code>isNew</code>. Jeśli dokument nie był jeszcze zapisany w bazie danych, to jego atrybut <code>isNew</code> jest równy <code>true</code>, a gdy został już do niej poprawnie wprowadzony, wartość tego atrybutu zwróci <code>false</code>. Z tą wiedzą możemy zmodyfikować nasz test następująco:</p>
<pre class=" language-js"><code class=" language-js"><span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should insert new document with "insertOne" method'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> department <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Department</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'Department #1'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">await</span> department<span class="token punctuation">.</span><span class="token method function property-access">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>department<span class="token punctuation">.</span><span class="token property-access">isNew</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">to</span><span class="token punctuation">.</span><span class="token property-access">be</span><span class="token punctuation">.</span><span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Następnie uruchom testy i sprawdź, czy udało się przejść wszystko pozytywnie. Jeśli podążasz zgodnie z instrukcjami, to efekt powinien być następujący:</p>
<a href="./Moduł_ 30. Testy jednostkowe w backendzie_files/Test9.png" class="img-modal-group"><img src="./Moduł_ 30. Testy jednostkowe w backendzie_files/Test9.png" alt="image" style="width: auto;"></a>
<p>Na końcu warto byłoby tylko zadbać o usunięcie tego testowego dokumentu. Możemy ponownie wykorzystać hook <code>after</code>:</p>
<pre class=" language-js"><code class=" language-js"><span class="token function">after</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">await</span> <span class="token maybe-class-name">Department</span><span class="token punctuation">.</span><span class="token method function property-access">deleteMany</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<h3 id="303-testowanie-operacji-crud-update">Update</h3>
<p>Pozostały nam do zweryfikowania jeszcze dwie operacje CRUD – <em>Update</em> i <em>Delete</em>. Zaczniemy od tej pierwszej. Warto tu przetestować metody <code>updateOne</code> i <code>updateMany</code>, ale również ideę modyfikacji danych z użyciem <code>save</code>.</p>
<p>Zacznij od utworzenia nowego bloku <code>describe</code> i trzech <code>it</code>.</p>
<pre class=" language-js"><code class=" language-js"><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'Updating data'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>

  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should properly update one document with "updateOne" method'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>

  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should properly update one document with "save" method'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>

  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should properly update multiple documents with "updateMany" method'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>

  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Zanim przejdziemy do samego sprawdzania, musimy jeszcze przygotować testowe dane. Przyda nam się do tego hook <code>beforeEach</code>. Dlaczego ten, a nie <code>before</code>? Dlatego, że każdy test będzie modyfikował dane, idealnie byłoby więc je przywracać do stanu początkowego przed każdym kolejnym testem.</p>
<pre class=" language-js"><code class=" language-js"><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> testDepOne <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Department</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'Department #1'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">await</span> testDepOne<span class="token punctuation">.</span><span class="token method function property-access">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> testDepTwo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Department</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'Department #2'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">await</span> testDepTwo<span class="token punctuation">.</span><span class="token method function property-access">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Od razu możemy dodać też hook <code>afterEach</code>, który po każdym teście będzie usuwał dane z kolekcji, aby można było je wprowadzić od nowa.</p>
<pre class=" language-js"><code class=" language-js"><span class="token function">afterEach</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">await</span> <span class="token maybe-class-name">Department</span><span class="token punctuation">.</span><span class="token method function property-access">deleteMany</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Czas zabrać się już za sam test:</p>
<pre class=" language-js"><code class=" language-js"><span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should properly update one document with "updateOne" method'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">await</span> <span class="token maybe-class-name">Department</span><span class="token punctuation">.</span><span class="token method function property-access">updateOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'Department #1'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> $set<span class="token operator">:</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'=Department #1='</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> updatedDepartment <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token maybe-class-name">Department</span><span class="token punctuation">.</span><span class="token method function property-access">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'=Department #1='</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>updatedDepartment<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">to</span><span class="token punctuation">.</span><span class="token property-access">not</span><span class="token punctuation">.</span><span class="token property-access">be</span><span class="token punctuation">.</span><span class="token keyword null nil">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Wykorzystujemy tutaj ideę bardzo podobną do tej, którą pokazywaliśmy już w pierwszej wersji testu dodawania dokumentu. Staramy się zaktualizować jeden z dokumentów, następnie sprawdzamy, czy rzeczywiście istnieje on teraz w kolekcji. Znowu bazujemy na tym, że <code>findOne</code> zwraca dokument (jeśli znajdzie pasujący) albo <code>null</code> (jeśli takiego nie ma).</p>
<p>Przejdźmy do drugiego testu. Mongoose, mimo tego, że zezwala na użycie <code>updateOne</code>, zaleca korzystanie z metody <code>save</code> do aktualizacji pojedynczego dokumentu. Musimy więc przetestować również taki scenariusz.</p>
<pre class=" language-js"><code class=" language-js"><span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should properly update one document with "save" method'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> department <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token maybe-class-name">Department</span><span class="token punctuation">.</span><span class="token method function property-access">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'Department #1'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  department<span class="token punctuation">.</span><span class="token property-access">name</span> <span class="token operator">=</span> <span class="token string">'=Department #1='</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">await</span> department<span class="token punctuation">.</span><span class="token method function property-access">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> updatedDepartment <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token maybe-class-name">Department</span><span class="token punctuation">.</span><span class="token method function property-access">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'=Department #1='</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>updatedDepartment<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">to</span><span class="token punctuation">.</span><span class="token property-access">not</span><span class="token punctuation">.</span><span class="token property-access">be</span><span class="token punctuation">.</span><span class="token keyword null nil">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Test jest bardzo podobny do pierwszego. Z tą różnicą, że tym razem korzystamy w aktualizacji danych z metody <code>save</code>. Oczywiście nie zapominajmy, że tak naprawdę pod maską <code>save</code> też korzysta z metody <code>updateOne</code>.</p>
<p>Pozostał nam jeszcze trzeci test.</p>
<p>Tym razem postaramy się sprawdzić, czy metoda <code>updateMany</code> zadziała poprawnie. Jak będzie wyglądał ten test? Najpierw spróbujemy zmodyfikować dane za pomocą metody <code>updateMany</code>, a następnie pobierzemy zawartość kolekcji i sprawdzimy, czy faktycznie wartości zostały zaktualizowane.</p>
<p>Spróbuj wykonać ten test bez naszej pomocy.</p>
<p class="text-center">
  <span class="collapse-toggles">
    <a href="https://kodilla.com/pl/bootcamp-module/407/279/5935#collapse-qTTXqNoIO-toggle" class="btn btn-primary collapsed" data-toggle="collapse">Pokaż odpowiedź</a>
    <a href="https://kodilla.com/pl/bootcamp-module/407/279/5935#collapse-qTTXqNoIO-toggle" class="btn btn-primary collapsed" data-toggle="collapse">Ukryj odpowiedź</a>
  </span>
</p>
<div id="collapse-qTTXqNoIO-toggle" class="collapse">
<pre class=" language-js"><code class=" language-js"><span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should properly update multiple documents with "updateMany" method'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">await</span> <span class="token maybe-class-name">Department</span><span class="token punctuation">.</span><span class="token method function property-access">updateMany</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> $set<span class="token operator">:</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'Updated!'</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> departments <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token maybe-class-name">Department</span><span class="token punctuation">.</span><span class="token method function property-access">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>departments<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token property-access">name</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">to</span><span class="token punctuation">.</span><span class="token property-access">be</span><span class="token punctuation">.</span><span class="token method function property-access">equal</span><span class="token punctuation">(</span><span class="token string">'Updated!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>departments<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token property-access">name</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">to</span><span class="token punctuation">.</span><span class="token property-access">be</span><span class="token punctuation">.</span><span class="token method function property-access">equal</span><span class="token punctuation">(</span><span class="token string">'Updated!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Można zrobić to także sprytniej:</p>
<pre class=" language-js"><code class=" language-js"><span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should properly update multiple documents with "updateMany" method'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">await</span> <span class="token maybe-class-name">Department</span><span class="token punctuation">.</span><span class="token method function property-access">updateMany</span><span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> $set<span class="token operator">:</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'Updated!'</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> departments <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token maybe-class-name">Department</span><span class="token punctuation">.</span><span class="token method function property-access">find</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'Updated!'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>departments<span class="token punctuation">.</span><span class="token property-access">length</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">to</span><span class="token punctuation">.</span><span class="token property-access">be</span><span class="token punctuation">.</span><span class="token method function property-access">equal</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
</div>
<p>Jeśli wszystkie testy zostały napisane poprawnie, modele powinny przejść je bez problemu, oczywiście o ile dobrze działają.</p>
<a href="./Moduł_ 30. Testy jednostkowe w backendzie_files/Test10.png" class="img-modal-group"><img src="./Moduł_ 30. Testy jednostkowe w backendzie_files/Test10.png" alt="image" style="width: auto;"></a>
<h3 id="303-testowanie-operacji-crud-delete">Delete</h3>
<p>Czas na ostatnie testy. Musimy jeszcze sprawdzić metody <code>deleteOne</code> i <code>deleteMany</code> oraz <code>remove</code> (która tak naprawdę jest skrótem od <code>deleteOne</code>, ale i tak musi być zweryfikowana).</p>
<p>Zacznij od przygotowania bloku <code>describe</code> oraz trzech <code>it</code>.</p>
<pre class=" language-js"><code class=" language-js"><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'Removing data'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>

  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should properly remove one document with "deleteOne" method'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>

  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should properly remove one document with "remove" method'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>

  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should properly remove multiple documents with "deleteMany" method'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>

  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Zanim przejdziemy do samych testów, zastanówmy się, czy nie potrzebujemy jakichś danych. Żeby coś usunąć, musimy najpierw to utworzyć, przygotujmy więc odpowiedni blok <code>beforeEach</code>, który zapewni nas, że zawsze będą istniały odpowiednie testowe dane. Dodajmy również blok <code>afterEach</code>, odpowiedzialny za każdorazowe zerowanie kolekcji po skończonych testach.</p>
<pre class=" language-js"><code class=" language-js"><span class="token function">beforeEach</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> testDepOne <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Department</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'Department #1'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">await</span> testDepOne<span class="token punctuation">.</span><span class="token method function property-access">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> testDepTwo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Department</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'Department #2'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">await</span> testDepTwo<span class="token punctuation">.</span><span class="token method function property-access">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">afterEach</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">await</span> <span class="token maybe-class-name">Department</span><span class="token punctuation">.</span><span class="token method function property-access">deleteMany</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Następnie możemy zabrać się już za same testy. Zaczniemy od pierwszego. Spróbuj go wykonać bez naszej pomocy.</p>
<p class="text-center">
  <span class="collapse-toggles">
    <a href="https://kodilla.com/pl/bootcamp-module/407/279/5935#collapse-8Z3XZ9ieDJ-toggle" class="btn btn-primary collapsed" data-toggle="collapse">Pokaż odpowiedź</a>
    <a href="https://kodilla.com/pl/bootcamp-module/407/279/5935#collapse-8Z3XZ9ieDJ-toggle" class="btn btn-primary collapsed" data-toggle="collapse">Ukryj odpowiedź</a>
  </span>
</p>
<div id="collapse-8Z3XZ9ieDJ-toggle" class="collapse">
<pre class=" language-js"><code class=" language-js"><span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should properly remove one document with "deleteOne" method'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">await</span> <span class="token maybe-class-name">Department</span><span class="token punctuation">.</span><span class="token method function property-access">deleteOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'Department #1'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> removeDepartment <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token maybe-class-name">Department</span><span class="token punctuation">.</span><span class="token method function property-access">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'Department #1'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>removeDepartment<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">to</span><span class="token punctuation">.</span><span class="token property-access">be</span><span class="token punctuation">.</span><span class="token keyword null nil">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Usuwamy dokument, następnie staramy się go znaleźć, a na końcu sprawdzamy, czy <code>findOne</code> zgodnie z planem zwróciło <code>null</code>. Taka wartość sugeruje bowiem, że elementu nie udało się zlokalizować, a więc już nie istnieje.</p>
</div>
<p>Co do drugiego testu, nie wykorzystywaliśmy <code>remove</code> zbyt często w praktyce, dlatego też tym razem Ci pomożemy.</p>
<p>Plan jest prosty. Musimy znaleźć jeden dokument, następnie postaramy się go usunąć, wywołując na nim bezpośrednio metodę <code>remove</code>. Na końcu sprawdzimy, czy element stanie się po tej operacji nullem.</p>
<pre class=" language-js"><code class=" language-js"><span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should properly remove one document with "remove" method'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> department <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token maybe-class-name">Department</span><span class="token punctuation">.</span><span class="token method function property-access">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'Department #1'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">await</span> department<span class="token punctuation">.</span><span class="token method function property-access">remove</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> removedDepartment <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token maybe-class-name">Department</span><span class="token punctuation">.</span><span class="token method function property-access">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'Department #1'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>removedDepartment<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">to</span><span class="token punctuation">.</span><span class="token property-access">be</span><span class="token punctuation">.</span><span class="token keyword null nil">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Pozostał nam jeszcze ostatni test. Spróbuj go wykonać bez naszej asysty. Musimy sprawdzić, czy metoda <code>deleteMany</code> poprawnie usunie więcej niż jeden dokument.</p>
<p class="text-center">
  <span class="collapse-toggles">
    <a href="https://kodilla.com/pl/bootcamp-module/407/279/5935#collapse-uBhKbexfD3-toggle" class="btn btn-primary collapsed" data-toggle="collapse">Pokaż odpowiedź</a>
    <a href="https://kodilla.com/pl/bootcamp-module/407/279/5935#collapse-uBhKbexfD3-toggle" class="btn btn-primary collapsed" data-toggle="collapse">Ukryj odpowiedź</a>
  </span>
</p>
<div id="collapse-uBhKbexfD3-toggle" class="collapse">
<pre class=" language-js"><code class=" language-js"><span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'should properly remove multiple documents with "deleteMany" method'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">await</span> <span class="token maybe-class-name">Department</span><span class="token punctuation">.</span><span class="token method function property-access">deleteMany</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> departments <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token maybe-class-name">Department</span><span class="token punctuation">.</span><span class="token method function property-access">find</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>departments<span class="token punctuation">.</span><span class="token property-access">length</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">to</span><span class="token punctuation">.</span><span class="token property-access">be</span><span class="token punctuation">.</span><span class="token method function property-access">equal</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Usuwamy wszystkie dokumenty i sprawdzamy, czy kolekcja jest teraz pusta.</p>
</div>
<p>Jeśli wszystkie testy zostały napisane poprawnie, a baza danych działa bezbłędnie, to naszym oczom powinien ukazać się bardzo przyjemny widok:</p>
<a href="./Moduł_ 30. Testy jednostkowe w backendzie_files/Test11.png" class="img-modal-group"><img src="./Moduł_ 30. Testy jednostkowe w backendzie_files/Test11.png" alt="image" style="width: auto;"></a>
<h3 id="303-testowanie-operacji-crud-podsumowanie">Podsumowanie</h3>
<p>Jak widzisz, nie było to aż takie trudne, a przynajmniej mamy pewność, że wszystkie operacje będą wykonywać się poprawnie.</p>
<p>Warto poruszyć jeszcze dwie kwestie, które mogą Cię zastanawiać. Po pierwsze, czy nie można połączyć testów schematów z testami metod? Jak najbardziej można. Wtedy byłyby to testy integracyjne i siłą rzeczy stałyby się trochę trudniejsze do napisania. Niemniej jednak, w swoich przyszłych aplikacjach, jak najbardziej możesz korzystać z takiego pomysłu.</p>
<p>Po drugie, czy możemy testować działanie metod od razu na prawdziwej bazie danych? Tak, jednak wtedy musimy pamiętać o tym, aby łączyć się z bazą testową, a nie produkcyjną. Krótko mówiąc, musimy mieć pewność, że jesteśmy w izolacji z bazą, z której korzystają użytkownicy. Inaczej musielibyśmy wziąć pod uwagę, że wszystkie dane są zmienne. W takiej sytuacji test próbujący dodać dokument o nazwie <code>test</code> mógłby przejść za pierwszym razem poprawnie, a za drugim już&nbsp;nie. Wystarczyłoby, że atrybut <code>name</code> jest unikalny, a akurat przed odpaleniem testu po raz drugi, ktoś by taki dokument dodał. Do tego, musielibyśmy poprawnie usuwać dane testowe oraz pilnować się, aby przypadkiem nie wpływać na pozostałe.</p>
<p>Przyjrzymy się tym zagadnieniom w kolejnym submodule.</p>

                        </div>
                    </div>
                                        <div class="card-block task-card">
                        <h3 id="303-testowanie-operacji-crud-zadanie-testujemy-kolejny-model">Zadanie: <span class="task-title">testujemy kolejny model</span></h3>
                        <div class="task-content">
                            <p>Przed Tobą odrobina praktyki. Twoim zadaniem będzie napisanie testów operacji CRUD dla kolejnego modelu – <code>Employee</code>. Całość powinna być zbudowana analogicznie do testów <code>Department</code>, które mogą posłużyć jako wzór.</p>
<p>Aby ułatwić Ci pracę, poniżej przedstawiamy listę testów, które musisz zaimplementować. Możesz jednak dodać również kolejne, jeśli uznasz to za stosowne. Opisy są po angielsku, by wdrażać Cię w nomenklaturę:</p>
<p><strong>Reading data</strong></p>
<ul>
<li>should return all the data with "find" method,</li>
<li>should return proper document by various params with "findOne" method.</li>
</ul>
<p><strong>Creating data</strong></p>
<ul>
<li>should insert new document with "insertOne" method.</li>
</ul>
<p><strong>Updating data</strong></p>
<ul>
<li>should properly update one document with "updateOne" method,</li>
<li>should properly update one document with "save" method,</li>
<li>should properly update multiple documents with "updateMany" method.</li>
</ul>
<p><strong>Removing data</strong></p>
<ul>
<li>should properly remove one document with "deleteOne" method,</li>
<li>should properly remove one document with "remove" method,</li>
<li>should properly remove multiple documents with "deleteMany" method.</li>
</ul>
<h4>Dla ambitnych</h4>
<p>Jeśli czujesz, że to dla Ciebie za mało, spróbuj przetestować również taką operację: <code>Employee.find().populate('department')</code>. Test powinien sprawdzić, czy takie wywołanie zwróci dokumenty, w których atrybut <code>department</code> nie będzie tylko referencyjnym <code>id</code>, lecz zwykłym obiektem, otrzymanym oczywiście z kolekcji <code>departments</code>.</p>
<p>To trochę trudniejsze zadanie, ale wbrew pozorom, końcowy kod wcale nie musi być długi. Możesz oczywiście wspomagać się internetem, ale najpierw spróbuj zastanowić się nad problemem bez pomocy.</p>

                        </div>
                    </div>
                                        <div class="card-block submodule-footer clearfix  completed ">
                                                <div class="clearfix">
                                                                                <a href="https://kodilla.com/pl/bootcamp-task/407/668565" target="_blank" class="btn btn-info-outline">Podgląd zadania</a>
                            <form target="_blank" class="form-inline project-link-form">
                                <div class="form-group">
                                    <input type="text" name="link" class="form-control" value="https://github.com/skwiryt/companyApp">
                                </div>
                                <button type="submit" class="btn  btn-primary ">Wyślij link <i class="fa fa-check"></i></button>
                            </form>
                                                                                                    </div>
                    </div>
                </section>
                                    
                <section id="submodule-1171" class="card submodule completed" data-bootcamp-user-submodule-id="668566">
                <!-- klasy dla section: completed current comments -->
                    <div class="card-block submodule-header clearfix">
                        <i class="fa fa-check-circle-o fa-2x"></i>
                        <i class="fa fa-play-circle-o fa-2x"></i>
                        <i class="fa fa-exclamation-circle fa-2x"></i>
                        <i class="fa fa-send-o fa-2x"></i>
                        <h2 class="bootcamp-submodule-name">30.4. <span>Testowanie endpointów</span></h2>
                                            </div>
                    <div class="card-block">
                        <div class="submodule-content">
                            <p>Wiemy już, jak możemy przetestować schematy struktur danych oraz jak sprawdzić działanie metod modeli. Czy to jednak wystarczy? Nawet w przypadku prostych aplikacji backendowych, jak nasz serwer API, jest jeszcze jedna rzecz, którą koniecznie musimy zweryfikować. Mowa o działaniu endpointów.</p>
<p>Należy upewnić się, czy np. pod <code>/departments</code> serwer zwróci tablicę wszystkich działów, a <code>/departments/1</code> pokaże jeden właściwy. Robiliśmy już takie testy, tyle że ręcznie za pomocą Postmana.</p>
<p>Było to bardzo proste, bo same requesty mogliśmy zapisywać i wywoływać&nbsp;później za pomocą jednego kliknięcia. Niemniej jednak zajmowało to trochę czasu i raczej nie chcielibyśmy powtarzać tego procesu za każdym razem, gdy zmodyfikujemy naszą aplikację.</p>
<p>Na szczęście ponownie na pomoc przyjdą nam testy automatyczne. Tak naprawdę będą robiły to samo, co my za pomocą Postmana, czyli symulowały requesty z odpowiednimi parametrami i sprawdzały rezultat. Jedyna różnica jest taka, że wcześniej wykonywaliśmy testy ręcznie, a teraz to zadanie przejmie Mocha.</p>
<h3 id="304-testowanie-endpointow-lokalizacja-testow">Lokalizacja testów</h3>
<p>Ponownie zastanówmy się, gdzie będziemy przechowywać nasze nowe testy. Wydaje się, że logiczne byłoby podążanie za trendem z poprzednich submodułów. Skoro testy schematów modeli danych, jak i ich metod, trzymaliśmy obok samych modeli, to może testy endpointów też powinny się tam znaleźć? Niekoniecznie.</p>
<p>Zauważ, że <strong>endpointy nie zawsze wykorzystują tylko dane z jednej kolekcji</strong>. U nas oczywiście często tak to wygląda, ale nie jest to regułą. W pewnych sytuacjach korzystamy z dwóch kolekcji. W takim przypadku, gdzie umieścilibyśmy te testy?</p>
<p>Co więcej, <strong>mogą istnieć też takie endpointy, które w ogóle nie będą korzystały z bazy danych</strong>. Pamiętasz, że przed wprowadzeniem MongoDB nasze endpointy wcale nie używały bazy danych?</p>
<p>Najlepszym wyjściem będzie więc potraktowanie ich jako coś bardziej "globalnego". Dlatego też nasza propozycja jest taka, aby tym razem przechowywać je w głównym katalogu serwera.</p>
<h4>Przygotowujemy katalogi</h4>
<p>Zacznij od założenia katalogu <code>test</code>, a w nim utwórz kolejny o nazwie <code>api</code>. To tutaj będziemy przechowywać nasze testy.</p>
<p>Moglibyśmy wszystkie testy endpointów dla danej grupy umieścić w jednym pliku. W takim scenariuszu nasz katalog <code>test.api</code> wyglądałby następująco:</p>
<pre class=" language-markup"><code class=" language-markup">/test
  /api
    departments.test.js
    employees.test.js
    products.test.js</code></pre>
<p>Jest to dobra strategia, ale zauważ, że naszych endpointów jest całkiem sporo. Jeśli zechcemy testować dla każdego z nich dobry, ale też i zły scenariusz, to ich liczba znacznie wzrośnie.</p>
<p>Może lepiej podejść do tego nieco inaczej, zwiększyć czytelność, a przy tym zmniejszyć rozmiar pojedynczych plików. Nasza propozycja jest taka, aby wydzielić endpointy dla każdej grupy route'ów ze względu na ich metodę.</p>
<p>Mogłoby to wyglądać tak:</p>
<pre class=" language-markup"><code class=" language-markup">/test
  /api
    /departments
      delete.test.js
      get.test.js
      post.test.js
      put.test.js
    /employees
      delete.test.js
      get.test.js
      post.test.js
      put.test.js
    /products
      delete.test.js
      get.test.js
      post.test.js
      put.test.js</code></pre>
<p>W tym submodule zajmiemy się wyłącznie testami grupy endpointów <code>departments</code>. Utwórz więc odpowiedni folder i pliki tylko dla niej.</p>
<p>Nasz katalog <code>test</code> na końcu powinien wyglądać więc tak:</p>
<pre class=" language-markup"><code class=" language-markup">/test
  /api
    /departments
      delete.test.js
      get.test.js
      post.test.js
      put.test.js</code></pre>
<h3 id="304-testowanie-endpointow-get">GET</h3>
<p>Zaczniemy od <code>get.test.js</code> i sprawdzenia endpointów do pobierania danych.</p>
<p>Wejdź teraz do tego pliku. Standardowo rozpoczniemy od przygotowania pierwszego bloku <code>describe</code> i zaimportowania funkcji <code>expect</code>.</p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> expect <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'chai'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">expect</span><span class="token punctuation">;</span>

<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'GET /api/departments'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Oprócz <code>expect</code> będziemy tym razem potrzebować jeszcze jednej funkcji pomocniczej – <code>request</code>. Służy ona do symulowania requestów i niestety nie jest wbudowana w pakiet Chai. Zamiast tego twórcy przygotowali ją w formie pluginu <code>chai-http</code>.</p>
<p>Pobierz go więc teraz:</p>
<pre class=" language-js"><code class=" language-js">yarn add chai<span class="token operator">-</span>http@<span class="token number">4.3</span><span class="token number">.0</span></code></pre>
<p>Następnie musimy go jeszcze zaimportować do naszego pliku z testami, a na końcu dodać do <code>chai</code> jako middleware. Całość po zmianach powinna wyglądać tak:</p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> chai <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'chai'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> chaiHttp <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'chai-http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

chai<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span>chaiHttp<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> expect <span class="token operator">=</span> chai<span class="token punctuation">.</span><span class="token property-access">expect</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> request <span class="token operator">=</span> chai<span class="token punctuation">.</span><span class="token property-access">request</span><span class="token punctuation">;</span>

<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'GET /api/departments'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Importujemy paczkę <code>chai</code> oraz <code>chai-http</code>. Następnie wprowadzamy ten plugin jako middleware (<code>chai.use</code>). Na końcu, dla wygody, tworzymy sobie skróty do metod <code>expect</code> i <code>request</code>. Zawsze lepiej pisać <code>expect</code> niż <code>chai.expect</code>.</p>
<p>Od teraz wciąż będziemy mieli dostęp do metody <code>expect</code>, ale dodatkowo możemy korzystać również z <code>request</code>.</p>
<p>Na końcu przygotuj jeszcze bloki <code>it</code> dla pojedynczych testów:</p>
<pre class=" language-js"><code class=" language-js"><span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'GET /api/departments'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>

  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'/ should return all departments'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>

  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'/:id should return one department by :id '</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>

  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'/random should return one random department'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>

  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Oczywiście dobrym pomysłem byłoby również przetestowanie tego, co serwer zwraca w przypadku błędów. To jednak wymagałoby od nas symulowania niepoprawnego działania aplikacji. Nie będziemy się więc teraz tym zajmować. Zamiast tego sprawdzimy tylko, czy przy poprawnym linku, serwer zwróci to, co trzeba.</p>
<h4>Przygotowujemy serwer</h4>
<p>Zanim przejdziemy do pisania testów, musimy zrobić jedną rzecz. Przed sprawdzaniem endpointów w Postmanie, zawsze uruchamialiśmy serwer, bo tylko w taki sposób mogliśmy weryfikować, jak zareaguje on na dany endpoint. To samo musi robić więc Mocha.</p>
<p>Zacznij od przygotowania eksportu serwera z <code>server.js</code>, aby można było go zaimportować w naszych plikach z testami.</p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> server <span class="token operator">=</span> app<span class="token punctuation">.</span><span class="token method function property-access">listen</span><span class="token punctuation">(</span><span class="token string">'8000'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'Server is running on port: 8000'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

module<span class="token punctuation">.</span><span class="token property-access">exports</span> <span class="token operator">=</span> server<span class="token punctuation">;</span></code></pre>
<p>Następnie zaimportuj go w naszym pliku <code>get.test.js</code>:</p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> server <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../../server.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Od tej chwili będziemy mieli do niego dostęp pod stałą <code>server</code>.</p>
<h4>Co z bazą danych?</h4>
<p>W poprzednim submodule symulowaliśmy bazę danych przy użyciu <code>mongodb-memory-server</code>, ale tym razem podejdziemy do tematu inaczej. Zastosowanie tej paczki wciąż byłoby wykonalne, ale mało praktyczne. Nasz serwer korzysta w końcu z prawdziwej bazy danych i to ją wykorzystuje przy endpointach. Aby zmienić tę sytuację na czas testów, musielibyśmy mocno ingerować w działanie samego serwera. Dlatego tym razem będziemy testować go wraz z prawdziwą bazą danych.</p>
<p>Nie ma w tym nic złego, o ile baza nie jest równocześnie wykorzystywana przez użytkowników. W takim przypadku wyniki mogłyby zostać zafałszowane.</p>
<p>Jest to warunek łatwy do spełnienia, gdy aplikacja nie jest jeszcze udostępniona użytkownikom, ale nie ma większego problemu także z tymi opublikowanymi. Wystarczy, że u siebie w projekcie korzystasz z bazy lokalnej, a aplikacja umieszczona np. na Heroku łączy się z jej zdalnym odpowiednikiem na MongoDB Atlas.</p>
<p>W takiej sytuacji nie boimy się, że użytkownicy w każdej chwili mogą zmienić coś w danych, które testujemy, bo mamy dwie oddzielne bazy. Są&nbsp;identyczne w swojej strukturze, obsługiwane przez identyczny kod, ale jednak inne. Dodatkowo nie musimy się obawiać, że przy testach przypadkiem popsujemy coś w danych użytkowników.</p>
<p>Nasz serwer w tej chwili korzysta już z bazy danych MongoDB Atlas, dlatego musimy go lekko zmodyfikować, aby w przypadku uruchamiania testów, nie korzystał z niej, lecz z bazy lokalnej. Możemy dokonać tego bardzo prosto, wystarczy dodać odpowiednią pętlę warunkową. Jeśli <code>process.env.NODE_ENV === 'production'</code>, to serwer powinien łączyć się z bazą zdalną. Jeśli środowisko jest inne (developerskie lub testowe),  powinien wykorzystać bazę lokalną.</p>
<pre class=" language-markup"><code class=" language-markup">const dbURI = process.env.NODE_ENV === 'production' ? 'url to remote db' : 'url to local db';
mongoose.connect(dbURI, { useNewUrlParser: true, useUnifiedTopology: true });
const db = mongoose.connection;</code></pre>
<p>Dodatkowo, dla porządku, warto zmodyfikować również task uruchamiający testy. Należy przed uruchamianiem Mochy ustawić <code>NODE_ENV</code> na <code>test</code>.</p>
<p>Windows:</p>
<pre class=" language-markup"><code class=" language-markup">"test": "set NODE_ENV=production &amp;&amp; mocha \"./{,!(node_modules)/**/}*.test.js\"",
"test:watch": "onchange \"./**/*.js\" -i -k -- yarn test",</code></pre>
<p>Linux lub Mac:</p>
<pre class=" language-markup"><code class=" language-markup">"test": "NODE_ENV=production mocha \"./{,!(node_modules)/**/}*.test.js\"",
"test:watch": "onchange \"./**/*.js\" -i -k -- yarn test",</code></pre>
<h4>Pierwszy test</h4>
<p>Przejdźmy do praktyki i zajmijmy się teraz pierwszym testem.</p>
<p>Skoro sprawdzamy requesty <code>GET</code>, warto byłoby mieć jakieś dane do zwracania. Aby upewnić się, że nasza baza nie jest pusta, możemy skorzystać z idei z poprzedniego submodułu, czyli dodawania danych w hooku <code>before</code>, a następnie kasowania ich po testach w <code>after</code>.</p>
<pre class=" language-js"><code class=" language-js"><span class="token function">before</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> testDepOne <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Department</span><span class="token punctuation">(</span><span class="token punctuation">{</span> _id<span class="token operator">:</span> <span class="token string">'5d9f1140f10a81216cfd4408'</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">'Department #1'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">await</span> testDepOne<span class="token punctuation">.</span><span class="token method function property-access">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">const</span> testDepTwo <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Department</span><span class="token punctuation">(</span><span class="token punctuation">{</span> _id<span class="token operator">:</span> <span class="token string">'5d9f1159f81ce8d1ef2bee48'</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">'Department #2'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">await</span> testDepTwo<span class="token punctuation">.</span><span class="token method function property-access">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">after</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">await</span> <span class="token maybe-class-name">Department</span><span class="token punctuation">.</span><span class="token method function property-access">deleteMany</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Zauważ, że sami ustaliliśmy <code>_id</code> dla naszych dokumentów. Jeśli tego nie zrobimy, to MongoDB nada je automatycznie. Dlaczego więc zdecydowaliśmy się na taki ruch? Z bardzo prostego powodu. Za chwilę będziemy testować endpoint do pobierania pojedynczego dokumentu po id. Gdybyśmy pozwolili nadać dokumentom <code>_id</code> w sposób automatyczny, to zwyczajnie nie wiedzielibyśmy jaki identyfikator tak naprawdę otrzymały i jaki <code>_id</code> możemy przetestować. Musielibyśmy więc najpierw sprawdzić, jakie jest <code>_id</code> losowego dokumentu i dopiero wtedy bylibyśmy w stanie przeprowadzić dla niego test. Po co dokładać sobie pracy?</p>
<p>Oczywiście, aby ten kod zadziałał, <strong>nie możesz zapomnieć o zaimportowaniu</strong> właściwego modelu.</p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> <span class="token maybe-class-name">Department</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../../models/department.model'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Teraz mamy pewność, że nasza baza danych podczas testów będzie miała w kolekcji <code>departments</code> dokładnie dwa dokumenty.</p>
<p>Przejdźmy już do samego testu.</p>
<p>Metoda <code>request</code>, z której skorzystamy, jest dość intuicyjna.</p>
<pre class=" language-js"><code class=" language-js"><span class="token function">request</span><span class="token punctuation">(</span>server<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/api/departments'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Jako pierwszy parametr musimy wskazać serwer, który chcemy testować. Następnie możemy wywołać odpowiednią metodę (<code>get</code>, <code>post</code>, <code>put</code>, <code>delete</code>) wraz z linkiem. Wystarczy to, aby zasymulować połączenie pod tym adresem. Dodatkowo funkcja <code>request</code> dostarcza jeszcze kolejne metody, a niektóre z nich będą naprawdę przydatne. Na przykład <code>send</code> pozwoli na wysłanie wraz z requestem pakietu danych, co ma zastosowanie np. przy testach requestów POST.</p>
<pre class=" language-js"><code class=" language-js"><span class="token function">request</span><span class="token punctuation">(</span>server<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">post</span><span class="token punctuation">(</span><span class="token string">'/api/departments'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'Department #1'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Jak będzie wyglądał już sam test?</p>
<pre class=" language-js"><code class=" language-js"><span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'/ should return all departments'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>

  <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token function">request</span><span class="token punctuation">(</span>server<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/api/departments'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span><span class="token property-access">status</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">to</span><span class="token punctuation">.</span><span class="token property-access">be</span><span class="token punctuation">.</span><span class="token method function property-access">equal</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">to</span><span class="token punctuation">.</span><span class="token property-access">be</span><span class="token punctuation">.</span><span class="token method function property-access">an</span><span class="token punctuation">(</span><span class="token string">'array'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">.</span><span class="token property-access">length</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">to</span><span class="token punctuation">.</span><span class="token property-access">be</span><span class="token punctuation">.</span><span class="token method function property-access">equal</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Przyznaj, że dość intuicyjnie. Łączymy się z <code>api/departments</code> za pomocą metody <strong>GET</strong>. Następnie sprawdzamy, czy serwer zwrócił kod sukcesu (a powinien) i czy otrzymaliśmy jako odpowiedź tablicę z dokładnie dwoma elementami. Wiemy, że ta ilość ma być właśnie taka, bo sami przed chwilą zadbaliśmy o odpowiednią zawartość kolekcji <code>departments</code>.</p>
<p>Tak jak w poprzednim submodule, nie sprawdzamy już poprawności struktury otrzymanych dokumentów.</p>
<p>A jak będzie wyglądał kolejny test?</p>
<pre class=" language-js"><code class=" language-js"><span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'/:id should return one department by :id '</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Spróbuj wykonać go już bez naszej pomocy.</p>
<p class="text-center">
  <span class="collapse-toggles">
    <a href="https://kodilla.com/pl/bootcamp-module/407/279/5935#collapse-EvJNQjWlP-toggle" class="btn btn-primary collapsed" data-toggle="collapse">Pokaż odpowiedź</a>
    <a href="https://kodilla.com/pl/bootcamp-module/407/279/5935#collapse-EvJNQjWlP-toggle" class="btn btn-primary collapsed" data-toggle="collapse">Ukryj odpowiedź</a>
  </span>
</p>
<div id="collapse-EvJNQjWlP-toggle" class="collapse">
<pre class=" language-js"><code class=" language-js"><span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'/:id should return one department by :id '</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token function">request</span><span class="token punctuation">(</span>server<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/api/departments/5d9f1140f10a81216cfd4408'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span><span class="token property-access">status</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">to</span><span class="token punctuation">.</span><span class="token property-access">be</span><span class="token punctuation">.</span><span class="token method function property-access">equal</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">to</span><span class="token punctuation">.</span><span class="token property-access">be</span><span class="token punctuation">.</span><span class="token method function property-access">an</span><span class="token punctuation">(</span><span class="token string">'object'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">to</span><span class="token punctuation">.</span><span class="token property-access">not</span><span class="token punctuation">.</span><span class="token property-access">be</span><span class="token punctuation">.</span><span class="token keyword null nil">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Łączymy się z endpointem, który powinien zwrócić nam pojedynczy obiekt. Wiemy, że musi to zrobić, bo <code>:id</code> jest prawidłowe i istnieje jeden dokument właśnie o takim identyfikatorze. Następnie sprawdzamy, czy otrzymaliśmy kod odpowiedzi sugerujący sukces (<code>200</code>), czy odpowiedź jest obiektem, oraz czy nie jest nullem. W tej sytuacji <code>null</code> sugerowałby bowiem, że obiektu nie udało się odnaleźć.</p>
</div>
<p>Analogicznie będziemy mogli zbudować trzeci test. Ponownie, spróbuj go wykonać bez naszej pomocy.</p>
<p class="text-center">
  <span class="collapse-toggles">
    <a href="https://kodilla.com/pl/bootcamp-module/407/279/5935#collapse-P_aZo3A9rL-toggle" class="btn btn-primary collapsed" data-toggle="collapse">Pokaż odpowiedź</a>
    <a href="https://kodilla.com/pl/bootcamp-module/407/279/5935#collapse-P_aZo3A9rL-toggle" class="btn btn-primary collapsed" data-toggle="collapse">Ukryj odpowiedź</a>
  </span>
</p>
<div id="collapse-P_aZo3A9rL-toggle" class="collapse">
<pre class=" language-js"><code class=" language-js"><span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'/random should return one random department'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token function">request</span><span class="token punctuation">(</span>server<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/api/departments/random'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span><span class="token property-access">status</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">to</span><span class="token punctuation">.</span><span class="token property-access">be</span><span class="token punctuation">.</span><span class="token method function property-access">equal</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">to</span><span class="token punctuation">.</span><span class="token property-access">be</span><span class="token punctuation">.</span><span class="token method function property-access">an</span><span class="token punctuation">(</span><span class="token string">'object'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">to</span><span class="token punctuation">.</span><span class="token property-access">not</span><span class="token punctuation">.</span><span class="token property-access">be</span><span class="token punctuation">.</span><span class="token keyword null nil">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
</div>
<p>Jeśli wszystkie testy działają właściwie, a nasze endpointy są poprawnie napisane, konsola powinna zwracać bardzo przyjemny widok.</p>
<a href="./Moduł_ 30. Testy jednostkowe w backendzie_files/Test12.png" class="img-modal-group"><img src="./Moduł_ 30. Testy jednostkowe w backendzie_files/Test12.png" alt="image" style="width: auto;"></a>
<div class="bc-note alert-success">
<h4 class="alert-heading text-center">Zbędne komunikaty</h4>
<p>Zapewne udało Ci się zauważyć, że po tym, jak zaczęliśmy korzystać z naszego serwera, coś złego stało się z listą testów. Obok opisów (jak <code>Department</code> czy <code>Reading data</code>) pojawiły się jeszcze komunikaty takie jak <code>Server is running on port...</code> czy <code>Connected to database</code>. Mogą być one dość denerwujące i psują czytelność wyników testów.</p>
<p>Rozwiązać ten problem możemy na kilka sposobów. Najbardziej eleganckie byłoby po prostu nadpisanie funkcji <code>console.log</code> tak, aby faktycznie zwracała dane tylko wtedy, kiedy zmienna środowiskowa <code>env</code> wskazywałaby na <code>false</code>. W takiej sytuacji wystarczyłoby uruchamiać task z testami wraz z ustawieniem tej zmiennej na <code>true</code>, aby mieć pewność, że logi się nie pojawią. Innym sposobem będzie po prostu usunięcie ich wywołania w pliku <code>server.js</code>. Jest to najłatwiejsza opcja, o ile uważasz, że te komunikaty nie są Ci do niczego potrzebne.</p>
</div>
<h3 id="304-testowanie-endpointow-post">POST</h3>
<p>Czas na kolejne endpointy, a więc plik <code>post.test.js</code>.</p>
<p>Początek będzie bardzo podobny. Musimy przygotować odpowiednie importy oraz bloki <code>describe</code> i <code>it</code>.</p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> chai <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'chai'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> chaiHttp <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'chai-http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> server <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../../server.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token maybe-class-name">Department</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../../models/department.model'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

chai<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span>chaiHttp<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> expect <span class="token operator">=</span> chai<span class="token punctuation">.</span><span class="token property-access">expect</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> request <span class="token operator">=</span> chai<span class="token punctuation">.</span><span class="token property-access">request</span><span class="token punctuation">;</span>

<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'POST /api/departments'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>

  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'/ should insert new document to db and return success'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>

  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Ponownie będziemy korzystać z <code>chai.request</code> do wykonywania requestów. Zadanie jest o tyle łatwiejsze, że tym razem mamy do napisania tylko jeden test – w końcu istnieje u nas tylko jeden endpoint dla metody <strong>POST</strong>, czyli ten dodający nowy dział.</p>
<p>Zastanówmy się, czy nie musimy w jakiś sposób przygotować naszej bazy danych, jak to robiliśmy we wcześniejszych testach.</p>
<p>Tym razem sprawdzamy dodawanie dokumentów, a więc to, czy w bazie aktualnie są dwa wpisy, sto czy zero, kompletnie nas nie interesuje. Dobrą praktyką byłoby za to usuwanie naszego próbnego wpisu, który będzie dodawany podczas wysyłania testowego requestu. Nie będziemy więc tym razem korzystać z hooka <code>before</code>, ale <code>after</code> ponownie nam się przyda.</p>
<pre class=" language-js"><code class=" language-js"><span class="token function">after</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">await</span> <span class="token maybe-class-name">Department</span><span class="token punctuation">.</span><span class="token method function property-access">deleteMany</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Teraz przejdźmy już do samego testu.</p>
<pre class=" language-js"><code class=" language-js"><span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'/ should insert new document to db and return success'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token function">request</span><span class="token punctuation">(</span>server<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">post</span><span class="token punctuation">(</span><span class="token string">'/api/departments'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'#Department #1'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> newDepartment <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token maybe-class-name">Department</span><span class="token punctuation">.</span><span class="token method function property-access">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'#Department #1'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span><span class="token property-access">status</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">to</span><span class="token punctuation">.</span><span class="token property-access">be</span><span class="token punctuation">.</span><span class="token method function property-access">equal</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">.</span><span class="token property-access">message</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">to</span><span class="token punctuation">.</span><span class="token property-access">be</span><span class="token punctuation">.</span><span class="token method function property-access">equal</span><span class="token punctuation">(</span><span class="token string">'OK'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>newDepartment<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">to</span><span class="token punctuation">.</span><span class="token property-access">not</span><span class="token punctuation">.</span><span class="token property-access">be</span><span class="token punctuation">.</span><span class="token keyword null nil">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Początek jest bardzo podobny do wcześniejszych testów – wysyłamy request pod wybrany adres przy użyciu konkretnej metody. Różnica jest tylko taka, że tym razem wraz z requestem wysyłane są również dane (body). Pamiętamy bowiem, że nasz endpoint <code>/api/departments</code> <strong>POST</strong> oczekuje na nazwę działu.</p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token function">request</span><span class="token punctuation">(</span>server<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">post</span><span class="token punctuation">(</span><span class="token string">'/api/departments'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'#Department #1'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Całkiem jasne mogą być dwa warunki:</p>
<pre class=" language-js"><code class=" language-js"><span class="token function">expect</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span><span class="token property-access">status</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">to</span><span class="token punctuation">.</span><span class="token property-access">be</span><span class="token punctuation">.</span><span class="token method function property-access">equal</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">expect</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">to</span><span class="token punctuation">.</span><span class="token method function property-access">be</span><span class="token punctuation">(</span><span class="token punctuation">{</span> message<span class="token operator">:</span> <span class="token string">'OK'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Oczekujemy, że serwer zwróci kod sukcesu, a jego odpowiedź to <code>{ message: 'OK' }</code>. Pewnie pamiętasz, że sami ustaliliśmy treść&nbsp;tego komunikatu, a teraz sprawdzamy, czy to wymaganie jest spełnione.</p>
<p>Jak widzisz jednak to nie wszystko. Oprócz tego mamy jeszcze kod, który sprawdza, czy element rzeczywiście jest dodany do bazy.</p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> newDepartment <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token maybe-class-name">Department</span><span class="token punctuation">.</span><span class="token method function property-access">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'#Department #1'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token spread operator">...</span>
<span class="token method function property-access">expect</span><span class="token punctuation">(</span>newDepartment<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">to</span><span class="token punctuation">.</span><span class="token property-access">not</span><span class="token punctuation">.</span><span class="token property-access">be</span><span class="token punctuation">.</span><span class="token keyword null nil">null</span><span class="token punctuation">;</span></code></pre>
<p>Pewnie domyślasz się skąd taki pomysł. Fakt, że serwer zwróci kod odpowiedzi <code>200</code>, to trochę za mało, aby dać nam pewność, że wszystko działa dobrze. Na dobrą sprawę, jeśli skrypt będzie napisany niepoprawnie, jest spora szansa, że taką odpowiedź dostaniemy nawet przy błędzie, niezależnie od tego, czy do bazy udało się coś wprowadzić, czy też nie. Nie możemy liczyć na to, że programista jest nieomylny, ani traktować kodu odpowiedzi <code>200</code> jako gwarancji.</p>
<p>Zauważ, że w poprzednich testach również nie poprzestawaliśmy na sprawdzeniu samej odpowiedzi. Zamiast tego badaliśmy, czy otrzymaliśmy odpowiedni typ danych (np. tablica) oraz ich ilość (np. 2). Dopiero to dawało pewność, że endpoint poprawnie łączy się z bazą i zwraca to, co trzeba.</p>
<p>Teraz mamy trochę trudniejszy scenariusz, bo serwer zwraca tylko komunikat <code>{ message: 'OK' }</code>. Dlatego też zwyczajnie musimy sprawdzić, czy po requeście w bazie danych pojawi się nowy dokument.</p>
<p>Jeśli Twój serwer działa poprawnie, to test powinien zaświecić się na zielono.</p>
<h3 id="304-testowanie-endpointow-put">PUT</h3>
<p>Czas na endpoint do edycji dokumentów. Ponownie będziemy musieli napisać tylko jeden test.</p>
<p>Zacznij standardowo, od przygotowania startowej struktury.</p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> chai <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'chai'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> chaiHttp <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'chai-http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> server <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../../server.js'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> <span class="token maybe-class-name">Department</span> <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'../../models/department.model'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

chai<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span>chaiHttp<span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> expect <span class="token operator">=</span> chai<span class="token punctuation">.</span><span class="token property-access">expect</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> request <span class="token operator">=</span> chai<span class="token punctuation">.</span><span class="token property-access">request</span><span class="token punctuation">;</span>

<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'PUT /api/departments'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>

  <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'/:id should update chosen document and return success'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>

  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Następnie zastanówmy się nad przygotowaniem bazy. Tym razem konieczne będą testowe dane, ale wystarczy nam tylko jeden dokument.</p>
<pre class=" language-js"><code class=" language-js"><span class="token function">before</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> testDepOne <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Department</span><span class="token punctuation">(</span><span class="token punctuation">{</span> _id<span class="token operator">:</span> <span class="token string">'5d9f1140f10a81216cfd4408'</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">'Department #1'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">await</span> testDepOne<span class="token punctuation">.</span><span class="token method function property-access">save</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">after</span><span class="token punctuation">(</span><span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">await</span> <span class="token maybe-class-name">Department</span><span class="token punctuation">.</span><span class="token method function property-access">deleteMany</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Sam test spróbuj napisać już bez naszej pomocy. Dasz radę? ;)</p>
<p class="text-center">
  <span class="collapse-toggles">
    <a href="https://kodilla.com/pl/bootcamp-module/407/279/5935#collapse-KelQa_j1-y-toggle" class="btn btn-primary collapsed" data-toggle="collapse">Pokaż odpowiedź</a>
    <a href="https://kodilla.com/pl/bootcamp-module/407/279/5935#collapse-KelQa_j1-y-toggle" class="btn btn-primary collapsed" data-toggle="collapse">Ukryj odpowiedź</a>
  </span>
</p>
<div id="collapse-KelQa_j1-y-toggle" class="collapse">
<pre class=" language-js"><code class=" language-js"><span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'/:id should update chosen document and return success'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token function">request</span><span class="token punctuation">(</span>server<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">put</span><span class="token punctuation">(</span><span class="token string">'/api/departments/5d9f1140f10a81216cfd4408'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'=#Department #1='</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span><span class="token property-access">status</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">to</span><span class="token punctuation">.</span><span class="token property-access">be</span><span class="token punctuation">.</span><span class="token method function property-access">equal</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">to</span><span class="token punctuation">.</span><span class="token property-access">not</span><span class="token punctuation">.</span><span class="token property-access">be</span><span class="token punctuation">.</span><span class="token keyword null nil">null</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Ten test był trochę prostszy. Nasz endpoint do edycji danych jest skonstruowany w taki sposób, że zwraca zmieniony dokument, a nie tylko komunikat w stylu <code>{ message: 'OK' }</code>. Tym samym możemy pozostać przy sprawdzeniu, czy odpowiedź (<code>res.body</code>) nie równa się <code>null</code>.</p>
<p>Jeśli jednak uważasz, że to za mało i chcesz upewnić się, czy naprawdę w bazie danych doszło do zmiany, możesz jeszcze ten test przebudować i sprawdzić, czy dokument faktycznie się zmienił.</p>
<pre class=" language-js"><code class=" language-js"><span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'/:id should update chosen document and return success'</span><span class="token punctuation">,</span> <span class="token keyword">async</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> res <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token function">request</span><span class="token punctuation">(</span>server<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">put</span><span class="token punctuation">(</span><span class="token string">'/api/departments/5d9f1140f10a81216cfd4408'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">'=#Department #1='</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> updatedDepartment <span class="token operator">=</span> <span class="token keyword control-flow">await</span> <span class="token maybe-class-name">Department</span><span class="token punctuation">.</span><span class="token method function property-access">findOne</span><span class="token punctuation">(</span><span class="token punctuation">{</span> _id<span class="token operator">:</span> <span class="token string">'5d9f1140f10a81216cfd4408'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span><span class="token property-access">status</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">to</span><span class="token punctuation">.</span><span class="token property-access">be</span><span class="token punctuation">.</span><span class="token method function property-access">equal</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">to</span><span class="token punctuation">.</span><span class="token property-access">not</span><span class="token punctuation">.</span><span class="token property-access">be</span><span class="token punctuation">.</span><span class="token keyword null nil">null</span><span class="token punctuation">;</span>
  <span class="token function">expect</span><span class="token punctuation">(</span>updatedDepartment<span class="token punctuation">.</span><span class="token property-access">name</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">to</span><span class="token punctuation">.</span><span class="token property-access">be</span><span class="token punctuation">.</span><span class="token method function property-access">equal</span><span class="token punctuation">(</span><span class="token string">'=#Department #1='</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
</div>
<p>Jeśli serwer działa dobrze, task <code>test</code> w konsoli powinien zwrócić nam same zielone sukcesy.</p>
<h3 id="304-testowanie-endpointow-podsumowanie">Podsumowanie</h3>
<p>Musisz przyznać, że przy użyciu metody <code>request</code>, pisanie testów dla endpointów jest niezwykle intuicyjne i stosunkowo proste.</p>
<p>Jeśli tylko przypomnimy sobie wszystkie te chwile, kiedy zaglądaliśmy do Postmana w celu sprawdzenia, czy czasem "nic się nie popsuło" po zmianach na naszym serwerze, to łatwo uświadomić sobie jaką wartość&nbsp;mają testy automatyczne.</p>

                        </div>
                    </div>
                                        <div class="card-block task-card">
                        <h3 id="304-testowanie-endpointow-zadanie-ostatni-test">Zadanie: <span class="task-title">ostatni test</span></h3>
                        <div class="task-content">
                            <p>Jak zapewne udało Ci się zauważyć, w submodule zabrakło jeszcze jednego testu. Chodzi oczywiście o <strong>DELETE</strong> w endpoincie <code>/departments/:id</code>. Jego wykonanie będzie Twoim zadaniem.</p>
<p>Postaraj się napisać ten test analogicznie do pozostałych w submodule. Nie zapomnij też o tym, że każda metoda ma u nas odpowiadający plik, a więc test tego endpointu powinien być przechowywany w <code>delete.test.js</code>.</p>

                        </div>
                    </div>
                                        <div class="card-block submodule-footer clearfix  completed ">
                                                <div class="clearfix">
                                                                                <a href="https://kodilla.com/pl/bootcamp-task/407/668566" target="_blank" class="btn btn-info-outline">Podgląd zadania</a>
                            <form target="_blank" class="form-inline project-link-form">
                                <div class="form-group">
                                    <input type="text" name="link" class="form-control" value="https://github.com/skwiryt/companyApp">
                                </div>
                                <button type="submit" class="btn  btn-primary ">Wyślij link <i class="fa fa-check"></i></button>
                            </form>
                                                                                                    </div>
                    </div>
                </section>
                                    
                <section id="submodule-1172" class="card submodule completed" data-bootcamp-user-submodule-id="668567">
                <!-- klasy dla section: completed current comments -->
                    <div class="card-block submodule-header clearfix">
                        <i class="fa fa-check-circle-o fa-2x"></i>
                        <i class="fa fa-play-circle-o fa-2x"></i>
                        <i class="fa fa-exclamation-circle fa-2x"></i>
                        <i class="fa fa-send-o fa-2x"></i>
                        <h2 class="bootcamp-submodule-name">30.5. <span>Testy w praktyce</span></h2>
                                            </div>
                    <div class="card-block">
                        <div class="submodule-content">
                            <p>Dotychczas zajmowaliśmy się głównie testowaniem gotowych skryptów. Mamy nadzieję, że tęsknisz już za właściwym kodowaniem i nie możesz doczekać się na kolejną dawkę praktyki.</p>
<p>Popracujemy nad rozwojem naszej aplikacji festiwalowej. Poniżej przedstawimy Ci trzy propozycje nowych funkcjonalności do wykonania. Twoim zdaniem będzie wybranie przynajmniej jednej z nich i poprawne jej zaimplementowanie. Pamiętaj przy tym, aby korzystać również z testów. Pozwolą Ci one upewnić się, czy to, co wykonano, faktycznie działa.</p>
<p>Nie narzucamy żadnej metodologii co do momentu, w którym należy pisać testy. Możesz robić to już po stworzeniu funkcjonalności, ale również pójść w kierunku TDD. Decyzja należy do Ciebie.</p>
<h3 id="305-testy-w-praktyce-opcja-1-wiecej-koncertow">Opcja 1 – więcej koncertów</h3>
<p>Twórcy festiwalu są bardzo zadowoleni z działania strony, jednak już teraz myślą nad jej rozwojem. W tym roku zaproszono tylko trzy gwiazdy, ale w następnym ma być ich znacznie więcej. Klient twierdzi, że zamiast długich występów tylko trzech artystów, chciałby postawić na koncerty grupowe, gdzie każdy miałby na swój występ około 15 minut. Tym samym, ilość "pojedynczych" koncertów ma być według niego nie mniejsza niż 30, z tego też powodu, marzy mu się wyszukiwarka.</p>
<p>Co ważne, nie jest ona potrzebna już teraz. Na razie wystarczy przygotowanie pomocniczych endpointów na serwerze, aby w przyszłości, w razie potrzeby, implementacja wyszukiwarki mogła przebiec szybciej.</p>
<p>Po rozmowie z klientem udało się ustalić następujące endpointy:</p>
<ul>
<li><code>/concerts/performer/:performer</code> – do wyszukiwania koncertów danego artysty,</li>
<li><code>/concerts/genre/:genre</code> - do wyszukiwania koncertów z wybranego gatunku muzycznego,</li>
<li><code>/concerts/price/:price_min/:price_max</code> – do wyszukiwania koncertów o cenie z przedziału <code>:price_min</code> - <code>:price_max</code>,</li>
<li><code>/concerts/price/day/:day</code> – do wyszukiwania koncertów w wybranym dniu.</li>
</ul>
<p>Wszystkie endpointy powinny zwracać przefiltrowane dane w formie tablicy. Dodatkowo, do każdego z nich musisz napisać poprawne testy.</p>
<h3 id="305-testy-w-praktyce-opcja-2-ilosc-wolnych-miejsc">Opcja 2 – ilość wolnych miejsc</h3>
<p>Klient chciałby, aby na stronie głównej, przy każdym z koncertów, widniała informacja o liczbie wolnych miejsc.</p>
<p>Powinno to wyglądać mniej więcej tak:</p>
<a href="./Moduł_ 30. Testy jednostkowe w backendzie_files/Test13.png" class="img-modal-group"><img src="./Moduł_ 30. Testy jednostkowe w backendzie_files/Test13.png" alt="image" style="width: auto; max-width: 50%;"></a>
<p>Zadanie wymaga zmian zarówno po stronie frontendu, jak i backendu.</p>
<h4>Serwer</h4>
<p>Musisz zmodyfikować endpoint pokazujący koncerty, w taki sposób, aby oprócz podstawowych informacji, zwracany był również nowy atrybut – nazwijmy go <code>tickets</code>. Jego wartość powinna być równa liczbie wolnych miejsc na dany koncert.</p>
<p>Pamiętaj, aby napisać odpowiednie testy dla tego endpointu.</p>
<h5>Wskazówki</h5>
<ul>
<li>Przyjmijmy, że liczba miejsc na każdym koncercie to 50. Tym samym, aby wyliczyć liczbę wolnych, wystarczy sprawdzić, ile biletów na dany koncert już sprzedano (kolekcja <code>seats</code>), a następnie odjąć ją od 50. Przykładowo, jeśli wiemy, że zarezerwowano 5 miejsc na koncert nr 1, to po odjęciu tej wartości od 50, wyjdzie nam, że mamy jeszcze 45 wolnych.</li>
<li>Pamiętaj, że <code>find</code> w Mongoose zwraca tablicę. Tym samym przed jej przesłaniem do klienta, możemy ją dowolnie zmodyfikować, na przykład dodając do każdego z jej elementów nowy atrybut.</li>
<li>Nic nie stoi na przeszkodzie, żeby w jednym endpoincie korzystać z dwóch modeli. Pamiętaj o tym.</li>
</ul>
<h4>Klient</h4>
<p>Twoim zadaniem będzie takie zmodyfikowanie komponentu <code>concert</code>, aby wyświetlał nową informację. Ma to wyglądać identycznie jak na obrazku, a więc, jeśli na koncert jest jeszcze 20 wolnych miejsc, to ma się pojawić informacja <code>Only 20 tickets left</code>. Jeśli tych miejsc jest tylko 10, to <code>Only 10 tickets left</code> itd.</p>
<p>Do stylowania wykorzystaj poniższą regułę CSS:</p>
<pre class=" language-css"><code class=" language-css"><span class="token selector"><span class="token class">.concert__info__tickets</span></span> <span class="token punctuation">{</span>
  <span class="token property">opacity</span><span class="token punctuation">:</span> <span class="token number">0.8</span><span class="token punctuation">;</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token number">0.9</span><span class="token unit">rem</span><span class="token punctuation">;</span>
  <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
  <span class="token property">bottom</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token unit">rem</span><span class="token punctuation">;</span>
  <span class="token property">left</span><span class="token punctuation">:</span> <span class="token number">1.5</span><span class="token unit">rem</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<h3 id="305-testy-w-praktyce-opcja-3-popraw-podstrony-prices">Opcja 3 – popraw podstrony "Prices"</h3>
<p>W tej chwili treść podstrony "Prices" jest umieszczona na stałe w pliku <code>PricesPage.js</code>. Zleceniodawca chciałby, aby wszystkie informacje były przechowywane na serwerze, w bazie danych. Podstrona ta powinna je pobierać, a następnie wykorzystać do wyrenderowania właściwego tekstu. To dla klienta bardzo ważne, bowiem rozmawia już z nową firmą na temat wykonania panelu administracyjnego i chciałby przekazać odpowiednio przygotowaną stronę. Woli zlecić tę ostatnią poprawkę nam, bo wie, że lepiej orientujemy się w budowie serwera.</p>
<p>Zadanie wymaga zmian zarówno po stronie klienta, jak i serwera.</p>
<h4>Serwer</h4>
<p>Twoje zadanie będzie kilkuetapowe.</p>
<h5>Etap 1</h5>
<p>Zacznij od utworzenia nowej kolekcji <code>workshops</code>, która będzie przechowywać dane zapisane w tej chwili po stronie klienta.</p>
<p>Jej struktura powinna być następująca.</p>
<p><strong>Workshops</strong></p>
<ul>
<li><code>_id</code> – identyfikator,</li>
<li><code>name</code> – nazwa warsztatu,</li>
<li><code>concertId</code> – id koncertu, którego tyczy się ten warsztat.</li>
</ul>
<p>Jako <code>_id</code> koncertu należy podać ten koncert, który odbywa się w dniu tego warsztatu, czyli przykładowo dla każdego z warsztatów z dnia pierwszego należy przypisać koncert Johna Doe.</p>
<p><strong>Uwaga</strong> – nie zapomnij o napisaniu testów do nowego modelu.</p>
<h5>Etap 2</h5>
<p>Następnie wypełnij nową kolekcję danymi, zgodnie z tym, co aktualnie przedstawia strona "Prices".</p>
<h5>Etap 3</h5>
<p>Upewnij się co do poprawności danych w kolekcji <code>concerts</code>, tak aby <code>price</code> danego koncertu zgadzało się z ceną podaną na podstronie <code>PricesPage</code>. Czyli np. koncert Johna Doe powinien mieć przypisaną cenę 25$.</p>
<h5>Etap 4</h5>
<p>Zmodyfikuj endpoint <code>/concerts</code>, tak aby każdy obiekt był zwracany z jeszcze jednym atrybutem – <code>workshops</code>. Powinny być w nim zawarte te dokumenty z kolekcji <code>workshops</code>, których atrybut <code>concertId</code> zgadza się z id samego koncertu. Możesz przy tym ponownie zmodyfikować schemat modelu <code>Concert</code>. Warto zastanowić się też nad wykorzystaniem idei referencji (<code>ref</code>).</p>
<h4>Klient</h4>
<p>Musisz tak zmodyfikować podstronę <code>PricesPage.js</code>, żeby wciąż pokazywała dokładnie taką samą treść jak teraz, ale tym razem bazowała na informacjach, które można pobrać pod endpointem <code>/concerts</code>.</p>
<p>Pozostawiamy Ci tutaj dowolność wykonania. Staraj się jednak korzystać z takich samych pomysłów, jakie są już zastosowane, aby zachować ogólną spójność. Koniecznie sprawdź, jak wykonywane były wcześniejsze podstrony, w jaki sposób zbudowany jest reducer oraz jak komunikują się z nim komponenty. To powinno dać Ci ogólny pogląd na ich działanie.</p>

                        </div>
                    </div>
                                        <div class="card-block task-card">
                        <h3 id="305-testy-w-praktyce-zadanie-gotowe">Zadanie: <span class="task-title">gotowe!</span></h3>
                        <div class="task-content">
                            <p>Gotowe zadanie wyślij Mentorowi do sprawdzenia.</p>

                        </div>
                    </div>
                                        <div class="card-block submodule-footer clearfix  completed ">
                                                <div class="clearfix">
                                                                                <a href="https://kodilla.com/pl/bootcamp-task/407/668567" target="_blank" class="btn btn-info-outline">Podgląd zadania</a>
                            <form target="_blank" class="form-inline project-link-form">
                                <div class="form-group">
                                    <input type="text" name="link" class="form-control" value="https://github.com/skwiryt/testimonials">
                                </div>
                                <button type="submit" class="btn  btn-primary ">Wyślij link <i class="fa fa-check"></i></button>
                            </form>
                                                                                                    </div>
                    </div>
                </section>
                                    
                <section id="submodule-1173" class="card submodule completed" data-bootcamp-user-submodule-id="668568">
                <!-- klasy dla section: completed current comments -->
                    <div class="card-block submodule-header clearfix">
                        <i class="fa fa-check-circle-o fa-2x"></i>
                        <i class="fa fa-play-circle-o fa-2x"></i>
                        <i class="fa fa-exclamation-circle fa-2x"></i>
                        <i class="fa fa-send-o fa-2x"></i>
                        <h2 class="bootcamp-submodule-name">30.6. <span>Podsumowanie</span></h2>
                                            </div>
                    <div class="card-block">
                        <div class="submodule-content">
                            <p>Testy w backendzie okazały się niewiele trudniejsze od tych, które wykonywaliśmy już po stronie klienta. Mogliśmy też odczuć, że było ich mniej, a to dlatego, że w naszych aplikacjach zawsze to frontend pełnił bardziej istotną funkcję. Pamiętasz zapewne, jak dużo rzeczy musieliśmy sprawdzać w aplikacjach reactowych.</p>
<p>Jedyną wadą testów backendowych była potrzeba użycia innego task runnera. Niemniej jednak Mocha nie różni się zbytnio od Jesta, a wiemy też, że jeśli się uprzemy, istnieje możliwość użycia po stronie serwera również tego drugiego narzędzia.</p>
<p>Podsumowując temat, nie sposób przecenić roli testów. Są bardzo intuicyjne i proste w użyciu, a dają nam przy tym pewność co do poprawnego działania serwera. Warto więc pamiętać o nich w każdym większym projekcie i nie traktować jako zło konieczne, ale raczej bardzo ważnego sprzymierzeńca.</p>
<p>Na pewno jeszcze nie raz docenisz ich obecność.</p>

                        </div>
                    </div>
                                        <div class="card-block submodule-footer clearfix  completed ">
                                                <small>Jeśli masz wątpliwości do powyższego materiału, to - zanim zatwierdzisz - zapytaj na czacie :)</small>
                                                <div class="clearfix">
                                                                                <button class="btn  btn-primary "><i class="fa fa-check"></i><span>Zapoznałe(a)m się!</span></button>
                                                                                                    </div>
                    </div>
                </section>
                                    
                <section id="submodule-1174" class="card submodule completed" data-bootcamp-user-submodule-id="668569">
                <!-- klasy dla section: completed current comments -->
                    <div class="card-block submodule-header clearfix">
                        <i class="fa fa-check-circle-o fa-2x"></i>
                        <i class="fa fa-play-circle-o fa-2x"></i>
                        <i class="fa fa-exclamation-circle fa-2x"></i>
                        <i class="fa fa-send-o fa-2x"></i>
                        <h2 class="bootcamp-submodule-name">30.7. <span>Quiz powtórkowy</span></h2>
                                            </div>
                    <div class="card-block">
                        <div class="submodule-content">
                            <p>Na koniec przygotowaliśmy dla Ciebie quiz powtórkowy. Pomoże Ci on utrwalić wiedzę z poprzednich modułów.</p>
<p>Odpowiedzi nie są nigdzie zapisywane, więc pozostaną tylko do Twojej wiadomości. Ten quiz ma Ci posłużyć jako pomoc w nauce – dlatego pod każdym pytaniem znajdziesz guzik, który sprawdzi poprawność Twoich odpowiedzi oraz poda Ci wyjaśnienie poruszanego zagadnienia.</p>

        <div class="kodilla-quiz">
      
        <article class="question initiated" data-type="multiple-choice">
      
        <header>
          <p><em>1.</em> Jaka jest przewaga baz danych nad zwykłymi tablicami?</p>

        </header>
        <ol type="a" class="answers" data-correct="0,2,3,4">
          <li><label><input type="checkbox"> informacje przechowywane w bazie danych nie są ulotne</label></li>
<li><label><input type="checkbox"> bazy danych są utrzymywane wyłącznie na komputerze użytkownika</label></li>
<li><label><input type="checkbox"> możemy z góry narzucić jak powinny wyglądać dane w bazie</label></li>
<li><label><input type="checkbox"> bazy danych oferują relacyjność</label></li>
<li><label><input type="checkbox"> bazy przechowują informacje niezależnie od aplikacji</label></li>
        </ol>
        <div class="buttons text-center">
          <button class="button-ok btn btn-primary">Sprawdź odpowiedź</button>
        </div>
      
      
        <div class="explanation">
          <div class="bc-note alert-success">
            <h4 class="alert-heading text-center">Wyjaśnienie</h4>
      <p>W wielu przypadkach użycie bazy danych jest lepszym rozwiązaniem niż zastosowanie zwykłej tablicy. Jak już wiesz z poprzedniego modułu – informacje w bazie danych utrzymywane są na zewnętrznych serwerach, zatem nie są zależne od naszej aplikacji, a co za tym idzie – nie znikają, gdy wyłączymy komputer.</p>
<p>Jedną z głównych zalet baz jest możliwość narzucenia z góry, jakie dane będą przyjmowane, oraz zastosowanie relacyjności, czyli powiązań między poszczególnymi kolekcjami.</p>

          </div>
        </div>
      
        </article>
      
        <article class="question initiated" data-type="multiple-choice">
      
        <header>
          <p><em>2.</em> Co oznacza skrót CRUD?</p>

        </header>
        <ol type="a" class="answers" data-correct="2">
          <li><label><input type="radio" name="question-oOr_Y2NBn"> Create, Raport, Update, Delete</label></li>
<li><label><input type="radio" name="question-oOr_Y2NBn"> Copy, Read, Update, Delete</label></li>
<li><label><input type="radio" name="question-oOr_Y2NBn"> Create, Read, Update, Delete</label></li>
        </ol>
        <div class="buttons text-center">
          <button class="button-ok btn btn-primary">Sprawdź odpowiedź</button>
        </div>
      
      
        <div class="explanation">
          <div class="bc-note alert-success">
            <h4 class="alert-heading text-center">Wyjaśnienie</h4>
      <p>CRUD to oczywiście "Create, Read, Update, Delete". Jest to zestaw poleceń do modyfikacji danych w bazach – ich tworzenia, odczytywania, aktualizacji i usuwania. Każdy silnik baz danych oferuje je w mniej lub bardziej zaawansowanej formie.</p>

          </div>
        </div>
      
        </article>
      
        <article class="question initiated" data-type="multiple-choice">
      
        <header>
          <p><em>3.</em> Załóżmy, że w bazie danych MongoDB, w przykładowej kolekcji <code>persons</code>, szukamy osób w odpowiednim wieku za pomocą komendy:
<code>db.persons.find({ age: { $and: [{ $gt: 18 }, { $lt: 40 }] } });</code>.</p>

        </header>
        <ol type="a" class="answers" data-correct="1,2">
          <li><label><input type="checkbox"> zostanie nam zwrócona lista osób w wieku mniejszym niż 18 i większym niż 40 lat</label></li>
<li><label><input type="checkbox"> użyty tu warunek jest odpowiednikiem <code>if(age &gt; 18 &amp;&amp; age &lt; 40)</code> w zwykłej pętli <code>if</code></label></li>
<li><label><input type="checkbox"> dostaniemy listę osób w wieku od 19 do 39 lat</label></li>

        </ol>
        <div class="buttons text-center">
          <button class="button-ok btn btn-primary">Sprawdź odpowiedź</button>
        </div>
      
      
        <div class="explanation">
          <div class="bc-note alert-success">
            <h4 class="alert-heading text-center">Wyjaśnienie</h4>
      <p>MongoDB daje nam szeroki wachlarz operatorów, których możemy użyć do przeszukiwania baz danych. Jednymi z bardziej przydatnych są&nbsp;operatory koniunkcji <code>$and</code> i alternatywy <code>$or</code>, które są odpowiednikami znanych z JS-a <code>&amp;&amp;</code> i <code>||</code>. Dodatkowo użyte tu <code>$gt</code> to "więcej niż", a <code>$lt</code> – "mniej niż". Zatem nasza komenda wyszuka osoby w wieku większym niż 18 i mniejszym niż 40, a za pomocą zwykłej pętli możemy to zapisać jako <code>if(age &gt; 18 &amp;&amp; age &lt; 40)</code>.</p>

          </div>
        </div>
      
        </article>
      
        <article class="question initiated" data-type="multiple-choice">
      
        <header>
          <p><em>4.</em> W Mongoose:</p>

        </header>
        <ol type="a" class="answers" data-correct="0">
          <li><label><input type="checkbox"> każda kolekcja musi posiadać własny model z opisanym schematem struktury danych</label></li>
<li><label><input type="checkbox"> użycie modeli danych nie jest wymagane</label></li>
<li><label><input type="checkbox"> wprowadzane dane nie są&nbsp;walidowane w żaden sposób</label></li>

        </ol>
        <div class="buttons text-center">
          <button class="button-ok btn btn-primary">Sprawdź odpowiedź</button>
        </div>
      
      
        <div class="explanation">
          <div class="bc-note alert-success">
            <h4 class="alert-heading text-center">Wyjaśnienie</h4>
      <p>Choć MongoDB domyślnie nie blokuje nas żadnymi ograniczeniami podczas dodawania danych, sytuacja wygląda inaczej w Mongoose. Tutaj każda kolekcja musi mieć własny model ze schematem struktury danych. Pozwala to na utrzymanie ich spójności.</p>
<p>Mongoose sprawdza dane wprowadzane do bazy pod kątem ilości i nazw atrybutów, ale walidowane są też same wartości – czy ich typ jest zgodny z tym, co założyliśmy.</p>

          </div>
        </div>
      
        </article>
      
        <article class="question initiated" data-type="multiple-choice">
      
        <header>
          <p><em>5.</em> Pomówmy o relacyjności danych w bazach, czyli o ich wzajemnych powiązaniach i zależnościach. Wiemy, że:</p>

        </header>
        <ol type="a" class="answers" data-correct="1">
          <li><label><input type="checkbox"> nie ma żadnych przeciwwskazań, by dane w kolekcjach się powielały</label></li>
<li><label><input type="checkbox"> przy użyciu Mongoose możemy powiązać ze sobą dane z różnych kolekcji za pomocą&nbsp;referencji</label></li>
<li><label><input type="checkbox"> niestety w Mongoose nie ma możliwości łatwego pobrania danych z jednej kolekcji, tak by zawierała dane z drugiej</label></li>

        </ol>
        <div class="buttons text-center">
          <button class="button-ok btn btn-primary">Sprawdź odpowiedź</button>
        </div>
      
      
        <div class="explanation">
          <div class="bc-note alert-success">
            <h4 class="alert-heading text-center">Wyjaśnienie</h4>
      <p>Dane w bazach nie powinny się dublować, ponieważ znacznie utrudnia to ich utrzymanie i aktualizację. Konieczność zmiany tych samych informacji w kilku miejscach jest nieefektywna i może prowadzić do wielu pomyłek.</p>
<p>Tworzenie relacji między danymi za pomocą referencji to najprostszy sposób na ich powiązanie (np. dane na temat tytułów książek mają odwołanie do informacji o autorze zgromadzonych w innej kolekcji). Referencją może być nazwa lub choćby unikalny id, do którego się odwołujemy.</p>
<p>Mongoose posiada wbudowaną metodę <code>populate</code>, która służy właśnie do łatwego pobierania danych z jednej kolekcji, od razu z informacjami, do których odnoszą się referencje.</p>

          </div>
        </div>
      
        </article>
      
        </div>
        
<style>
  .kodilla-quiz .question {
    margin-bottom: 1.5em;
  }
  .kodilla-quiz .explanation {
    display: none;
  }
  .kodilla-quiz li>label {
    display: inline-block;
    padding-top: 1px;
    vertical-align: top;
  }
</style>
<script>
  if(typeof initQuizzes == 'undefined'){
    function initQuizzes(){
      var types = {
        'multiple-choice': initMultipleChoice,
      };

      var questions = document.querySelectorAll('.kodilla-quiz .question');

      for(var i=0; i<questions.length; i++){
        var question = questions[i];
        var initFunc = types[question.dataset.type];

        if(typeof(initFunc) != 'undefined' && !question.classList.contains('initiated')){
          question.classList.add('initiated');
          initFunc(question);
        }
      }
    }

    function initMultipleChoice(question){
      var answers = question.querySelector('.answers');
      var inputs = answers.querySelectorAll('input');
      var buttons = question.querySelector('.buttons');
      var buttonOK = buttons.querySelector('.button-ok');
      var explanation = question.querySelector('.explanation');
      var correct = question.querySelector('[data-correct]').dataset.correct.split(',');

      buttonOK.addEventListener('click', function(e){
        e.preventDefault();

        var inputsChecked = answers.querySelectorAll('input:checked');
        if(inputsChecked.length == 0){
          alert('Wybierz co najmniej jedna odpowiedź');
          return;
        }

        correct.forEach(function(index){
          inputs[index].parentNode.parentNode.classList.add('text-success', 'text-bold');
        });

        for (var i = 0; i < inputs.length; i++) {
          var input = inputs[i];
          var li = input.parentNode.parentNode;
          input.setAttribute('disabled', true);
          
          if(input.checked){
            li.classList.add('text-bold');
            
            if(!li.classList.contains('text-success')){
              li.classList.add('text-danger');
            }
          }

        }
        
        if(explanation) explanation.style.display = 'block';
        buttons.setAttribute('hidden', true);
      });
    }
  }
  initQuizzes();
</script>

      
                        </div>
                    </div>
                                        <div class="card-block submodule-footer clearfix  completed ">
                                                <small>Jeśli masz wątpliwości do powyższego materiału, to - zanim zatwierdzisz - zapytaj na czacie :)</small>
                                                <div class="clearfix">
                                                                                <button class="btn  btn-primary "><i class="fa fa-check"></i><span>Zapoznałe(a)m się!</span></button>
                                                                                                    </div>
                    </div>
                </section>
                            </main>
        </div>
    </section>
</main>
;
<script async="" src="./Moduł_ 30. Testy jednostkowe w backendzie_files/ei.js"></script>
<script type="text/x-translation" data-translation-name="SentBootcampLinkReviewFormMessage">Wysłano link do zatwierdzenia</script>
    <div id="alerts">
    <div class="alert alert-danger" role="alert" style="display: none;">
        <i class="fa fa-exclamation" aria-hidden="true"></i>
        <button type="button" class="close" data-hide="alert" aria-label="Zamknij">
            <span aria-hidden="true">×</span>
            <span class="sr-only">Zamknij</span>
        </button>
        <ul>
                        </ul>
    </div>
    <div class="alert alert-success" role="alert" style="display: none;">
        <i class="fa fa-check" aria-hidden="true"></i>
        <button type="button" class="close" data-hide="alert" aria-label="Zamknij">
            <span aria-hidden="true">×</span>
            <span class="sr-only">Zamknij</span>
        </button>
        <ul>
                </ul>
    </div>
    <div class="alert alert-warning" role="alert" style="display: none;">
        <i class="fa fa-warning" aria-hidden="true"></i>
        <button type="button" class="close" data-hide="alert" aria-label="Zamknij">
            <span aria-hidden="true">×</span>
            <span class="sr-only">Zamknij</span>
        </button>
        <ul>
                </ul>
    </div>
    <div class="alert alert-info" role="alert" style="display: none;">
        <i class="fa fa-info" aria-hidden="true"></i>
        <button type="button" class="close" data-hide="alert" aria-label="Zamknij">
            <span aria-hidden="true">×</span>
            <span class="sr-only">Zamknij</span>
        </button>
        <ul>
                    </ul>
    </div>
    <div class="container">
        <div class="alert alert-notify" role="alert" style="display: none;">
            <i class="fa fa-info" aria-hidden="true"></i>
            <button type="button" class="close" data-hide="alert" aria-label="Zamknij">
                <span aria-hidden="true">×</span>
                <span class="sr-only">Zamknij</span>
            </button>
            <ul>
                            </ul>
        </div>
    </div>
</div>
    <div class="modal fade informator-modal" id="informator" tabindex="-1" role="dialog" aria-labelledby="informatorModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <img src="./Moduł_ 30. Testy jednostkowe w backendzie_files/logo-menu.png" alt="Logo Kodilla" class="brand-logo">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <i class="fa fa-times" aria-hidden="true"></i>
                </button>
            </div>
            <div class="modal-body content-container">
                <h3>Zamów szczegółowy informator</h3>
                <form class="row js-ajax-form" data-view-class="InformatorForm" action="https://kodilla.com/pl/download-informator" method="post">
                    <input type="hidden" name="ga-pobieranie-informatora-z-modala" value="wypelnienie">
                    <input type="hidden" name="tags[0]" value="informator">
                                        <div class="user-data-container">
                        <input type="text" class="form-control" name="firstname" placeholder="Imię">
                        <input type="text" class="form-control" name="surname" placeholder="Nazwisko">
                    </div>
                    <div class="user-data-container">
                        <input type="email" class="form-control" name="email" placeholder="Email" required="">
                        <input type="tel" class="form-control" name="phone" placeholder="Numer telefonu" pattern="^([\+][0-9]{1,3}([ \.\-])?)?([\(]{1}[0-9]{3}[\)])?([0-9 \.\-]{1,15})$" title="Wpisz poprawny numer telefonu, np. 453 674 897" minlength="9" maxlength="15" data-custom-message="Wpisz poprawny numer telefonu, np. 453 674 897">
                    </div>
                    <div class="terms-box">
                        <label>
                            <input name="accept_terms" value="true" data-custom-message="Prosimy o zaakceptowanie regulaminu" type="checkbox" class="form-control input-checkbox" required="">
                            <span>Akceptuję <a target="_blank" href="https://kodilla.com/pl/regulamin">regulamin</a>  i nie wnoszę zastrzeżeń</span>
                        </label>
                    </div>
                    <div class="personal-terms-box">
                        <label>
                            <input name="accept_marketing" value="true" data-custom-message="Jeśli chcesz otrzymać dostęp do materiałów, konieczna jest akceptacja obydwu zgód" type="checkbox" class="form-control input-checkbox" required="">
                            <span>Chcę otrzymywać newsletter, informacje o promocjach i produktach dostępnych w Kodilla.
                                <span class="details-button" data-action="show-details" data-identifier="personal-terms-details-informator">Czytaj więcej</span>
                                <span class="display-none" data-identifier="personal-terms-details-informator">Wyrażam zgodę na otrzymywanie informacji handlowych od Kodilla na podany przeze mnie adres e-mail. Zgoda jest dobrowolna, jednakże niezbędna do otrzymywania informacji o produktach, promocjach i o tym, co u nas słychać. Administratorem danych jest Codemy S.A. z siedzibą we Wrocławiu, Plac Powstańców Śląskich 13/4. Mam prawo cofnąć zgodę w każdym czasie, jednak wtedy nie będę otrzymywać informacji. Dane mogą być przetwarzane pomimo cofnięcia zgody wyłącznie w takim zakresie i celu, w jakim ich przetwarzanie jest niezbędne do ustalenia, dochodzenia lub obrony roszczeń Administratora w związku z udzieloną zgodą. Mam prawo dostępu do danych, sprostowania, usunięcia, ograniczenia przetwarzania, prawo wniesienia sprzeciwu, skargi do organu nadzorczego i przeniesienia danych. Szczegółowe informacje znajdują się na stronie kodilla.com, zakładka "Polityka Prywatności".</span>
                            </span>
                        </label>
                    </div>
                    <div class="display-none">
                        <input type="text" name="myName" value="">
                    </div>
                    <div class="">
                        <button type="submit" class="btn btn-primary">
                            Pobierz Informator
                            <i data-role="loading-icon" class="fa fa-spinner fa-spin fa-1x fa-fw display-none"></i>
                        </button>
                    </div>
                </form>
                <a href="https://kodilla.com/pl/informator" id="informator-link" target="_blank" class="display-none"></a>
            </div>
            <div class="modal-footer">
                <p>Pobranie informatora do niczego nie zobowiązuje</p>
            </div>
        </div>
    </div>
</div>
<footer class="site-footer">
                <section class="footer-lower">
            <nav class="container">
                <a class="navbar-img" href="https://kodilla.com/pl">
                    <svg id="kodilla-logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 168 29.553" width="168" height="30">
                        <defs>
                            <style>
                                .footer-logo-fill {
                                    fill: #fff;
                                }
                            </style>
                        </defs>
                        <g id="Group_1" data-name="Group 1" transform="translate(23.59)">
                            <path id="KODILLA_copy_5_1_" class="footer-logo-fill" d="M78.058,0a14.758,14.758,0,1,0,.075,0Zm0,23.739a8.939,8.939,0,0,1-8.944-8.907V14.8c0-4.957,4.584-.708,8.907-.708,4.919,0,9.019-4.211,9.019.708a8.978,8.978,0,0,1-8.981,8.944Z" transform="translate(-63.3)"></path>
                            <ellipse id="eye_copy_4_1_" class="footer-logo-fill" cx="3.876" cy="3.876" rx="3.876" ry="3.876" transform="translate(9.462 13.2) rotate(-28.436)"></ellipse>
                        </g>
                        <path id="Path_1" data-name="Path 1" class="footer-logo-fill" d="M0,29.819V.9H6.671V13.347L17.255.9h7.491L13.938,13.794,25.491,29.819h-7.6l-8.2-11.665-3.019,3.13v8.5H0Z" transform="translate(0 -0.565)"></path>
                        <path id="Path_2" data-name="Path 2" class="footer-logo-fill" d="M151.4,29.819V.9h10.807a15.515,15.515,0,0,1,6.261,1.155,12.966,12.966,0,0,1,4.509,3.093A12.918,12.918,0,0,1,175.7,9.732a17.245,17.245,0,0,1,.932,5.59,16.821,16.821,0,0,1-1.006,5.963,12.227,12.227,0,0,1-2.907,4.547,13.484,13.484,0,0,1-4.547,2.944,15.964,15.964,0,0,1-5.925,1.043Zm18.41-14.5a11.274,11.274,0,0,0-.522-3.466,7.723,7.723,0,0,0-1.491-2.72,6.616,6.616,0,0,0-2.385-1.752,8.055,8.055,0,0,0-3.205-.6h-4.1v17.18h4.1a7.985,7.985,0,0,0,3.242-.634,6.8,6.8,0,0,0,2.385-1.826,8.286,8.286,0,0,0,1.453-2.72A11.634,11.634,0,0,0,169.81,15.322Z" transform="translate(-94.978 -0.565)"></path>
                        <path id="Path_3" data-name="Path 3" class="footer-logo-fill" d="M228.3,29.819V.9h6.671V29.819Z" transform="translate(-143.219 -0.565)"></path>
                        <path id="Path_4" data-name="Path 4" class="footer-logo-fill" d="M259.9,29.819V.9h6.671V23.968h14.012v5.851Z" transform="translate(-163.043 -0.565)"></path>
                        <path id="Path_5" data-name="Path 5" class="footer-logo-fill" d="M327.371,23.931V.9H320.7V29.819h18.522l2.124-5.851H327.371Z" transform="translate(-201.185 -0.565)"></path>
                        <path id="Path_6" data-name="Path 6" class="footer-logo-fill" d="M388.547.9h6.037L405.13,29.819h-6.857l-2.236-6.484h-9.019l-2.2,6.484H378Zm6.373,17.851L391.528,8.54l-3.466,10.211Z" transform="translate(-237.13 -0.565)"></path>
                    </svg>
                </a>
                <ul class="nav">
                    <li>
                        <a href="https://kodilla.com/pl/regulamin" rel="nofollow">Regulamin</a>
                    </li>
                    <li>
                        <a href="https://kodilla.com/pl/polityka-prywatnosci" rel="nofollow">Polityka prywatności</a>
                    </li>
                    <li class="nav-item nav-item-last">© 2021 Kodilla</li>
                </ul>
            </nav>
        </section>
    </footer>

<!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KN2WWBH" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->

    <script src="./Moduł_ 30. Testy jednostkowe w backendzie_files/jquery-2.1.4.min.js"></script>
<script src="./Moduł_ 30. Testy jednostkowe w backendzie_files/js.cookie-2.1.0.min.js"></script>
<script src="./Moduł_ 30. Testy jednostkowe w backendzie_files/jquery-dateFormat.min.js"></script>
<script src="./Moduł_ 30. Testy jednostkowe w backendzie_files/bootstrap.min.js"></script>
<script>
    (function () {
        $(document).ready(function () {
            if (window.location.hash === '#informator-modal') {
                showInformator();
            }
        });

        $('[data-action="show-modal"]').click(function() {
            showInformator();
        });

        function showInformator() {
            $('#informator').modal('show');
        }
    })();
</script>
<script src="./Moduł_ 30. Testy jednostkowe w backendzie_files/fb-412414a519.js" async=""></script>
<script src="./Moduł_ 30. Testy jednostkowe w backendzie_files/call-us-261b222cf4.js"></script>
<script>
    if (document.querySelector('main.editor')) {
        document.querySelector('body').classList.add('editor');
    }
</script>

<script type="text/javascript" async="">
  setTimeout(function (){
      (function(e,t,o,n,p,r,i){e.visitorGlobalObjectAlias=n;e[e.visitorGlobalObjectAlias]=e[e.visitorGlobalObjectAlias]||function(){(e[e.visitorGlobalObjectAlias].q=e[e.visitorGlobalObjectAlias].q||[]).push(arguments)};e[e.visitorGlobalObjectAlias].l=(new Date).getTime();r=t.createElement("script");r.src=o;r.async=true;i=t.getElementsByTagName("script")[0];i.parentNode.insertBefore(r,i)})(window,document,"https://diffuser-cdn.app-us1.com/diffuser/diffuser.js","vgo");
      vgo('setAccount', '649095895');
      vgo('setTrackByDefault', true);

      vgo('process');
  }, 3000);

</script>

<script>
    document.addEventListener("DOMContentLoaded", yall);
    window.environment = 'production';
    window.loggedIn = true;
    window.domain = 'https://kodilla.com';
            window.fbAppId = 1449248938627896;
    window.chatService = 'LiveAgent';
    window.useMessenger = window.chatService === 'Messenger';
    window.locale = 'pl';
    window.lang = 'pl';

    window.serverUTC       = 1627846121000;
    window.serverOffset    = 120;
    window.userDate        = new Date();
    window.userUTC         = userDate.getTime();
    window.userOffset      = userDate.getTimezoneOffset() * (-1);
    window.userClockDiff   = userUTC - serverUTC;
    window.diffRounded     = Math.round( userClockDiff / ( 1000 * 60 * 15 ) );
    window.isDifferentZone = ( userOffset - serverOffset !== 0 ) ? 1 : 0;
    window.hasWrongTime    = ( diffRounded !== 0 ) ? 1 : 0;
    window.dateTooltipText = 'Data i godzina są podane dla Twojej strefy czasowej GMT. <br>W razie wątpliwości napisz: <u>support@kodilla.com</u>.';
    window.wrongHourNotice = 'Godzina na Twoim urządzeniu r&oacute;żni się od godziny obowiązującej w strefie czasowej wybranej w ustawieniach Twojego urządzenia.';

    window.PAYU_HASH_ALGORITHM = 'SHA-256';
    window.PAYU_POS_ID = 1429452;
    window.PAYU_MD5_SECOND_KEY = 'f3627be5fab5a4238c8474936f057908';

    var moment = undefined,
        momentReady = function( method, method2, count ){
            var c = ( count ) ? count : 0;

            if      ( isDifferentZone && moment !== undefined ){
                if      ( method ) { method(); }
                else    { return false; }
            }
            else if ( isDifferentZone && moment === undefined ) {
                if ( c < 20 ) {
                    c++;
                    setTimeout( function() { momentReady( method, method2, c ); }
                        , 300 );
                } else {
                    if      ( method2 === true && method )  { method(); }
                    else if ( method2 !== true && method2 ) { method2(); }
                }
            }
            else {
                if      ( method2 === true && method )  { method(); }
                else if ( method2 !== true && method2 ) { method2(); }
                else    { return false; }
            }
        };

    if ( window.isDifferentZone && moment === undefined ) {
        var script = document.createElement("script");
        script.type = "text/javascript";
        script.src = '/static/js/libs/moment.timezone.locales.min.js?v=2.22.2';
        document.getElementsByTagName("head")[0].appendChild(script);
    }
</script>
<script src="./Moduł_ 30. Testy jednostkowe w backendzie_files/OneSignalSDK.js" async=""></script>
<script>
    var OneSignal = window.OneSignal || [];
    OneSignal.push(function() {
        OneSignal.init({
            appId: "92552bb5-b477-4ea2-8260-dba65be198d9",
        });
    });
</script>
<script data-ad-client="ca-pub-9483216428129091" async="" src="./Moduł_ 30. Testy jednostkowe w backendzie_files/f.txt"></script>
<script>
    (function(h,o,t,j,a,r){
        h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
        h._hjSettings={hjid:2404285,hjsv:6};
        a=o.getElementsByTagName('head')[0];
        r=o.createElement('script');r.async=1;
        r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
        a.appendChild(r);
    })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
</script>
        <script src="./Moduł_ 30. Testy jednostkowe w backendzie_files/underscore-min.js"></script>
<script src="./Moduł_ 30. Testy jednostkowe w backendzie_files/backbone-min.js"></script>
<script src="./Moduł_ 30. Testy jednostkowe w backendzie_files/backbone-relational.min.js"></script>
<script src="./Moduł_ 30. Testy jednostkowe w backendzie_files/backbone-super.min.js"></script>
<script src="./Moduł_ 30. Testy jednostkowe w backendzie_files/handlebars-v4.0.5.min.js"></script>
<script src="./Moduł_ 30. Testy jednostkowe w backendzie_files/handlebars-ifCond-139a2339f7.js"></script>
<script src="./Moduł_ 30. Testy jednostkowe w backendzie_files/application-0dcfdc1306.js"></script>
<script src="./Moduł_ 30. Testy jednostkowe w backendzie_files/main-cf3b73d734.js"></script>
<script src="./Moduł_ 30. Testy jednostkowe w backendzie_files/settings-5fc44a761b.js"></script>
<script src="./Moduł_ 30. Testy jednostkowe w backendzie_files/delete-account-da2b3de486.js"></script>
<script type="text/x-translation" data-translation-name="checkAccountDeleteCalculationMessage">Wynik jest nieprawidłowy</script>
<script src="./Moduł_ 30. Testy jednostkowe w backendzie_files/forms-222ea01b08.js"></script>
<script src="./Moduł_ 30. Testy jednostkowe w backendzie_files/alerts-66650c3acb.js"></script>
<script>
    App.Views.InpageAlertManager = Backbone.View.extend({
        events: {
            'click [data-alert-type][data-alert-text]': 'showAlert'
        },
        showAlert: function(e) {
            var $el = $(e.currentTarget);
            App.alertsView['show'+$el.data('alertType')]([App.Translations($el.data('alertText'))]);
        }
    });
</script>
<script src="./Moduł_ 30. Testy jednostkowe w backendzie_files/collections-c07e1162e2.js"></script>
<script src="./Moduł_ 30. Testy jednostkowe w backendzie_files/models-4e0e4fcffb.js"></script>
<script src="./Moduł_ 30. Testy jednostkowe w backendzie_files/knowledge-base-61f71273c9.js"></script>
<script>
    App.Views.LearningProgram = Backbone.View.extend({
        events: {
            'click [data-technology-desc-expander]' : 'expandTechnologyDesc'
        },

        initialize: function() {
            this.$allTechnologyDesc = this.$el.find('[data-technology-desc]');
            this.$allTechnologyExpanderIcons = this.$el.find('[data-technology-expander-icon]');
        },

        expandTechnologyDesc: function() {
            this.$allTechnologyDesc.each(function(){
                var $desc = $(this);
                $desc.slideToggle('fast');
            });
            this.$allTechnologyExpanderIcons.each(function(){
                var $icon = $(this);
                $icon.toggleClass("fa-minus");
            });
        },
    });
</script>

    <script src="./Moduł_ 30. Testy jednostkowe w backendzie_files/tether.min.js"></script>
    <script src="./Moduł_ 30. Testy jednostkowe w backendzie_files/prism.min.js"></script>

    <script src="./Moduł_ 30. Testy jednostkowe w backendzie_files/bootcamp-1522c7c010.js"></script>
    <script src="./Moduł_ 30. Testy jednostkowe w backendzie_files/jquery.seourl.min.js"></script>
    <script src="./Moduł_ 30. Testy jednostkowe w backendzie_files/perfect-scrollbar.jquery.min.js"></script>
    <script src="./Moduł_ 30. Testy jednostkowe w backendzie_files/jquery.fancybox.min.js"></script>
    <script src="./Moduł_ 30. Testy jednostkowe w backendzie_files/moment.timezone.locales.min.js"></script>
    <script src="./Moduł_ 30. Testy jednostkowe w backendzie_files/bootstrap-datetimepicker.min.js"></script>
    <script type="text/javascript">
        $(document).ready(function() {
            $("a.img-modal-group").fancybox();
        });
    </script>

<div class="modal fade" tabindex="-1" role="dialog" id="call-us-modal">
    <div class="modal-dialog modal-dialog-callus" role="document">
        <div class="modal-content call-modal">
            <div id="call-us-step1">
                <h2>Umów się na rozmowę z doradcą Kodilli</h2>
                <p>Krok <span>1/2:</span> Podaj numer telefonu</p>
                <form action="https://kodilla.com/pl/call-center/dates/phone_calls" method="post" id="call-us-form1">
                    <input type="tel" name="phone" id="call-us-input-phone" class="call-center-input" placeholder="731771787">
                    <p class="error-message display-none" id="validation-message-phone">Pole Numer Telefonu jest wymagane. Nieprawidłowy format.</p>
                    <button class="btn btn-success" id="call-us-submit-phone">Zarezerwuj rozmowę</button>
                </form>
                <p id="call-us-counter-holder" style="display: none;">Dzisiaj już  <span id="call-us-counter" class="call-counter" data-url="https://kodilla.com/pl/call-center/counter/phone_calls">-</span> <span id="call-us-counter-text" data-one=" osoba zamówiła rozmowę z nami." data-few=" osoby zamówiły rozmowę z nami." data-more=" osób zamówiło rozmowę z nami."></span></p>
                <div class="data-protection">
                    <p>Twój numer telefonu nie będzie wykorzystywany w celach marketingowych ani przekazany dalej. Tylko oddzwonimy. Dane są przetwarzane zgodnie z <a href="https://kodilla.com/pl/polityka-prywatnosci">Polityką Prywatności</a>.</p>
                </div>
            </div>

            <div id="call-us-step2" style="display: none;">
                <h2>Wybierz dogodny termin i godzinę na rozmowę z doradcą</h2>
                <p>Krok <span>2/2:</span>
                </p><form action="https://kodilla.com/pl/call-center/step2/phone_calls" method="post" id="call-us-form2">
                    <div class="select-date">
                        <select name="date" id="call-us-input-date">
                        </select>
                        <select name="time" id="call-us-input-time">
                        </select>
                    </div>
                    <button class="btn btn-success" id="call-us-submit-call">Oddzwońcie do mnie!</button>
                </form>
            </div>

            <div id="call-us-step3" style="display: none;">
                <div class="thanks">
                    <i class="fa fa-check-circle" aria-hidden="true"></i>
                    <h2>Dziękujemy za zamowienie rozmowy! Do usłyszenia w wybranym terminie!</h2>
                </div>
            </div>
        </div>
    </div>
</div>



                <style type="text/css">
    .embeddedServiceHelpButton .helpButton .uiButton {
        background-color: #1EA71C;
        font-family: "Arial", sans-serif;
    }
    .embeddedServiceHelpButton .helpButton .uiButton:focus {
        outline: 1px solid #1EA71C;
    }
</style>
<script>
    function openChat(){
        $('.helpButtonEnabled').trigger('click');
    }
</script>
<script type="text/javascript" src="./Moduł_ 30. Testy jednostkowe w backendzie_files/esw.min.js"></script>

<script type="text/javascript">
    var initESW = function(gslbBaseURL) {
        let firstName = 'Marek Baberowski'.split(" ")[0];
        let lastName = 'Marek Baberowski'.split(" ")[1];
        console.log(name);
        embedded_svc.settings.displayHelpButton = true;
        embedded_svc.settings.language = '';

        embedded_svc.settings.defaultMinimizedText =  'Skontaktuj się z nami';
        embedded_svc.settings.disabledMinimizedText = ' ';

        embedded_svc.settings.loadingText = 'Ładowanie';
        embedded_svc.settings.storageDomain = 'kodilla.com';

        embedded_svc.settings.prepopulatedPrechatFields = {
            'FirstName': firstName,
            'LastName': lastName,
            'Email': 'm.z.baberowski@gmail.com'
        };
        embedded_svc.settings.offlineSupportMinimizedText = 'Napisz do nas';

        embedded_svc.settings.enabledFeatures = ['LiveAgent'];
        embedded_svc.settings.entryFeature = 'LiveAgent';

        embedded_svc.init(
            'https://kodilla.my.salesforce.com',
            'https://kodillacommunity.force.com',
            gslbBaseURL,
            '00D1i000000VBFH',
            'Support_Kodilla',
            {
                baseLiveAgentContentURL: 'https://c.la1-c2-fra.salesforceliveagent.com/content',
                deploymentId: '5721i00000009s9',
                buttonId: '5731i0000000AJN',
                baseLiveAgentURL: 'https://d.la1-c2-fra.salesforceliveagent.com/chat',
                eswLiveAgentDevName: 'Support_Kodilla',
                isOfflineSupportEnabled: true
            }
        );
    };

    if (!window.embedded_svc) {
        var s = document.createElement('script');
        s.setAttribute('src', 'https://kodilla.my.salesforce.com/embeddedservice/5.0/esw.min.js');
        s.onload = function() {
            initESW(null);
        };
        document.body.appendChild(s);
    } else {
        initESW('https://service.force.com');
    }
</script><script id="common-script" type="text/javascript" src="./Moduł_ 30. Testy jednostkowe w backendzie_files/common.min.js"></script>
        <div data-role="notifications-wrapper" class="notifications-wrapper"></div>
<!-- Facebook Pixel Code -->
    <script>
        setTimeout(function(){
            !function(f,b,e,v,n,t,s)
            {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
                n.callMethod.apply(n,arguments):n.queue.push(arguments)};
                if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
                n.queue=[];t=b.createElement(e);t.async=!0;
                t.src=v;s=b.getElementsByTagName(e)[0];
                s.parentNode.insertBefore(t,s)}(window, document,'script',
                'https://connect.facebook.net/en_US/fbevents.js');
            fbq('init', 389137334769464 );
            fbq('track', 'PageView');
        }, 3000);
    </script>
    <!-- End Facebook Pixel Code -->

    <!-- Google Tag Manager -->
    <script>
        setTimeout(function () {
            (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
            })(window,document,'script','dataLayer','GTM-KN2WWBH');
        }, 3000);

    </script>
    <!-- End Google Tag Manager -->

    
    

<script id="liveagent-esw-script" type="text/javascript" src="./Moduł_ 30. Testy jednostkowe w backendzie_files/liveagent.esw.min.js"></script><iframe name="_hjRemoteVarsFrame" title="_hjRemoteVarsFrame" id="_hjRemoteVarsFrame" src="./Moduł_ 30. Testy jednostkowe w backendzie_files/box-25a418976ea02a6f393fbbe77cec94bb.html" style="display: none !important; width: 1px !important; height: 1px !important; opacity: 0 !important; pointer-events: none !important;"></iframe><form id="fileUploadForm" enctype="multipart/form-data" method="post" target="fileUploadIframe"><input type="file" id="fileSelector" name="file" style="display: none;"><input name="filename" type="hidden"></form><iframe id="fileUploadIframe" name="fileUploadIframe" title="FileUploadFrame" style="display: none;" src="./Moduł_ 30. Testy jednostkowe w backendzie_files/saved_resource.html"></iframe><iframe id="esw_storage_iframe" src="./Moduł_ 30. Testy jednostkowe w backendzie_files/esw.html" title="Live Chat Metadata" style="display: none;"></iframe><script type="text/javascript" src="./Moduł_ 30. Testy jednostkowe w backendzie_files/EmbeddedServiceConfig.jsonp"></script><script id="invite-esw-script" type="text/javascript" src="./Moduł_ 30. Testy jednostkowe w backendzie_files/invite.esw.min.js"></script><div class="embeddedServiceHelpButton"><div class="helpButton"><button class="helpButtonEnabled uiButton" href="javascript:void(0)"><span class="embeddedServiceIcon" aria-hidden="true" data-icon="" style="display: inline-block;"></span><span class="helpButtonLabel" id="helpButtonSpan" aria-live="polite" aria-atomic="true"><span class="assistiveText">Live chat:</span><span class="message">Napisz do nas</span></span></button></div></div><script id="inert-script" type="text/javascript" src="./Moduł_ 30. Testy jednostkowe w backendzie_files/inert.min.js"></script><script type="text/javascript" src="./Moduł_ 30. Testy jednostkowe w backendzie_files/EmbeddedServiceConfig(1).jsonp"></script><div id="fb-root" class=" fb_reset"><div style="position: absolute; top: -10000px; width: 0px; height: 0px;"><div></div></div></div>
<script type="text/javascript" id="">window._tfa=window._tfa||[];window._tfa.push({notify:"event",name:"page_view",id:1209537});!function(a,b,d,c){document.getElementById(c)||(a.async=1,a.src=d,a.id=c,b.parentNode.insertBefore(a,b))}(document.createElement("script"),document.getElementsByTagName("script")[0],"//cdn.taboola.com/libtrc/unip/1209537/tfa.js","tb_tfa_script");</script>
<noscript>
  <img src="//trc.taboola.com/1209537/log/3/unip?en=page_view" width="0" height="0" style="display:none">
</noscript>


<script type="text/javascript" id="">window._adftrack=Array.isArray(window._adftrack)?window._adftrack:window._adftrack?[window._adftrack]:[];window._adftrack.push({pm:2049944});(function(){var a=document.createElement("script");a.type="text/javascript";a.async=!0;a.src="https://track.adform.net/serving/scripts/trackpoint/async/";var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)})();</script>
<noscript>
    <p style="margin:0;padding:0;border:0;">
        <img src="https://track.adform.net/Serving/TrackPoint/?pm=2049944" width="1" height="1" alt="">
    </p>
</noscript>

<script type="text/javascript" id="">(function(){window.__insp=window.__insp||[];__insp.push(["wid",794470694]);var c=function(){if("undefined"==typeof window.__inspld){window.__inspld=1;var a=document.createElement("script");a.type="text/javascript";a.async=!0;a.id="inspsync";a.src=("https:"==document.location.protocol?"https":"http")+"://cdn.inspectlet.com/inspectlet.js?wid\x3d794470694\x26r\x3d"+Math.floor((new Date).getTime()/36E5);var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)}};setTimeout(c,0)})();</script>
</body></html>