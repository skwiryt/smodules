<!DOCTYPE html>
<!-- saved from url=(0051)https://kodilla.com/pl/bootcamp-module/407/276/5935 -->
<html lang="pl" class=""><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="ahrefs-site-verification" content="c2d3c04b9f125c5b8c98d89f738d343f69d841f035150344a932150235c5639a">
    
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="csrf-token" content="RtYZFGj83q4iSrSPWWX0bG3bzYwVu4VNaOaoyGGq">

<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="https://kodilla.com/static/img/icons/apple-touch-icon-60x60.png?00000">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="https://kodilla.com/static/img/icons/apple-touch-icon-76x76.png?00000">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="https://kodilla.com/static/img/icons/apple-touch-icon-120x120.png?00000">
<link rel="apple-touch-icon" type="image/png" sizes="152x152" href="https://kodilla.com/static/img/icons/apple-touch-icon-152x152.png?00000">
<link rel="icon" type="image/png" sizes="32x32" href="https://kodilla.com/static/img/icons/favicon-32x32.png?00000">
<link rel="icon" type="image/png" sizes="96x96" href="https://kodilla.com/static/img/icons/favicon-96x96.png?00000">
<link rel="icon" type="image/png" sizes="16x16" href="https://kodilla.com/static/img/icons/favicon-16x16.png?00000">

    <link rel="canonical" href="https://kodilla.com/pl/bootcamp-module/407/276/5935">

    <meta name="robots" content="noindex, follow">
    <title>    Moduł: 27. Express – własny serwer HTTP
</title>
        <script type="text/javascript" src="./Moduł_ 27. Express – własny serwer HTTP_files/saved_resource"></script><script type="text/javascript" async="" src="./Moduł_ 27. Express – własny serwer HTTP_files/js"></script><script type="text/javascript" async="" id="inspsync" src="./Moduł_ 27. Express – własny serwer HTTP_files/inspectlet.js"></script><script type="text/javascript" async="" src="./Moduł_ 27. Express – własny serwer HTTP_files/saved_resource(1)"></script><script async="" src="./Moduł_ 27. Express – własny serwer HTTP_files/tfa.js" id="tb_tfa_script"></script><script type="text/javascript" async="" src="./Moduł_ 27. Express – własny serwer HTTP_files/insight.min.js"></script><script type="text/javascript" async="" src="./Moduł_ 27. Express – własny serwer HTTP_files/analytics.js"></script><script type="text/javascript" async="" src="./Moduł_ 27. Express – własny serwer HTTP_files/analytics.js"></script><script type="text/javascript" async="" src="./Moduł_ 27. Express – własny serwer HTTP_files/js(1)"></script><script async="" src="./Moduł_ 27. Express – własny serwer HTTP_files/gtm.js"></script><script src="./Moduł_ 27. Express – własny serwer HTTP_files/389137334769464" async=""></script><script async="" src="./Moduł_ 27. Express – własny serwer HTTP_files/fbevents.js"></script><script src="./Moduł_ 27. Express – własny serwer HTTP_files/sdk.js" async="" crossorigin="anonymous"></script><script id="facebook-jssdk" src="./Moduł_ 27. Express – własny serwer HTTP_files/sdk(1).js"></script><script src="./Moduł_ 27. Express – własny serwer HTTP_files/diffuser.js" async=""></script><script>document.documentElement.classList.remove("no-js")</script>
<script src="./Moduł_ 27. Express – własny serwer HTTP_files/yall.min.js"></script>
<link rel="stylesheet" href="./Moduł_ 27. Express – własny serwer HTTP_files/bootstrap.min.css" as="style" onload="this.rel=&#39;stylesheet&#39;">
<link href="./Moduł_ 27. Express – własny serwer HTTP_files/font-awesome.min.css" rel="stylesheet">
<link rel="stylesheet" href="./Moduł_ 27. Express – własny serwer HTTP_files/main-b3cf79332c.css" as="style" onload="this.rel=&#39;stylesheet&#39;">
            
    <link href="./Moduł_ 27. Express – własny serwer HTTP_files/prism.min.css" rel="stylesheet">

    <link href="./Moduł_ 27. Express – własny serwer HTTP_files/bootcamp-6d0888d826.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="./Moduł_ 27. Express – własny serwer HTTP_files/perfect-scrollbar.css">
    <link rel="stylesheet" href="./Moduł_ 27. Express – własny serwer HTTP_files/jquery.fancybox.min.css" type="text/css" media="screen">
    <link href="https://kodilla.com/static/css/libs/bootstrap-datetimepicker.min.css?00000">
    <link rel="stylesheet" href="./Moduł_ 27. Express – własny serwer HTTP_files/content.css">

<script async="" src="./Moduł_ 27. Express – własny serwer HTTP_files/hotjar-2404285.js"></script><script src="./Moduł_ 27. Express – własny serwer HTTP_files/OneSignalPageSDKES6.js" async=""></script><style type="text/css">.fancybox-margin{margin-right:15px;}</style><script async="" src="./Moduł_ 27. Express – własny serwer HTTP_files/modules.2ec2062e86adda67b2fe.js" charset="utf-8"></script><style type="text/css">iframe#_hjRemoteVarsFrame {display: none !important; width: 1px !important; height: 1px !important; opacity: 0 !important; pointer-events: none !important;}</style><link href="./Moduł_ 27. Express – własny serwer HTTP_files/esw.min.css" type="text/css" rel="stylesheet"><style id="inert-style">
[inert] {
	pointer-events: none;
	cursor: default;
}

[inert], [inert] * {
	user-select: none;
	-webkit-user-select: none;
	-moz-user-select: none;
	-ms-user-select: none;
}
</style><script type="text/javascript" charset="utf-8" src="./Moduł_ 27. Express – własny serwer HTTP_files/saved_resource(2)" async=""></script><style type="text/css" data-fbcssmodules="css:fb.css.base css:fb.css.dialog css:fb.css.iframewidget css:fb.css.customer_chat_plugin_iframe">.fb_hidden{position:absolute;top:-10000px;z-index:10001}.fb_reposition{overflow:hidden;position:relative}.fb_invisible{display:none}.fb_reset{background:none;border:0;border-spacing:0;color:#000;cursor:auto;direction:ltr;font-family:"lucida grande", tahoma, verdana, arial, sans-serif;font-size:11px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:1;margin:0;overflow:visible;padding:0;text-align:left;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;visibility:visible;white-space:normal;word-spacing:normal}.fb_reset>div{overflow:hidden}@keyframes fb_transform{from{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}.fb_animate{animation:fb_transform .3s forwards}
.fb_dialog{background:rgba(82, 82, 82, .7);position:absolute;top:-10000px;z-index:10001}.fb_dialog_advanced{border-radius:8px;padding:10px}.fb_dialog_content{background:#fff;color:#373737}.fb_dialog_close_icon{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 0 transparent;cursor:pointer;display:block;height:15px;position:absolute;right:18px;top:17px;width:15px}.fb_dialog_mobile .fb_dialog_close_icon{left:5px;right:auto;top:5px}.fb_dialog_padding{background-color:transparent;position:absolute;width:1px;z-index:-1}.fb_dialog_close_icon:hover{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -15px transparent}.fb_dialog_close_icon:active{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -30px transparent}.fb_dialog_iframe{line-height:0}.fb_dialog_content .dialog_title{background:#6d84b4;border:1px solid #365899;color:#fff;font-size:14px;font-weight:bold;margin:0}.fb_dialog_content .dialog_title>span{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yd/r/Cou7n-nqK52.gif) no-repeat 5px 50%;float:left;padding:5px 0 7px 26px}body.fb_hidden{height:100%;left:0;margin:0;overflow:visible;position:absolute;top:-10000px;transform:none;width:100%}.fb_dialog.fb_dialog_mobile.loading{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ya/r/3rhSv5V8j3o.gif) white no-repeat 50% 50%;min-height:100%;min-width:100%;overflow:hidden;position:absolute;top:0;z-index:10001}.fb_dialog.fb_dialog_mobile.loading.centered{background:none;height:auto;min-height:initial;min-width:initial;width:auto}.fb_dialog.fb_dialog_mobile.loading.centered #fb_dialog_loader_spinner{width:100%}.fb_dialog.fb_dialog_mobile.loading.centered .fb_dialog_content{background:none}.loading.centered #fb_dialog_loader_close{clear:both;color:#fff;display:block;font-size:18px;padding-top:20px}#fb-root #fb_dialog_ipad_overlay{background:rgba(0, 0, 0, .4);bottom:0;left:0;min-height:100%;position:absolute;right:0;top:0;width:100%;z-index:10000}#fb-root #fb_dialog_ipad_overlay.hidden{display:none}.fb_dialog.fb_dialog_mobile.loading iframe{visibility:hidden}.fb_dialog_mobile .fb_dialog_iframe{position:sticky;top:0}.fb_dialog_content .dialog_header{background:linear-gradient(from(#738aba), to(#2c4987));border-bottom:1px solid;border-color:#043b87;box-shadow:white 0 1px 1px -1px inset;color:#fff;font:bold 14px Helvetica, sans-serif;text-overflow:ellipsis;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0;vertical-align:middle;white-space:nowrap}.fb_dialog_content .dialog_header table{height:43px;width:100%}.fb_dialog_content .dialog_header td.header_left{font-size:12px;padding-left:5px;vertical-align:middle;width:60px}.fb_dialog_content .dialog_header td.header_right{font-size:12px;padding-right:5px;vertical-align:middle;width:60px}.fb_dialog_content .touchable_button{background:linear-gradient(from(#4267B2), to(#2a4887));background-clip:padding-box;border:1px solid #29487d;border-radius:3px;display:inline-block;line-height:18px;margin-top:3px;max-width:85px;padding:4px 12px;position:relative}.fb_dialog_content .dialog_header .touchable_button input{background:none;border:none;color:#fff;font:bold 12px Helvetica, sans-serif;margin:2px -12px;padding:2px 6px 3px 6px;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog_content .dialog_header .header_center{color:#fff;font-size:16px;font-weight:bold;line-height:18px;text-align:center;vertical-align:middle}.fb_dialog_content .dialog_content{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/y9/r/jKEcVPZFk-2.gif) no-repeat 50% 50%;border:1px solid #4a4a4a;border-bottom:0;border-top:0;height:150px}.fb_dialog_content .dialog_footer{background:#f5f6f7;border:1px solid #4a4a4a;border-top-color:#ccc;height:40px}#fb_dialog_loader_close{float:left}.fb_dialog.fb_dialog_mobile .fb_dialog_close_icon{visibility:hidden}#fb_dialog_loader_spinner{animation:rotateSpinner 1.2s linear infinite;background-color:transparent;background-image:url(https://static.xx.fbcdn.net/rsrc.php/v3/yD/r/t-wz8gw1xG1.png);background-position:50% 50%;background-repeat:no-repeat;height:24px;width:24px}@keyframes rotateSpinner{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
.fb_iframe_widget{display:inline-block;position:relative}.fb_iframe_widget span{display:inline-block;position:relative;text-align:justify}.fb_iframe_widget iframe{position:absolute}.fb_iframe_widget_fluid_desktop,.fb_iframe_widget_fluid_desktop span,.fb_iframe_widget_fluid_desktop iframe{max-width:100%}.fb_iframe_widget_fluid_desktop iframe{min-width:220px;position:relative}.fb_iframe_widget_lift{z-index:1}.fb_iframe_widget_fluid{display:inline}.fb_iframe_widget_fluid span{width:100%}
.fb_mpn_mobile_landing_page_slide_out{animation-duration:200ms;animation-name:fb_mpn_landing_page_slide_out;transition-timing-function:ease-in}.fb_mpn_mobile_landing_page_slide_out_from_left{animation-duration:200ms;animation-name:fb_mpn_landing_page_slide_out_from_left;transition-timing-function:ease-in}.fb_mpn_mobile_landing_page_slide_up{animation-duration:500ms;animation-name:fb_mpn_landing_page_slide_up;transition-timing-function:ease-in}.fb_mpn_mobile_bounce_in{animation-duration:300ms;animation-name:fb_mpn_bounce_in;transition-timing-function:ease-in}.fb_mpn_mobile_bounce_out{animation-duration:300ms;animation-name:fb_mpn_bounce_out;transition-timing-function:ease-in}.fb_mpn_mobile_bounce_out_v2{animation-duration:300ms;animation-name:fb_mpn_fade_out;transition-timing-function:ease-in}.fb_customer_chat_bounce_in_v2{animation-duration:300ms;animation-name:fb_bounce_in_v2;transition-timing-function:ease-in}.fb_customer_chat_bounce_in_from_left{animation-duration:300ms;animation-name:fb_bounce_in_from_left;transition-timing-function:ease-in}.fb_customer_chat_bounce_out_v2{animation-duration:300ms;animation-name:fb_bounce_out_v2;transition-timing-function:ease-in}.fb_customer_chat_bounce_out_from_left{animation-duration:300ms;animation-name:fb_bounce_out_from_left;transition-timing-function:ease-in}.fb_customer_chat_bubble_animated_no_badge{box-shadow:0 3px 12px rgba(0, 0, 0, .15);transition:box-shadow 150ms linear}.fb_customer_chat_bubble_animated_no_badge:hover{box-shadow:0 5px 24px rgba(0, 0, 0, .3)}.fb_customer_chat_bubble_animated_with_badge{box-shadow:-5px 4px 14px rgba(0, 0, 0, .15);transition:box-shadow 150ms linear}.fb_customer_chat_bubble_animated_with_badge:hover{box-shadow:-5px 8px 24px rgba(0, 0, 0, .2)}.fb_invisible_flow{display:inherit;height:0;overflow-x:hidden;width:0}.fb_new_ui_mobile_overlay_active{overflow:hidden}@keyframes fb_mpn_landing_page_slide_in{0%{border-radius:50%;margin:0 24px;width:60px}40%{border-radius:18px}100%{margin:0 12px;width:100% - 24px}}@keyframes fb_mpn_landing_page_slide_in_from_left{0%{border-radius:50%;left:12px;margin:0 24px;width:60px}40%{border-radius:18px}100%{left:12px;margin:0 12px;width:100% - 24px}}@keyframes fb_mpn_landing_page_slide_out{0%{margin:0 12px;width:100% - 24px}60%{border-radius:18px}100%{border-radius:50%;margin:0 24px;width:60px}}@keyframes fb_mpn_landing_page_slide_out_from_left{0%{left:12px;width:100% - 24px}60%{border-radius:18px}100%{border-radius:50%;left:12px;width:60px}}@keyframes fb_mpn_landing_page_slide_up{0%{bottom:0;opacity:0}100%{bottom:24px;opacity:1}}@keyframes fb_mpn_bounce_in{0%{opacity:.5;top:100%}100%{opacity:1;top:0}}@keyframes fb_mpn_fade_out{0%{bottom:30px;opacity:1}100%{bottom:0;opacity:0}}@keyframes fb_mpn_bounce_out{0%{opacity:1;top:0}100%{opacity:.5;top:100%}}@keyframes fb_bounce_in_v2{0%{opacity:0;transform:scale(0, 0);transform-origin:bottom right}50%{transform:scale(1.03, 1.03);transform-origin:bottom right}100%{opacity:1;transform:scale(1, 1);transform-origin:bottom right}}@keyframes fb_bounce_in_from_left{0%{opacity:0;transform:scale(0, 0);transform-origin:bottom left}50%{transform:scale(1.03, 1.03);transform-origin:bottom left}100%{opacity:1;transform:scale(1, 1);transform-origin:bottom left}}@keyframes fb_bounce_out_v2{0%{opacity:1;transform:scale(1, 1);transform-origin:bottom right}100%{opacity:0;transform:scale(0, 0);transform-origin:bottom right}}@keyframes fb_bounce_out_from_left{0%{opacity:1;transform:scale(1, 1);transform-origin:bottom left}100%{opacity:0;transform:scale(0, 0);transform-origin:bottom left}}@keyframes fb_bounce_out_v2_mobile_chat_started{0%{opacity:1;top:0}100%{opacity:0;top:20px}}@keyframes fb_customer_chat_bubble_bounce_in_animation{0%{bottom:6pt;opacity:0;transform:scale(0, 0);transform-origin:center}70%{bottom:18pt;opacity:1;transform:scale(1.2, 1.2)}100%{transform:scale(1, 1)}}@keyframes slideInFromBottom{0%{opacity:.1;transform:translateY(100%)}100%{opacity:1;transform:translateY(0)}}@keyframes slideInFromBottomDelay{0%{opacity:0;transform:translateY(100%)}97%{opacity:0;transform:translateY(100%)}100%{opacity:1;transform:translateY(0)}}</style><script type="text/javascript" charset="utf-8" src="./Moduł_ 27. Express – własny serwer HTTP_files/t_prism_sitemessages.php" async=""></script></head>
<body class="student callus-enabled" cz-shortcut-listen="true">
<!-- Facebook Pixel Code -->
<noscript><img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=389137334769464&ev=PageView&noscript=1"/></noscript>
<!-- End Facebook Pixel Code -->
<script>
    document.getElementsByTagName('body')[0].classList.remove('no-js');
    if ( window.isDifferentZone ) {
        document.querySelector('body').classList.add('time-conversion-applied');
    }
    if ( window.hasWrongTime ) {
        document.querySelector('body').classList.add('wrong-hour');
    }
</script>

    <nav class="navbar-main hidden-sm-down dark navbar">
    <div class="nav-container">
        <div class="navbar-header clearfix">
            <button class="navbar-toggler hidden-md-up pull-right" type="button" data-toggle="collapse" data-target="#collapsingNavbarUpper"><i class="fa fa-bars"></i></button>
        </div>
        <div class="collapse navbar-toggleable-sm container" id="collapsingNavbarUpper">
            <ul class="nav navbar-nav navbar-nav-left">
                                    <li class="nav-item nav-contact">
    <span>Skontaktuj się z nami:</span>
    <a href="mailto:support@kodilla.com">
        <i class="fa fa-envelope-o"></i>
        support@kodilla.com
    </a>
    <span>lub</span>
    <a href="javascript:openChat();">
        <i class="fa fa-comments"></i>
        porozmawiaj na czacie
    </a>
</li>
                                </ul>
            <ul class="nav navbar-nav pull-right">
                                <li class="nav-item">
                    <a href="https://kodilla.com/pl/informator" class="nav-link" target="_blank">
        Informator
    </a>
                </li>
                <li class="nav-item hidden-sm-down">
    <a href="https://kodilla.com/pl/account" class="nav-link">Konto</a>
</li>
        <li class="nav-item">
    <a class="analytics-track nav-link nav-link-accent" data-event="account_logout" href="https://kodilla.com/pl/sign-out">Wyloguj</a>
</li>
                            </ul>
        </div>
    </div>
</nav>
<nav class="navbar-main light navbar">
    <div class="container clearfix">
        <a class="navbar-brand" href="https://kodilla.com/pl">
            <img src="./Moduł_ 27. Express – własny serwer HTTP_files/kodilla-nav-logo.svg" alt="Kodilla - szkoła programowania">
        </a>
        <span class="contact-us-button-container"></span>
        <button class="navbar-toggler pull-right collapsed" type="button" data-toggle="collapse" data-target="#navbar-main">
            <i class="fa fa-bars navbar-ico-open"></i>
            <i class="fa fa-times navbar-ico-close"></i>
        </button>
        <ul id="navbar-main" class="nav navbar-nav pull-right collapse">
            <li class="nav-item hidden-sm-down">
    <a class="dropdown-toggle nav-link" href="https://kodilla.com/pl/poznaj-nasze-bootcampy">
        Szkolenia Bootcamp
    </a>
    <ul class="bootcamp-list">
                    <li class="list-sub list-sub-fe">
                <img src="./Moduł_ 27. Express – własny serwer HTTP_files/menu_fer.svg" class="menu-svg" width="32px" height="32px" title="menu_fer_logo">
                <a href="https://kodilla.com/pl/bootcamp/front-end">
                    <h4 class="bootcamp-name">Front-end: React</h4>
                    <p>Naucz się tworzyć front-end aplikacji w 4 miesiące</p>
                </a>
            </li>
            <li class="list-sub">
                <img src="./Moduł_ 27. Express – własny serwer HTTP_files/menu_wd.svg" class="menu-svg" width="32px" height="32px" title="menu_wd_logo">
                <a href="https://kodilla.com/pl/bootcamp/webdeveloper?type=wdp">
                    <h4 class="bootcamp-name">Web Developer</h4>
                    <p>Naucz&nbsp;się tworzyć aplikacje internetowe od&nbsp;podstaw</p>
                    <span class="bootcamp-label">FRONT-END i BACK-END</span>
                </a>
            </li>

            <li class="list-sub">
                <img src="./Moduł_ 27. Express – własny serwer HTTP_files/menu_java.svg" class="menu-svg" width="32px" height="32px" title="menu_java_logo">
                <a href="https://kodilla.com/pl/bootcamp/java?type=jdp">
                    <h4 class="bootcamp-name">Java Developer</h4>
                    <p>Poznaj najpopularniejszy na&nbsp;świecie język programowania od&nbsp;zera</p>
                </a>
            </li>
            <li class="list-sub">
                <img src="./Moduł_ 27. Express – własny serwer HTTP_files/menu_python.svg" class="menu-svg" width="32px" height="32px" title="menu_python_logo">
                <a href="https://kodilla.com/pl/bootcamp/python">
                    <h4 class="bootcamp-name">Python Developer</h4>
                    <p>Zdobądź kompetencje do tworzenia rozwiązań webowych</p>
                </a>
            </li>
            <li class="list-sub">
                <img src="./Moduł_ 27. Express – własny serwer HTTP_files/menu_tester.svg" class="menu-svg" width="32px" height="32px" title="menu_tester_logo">
                <a href="https://kodilla.com/pl/bootcamp/tester-automatyzujacy">
                    <h4 class="bootcamp-name">Tester Automatyzujący</h4>
                    <p>Poznaj podstawy testowania automatycznego w Javie</p>
                </a>
            </li>
            <li class="list-sub">
                <img src="./Moduł_ 27. Express – własny serwer HTTP_files/menu_game.svg" class="menu-svg" width="32px" height="32px" title="menu_mage_logo">
                <a href="https://kodilla.com/pl/bootcamp/game-dev">
                    <h4 class="bootcamp-name">Mobile Game Developer</h4>
                    <p>Zdobądź kompetencje do tworzenia gier</p>
                    <span class="bootcamp-label">nowość</span>
                </a>
            </li>
            </ul>
</li>

                        <li class="nav-item hidden-sm-down">
    <a class="dropdown-toggle nav-link" href="https://kodilla.com/pl/szkolenia-pro">
        Szkolenia Pro
    </a>
    <ul>
        <li><a href="https://kodilla.com/pl/szkolenia-pro/mikroserwisy" class="nav-link">Mikroserwisy w Javie</a></li>
        <li><a href="https://kodilla.com/pl/szkolenia-pro/spring-hibernate" class="nav-link">Spring i Hibernate</a></li>
        <li><a href="https://kodilla.com/pl/szkolenia-pro/wielowatkowosc" class="nav-link">Wielowątkowość w Javie</a></li>
        <li><a href="https://kodilla.com/pl/szkolenia-pro/django" class="nav-link">Aplikacje webowe z Django</a></li>
        <li><a href="https://kodilla.com/pl/szkolenia-pro/wizualizacja-danych" class="nav-link">Analiza danych w Pythonie</a></li>
        <li><a href="https://kodilla.com/pl/szkolenia-pro/machine-learning" class="nav-link">Podstawy Machine Learning</a></li>
        <li><a href="https://kodilla.com/pl/szkolenia-pro/bigdata-pyspark" class="nav-link">Big Data z PySpark</a></li>
        <li><a href="https://kodilla.com/pl/szkolenia-pro/automatyzacja-testow" class="nav-link">Automatyzacja testów</a></li>
        <li><a href="https://kodilla.com/pl/szkolenia-pro/vanilla-js" class="nav-link">Advanced Vanilla JS</a></li>
        <li><a href="https://kodilla.com/pl/szkolenia-pro/typescript" class="nav-link">TypeScript - kurs praktyczny</a></li>
        <li><a href="https://kodilla.com/pl/szkolenia-pro/vue3" class="nav-link">Vue3 - kompletny przewodnik</a></li>
        <li><a href="https://kodilla.com/pl/szkolenia-pro/zaawansowany-backend" class="nav-link">Backend zaawansowany</a></li>
    </ul>
</li>
            <li class="nav-item hidden-sm-down">
    <a class="dropdown-toggle nav-link">
        Strefa kursanta
    </a>
    <ul>
                    <li><a href="https://kodilla.com/pl/bootcamp-dashboard/407" class="nav-link">Bootcamp WD PLUS 2020-12</a></li>
                    <li><a class="nav-link" href="https://kodilla.com/pl/kursy">Samodzielne kursy</a></li>
                    <li><a class="nav-link" href="https://chat.kodilla.com/" target="_blank">Komunikator</a></li>
                    <li><a class="nav-link" href="https://kodilla.com/pl/projects">Moje projekty</a></li>
    </ul>
</li>
                            <li class="nav-item hidden-sm-down">
    <a class="dropdown-toggle nav-link">
        O nas
    </a>
    <ul class="about-us">
        <li><a href="https://kodilla.com/pl/mentorzy" class="nav-link">Mentorzy</a></li>
        <li><a href="https://kodilla.com/pl/zespol" class="nav-link">Zespół Kodilli</a></li>
        <li><a href="https://kodilla.com/pl/o-nas" class="nav-link">O firmie</a></li>
    </ul>
</li>
                                                                    <li class="nav-item hidden-md-up nav-group">
    <span class="mobile-menu-separator">Szkolenia Bootcamp</span>
    <ul>
                    <li class="nav-item list-sub-fe">
                <a class="nav-link nav-link-with-label" href="https://kodilla.com/pl/bootcamp/front-end">Bootcamp Front-end: React
                </a>
            </li>
                <li class="nav-item">
            <a class="nav-link nav-link-with-label" href="https://kodilla.com/pl/bootcamp/webdeveloper">Bootcamp Web Developer
                <span class="bootcamp-label">FRONT-END i BACK-END</span>
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="https://kodilla.com/pl/bootcamp/java">Bootcamp Java</a>
        </li>
        <li class="nav-item list-sub-fe">
            <a class="nav-link nav-link-with-label" href="https://kodilla.com/pl/bootcamp/tester-automatyzuj%C4%85cy">Bootcamp Tester Automatyzujący
            </a>
        </li>
        <li class="nav-item list-sub-fe">
            <a class="nav-link nav-link-with-label" href="https://kodilla.com/pl/bootcamp/python">Python Developer
            </a>
        </li>
        <li class="nav-item list-sub-fe">
            <a class="nav-link nav-link-with-label" href="https://kodilla.com/pl/bootcamp/game-dev">Mobile Game Developer
                <span class="bootcamp-label">nowość</span>
            </a>
        </li>
    </ul>
</li>
<li class="nav-item hidden-md-up nav-group">
    <a class="nav-link-bold" href="https://kodilla.com/pl/szkolenia-pro">Szkolenia Pro</a>
</li>
            <li class="nav-item hidden-md-up nav-group">
            <span class="mobile-menu-separator">Strefa kursanta</span>
            <ul>
                <li class="nav-item ">
                                            <a class="nav-link" href="https://kodilla.com/pl/bootcamp-dashboard/407">
                            Bootcamp   WD PLUS 2020-12
                        </a>
                                    </li>
                <li class="nav-item ">
                    <a class="nav-link" href="https://kodilla.com/pl/kursy">Samodzielne kursy</a>
                </li>
                                    <li class="nav-item ">
                        <a class="nav-link" href="https://chat.kodilla.com/" target="_blank">Komunikator</a>
                    </li>
                                <li class="nav-item">
                    <a class="nav-link" href="https://kodilla.com/pl/projects">Moje projekty</a>
                </li>
            </ul>
        </li>
    
        
            <li class="nav-item hidden-md-up nav-group">
            <span class="mobile-menu-separator">O nas</span>
            <ul>
                <li class="nav-item">
                    <a href="https://kodilla.com/pl/mentorzy" class="nav-link">Mentorzy</a>
                </li>
                <li class="nav-item">
                    <a href="https://kodilla.com/pl/zespol" class="nav-link">Zespół Kodilli</a>
                </li>
                <li class="nav-item">
                    <a href="https://kodilla.com/pl/o-nas" class="nav-link">O firmie</a>
                </li>
            </ul>
        </li>
    
<li class="nav-item hidden-md-up nav-group">
    <span class="mobile-menu-separator">Pozostałe</span>
    <ul>
                                        
        <li class="nav-item">
            <a href="https://kodilla.com/pl/informator" class="nav-link" target="_blank">
        Informator
    </a>
        </li>
    </ul>

</li>

    <li class="nav-item hidden-md-up">
        <a class="nav-link" href="https://kodilla.com/pl/account">Konto</a>
    </li>
    <li class="nav-item hidden-md-up">
        <a class="nav-link analytics-track" data-event="account_logout" href="https://kodilla.com/pl/sign-out">Wyloguj</a>
    </li>

        
    <li class="nav-item hidden-md-up nav-group">
        <span class="mobile-menu-separator">Skontaktuj się z nami</span>
        <ul>
            <li class="nav-item">
                <a href="mailto:support@kodilla.com" class="nav-link">
                    <i class="fa fa-envelope-o"></i>
                    support@kodilla.com
                </a>
            </li>
            <li class="nav-item">
                <a href="javascript:openChat();" class="nav-link">
                    <i class="fa fa-comments"></i>
                    <span>Porozmawiaj na czacie</span>
                </a>
            </li>
        </ul>
    </li>
        </ul>
    </div>
</nav>
<main class="bootcamp module page-height-fix" id="bootcamp-module">
    <div class="aside-toggle hidden-md-up">
        <button class="navbar-toggler pull-left collapsed" type="button" data-toggle="collapse" data-target="#aside-sticky" aria-expanded="false">
            <i class="fa fa-bars navbar-ico-open"></i>
            <i class="fa fa-times navbar-ico-close"></i>
        </button>
    </div>
    <div class="table-of-contents aside-sticky collapsed collapse" id="aside-sticky">
        <section class="container">
            <div class="row">
                <aside class="module-nav col-md-4 col-md-offset-8">
                    <section class="card">
                        <div class="card-header">
                            <h4 class="card-title">Spis treści modułu</h4>
                        </div>
                        <ul class="list-group list-group-flush ps-container ps-theme-default ps-active-y" data-ps-id="c62efe52-4bec-385b-50e3-6955c955e8ac">
                                                        <li class="list-group-item completed">
                                <a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#submodule-1116" class="clearfix">
                                    <p>27.1. Wprowadzenie do Expressa</p>
                                    <i class="fa fa-check-circle-o"></i>
                                    <i class="fa fa-play-circle-o"></i>
                                    <i class="fa fa-send-o"></i>
                                    <i class="fa fa-exclamation-circle"></i>
                                </a>
                            </li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#271-wprowadzenie-do-expressa-frontend-vs-backend" class="clearfix">Frontend vs backend</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#271-wprowadzenie-do-expressa-pierwsze-kroki" class="clearfix">Pierwsze kroki</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#271-wprowadzenie-do-expressa-pierwszy-endpoint" class="clearfix">Pierwszy endpoint</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#271-wprowadzenie-do-expressa-kolejne-endpointy" class="clearfix">Kolejne endpointy</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#271-wprowadzenie-do-expressa-czy-naprawde-express-jest-nam-potrzebny" class="clearfix">Czy naprawdę Express jest nam potrzebny?</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#271-wprowadzenie-do-expressa-podsumowanie" class="clearfix">Podsumowanie</a></li>
                                                        <li class="list-group-item completed">
                                <a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#submodule-1117" class="clearfix">
                                    <p>27.2. Serwowanie plików statycznych i middleware</p>
                                    <i class="fa fa-check-circle-o"></i>
                                    <i class="fa fa-play-circle-o"></i>
                                    <i class="fa fa-send-o"></i>
                                    <i class="fa fa-exclamation-circle"></i>
                                </a>
                            </li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#272-serwowanie-plikow-statycznych-i-middleware-serwowanie-plikow-statycznych" class="clearfix">Serwowanie plików statycznych</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#272-serwowanie-plikow-statycznych-i-middleware-middleware" class="clearfix">Middleware</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#272-serwowanie-plikow-statycznych-i-middleware-powrot-do-pracy" class="clearfix">Powrót do pracy</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#272-serwowanie-plikow-statycznych-i-middleware-wylapujemy-wadliwe-linki" class="clearfix">Wyłapujemy wadliwe linki</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#272-serwowanie-plikow-statycznych-i-middleware-dodajemy-zewnetrzne-zasoby" class="clearfix">Dodajemy zewnętrzne zasoby</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#272-serwowanie-plikow-statycznych-i-middleware-posumowanie" class="clearfix">Posumowanie</a></li><li class="list-group-item list-group-flush sub task"><a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#272-serwowanie-plikow-statycznych-i-middleware-zadanie-szlifujemy-umiejetnosci" class="clearfix">Zadanie: szlifujemy umiejętności</a></li>
                                                        <li class="list-group-item completed">
                                <a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#submodule-1118" class="clearfix">
                                    <p>27.3. Komunikacja z użytkownikiem</p>
                                    <i class="fa fa-check-circle-o"></i>
                                    <i class="fa fa-play-circle-o"></i>
                                    <i class="fa fa-send-o"></i>
                                    <i class="fa fa-exclamation-circle"></i>
                                </a>
                            </li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#273-komunikacja-z-uzytkownikiem-nodemon-automatyczne-odswiezanie-zmian" class="clearfix">Nodemon – automatyczne odświeżanie zmian</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#273-komunikacja-z-uzytkownikiem-przekazujemy-proste-informacje" class="clearfix">Przekazujemy proste informacje</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#273-komunikacja-z-uzytkownikiem-renderowanie-templateow" class="clearfix">Renderowanie template'ów</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#273-komunikacja-z-uzytkownikiem-templatey-w-praktyce" class="clearfix">Template'y w praktyce</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#273-komunikacja-z-uzytkownikiem-unifikacja-widokow" class="clearfix">Unifikacja widoków</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#273-komunikacja-z-uzytkownikiem-layouty-aplikacji" class="clearfix">Layouty aplikacji</a></li><li class="list-group-item list-group-flush sub task"><a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#273-komunikacja-z-uzytkownikiem-zadanie-tworzymy-layout-aplikacji" class="clearfix">Zadanie: tworzymy layout aplikacji</a></li>
                                                        <li class="list-group-item completed">
                                <a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#submodule-1119" class="clearfix">
                                    <p>27.4. Testowanie połączeń HTTP</p>
                                    <i class="fa fa-check-circle-o"></i>
                                    <i class="fa fa-play-circle-o"></i>
                                    <i class="fa fa-send-o"></i>
                                    <i class="fa fa-exclamation-circle"></i>
                                </a>
                            </li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#274-testowanie-polaczen-http-nowy-endpoint" class="clearfix">Nowy endpoint</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#274-testowanie-polaczen-http-postman" class="clearfix">Postman</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#274-testowanie-polaczen-http-strona-kontaktu" class="clearfix">Strona kontaktu</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#274-testowanie-polaczen-http-stylujemy-aplikacje" class="clearfix">Stylujemy aplikację</a></li><li class="list-group-item list-group-flush sub task"><a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#274-testowanie-polaczen-http-zadanie-rozwijamy-podstrone-kontaktu" class="clearfix">Zadanie: rozwijamy podstronę kontaktu</a></li>
                                                        <li class="list-group-item completed">
                                <a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#submodule-1120" class="clearfix">
                                    <p>27.5. REST API w praktyce</p>
                                    <i class="fa fa-check-circle-o"></i>
                                    <i class="fa fa-play-circle-o"></i>
                                    <i class="fa fa-send-o"></i>
                                    <i class="fa fa-exclamation-circle"></i>
                                </a>
                            </li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#275-rest-api-w-praktyce-serwer-api-standaryzacja" class="clearfix">Serwer API, standaryzacja</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#275-rest-api-w-praktyce-rest-podazamy-za-standardem" class="clearfix">REST – podążamy za standardem</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#275-rest-api-w-praktyce-przykladowa-aplikacja" class="clearfix">Przykładowa aplikacja</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#275-rest-api-w-praktyce-dodajemy-baze-danych" class="clearfix">Dodajemy "bazę danych"</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#275-rest-api-w-praktyce-czas-na-endpointy" class="clearfix">Czas na endpointy</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#275-rest-api-w-praktyce-wylapujemy-wadliwe-linki" class="clearfix">Wyłapujemy wadliwe linki</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#275-rest-api-w-praktyce-gotowe" class="clearfix">Gotowe!</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#275-rest-api-w-praktyce-dobre-praktyki-grupowanie-endpointow" class="clearfix">Dobre praktyki – grupowanie endpointów</a></li><li class="list-group-item list-group-flush sub task"><a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#275-rest-api-w-praktyce-zadanie-grupujemy-endpointy" class="clearfix">Zadanie: grupujemy endpointy</a></li>
                                                        <li class="list-group-item completed">
                                <a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#submodule-1121" class="clearfix">
                                    <p>27.6. Publikujemy aplikację</p>
                                    <i class="fa fa-check-circle-o"></i>
                                    <i class="fa fa-play-circle-o"></i>
                                    <i class="fa fa-send-o"></i>
                                    <i class="fa fa-exclamation-circle"></i>
                                </a>
                            </li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#276-publikujemy-aplikacje-pare-slow-o-projekcie" class="clearfix">Parę słów o projekcie</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#276-publikujemy-aplikacje-lista-zadan" class="clearfix">Lista zadań</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#276-publikujemy-aplikacje-bierzemy-sie-do-pracy" class="clearfix">Bierzemy się do pracy</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#276-publikujemy-aplikacje-etap-1" class="clearfix">Etap 1</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#276-publikujemy-aplikacje-etap-2" class="clearfix">Etap 2</a></li><li class="list-group-item list-group-flush sub task"><a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#276-publikujemy-aplikacje-zadanie-publikacja-na-heroku" class="clearfix">Zadanie: publikacja na Heroku</a></li>
                                                        <li class="list-group-item completed">
                                <a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#submodule-1122" class="clearfix">
                                    <p>27.7. Podsumowanie</p>
                                    <i class="fa fa-check-circle-o"></i>
                                    <i class="fa fa-play-circle-o"></i>
                                    <i class="fa fa-send-o"></i>
                                    <i class="fa fa-exclamation-circle"></i>
                                </a>
                            </li>
                                                        <li class="list-group-item completed">
                                <a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#submodule-1123" class="clearfix">
                                    <p>27.8. Quiz powtórkowy</p>
                                    <i class="fa fa-check-circle-o"></i>
                                    <i class="fa fa-play-circle-o"></i>
                                    <i class="fa fa-send-o"></i>
                                    <i class="fa fa-exclamation-circle"></i>
                                </a>
                            </li>
                                                    <div class="ps-scrollbar-x-rail" style="left: 0px; bottom: 3px;"><div class="ps-scrollbar-x" tabindex="0" style="left: 0px; width: 0px;"></div></div><div class="ps-scrollbar-y-rail" style="top: 0px; height: 606px; right: 3px;"><div class="ps-scrollbar-y" tabindex="0" style="top: 0px; height: 153px;"></div></div></ul>
                        <div class="card-block text-center">
                                                                                                <a href="https://kodilla.com/pl/bootcamp-dashboard/407">Powrót do dashboardu</a>
                                                                                    </div>
                    </section>
                </aside>
            </div>
        </section>
    </div>
    <section class="container module-content">
        <div class="row">
            <main class="col-md-8">
                <section class="card">
                    <div class="card-block module-header clearfix  completed ">
                        <h1 class="card-title">27. Express – własny serwer HTTP</h1>
                                                <i class="fa fa-bookmark fa-3x" aria-hidden="true"></i>
                    </div>
                                        <div class="card-block challenge">
                        <h3>Wyzwania:</h3>
                        <ul>
<li>zbudujesz swój pierwszy serwer,</li>
<li>nauczysz się jak testować endpointy bez tworzenia warstwy klienta,</li>
<li>dowiesz się jak wykorzystać system szablonów handlebars również na serwerze,</li>
<li>opublikujesz swoją pierwszą fullstackową aplikację.</li>
</ul>
<h3>Wstęp</h3>
<p>Większość kursów i tutoriali wprowadzających do Node.js skupia się tylko i wyłącznie na jego jednej zalecie – możliwości tworzenia serwerów. Oczywiście jest to prawdopodobnie najbardziej istotna cecha tego narzędzia, ale – jak wiesz już po lekturze poprzedniego modułu – niejedyna. Tak czy inaczej, nie mieliśmy jeszcze okazji bezpośrednio zmierzyć się z tą funkcjonalnością. Czas to zmienić!</p>
<p>Nie będziemy jednak pracować w czystym Node.js. Jest to możliwe, ale na dłuższą metę, szczególnie przy większych projektach, trochę niewygodne. Musielibyśmy pamiętać o zbyt wielu aspektach, które trzeba wziąć pod uwagę. Zamiast tego skorzystamy z frameworka o nazwie <strong>Express</strong>, który pozwoli osiągnąć takie same efekty, ale przejmie od nas część obowiązków.</p>

                    </div>
                                    </section>
                                    
                <section id="submodule-1116" class="card submodule completed" data-bootcamp-user-submodule-id="661003">
                <!-- klasy dla section: completed current comments -->
                    <div class="card-block submodule-header clearfix">
                        <i class="fa fa-check-circle-o fa-2x"></i>
                        <i class="fa fa-play-circle-o fa-2x"></i>
                        <i class="fa fa-exclamation-circle fa-2x"></i>
                        <i class="fa fa-send-o fa-2x"></i>
                        <h2 class="bootcamp-submodule-name">27.1. <span>Wprowadzenie do Expressa</span></h2>
                                            </div>
                    <div class="card-block">
                        <div class="submodule-content">
                            <p><strong>Express</strong> to szybki i wydajny framework do Node'a. Jego zadaniem jest przede wszystkim pomoc przy tworzeniu serwerów, obsłudze endpointów, a także wsparcie w zakresie bezpieczeństwa aplikacji webowych. Krótko mówiąc, Express pozwala nam tworzyć serwery oraz całe aplikacje webowe w łatwy i szybki sposób, przy okazji przejmując od nas wiele zadań. Jego największymi zaletami są: minimalizm, intuicyjność i łatwość nauki.</p>
<p>Oczywiście Express to tylko framework, a nie zupełnie nowe narzędzie. Tak naprawdę pod maską korzysta z czystego Node'a. Wszystko, co oferuje, możemy więc uzyskać również bez jego pomocy, ale&nbsp;byłoby to bardziej pracochłonne.</p>
<p>Co jest sporym plusem – twórcy frameworka skupili się na funkcjonalnościach webowych i właśnie do takich zastosowań Express nam się&nbsp;przyda. W przypadku aplikacji, które wykonywaliśmy np. w poprzednim module, byłby zupełnie zbędny.</p>
<p>Express nie jest jedynym frameworkiem tego typu. Znane są również np. <a href="https://koajs.com/" target="_blank">Koa.js</a> czy <a href="https://feathersjs.com/" target="_blank">Feather.js</a>, które oferują zbliżone funkcjonalności. Dlaczego wybraliśmy właśnie jego? Przede wszystkim z powodu popularności – <strong>to zdecydowanie numer 1 na rynku</strong>. Do tego jest obecny w web developmencie już od bardzo dawna, możemy być pewni jego <strong>stabilności</strong> i że <strong>nagle nie zniknie</strong>. Obie te zalety powodują, że cieszy się on sporym zainteresowaniem wśród pracodawców, a w internecie znajdziesz wiele pomocnych materiałów.</p>
<h3 id="271-wprowadzenie-do-expressa-frontend-vs-backend">Frontend vs backend</h3>
<p>Zanim przejdziemy do praktyki, wyjaśnijmy czym w ogóle jest serwer.</p>
<p>Przypomnijmy sobie. Serwer to, najprościej mówiąc, <strong>jakiś komputer udostępniający użytkownikowi lub użytkownikom (klientom) swoje zasoby.</strong> Zasobami mogą być po prostu pliki, bazy danych, albo np. strony internetowe.</p>
<a href="./Moduł_ 27. Express – własny serwer HTTP_files/ClientServer.png" class="img-modal-group"><img src="./Moduł_ 27. Express – własny serwer HTTP_files/ClientServer.png" alt="image" style="width: auto;"></a>
<p>Serwer może mieć bardzo różne zastosowania. Istnieją serwery FTP (serwery plików), poczty, telnet (zdalna obsługa komputera), czy WWW. Nas interesuje właśnie ten ostatni, który pozwala na serwowanie stron internetowych oraz prostą komunikację za pomocą protokołu HTTP.</p>
<p>Serwer WWW jest wykorzystywany między innymi przez Webpacka do tworzenia podglądu Twojej strony. Podobnie działa też wtyczka Live Server w Visual Studio Code, a bezpośrednią styczność z tą technologią mieliśmy już w module wprowadzającym do AJAX-a i API. Wtedy w praktyce dowiedzieliśmy się, jak wygląda praca z serwerem i nawet się z nim komunikowaliśmy.</p>
<p>Idea serwera nie jest więc dla Ciebie żadną nowością, choć dotychczas było Ci dane poznać ją od jednej strony – klienta. Teraz przyjrzymy się tematowi z trochę innej perspektywy ;)</p>
<h4>Cienka granica</h4>
<p>Podział pomiędzy frontedenem i backendem jest już od dłuższego czasu bardzo rozmyty. Wcześniej ta granica była dość mocno zarysowana. Backend zajmował się całą logiką aplikacji oraz kontaktem z bazą danych, a frontend obsługiwał tylko komunikację z użytkownikiem. Wraz z rozwojem JS-a, sytuacja uległa zmianie. Na tym etapie kursu wiesz, że nawet bez wykorzystania serwera jesteśmy w stanie zbudować całkiem skomplikowane aplikacje. Faktycznie JS jest teraz o wiele bardziej funkcjonalny, co wpływa na zmianę balansu – coraz częściej frontend zajmuję się większością logiki aplikacji, a backend pełni drugorzędną funkcję. Bardzo często sprowadza się ona jedynie do obsługi bazy danych. W takiej sytuacji mówimy o <strong>serwerach API</strong>.</p>
<p>Pamiętaj jednak, że nie zawsze musi tak być. Wciąż istnieje mnóstwo aplikacji i stron, w których główną rolę odgrywa serwer. Tak działają np. wszystkie blogi oparte na popularnym systemie Wordpress.</p>
<div class="bc-note alert-info">
<h4 class="alert-heading text-center">Node.js – a może coś innego?</h4>
<p>Czy istnieje jakaś alternatywa dla Node'a, jeśli chodzi o tworzenie serwerów? Oczywiście, nawet kilka. Jedną z najbardziej popularnych jest oprogramowanie <strong>Apache</strong>, pozwalające na pisanie backendu w języku <strong>PHP</strong>. To rozwiązanie o wiele starsze niż Node.js, jednak wciąż mocno zakorzenione w rynku.</p>
<p>Zatem dlaczego używamy właśnie Node'a?</p>
<p>Uruchomienie JS-a na serwerze Apache byłoby karkołomnym zadaniem, a sama nauka nowego języka zapewne jeszcze bardziej wymagająca. Współpraca frontendu JS z backendem PHP jest możliwa, ale dość kłopotliwa, bowiem oba języki preferują inne formaty danych.</p>
<p>W tym momencie widzimy jedną z głównych zalet Node.js – <strong>pozwala na pisanie frontendu i backendu w tym samym języku.</strong> Dzięki temu, o wiele łatwiej możemy zintegrować całą aplikację oraz tworzyć ją od początku do końca samemu, bez potrzeby uczenia się dodatkowego języka programowania.</p>
</div>
<h3 id="271-wprowadzenie-do-expressa-pierwsze-kroki">Pierwsze kroki</h3>
<p>Zacznij od stworzenia nowego katalogu na nasz projekt. Następnie pobierz <code>express</code> i utwórz plik <code>package.json</code>.</p>
<pre class=" language-js"><code class=" language-js">yarn add express@<span class="token number">4.17</span><span class="token number">.1</span></code></pre>
<p>Dodaj nowy plik – <code>server.js</code>. To właśnie on, po skompilowaniu, będzie uruchamiał na naszym komputerze serwer. Następnie wstaw do niego następującą treść:</p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">listen</span><span class="token punctuation">(</span><span class="token number">8000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'Server is running on port: 8000'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Teraz po kolei omówmy ten kod.</p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Tutaj komentarz jest zbędny. Po prostu importujemy zewnętrzną paczkę do naszej aplikacji. Po module o Node.js nie powinno to być dla Ciebie nowością.</p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>W tym momencie tworzymy nową aplikację expressową i przypisujemy ją do stałej <code>app</code>. Po co? Żeby później mieć do niej dostęp.</p>
<pre class=" language-js"><code class=" language-js">app<span class="token punctuation">.</span><span class="token method function property-access">listen</span><span class="token punctuation">(</span><span class="token number">8000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'Server is running on port: 8000'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Kolejna część kodu mówi po prostu, na jakim porcie chcemy utworzyć serwer HTTP. W naszym komputerze może być odpalonych wiele serwerów (chociażby <code>webpack-dev-server</code>) i aby możliwa była ich identyfikacja, wykorzystujemy właśnie mechanizm portów.</p>
<p>Jeśli u Ciebie port <code>8000</code> jest już zajęty, możesz ustawić tu inną wartość, np. <code>3000</code> albo <code>9000</code>. Przykładowo Create React App, oficjalny szablon Reacta, wykorzystuje port <code>3000</code> do uruchamiania podglądu aplikacji.</p>
<pre class=" language-js"><code class=" language-js"><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'Server is running on port: 8000'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>Co do samej funkcji callback – nie jest wymagana, ale możemy jej użyć np. do wyświetlenie komunikatu po utworzeniu serwera.</p>
<p>Czy taki krótki kod jest w stanie utworzyć&nbsp;nasz serwer? Tak! Oczywiście "pod maską" dzieje się o wiele więcej rzeczy, ale w tym momencie one nas nie interesują.</p>
<h4>Pierwsze uruchomienie</h4>
<p>Czas sprawdzić, czy wszystko działa! Uruchom terminal i odpal w swoim folderze komendę <code>node server.js</code>. Naturalne wciąż używamy Node'a do kompilacji. Nie zapomnij – <strong>Express wykorzystuje właśnie funkcjonalności Node.js</strong>.</p>
<pre class=" language-js"><code class=" language-js">node server<span class="token punctuation">.</span><span class="token property-access">js</span></code></pre>
<p>Następnie wejdź do przeglądarki i odwiedź <code>localhost:8000</code>.</p>
<div class="bc-note alert-info">
<h4 class="alert-heading text-center">localhost?</h4>
<p><code>localhost</code> oznacza, że szukamy serwera lokalnego, dostępnego na naszym komputerze. Kiedy chcemy za pomocą przeglądarki łączyć się z innymi serwerami (komputerami) dostępnymi w internecie, ale poza naszym komputerem, musimy wpisać ich adres IP (np. <code>52.19.39.113</code> dla serwera kodilla.com) albo, co częściej czynimy, adres domenowy (np. <code>kodilla.com</code>) – o ile serwer taki posiada.</p>
</div>
<p>Przed Twoimi oczami powinien pokazać się następujący tekst:</p>
<pre class=" language-markup"><code class=" language-markup">Cannot GET /</code></pre>
<p>Informuje nas to o dwóch rzeczach. Po pierwsze serwer faktycznie działa (brawo!), a po drugie, nie wie, co ma pokazać zaraz po wejściu. Komunikat <code>Cannot GET /</code> zwyczajnie mówi nam: nie mogę znaleźć żadnego endpointu pod linkiem <code>/</code> dla metody <code>GET</code> i nie wiem co pokazać. To całkiem sensowne, bo faktycznie nie przygotowaliśmy jeszcze żadnego endpointu. Zaraz to zrobimy.</p>
<p>Dlaczego jednak serwer szukał endpointu <code>/</code>? Przecież w linku <code>http://localhost:8000</code> nie widać żadnego ukośnika na końcu. I dlaczego szukał endpointu pod metodę <code>GET</code>?</p>
<p>Sprawę linku możemy wytłumaczyć bardzo prosto. Ścieżka <code>/</code> jest po prostu główną, wybieraną wtedy, kiedy wpiszemy tylko sam adres serwera. Musimy ją opisać za pomocą chociażby jednego znaku – stąd używane oznaczenie <code>/</code>.</p>
<p>A dlaczego <code>GET</code>? Przypomnijmy jakie metody były przez Ciebie używane:</p>
<ul>
<li><code>GET</code> – do pobierania danych.</li>
<li><code>POST</code> – do dodawania danych.</li>
<li><code>PUT</code> – do modyfikacji danych.</li>
<li><code>DELETE</code> – do usuwania danych.</li>
</ul>
<p>Która Twoim zdaniem najbardziej pasuje do procesu wejścia na stronę? Tak jest, właśnie <code>GET</code>. W końcu wchodząc na jakąś witrynę, my tak naprawdę pobieramy daną stronę – kod HTML, pliki JS, używane arkusze CSS itd. Właśnie dlatego jest to domyślna metoda używana przez przeglądarki.</p>
<h3 id="271-wprowadzenie-do-expressa-pierwszy-endpoint">Pierwszy endpoint</h3>
<p>Wiemy już, jaki jest problem, teraz trzeba go rozwiązać. Czas na dodanie pierwszego endpointu.</p>
<p>Czym jest <code>endpoint</code>? To po prostu adres serwera, pod którym  będzie on wykonywał jakąś konkretną czynność. Na przykład endpoint <code>posts/1</code> może zwracać post o id <code>1</code>, a endpoint <code>posts/all</code> wszystkie posty.</p>
<p>Przejdźmy teraz do pracy. Zmodyfikuj plik <code>server.js</code> dodając do niego endpoint pod link <code>/</code> oraz zakładając, że chodzi o połączenie za pomocą metody <code>GET</code>. Musimy ją wskazać, bowiem istnieje możliwość tworzenia kilku endpointów dla tego samego linku, ale innych metod. Wtedy ten sam link, ale przy połączeniu za pomocą innej metody, może zwrócić zupełnie inny rezultat. Np. <code>posts/all</code> z metodą <code>GET</code> może służyć do pobierania wszystkich postów, a <code>posts/all</code> z metodą <code>DELETE</code> do ich usuwania.</p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token string">'&lt;h1&gt;My first server!&lt;/h1&gt;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">listen</span><span class="token punctuation">(</span><span class="token number">8000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'Server is running on port: 8000'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Musisz przyznać, że sposób dodawania endpointów jest dość intuicyjny – <code>app</code> to po prostu odnośnik do naszego serwera, a <code>.get</code> ustala metodę, którą chcemy obsługiwać w tym endpoincie (oczywiście dla <code>POST</code> byłoby to <code>.post</code> itd.). Pierwszy parametr tej funkcji ustala już konkretnie link, o którym mowa, a drugi to callback – funkcja, która ma uruchomić się w sytuacji, gdy serwer wykryje, że użytkownik wchodzi właśnie pod ten link.</p>
<p>Parametry <code>req, res</code> dają nam dostęp do obiektu zapytania/żądania (ang. <em>request</em>) i odpowiedzi (ang. <em>response</em>). Co w nich jest?</p>
<ul>
<li>
<p><code>req</code> zawiera informacje o użytkowniku, który łączy się z serwerem (jego przeglądarka, IP itp.) oraz o samym zapytaniu. Ma więc np. dostęp do danych wysyłanych wraz z zapytaniem (o ile użytkownik takie wysyłał).</p>
</li>
<li>
<p><code>res</code> zawiera za to wiele przydatnych metod do komunikacji zwrotnej. Możemy wysłać np. komunikat tekstowy (metoda <code>send</code>), kod HTML (również <code>send</code>), dane w formacie JSON (metoda <code>json</code>) czy... nawet cały plik (metoda <code>sendFile</code>)! Istnieją tutaj również np. metody do zwracania kodów statusu. Pamiętasz <code>200</code>, <code>404</code> albo spędzający sen z powiek <code>500</code>? Teraz sami możemy zdecydować, kiedy "wyrzucimy" użytkownikowi błąd, a kiedy powiemy, że wszystko poszło dobrze.</p>
</li>
</ul>
<p>Oczywiście oba obiekty są na tyle obszerne, że nie będziemy ich szczegółowo opisywać – od tego jest <a href="https://expressjs.com/en/api.html" target="_blank">dokumentacja</a>. W niniejszym module poznasz jednak ich wszystkie najistotniejsze możliwości.</p>
<div class="bc-note alert-info">
<h4 class="alert-heading text-center">A może inne nazwy?</h4>
<p>Czy moglibyśmy użyć innych nazw zamiast <code>req</code> i <code>res</code>? Oczywiście. Pamiętasz nasłuchiwacze? Pierwszy parametr w funkcjach nazywaliśmy <code>e</code> albo <code>event</code>. Tutaj także nazwy mogą być inne, choć pierwszy parametr zawsze będzie odwoływał się do obiektu zapytania, a drugi do odpowiedzi. Przyjęło się jednak, że będą one nazywane <code>req</code> i <code>res</code>, dlatego i my będziemy się tej konwencji trzymać, podobnie jak trzymaliśmy się nazw <code>event</code> lub <code>e</code> przy nasłuchiwaczach.</p>
</div>
<p>Teraz uruchom ponownie nasz serwer i sprawdź rezultat.</p>
<a href="./Moduł_ 27. Express – własny serwer HTTP_files/Express1.png" class="img-modal-group"><img src="./Moduł_ 27. Express – własny serwer HTTP_files/Express1.png" alt="image" style="width: auto;"></a>
<p>Nie jest to może coś imponującego, ale oznacza, że serwer dobrze obsłużył żądanie.</p>
<h3 id="271-wprowadzenie-do-expressa-kolejne-endpointy">Kolejne endpointy</h3>
<p>W ramach praktyki dodamy sobie jeszcze kolejne endpointy.</p>
<p>Oto nasze założenia:</p>
<ul>
<li><code>/about</code> pod metodą <code>GET</code> – powinna zwracać tekst <code>&lt;h1&gt;About&lt;/h1&gt;</code>,</li>
<li><code>/contact</code> pod metodą <code>GET</code> – powinna zwracać tekst <code>&lt;h1&gt;Contact&lt;/h1&gt;</code>,</li>
<li><code>/info</code> pod metodą <code>GET</code> – powinna zwracać tekst <code>&lt;h1&gt;Info&lt;/h1&gt;</code>,</li>
<li><code>/history</code> pod metodą <code>GET</code> – powinna zwracać tekst <code>&lt;h1&gt;History&lt;/h1&gt;</code>.</li>
</ul>
<p>Zacznijmy od dodania dwóch pierwszych:</p>
<pre class=" language-js"><code class=" language-js">app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/about'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token string">'&lt;h1&gt;About&lt;/h1&gt;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/contact'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token string">'&lt;h1&gt;Contact&lt;/h1&gt;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Musisz przyznać, że to nie było takie trudne. Express faktycznie jest bardzo intuicyjny, a zarazem czytelny. Powyższy kod oczywiście działa dość prosto. Jeśli wejdziemy na link <code>/about</code> za pomocą metody <code>GET</code> (dla przypomnienia, to metoda, której przeglądarka używa domyślnie), otrzymamy komunikat <code>About</code>. Jeśli odwiedzimy <code>/contact</code> za pomocą tej samej metody, serwer zwróci tekst <code>Contact</code>.</p>
<p>W ramach treningu spróbuj dodać pozostałe dwa endpointy na własną rękę. W efekcie powinniśmy otrzymać serwer, który działa następująco:</p>
<a href="./Moduł_ 27. Express – własny serwer HTTP_files/Express2.gif" class="img-modal-group"><img src="./Moduł_ 27. Express – własny serwer HTTP_files/Express2.gif" alt="image" style="width: auto;"></a>
<p class="text-center">
  <span class="collapse-toggles">
    <a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#collapse-xYai2xcxV-toggle" class="btn btn-primary collapsed" data-toggle="collapse">Pokaż gotowy kod</a>
    <a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#collapse-xYai2xcxV-toggle" class="btn btn-primary collapsed" data-toggle="collapse">Ukryj gotowy kod</a>
  </span>
</p>
<div id="collapse-xYai2xcxV-toggle" class="collapse">
<pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token string">'&lt;h1&gt;My first server!&lt;/h1&gt;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/about'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token string">'&lt;h1&gt;About&lt;/h1&gt;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/contact'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token string">'&lt;h1&gt;Contact&lt;/h1&gt;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/info'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token string">'&lt;h1&gt;Info&lt;/h1&gt;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/history'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token string">'&lt;h1&gt;History&lt;/h1&gt;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">listen</span><span class="token punctuation">(</span><span class="token number">8000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'Server is running on port: 8000'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
</div>
<p>Swoją drogą, czy kod naszej aplikacji coś Ci przypomina? Zastosowaliśmy tu zwykły routing, który znasz już z kursu, choć tym razem był to <strong>routing po stronie serwera</strong>. Zamysł jest jednak analogiczny – pod danym linkiem pokazujemy konkretną treść.</p>
<h3 id="271-wprowadzenie-do-expressa-czy-naprawde-express-jest-nam-potrzebny">Czy naprawdę Express jest nam potrzebny?</h3>
<p>Możliwe, że wciąż zadajesz sobie jedno pytanie – jak wyglądałby nasz kod bez użycia Expressu?</p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> http <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'http'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> server <span class="token operator">=</span> http<span class="token punctuation">.</span><span class="token method function property-access">createServer</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>

  <span class="token keyword control-flow">if</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span><span class="token property-access">url</span> <span class="token operator">===</span> <span class="token string">'/'</span> <span class="token operator">&amp;&amp;</span> req<span class="token punctuation">.</span><span class="token property-access">method</span> <span class="token operator">===</span> <span class="token string">'GET'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token method function property-access">write</span><span class="token punctuation">(</span><span class="token string">'&lt;h1&gt;My first server!&lt;/h1&gt;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    res<span class="token punctuation">.</span><span class="token method function property-access">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword control-flow">else</span> <span class="token keyword control-flow">if</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span><span class="token property-access">url</span> <span class="token operator">===</span> <span class="token string">'about/'</span> <span class="token operator">&amp;&amp;</span> req<span class="token punctuation">.</span><span class="token property-access">method</span> <span class="token operator">===</span> <span class="token string">'GET'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token method function property-access">write</span><span class="token punctuation">(</span><span class="token string">'&lt;h1&gt;About&lt;/h1&gt;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    res<span class="token punctuation">.</span><span class="token method function property-access">end</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// ... then similar other routes</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span>

server<span class="token punctuation">.</span><span class="token method function property-access">listen</span><span class="token punctuation">(</span><span class="token number">8000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">err</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">return</span> <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'something bad happened'</span><span class="token punctuation">,</span> err<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">server is listening on </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span><span class="token number">8000</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Czy jest o wiele gorzej? To wciąż w miarę czytelny kod, choć zapewne widzisz sporą różnicę na korzyść Expressu.</p>
<h3 id="271-wprowadzenie-do-expressa-podsumowanie">Podsumowanie</h3>
<p>Express jest stosunkowo przyjazny w obsłudze. Nasza mała aplikacja działa naprawdę dobrze, a sam kod jest przejrzysty. To jedne z zalet tego frameworka – łatwość w obsłudze i czytelność.</p>

                        </div>
                    </div>
                                        <div class="card-block submodule-footer clearfix  completed ">
                                                <small>Jeśli masz wątpliwości do powyższego materiału, to - zanim zatwierdzisz - zapytaj na czacie :)</small>
                                                <div class="clearfix">
                                                                                <button class="btn  btn-primary "><i class="fa fa-check"></i><span>Zapoznałe(a)m się!</span></button>
                                                                                                    </div>
                    </div>
                </section>
                                    
                <section id="submodule-1117" class="card submodule completed" data-bootcamp-user-submodule-id="661004">
                <!-- klasy dla section: completed current comments -->
                    <div class="card-block submodule-header clearfix">
                        <i class="fa fa-check-circle-o fa-2x"></i>
                        <i class="fa fa-play-circle-o fa-2x"></i>
                        <i class="fa fa-exclamation-circle fa-2x"></i>
                        <i class="fa fa-send-o fa-2x"></i>
                        <h2 class="bootcamp-submodule-name">27.2. <span>Serwowanie plików statycznych i middleware</span></h2>
                                            </div>
                    <div class="card-block">
                        <div class="submodule-content">
                            <p>Nasza aplikacja z pierwszego modułu była niezwykle prymitywna, więc teraz trochę ją rozwiniemy. Przy okazji poznamy kolejne możliwości oferowane przez Express.</p>
<h3 id="272-serwowanie-plikow-statycznych-i-middleware-serwowanie-plikow-statycznych">Serwowanie plików statycznych</h3>
<p>Zacznijmy od rozwinięcia treści naszych stron. Sam nagłówek to raczej za mało, prawda? Dodamy więc trochę tekstu do odpowiedzi każdego z endpointów.</p>
<p>W tym miejscu jednak od razu w głowie zapala się czerwona lampka. Dopóki zwracaliśmy sam nagłówek, spokojnie mogliśmy go trzymać bezpośrednio w pliku <code>server.js</code>. Przechowywanie tam większej treści nie ma jednak większego sensu – skrypt niepotrzebnie by się rozrósł, edycja plików stałaby się koszmarem, a ponadto każda ze stron powinna mieć przecież całą semantyczną strukturę.</p>
<p>Na szczęście Express zadbał o to, by nam pomóc. Treść HTML możemy trzymać w zewnętrznych plikach, a następnie zwrócić je pod danym endpointem za pomocą przyjaznej metody <code>sendFile</code>.</p>
<p>Jej użycie jest następujące:</p>
<pre class=" language-js"><code class=" language-js">app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'link'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">sendFile</span><span class="token punctuation">(</span><span class="token string">'filename-path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>To zaskakująco proste, prawda?</p>
<h4>Rozwijamy podstrony</h4>
<p>Czas wykorzystać nową wiedzę w praktyce!</p>
<p>Zacznij od stworzenia katalogu <code>views</code> – to tam będziemy trzymać nasze pliki HTML. Oczywiście nazwa folderu jest dowolna. To, gdzie Express będzie szukał danego pliku, zależy po prostu od ścieżki, którą wskażemy.</p>
<pre class=" language-markup"><code class=" language-markup">mkdir views</code></pre>
<p>Następnie utwórz pięć nowych plików, po jednym dla każdego endpointu.</p>
<pre class=" language-markup"><code class=" language-markup">touch views/index.html views/about.html views/contact.html views/info.html views/history.html</code></pre>
<p>Teraz wypełnij je następującą treścią:</p>
<p><em>index.html</em></p>
<pre class=" language-html"><code class=" language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span> <span class="token attr-name">dir</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ltr<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Home<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>Home<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>Welcome to my page!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span></code></pre>
<p><em>about.html</em></p>
<pre class=" language-html"><code class=" language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span> <span class="token attr-name">dir</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ltr<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>About<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>About<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>I'm a very skillful programmer. Nice to meet you.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span></code></pre>
<p><em>contact.html</em></p>
<pre class=" language-html"><code class=" language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span> <span class="token attr-name">dir</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ltr<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Contact<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>Contact<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>Send me an email at programmer@example.com<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span></code></pre>
<p><em>info.html</em></p>
<pre class=" language-html"><code class=" language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span> <span class="token attr-name">dir</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ltr<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Info<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>Info<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>I will put here all my accomplishments. Stay tuned!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span></code></pre>
<p><em>history.html</em></p>
<pre class=" language-html"><code class=" language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span> <span class="token attr-name">dir</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ltr<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>History<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>History<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>Page not yet available... Give me more time, folks.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span></code></pre>
<p>Nadszedł czas na odpowiednie zmiany w <code>server.js</code>. Nie chcemy już zwracać samych nagłówków, teraz będą to całe pliki!</p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">sendFile</span><span class="token punctuation">(</span><span class="token string">'./views/index.html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/about'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">sendFile</span><span class="token punctuation">(</span><span class="token string">'./views/about.html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/contact'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">sendFile</span><span class="token punctuation">(</span><span class="token string">'./views/contact.html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/info'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">sendFile</span><span class="token punctuation">(</span><span class="token string">'./views/info.html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/history'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">sendFile</span><span class="token punctuation">(</span><span class="token string">'./views/history.html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">listen</span><span class="token punctuation">(</span><span class="token number">8000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'Server is running on port: 8000'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>I... nie działa... Serwer, zamiast treści zaczął wyrzucać błąd – <code>path must be absolute or specify root to res.sendFile</code>. O co chodzi?</p>
<p>To, że serwer został uruchomiony w Twoim katalogu projektu, wcale nie oznacza, że chcesz, aby szukał plików właśnie tam. <strong>Express wymaga od nas ustalenia dokładnej ścieżki do pliku</strong>. Co mamy tutaj na myśli? Jeśli Twój folder projektu to np. <code>C:\Kodilla\Express</code>, to dokładną ścieżką do <code>index.html</code> byłoby  <code>C:\Kodilla\Express\views\index.html</code>, a dla <code>about.html</code> – <code>C:\Kodilla\Express\views\about.html</code>.</p>
<p>Czy to oznacza, że musimy wpisywać aż tak długie ścieżki? Przecież nie byłoby to dobrym pomysłem. Zwykła zmiana lokalizacji naszego projektu powodowałaby potrzebę modyfikacji każdego z linków... Po raz kolejny Express nie zostawia nas bez pomocy i proponuje użycie wbudowanego w Node'a modułu <code>path</code>. Pamiętasz go? Był już przez nas używany.</p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">sendFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token method function property-access">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'/views/index.html'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token spread operator">...</span></code></pre>
<p>Jak to działa?</p>
<pre class=" language-js"><code class=" language-js">path<span class="token punctuation">.</span><span class="token method function property-access">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'/views/index.html'</span><span class="token punctuation">)</span></code></pre>
<p>Metoda <code>path.join</code> stara się odpowiednio "skleić" ścieżkę bazową ze ścieżką docelową. Np. <code>path.join('C:/Kodilla/Test' + '/views/index.html)</code> powinno dać nam w rezultacie <code>C:/Kodilla/Test/views/index.html</code>. Natomiast stała <code>__dirname</code> zwraca adres aktualnej ścieżki. Dzięki niej nie będziemy musieli wpisywać, że skrypt aktualnie znajduje się np. w lokalizacji <code>C:\Kodilla\Test</code>, tylko ustali to za każdym razem sam Node.js. W takiej sytuacji zmiana lokalizacji projektu nie będzie nam straszna. Node po prostu zwróci pod <code>__dirname</code> nową ścieżkę i skrypt wciąż będzie działał.</p>
<p>Powyższy kod możemy więc rozumieć jako rozkaz: znajdź plik <code>index.html</code> w folderze <code>views</code>, przy czym zacznij szukać w katalogu, w którym odpalono skrypt.</p>
<p>Wyposażeni w nową wiedzę możemy zmodyfikować nasz kod.</p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">sendFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token method function property-access">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'/views/index.html'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/about'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">sendFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token method function property-access">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'/views/about.html'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/contact'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">sendFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token method function property-access">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'/views/contact.html'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/info'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">sendFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token method function property-access">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'/views/info.html'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/history'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">sendFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token method function property-access">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'/views/history.html'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">listen</span><span class="token punctuation">(</span><span class="token number">8000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'Server is running on port: 8000'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Czy nie ma jakiejś prostszej drogi? Nie moglibyśmy zdefiniować wszystkiego raz, globalnie?</p>
<p>Owszem, istnieje taka możliwość, ale będzie nam potrzebna funkcjonalność <em>middleware'u</em>. Opowiemy o niej dosłownie za chwilę.</p>
<p>Na razie sprawdź, czy skrypt zaczął ponownie działać. Powinien dać nam następujący efekt:</p>
<a href="./Moduł_ 27. Express – własny serwer HTTP_files/Express3.gif" class="img-modal-group"><img src="./Moduł_ 27. Express – własny serwer HTTP_files/Express3.gif" alt="image" style="width: auto;"></a>
<h3 id="272-serwowanie-plikow-statycznych-i-middleware-middleware">Middleware</h3>
<img src="./Moduł_ 27. Express – własny serwer HTTP_files/Middleware.png" class="img-inline img-right">
<p>Czym jest middleware? Najprościej mówiąc, <strong>to funkcjonalność pośrednicząca, która "wpycha się" pomiędzy rozpoczęcie a zakończenie jakiegoś procesu</strong>. Gdy poznawaliśmy Reduksa, mówiliśmy o Redux Thunk. On też pełnił właśnie taką rolę pośrednicząca. Wchodził pomiędzy uruchomienie funkcji w komponencie a dispatchowanie akcji i pozwalał na oddalenie tej operacji w czasie (pomagało nam to głównie przy wywołaniach asynchronicznych).</p>
<p>Żeby łatwiej było Ci zrozumieć, o czym mowa, zaczniemy od przykładu.</p>
<p>Powiedzmy, że zbudowaliśmy aplikację sklepu internetowego. Nie jest ona bardzo zaawansowana, ale posiada kilka podstron:</p>
<ul>
<li><code>/</code>– strona główna, dostępna dla wszystkich.</li>
<li><code>/cart</code> – strona koszyka, również widoczna dla każdego.</li>
<li><code>/admin/products</code> – strona z katalogiem produktów, dostępna tylko dla admina.</li>
<li><code>/admin/payments</code> – strona z rachunkami, również widoczna tylko dla admina.</li>
</ul>
<p>Pomysł jest oczywiście bardzo prosty. Niektóre podstrony są przygotowane dla klientów, pozostałe służą administrowaniu serwisem i powinny być dostępne tylko dla zalogowanych właścicieli. Jak mógłby wyglądać kod serwera takiej strony?</p>
<p>Wykorzystując naszą dotychczasową wiedzę, na pewno zbudowalibyśmy coś takiego:</p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">sendFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token method function property-access">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'/views/home.html'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/cart'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">sendFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token method function property-access">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'/views/cart.html'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/admin/products'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">if</span><span class="token punctuation">(</span><span class="token function">isAdmin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> res<span class="token punctuation">.</span><span class="token method function property-access">sendFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token method function property-access">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'/views/admin/products.html'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">else</span> res<span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token string">'Go away!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/admin/payments'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">if</span><span class="token punctuation">(</span><span class="token function">isAdmin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> res<span class="token punctuation">.</span><span class="token method function property-access">sendFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token method function property-access">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'/views/admin/payments.html'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">else</span> res<span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token string">'Go away!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token spread operator">...</span></code></pre>
<p>Oczywiście funkcja <code>isAdmin()</code> jest umowna. Załóżmy, że sprawdza ona, czy użytkownik jest administratorem i zwraca <code>true</code> (jeśli tak) lub <code>false</code> (jeśli nie).</p>
<p>Czy ten kod ma sens? Oczywiście. Widzisz jednak, że podobnie jak w poprzednim rozdziale, mamy problem z powtarzalnością. W każdym endpoincie <code>/admin/...</code> sprawdzamy, czy użytkownik jest administratorem. Nie jest to przeszkodą, póki mamy ich niewiele, ale dla większej liczby mogłoby stać się bardziej uciążliwe.</p>
<p>Nie da się jakoś tego skrócić? W końcu widać, że endpointy "adminowe" mają część wspólną – przedrostek <code>/admin</code>. Nie można by więc w jakiś sposób zmusić Expressa, aby sprawdzał rolę użytkownika dla każdego linku rozpoczynającego się w taki sposób? Odpowiedź jest pozytywna – da się!</p>
<h4>Metoda <code>app.use</code></h4>
<p>Wyjściem jest oczywiście wcześniej wspomniany pomysł z middleware. Express dostarcza nam specjalną metodę o nazwie <code>use</code>, która potrafi "wepchnąć się" pomiędzy otrzymane od klienta żądania a zwrócenie odpowiedzi i wykonać jakieś dodatkowe operacje. Co ważne, sami wybieramy, w jakiej sytuacji mają się one wykonywać.
Możemy więc przed zwróceniem odpowiedzi pobrać coś z bazy danych albo sprawić, że każde żądanie przeszuka pliki w <code>__dirname</code>. Będziemy mogli również ustawiać operacje tylko dla wybranej grupy endpointów i jest to coś, czego potrzebujemy w przykładzie ze sklepem. Ustalimy, że wszystkie endpointy rozpoczynające się na <code>/admin</code> uruchomią najpierw funkcję sprawdzenia roli, i dopiero gdy potwierdzimy, że użytkownik jest administratorem, middleware uruchomi instrukcję z endpointu.</p>
<p>Podsumujmy więc, jak wyglądałoby to dokładnie w przypadku naszego sklepu.</p>
<p>Obecna sytuacja prezentuje się następująco:</p>
<a href="./Moduł_ 27. Express – własny serwer HTTP_files/Middleware2.png" class="img-modal-group"><img src="./Moduł_ 27. Express – własny serwer HTTP_files/Middleware2.png" alt="image" style="width: auto;"></a>
<p>Proces jest bardzo prosty. Użytkownik wysyła <strong>request</strong>, serwer szuka odpowiedniego endpointu i zwraca <strong>response</strong>.</p>
<p>Jak będzie wyglądał ten proces po zmianach i wprowadzeniu middleware'u?</p>
<a href="./Moduł_ 27. Express – własny serwer HTTP_files/Middleware3.png" class="img-modal-group"><img src="./Moduł_ 27. Express – własny serwer HTTP_files/Middleware3.png" alt="image" style="width: auto;"></a>
<p>Wciąż po <strong>requeście</strong> nastąpi <strong>response</strong>, ale pomiędzy nimi serwer uruchomi nasz <strong>middleware</strong>, który w założeniu sprawdzi, czy link nie jest przypadkiem jednym z "adminowych". Jeśli tak, wtedy ustali, czy jesteśmy zalogowani i zdecyduje o przekierowaniu nas do endpointu <code>admin/payments</code> lub <code>admin/products</code>, albo po prostu powie "Go away!".</p>
<p>Oczywiście to, co znajdzie się w middleware, zależy tylko i wyłącznie od nas. Na dobrą sprawę, jesteśmy w stanie zrobić tam wszystko. Moglibyśmy nawet ustalić, że nie ważne, jaki link użytkownik wybrał, jego endpoint i tak będzie losowy.</p>
<p>Podsumowując, <strong>middleware w Expressie to po prostu pośrednik pomiędzy rozpoczęciem żądania a zwróceniem odpowiedzi klientowi</strong>.</p>
<p>Jeśli czujesz, że nie do końca jeszcze rozumiesz cały zamysł, nie przejmuj się. Gdy tylko wykorzystamy middleware w praktyce, przekonasz się, że jest stosunkowo łatwy w użyciu.</p>
<h4>Czas na praktykę!</h4>
<p>Jak to wszystko wyglądałoby w kodzie?</p>
<p>Metody <code>.use</code> używa się następująco:</p>
<pre class=" language-js"><code class=" language-js">app<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// some middleware operations</span>
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Parametr <code>path</code> to ścieżka, którą chcemy "wychwycić". Ustalenie tu np. wartości <code>/admin</code> informowałoby, że wybieramy requesty zaczynające się właśnie takim przedrostkiem. Gdybyśmy wstawili <code>/</code>, wtedy pod uwagę brane byłyby wszystkie linki (bo w końcu każdy zaczyna się na <code>/</code>). W sytuacji, gdy zależy nam na wszystkich requestach, nie musimy pisać nawet tej wartości. Wystarczy, że zrezygnujemy z tego parametru w ogóle:</p>
<pre class=" language-js"><code class=" language-js">app<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// some middleware operations</span>
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Funkcja callback, którą widzisz dalej, to po prostu instrukcje, które mają się wykonać, jeśli Express uzna, że dany request pasuje (czyli, że np. faktycznie zaczyna się od <code>/admin</code>).</p>
<pre class=" language-js"><code class=" language-js"><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// some middleware operations</span>
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Pojawiają się tutaj aż trzy parametry. <code>req</code> i <code>res</code> to po prostu obiekt żądania i odpowiedzi. Mamy do nich taki sam dostęp jak w endpointach. To ważna opcja, bo dzięki temu możemy zwrócić coś klientowi już na tym etapie i w ogóle nie uruchamiać kodu spod samego endpointu.</p>
<p>Na przykład:</p>
<pre class=" language-js"><code class=" language-js">app<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span><span class="token string">'/forbidden-area'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token string">'Go away!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Pozostaje jeszcze parametr <code>next</code>, który – jak widać na przykładzie – jest jakąś funkcją. Jaką dokładnie? <strong>Taką, która w normalnych warunkach, bez middleware, byłaby wykonywana pod tym linkiem</strong>.</p>
<p>Spójrzmy na taki kod:</p>
<pre class=" language-js"><code class=" language-js">app<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span><span class="token string">'/home'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'Hello!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>W przypadku linku <code>/home</code> skrypt powoduje pokazanie w konsoli tekstu <code>Hello</code>. Następnie serwer rusza dalej i przeszukuje plik w celu znalezieniu samego konkretnego endpointu.</p>
<p>Co stałoby się, gdybyśmy jednak nie użyli tej funkcji?</p>
<pre class=" language-js"><code class=" language-js">app<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span><span class="token string">'/home'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'Hello!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>W konsoli zobaczylibyśmy tekst <code>Hello</code> i na tym etapie serwer zakończyłby poszukiwania. Nawet gdyby istniał konkretny pasujący endpoint i znajdował się dalej w kodzie, serwer i tak by go nie uruchomił.</p>
<p>Jak widzisz, funkcja <code>next</code> daje nam kontrolę nad dalszym działaniem serwera. To bardzo przydatna opcja.</p>
<h4>Aplikacja sklepu po zmianach</h4>
<p>Jak wyglądałby kod naszego przykładowego sklepu po zmianach?</p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span><span class="token string">'/admin'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">if</span><span class="token punctuation">(</span><span class="token function">isAdmin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">else</span> res<span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token string">'Go away!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">sendFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token method function property-access">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'/views/home.html'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/cart'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">sendFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token method function property-access">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'/views/cart.html'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/admin/products'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">sendFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token method function property-access">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'/views/admin/products.html'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/admin/payments'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">sendFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token method function property-access">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'/views/admin/payments.html'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Nas interesuje zwłaszcza ten kawałek:</p>
<pre class=" language-js"><code class=" language-js">app<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span><span class="token string">'/admin'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword control-flow">if</span><span class="token punctuation">(</span><span class="token function">isAdmin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">else</span> res<span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token string">'Go away!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Jak on działa? Pewnie już się domyślasz. Nasz middleware "wyłapuje" wszystkie żądania, w których link zaczyna się na <code>/admin</code> (czyli np. <code>admin/payments</code>). Następnie, jeśli na taki link trafi, sprawdza, czy jesteśmy administratorem. Jeśli tak, pozwala serwerowi działać dalej i ten spokojnie próbuje znaleźć już konkretny endpoint. Jeśli jednak nie, kończymy odpowiedź, zwracając klientowi tekst <code>Go away!</code>.</p>
<p>Co nam to dało? Teraz w endpointach "adminowych" nie musimy już sprawdzać roli użytkownika. Mamy pewność, że skoro serwer je odpala, wcześniej poprawnie przeszliśmy proces sprawdzenia w middleware.</p>
<h3 id="272-serwowanie-plikow-statycznych-i-middleware-powrot-do-pracy">Powrót do pracy</h3>
<p>Wiemy już jak działa middleware, do czego i w jaki sposób możemy wykorzystać <code>use</code>. Czas więc wrócić do naszej aplikacji i spróbować naprawić to, co nam nie pasuje.
Chcemy w jakiś sposób zniwelować potrzebę ciągłego odwoływania się do <code>__dirname</code>. Oczywiście pomoże nam w tym middleware.</p>
<pre class=" language-js"><code class=" language-js">app<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method-variable function-variable method function property-access">show</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token method function property-access">sendFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token method function property-access">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/views/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Spójrz na powyższy kod. Zacznijmy od ustalenia, na jakie requesty zadziała. Skoro nie podano żadnej ścieżki, <strong>bierzemy pod uwagę wszystkie linki</strong>. Nieważne, czy wejdziemy pod <code>/</code>, <code>contact</code> czy <code>about</code> – na pewno ten middleware się uruchomi.</p>
<p>Co dokładnie się w nim dzieje?</p>
<pre class=" language-js"><code class=" language-js">res<span class="token punctuation">.</span><span class="token method-variable function-variable method function property-access">show</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token method function property-access">sendFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token method function property-access">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/views/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>
<p>Przede wszystkim dodajemy do obiektu <code>res</code> nową metodę! Ma ona przyjmować nazwę pliku, a następnie zwracać go za pomocą <code>sendFile</code>. Co ważne jednak dobiera się do niego przy użyciu dokładnej ścieżki. Otrzymujemy więc funkcję, która potrzebuje jedynie nazwy pliku, a daje nam to, co wcześniej osiągaliśmy znacznie dłuższym kodem.</p>
<p>Przykładowo <code>res.show('about.html')</code> powinno zwracać klientowi <code>about.html</code>. Jest to znacznie łatwiejszy zapis, a ma taki sam efekt jak <code>res.sendFile(path.join(__dirname, '/views/about.html'));</code>.</p>
<p>Oczywiście <code>next</code> służy do tego, co zawsze – pozwala serwerowi ruszyć dalej w poszukiwaniu endpointu. Co ważne, gdy już go znajdzie, nasza nowa metoda <code>show</code> stanie się dostępna w obiekcie <code>res</code> i będziemy mogli wykorzystać ją zamiast <code>sendFile</code>!</p>
<p>Nasz kod zmieni się więc następująco:</p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method-variable function-variable method function property-access">show</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token method function property-access">sendFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token method function property-access">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/views/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">show</span><span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/about'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">show</span><span class="token punctuation">(</span><span class="token string">'about.html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/contact'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">show</span><span class="token punctuation">(</span><span class="token string">'contact.html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/info'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">show</span><span class="token punctuation">(</span><span class="token string">'info.html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/history'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">show</span><span class="token punctuation">(</span><span class="token string">'history.html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">listen</span><span class="token punctuation">(</span><span class="token number">8000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'Server is running on port: 8000'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Skąd mamy pewność, że na etapie znalezienia endpointu, funkcja <code>res.show</code> będzie już przygotowana? Nasz middleware jest w kodzie przed endpointami, więc wykona się jako pierwszy. Dodatkowo wyłapujemy wszystkie możliwe linki, zatem nie musimy się bać, że któryś endpoint nie będzie miał dostępu do tej metody.</p>
<h3 id="272-serwowanie-plikow-statycznych-i-middleware-wylapujemy-wadliwe-linki">Wyłapujemy wadliwe linki</h3>
<p>Co ciekawe, metoda <code>use</code> może przydać się też do odpowiedniego obsłużenia niepoprawnych requestów! Wystarczy, że wstawimy nasz middleware po endpointach:</p>
<pre class=" language-js"><code class=" language-js"><span class="token spread operator">...</span>

app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/info'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">show</span><span class="token punctuation">(</span><span class="token string">'info.html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/history'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">show</span><span class="token punctuation">(</span><span class="token string">'history.html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token string">'404 not found...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>
<p>Jak to działa? Jeśli wpiszemy taki link, który rzeczywiście ma pasujący endpoint na serwerze, klient zobaczy właściwą odpowiedź (plik HTML), a serwer skończy na tym etapie proces poszukiwania. Mimo tego, że middleware na końcu nie ma podanej ścieżki i jest w stanie wyłapać każdy request, zwyczajnie nigdy nie zostanie nawet uruchomiony.</p>
<p>Jeśli jednak serwer nie znajdzie pasującego endpointu, to w końcu trafi do middleware i pokaże klientowi odpowiedź <code>404 not found</code>. Tym samym stworzyliśmy funkcjonalność wyłapującą wszystkie niepoprawne zapytania. Jeśli ktoś wpisze <code>/info</code>, to zwrócimy mu treść pliku <code>info.html</code>, ale jeśli poda link, którego nie obsługujemy – zobaczy przygotowany przez nas komunikat. Na pewno będzie wyglądał on lepiej niż domyślne <code>Cannot GET /</code>.</p>
<div class="bc-note alert-info">
<h4 class="alert-heading text-center">Kody odpowiedzi</h4>
<p>Idea kodów odpowiedzi nie jest Ci zapewne obca. Była już o nich mowa w module dotyczącym AJAX-u i API. Pamiętasz kod <strong>404</strong> zwracany w przypadku braku zasobu lub błędnego linku albo <strong>500</strong> informujący o błędzie serwera? Właśnie o tym mowa.</p>
<p>Kiedy sami programujemy serwer, decydujemy jaki kod odpowiedzi zwrócimy klientowi – będzie to <strong>200</strong> sugerujące, że wszystko gra, czy może coś innego. W przykładzie powyżej zwracamy klientowi kod <strong>404</strong>, informujący o błędnej ścieżce. Stąd też użycie wbudowanej w Express funkcji <code>status</code>.</p>
<p>Dlaczego nie ustawialiśmy takiego kodu do wcześniejszych endpointów? Ponieważ tam odpowiedź była jak najbardziej zgodna z oczekiwaniami klienta, a kodem pasującym byłby <strong>200</strong>. Jest on <strong>domyślną odpowiedzią obiektu <code>response</code></strong>, o ile nie ustalimy inaczej.</p>
</div>
<p>Swoją drogą, na pewno udało Ci się zauważyć, że tym razem brakuje funkcji <code>next</code>. Pominęliśmy ją z prostego powodu. Nie ma sensu odpalania kolejnej funkcji, skoro nasz endpoint jest już ostatnim elementem aplikacji.</p>
<p>To trochę inny przykład wykorzystania middleware'u, ale jak widzisz równie przydatny.</p>
<p>Nasza aplikacja powinna wyglądać teraz następująco:</p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method-variable function-variable method function property-access">show</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token method function property-access">sendFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token method function property-access">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/views/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">show</span><span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/about'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">show</span><span class="token punctuation">(</span><span class="token string">'about.html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/contact'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">show</span><span class="token punctuation">(</span><span class="token string">'contact.html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/info'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">show</span><span class="token punctuation">(</span><span class="token string">'info.html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/history'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">show</span><span class="token punctuation">(</span><span class="token string">'history.html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token string">'404 not found...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token method function property-access">listen</span><span class="token punctuation">(</span><span class="token number">8000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'Server is running on port: 8000'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<div class="bc-note alert-info">
<h4 class="alert-heading text-center"><code>next()</code>, nie tylko w middleware</h4>
<p>Dotychczas pokazywaliśmy użycie <code>next</code> wyłącznie przy wykorzystaniu funkcji <code>use</code>. Warto wiedzieć, że tego parametru możemy używać również w samych endpointach.</p>
<pre class=" language-js"><code class=" language-js">app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/about'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token string">'About me'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">//do something after, disconnect with DB for example</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>
<p>Kod powyżej zadziałaby tak, że wejście w link <code>/about</code> nie tylko pokazałoby treść <code>About me</code>, ale kazałoby jeszcze  działać serwerowi dalej. Ten szukałby więc kolejnego pasującego endpointu i trafiłby w końcu do... naszego middleware na samym dole.</p>
<p>Jak można zastosować ten pomysł? Moglibyśmy np. na koniec requestu czyścić w ten sposób jakieś dane albo rozłączać się z bazą danych.</p>
</div>
<h3 id="272-serwowanie-plikow-statycznych-i-middleware-dodajemy-zewnetrzne-zasoby">Dodajemy zewnętrzne zasoby</h3>
<p>Do tej pory nasze podstrony były niezwykle proste. Co się jednak stanie, gdy zaczniemy tworzyć o wiele bardziej skomplikowane witryny, np. z rozbudowanym CSS i wykorzystaniem obrazków? Jak Express poradzi sobie z dużymi plikami HTML? Sprawdźmy!</p>
<p>Do celów testowych edytujemy plik <code>index.html</code>. Obecnie wygląda on tak:</p>
<pre class=" language-html"><code class=" language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span> <span class="token attr-name">dir</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ltr<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Home<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>Home<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>Welcome to my page!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span></code></pre>
<p>Dodamy do niego linkowanie arkusza stylów oraz obrazka.</p>
<pre class=" language-html"><code class=" language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span> <span class="token attr-name">dir</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ltr<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Home<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/style.css<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>Home<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>Welcome to my page!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>test.png<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span></code></pre>
<p>Nic specjalnego, ale jak widzisz, linkujemy do kolejnych zasobów. Wydaje się, że to jak najbardziej sensowne.</p>
<p>Teraz czas na stworzenie tych plików. Dodaj do folderu projektu <code>style.css</code> z następującą zawartością:</p>
<pre class=" language-css"><code class=" language-css"><span class="token selector">h1</span> <span class="token punctuation">{</span>
  <span class="token property">font-weight</span><span class="token punctuation">:</span> lighter<span class="token punctuation">;</span>
  <span class="token property">font-style</span><span class="token punctuation">:</span> italic<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>Następnie w tym samym folderze umieść dowolny obrazek o nazwie <code>test.png</code>.</p>
<p>Powinno działać? Zobaczymy! Zrestartuj serwer i sprawdź.</p>
<a href="./Moduł_ 27. Express – własny serwer HTTP_files/Express4.png" class="img-modal-group"><img src="./Moduł_ 27. Express – własny serwer HTTP_files/Express4.png" alt="image" style="width: auto;"></a>
<p>Okazuje się, że nie działa ani obrazek, ani arkusz... Sprawdźmy narzędzia developerskie i zakładkę <strong>Network</strong>.</p>
<a href="./Moduł_ 27. Express – własny serwer HTTP_files/Express5.png" class="img-modal-group"><img src="./Moduł_ 27. Express – własny serwer HTTP_files/Express5.png" alt="image" style="width: auto;"></a>
<p>Nasze zasoby nie zostały znalezione, a serwer zwrócił kod błędu 404. Możesz wpisać ścieżkę do pliku bezpośrednio w przeglądarce (<code>http://localhost/style.css</code>), a i tak dostaniesz informację, że ona nie istnieje.</p>
<p>Dlaczego? Przecież wydaje się, że podaliśmy prawidłowe nazwy pliku... Same zasoby też są obecne na dysku w tym samym folderze, w którym uruchamiamy serwer.</p>
<p>Odpowiedź jest prosta. <strong>To, że serwer jest uruchamiany w jakimś folderze nie oznacza, że automatycznie daje klientowi dostęp do plików w nim obecnych</strong>. Wbrew pozorom, jest to bardzo dobra informacja. Jeśli byłoby inaczej, równie dobrze, jak plik <code>style.css</code>, klient mógłby otworzyć <code>server.js</code> – wystarczyłoby wejść w link <code>http://localhost/server.js</code>. Tego byśmy nie chcieli, bo przecież często są tam informacje poufne, jak na przykład hasła do bazy danych, wykorzystywane przy połączeniu.</p>
<p>Oczywiście serwer ma wgląd do tych plików, jednak domyślnie nie udostępnia ich klientom.</p>
<p>Możemy jednak stworzyć odpowiednie endpointy i ustalić np. że link <code>http://localhost/style.css</code> faktycznie będzie zwracał plik <code>style.css</code>. Tym właśnie zaraz się zajmiemy!</p>
<div class="bc-note alert-info">
<h4 class="alert-heading text-center">Warto zapamiętać</h4>
<p>Utworzenie serwera w danym folderze nie daje klientowi automatycznie dostępu do plików w nim zawartych. <strong>Serwer udostępnia tylko takie ścieżki (endpointy), jakie sami w nim podamy</strong>.</p>
</div>
<h4>Przygotowujemy obsługę zasobów</h4>
<p>Do dzieła!</p>
<p>W tym momencie obsługujemy następujące endpointy:</p>
<ul>
<li><code>/</code></li>
<li><code>/about</code></li>
<li><code>/contact</code></li>
<li><code>/info</code></li>
<li><code>/history</code></li>
</ul>
<p>Gdy wpiszemy jakikolwiek inny link, serwer zwróci nam komunikat <code>404 not found...</code>, o co dba nasz middleware na końcu:</p>
<pre class=" language-js"><code class=" language-js">app<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token string">'404 not found...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span></code></pre>
<p>Zatem, co dzieje się, kiedy chcemy, aby nasz serwer połączył się z plikiem <code>http://localhost:8000/style.css</code> albo <code>http://localhost:8000/test.png</code>? Otrzymujemy właśnie taki komunikat.</p>
<a href="./Moduł_ 27. Express – własny serwer HTTP_files/Express6.png" class="img-modal-group"><img src="./Moduł_ 27. Express – własny serwer HTTP_files/Express6.png" alt="image" style="width: auto;"></a>
<p>Teraz już wiemy, w czym rzecz. Skoro serwer nie może znaleźć endpointu <code>style.css</code>, to trafia do middleware na końcu i zwraca komunikat. Tak samo sytuacja ma się z <code>test.png</code>.</p>
<p>Musimy więc po prostu przygotować te endpointy:</p>
<pre class=" language-js"><code class=" language-js">app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/style.css'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">sendFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token method function property-access">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'/style.css'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/test.png'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">sendFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token method function property-access">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'/test.png'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Od tego momentu, pod <code>/style.css</code> serwer będzie faktycznie zwracał nasz plik <code>style.css</code>, a pod <code>/test.png</code> obrazek <code>test.png</code>. Oczywiście równie dobrze endpoint <code>/style.css</code> mógłby kierować np. do pliku o nazwie <code>main.css</code>. To w końcu my decydujemy o tym, co pokaże się pod danym linkiem.</p>
<p>Wszystko już działa i jak widzisz nie było to takie trudne. Zapewne zdajesz sobie jednak sprawę, że to rozwiązanie bardzo czasochłonne. Często używamy o wiele większej ilości plików zewnętrznych, a ustawianie dla każdego z osobna nowego endpointu nie byłoby najlepszym pomysłem.</p>
<p>Na szczęście wiesz już, że w takich sytuacjach może nam pomóc middleware!</p>
<h4>Wbudowany middleware <code>express.static</code></h4>
<p>Co najlepsze, nie musimy nawet pisać go sami. Express daje kilka gotowych funkcji middleware, odpowiadających na najważniejsze potrzeby. Jedną z nich jest właśnie <code>express.static</code>, która pozwala udostępniać całe foldery.</p>
<p>Wystarczyłoby więc dodać taki kod:</p>
<pre class=" language-js"><code class=" language-js">app<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token method function property-access">static</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>...a każdy link <code>style.css</code>, <code>test.png</code>, czy nawet <code>package.json</code>, byłby zwracany poprawnie przez serwer! W ten sposób udostępniamy całą zawartość&nbsp;katalogu naszego projektu, bowiem <code>__dirname</code> to jego ścieżka.</p>
<p>Oczywiście nie jest to najlepszym rozwiązaniem, bo oddajemy w ten sposób również dostęp do <code>server.js</code>. Dlatego częściej tworzy się i udostępnia jedynie specjalny katalog na pliki, które będą wykorzystywane przy renderowaniu widoku. Folder ten można nazwać&nbsp;np. <code>public</code>.</p>
<pre class=" language-js"><code class=" language-js">app<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token method function property-access">static</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token method function property-access">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'/public'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<div class="bc-note alert-info">
<h4 class="alert-heading text-center">Jak <code>express.static</code> działa "pod maską"?</h4>
<p>Tak naprawdę dość prosto. Jego praca jest równoznaczna z ręcznym dodawaniem endpointów do plików, przy czym nazwa ścieżki jest dokładnie taka sama, jak ścieżka do pliku względem udostępnianego folderu.</p>
<p>Np. dla katalogu <code>public</code> z taką zawartością:</p>
<pre class=" language-markup"><code class=" language-markup">style.css
script.js
/images
  logo.png</code></pre>
<p><code>app.use(express.static(path.join(__dirname, '/public')));</code> spowodowałoby obsługę następujących endpointów:</p>
<pre class=" language-js"><code class=" language-js">http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token operator">:</span><span class="token number">8000</span><span class="token operator">/</span>style<span class="token punctuation">.</span><span class="token property-access">css</span>
http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token operator">:</span><span class="token number">8000</span><span class="token operator">/</span>script<span class="token punctuation">.</span><span class="token property-access">js</span>
http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>localhost<span class="token operator">:</span><span class="token number">8000</span><span class="token operator">/</span>images<span class="token operator">/</span>logo<span class="token punctuation">.</span><span class="token property-access">png</span></code></pre>
</div>
<p>W ramach ćwiczenia spróbuj teraz dokończyć naszą aplikację, a więc:</p>
<ol>
<li>Stwórz folder <code>public</code>.</li>
<li>Przenieś tam pliki <code>test.png</code> i <code>style.css</code>.</li>
<li>Usuń konkretne endpointy dla tych plików.</li>
<li>Dodaj middleware udostępniający cały katalog <code>public</code>. Oczywiście należy użyć tutaj wbudowanego <code>express.static</code>.</li>
</ol>
<p class="text-center">
  <span class="collapse-toggles">
    <a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#collapse-VYwE6s1XU-toggle" class="btn btn-primary collapsed" data-toggle="collapse">Pokaż gotowy kod</a>
    <a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#collapse-VYwE6s1XU-toggle" class="btn btn-primary collapsed" data-toggle="collapse">Ukryj gotowy kod</a>
  </span>
</p>
<div id="collapse-VYwE6s1XU-toggle" class="collapse">
<pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method-variable function-variable method function property-access">show</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token method function property-access">sendFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token method function property-access">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/views/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token method function property-access">static</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token method function property-access">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'/public'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">show</span><span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/about'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">show</span><span class="token punctuation">(</span><span class="token string">'about.html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/contact'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">show</span><span class="token punctuation">(</span><span class="token string">'contact.html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/info'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">show</span><span class="token punctuation">(</span><span class="token string">'info.html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/history'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">show</span><span class="token punctuation">(</span><span class="token string">'history.html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token string">'404 not found...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token method function property-access">listen</span><span class="token punctuation">(</span><span class="token number">8000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'Server is running on port: 8000'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
</div>
<h3 id="272-serwowanie-plikow-statycznych-i-middleware-posumowanie">Posumowanie</h3>
<p>Nasza aplikacja prawie nie zmieniła się z wyglądu. Nowością jest jedynie pokazywanie własnego komunikatu o błędzie w przypadku wejścia na nieistniejącą stronę i trochę więcej informacji. Modyfikacji dokonaliśmy natomiast "pod maską" – wykorzystaliśmy zewnętrzne pliki do wyświetlania treści, poznaliśmy koncepcję middleware i wykorzystaliśmy ją w praktyce. Mimo nowości skrypt mocno się nie skomplikował. Zwróć uwagę, że nasz serwer to zaledwie 40 linijek kodu.</p>

                        </div>
                    </div>
                                        <div class="card-block task-card">
                        <h3 id="272-serwowanie-plikow-statycznych-i-middleware-zadanie-szlifujemy-umiejetnosci">Zadanie: <span class="task-title">szlifujemy umiejętności</span></h3>
                        <div class="task-content">
                            <p>Jak dotąd, cały kod pisaliśmy razem, a teraz czas na Twoją indywidualną pracę. Co prawda, dawka wiedzy, którą dotychczas poznaliśmy, nie była duża, jednak i tak warto ją sobie utrwalić, zanim przejdziemy dalej.</p>
<p>Twoim zadaniem jest zbudowanie aplikacji/serwera, która będzie działać w następujący sposób:</p>
<ol>
<li>Wejście pod link <code>/</code> lub <code>home</code> spowoduje pokazanie się treści "Hello world".</li>
<li>Wejście pod link <code>/about</code> spowoduje pokazanie się treści "About me".</li>
<li>Wejście pod link <code>/user/settings</code> oraz <code>/user/panel</code> będzie powodować wyświetlenie informacji o potrzebie logowania. Należy tutaj wykorzystać middleware. Uwaga – nie ma potrzeby tworzenia konkretnych endpointów, w naszym przykładzie i tak nie pozwolimy na zalogowanie ;)</li>
<li>Wejście pod inny link niż wcześniej wspomniane powinno spowodować pokazanie obrazka "404 not found".</li>
</ol>
<p><strong>Uwaga</strong> – <strong>każda odpowiedź tekstowa ma być zwracana z pliku HTML</strong>, podobnie jak robiliśmy to w przykładzie z submodułu. Możesz wykorzystać nasz pomysł z dodawaną w middleware metodą <code>show</code>.</p>
<p>Dodatkowo, gdy link jest nieprawidłowy ("404 not found"), pokazywana strona powinna zwracać obrazek z komunikatem o nieznalezionej witrynie, najlepiej wykorzystać któryś z dostępnych na <a href="https://pixabay.com/images/search/not%20found/" target="_blank">tej stronie</a>. Co ważne, <strong>obrazek ma być ładowany lokalnie</strong>.</p>
<p>Możesz wzorować się na projekcie, który przygotowywaliśmy w tym submodule. Powinien być bardzo pomocny.</p>
<p>Jeśli potrzebujesz dokładniejszej instrukcji, możesz ją przeczytać poniżej. <strong>Najpierw spróbuj jednak wykonać to zadanie bez jej pomocy.</strong></p>
<p class="text-center">
  <span class="collapse-toggles">
    <a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#collapse-424wzKUs8m-toggle" class="btn btn-primary collapsed" data-toggle="collapse">Pokaż dokładną instrukcję</a>
    <a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#collapse-424wzKUs8m-toggle" class="btn btn-primary collapsed" data-toggle="collapse">Ukryj dokładną instrukcję</a>
  </span>
</p>
<div id="collapse-424wzKUs8m-toggle" class="collapse">
<ol>
<li>Stwórz nowy folder projektu. Wygeneruj w nim <code>package.json</code>, pobierz Express i stwórz plik <code>server.js</code>. Następnie wejdź do niego i zacznij edycję.</li>
<li>Rozpocznij od zaimportowania Expressu za pomocą <code>require</code>.</li>
<li>Następnie stwórz nowy serwer (na razie bez endpointów) i ustaw, na jakim porcie będzie nasłuchiwany. Dokładne wytłumaczenie, jak to zrobić, znajduje się w pierwszym submodule.</li>
<li>Zaimportuj <code>path</code> i przygotuj middleware, który zaoferuje nam funkcję do łatwego zwracania plików HTML (wykorzystaj ten, który pojawił się w już submodule).</li>
<li>Stwórz katalog <code>views</code> i dodaj do niego cztery pliki: <code>home.html</code> (z treścią "Hello world"), <code>about.html</code> (z treścią "About me"), <code>forbidden.html</code> (z treścią "You can't be here!") oraz <code>404.html</code> (z dowolnym obrazkiem o treści "404 not found").</li>
<li>Przygotuj endpointy <code>/</code>, <code>/home</code> i <code>/about</code>. Jako odpowiedź, mają one zwracać właściwe pliki z <code>views</code>.</li>
<li>Stwórz middleware (przed endpointami), który będzie działał na wszystkie requesty, których link zaczyna się na <code>/user/</code>. Powinien on zwracać treść pliku <code>forbidden.html</code>.</li>
<li>Na końcu, po endpointach, dodaj middleware, który będzie wyłapywał niepoprawne linki i zwracał treść pliku <code>404.html</code>.</li>
<li>Dodaj endpoint do obsługi pliku obrazkowego.</li>
</ol>
</div>

                        </div>
                    </div>
                                        <div class="card-block submodule-footer clearfix  completed ">
                                                <div class="clearfix">
                                                                                <a href="https://kodilla.com/pl/bootcamp-task/407/661004" target="_blank" class="btn btn-info-outline">Podgląd zadania</a>
                            <form target="_blank" class="form-inline project-link-form">
                                <div class="form-group">
                                    <input type="text" name="link" class="form-control" value="https://github.com/skwiryt/second-express">
                                </div>
                                <button type="submit" class="btn  btn-primary ">Wyślij link <i class="fa fa-check"></i></button>
                            </form>
                                                                                                    </div>
                    </div>
                </section>
                                    
                <section id="submodule-1118" class="card submodule completed" data-bootcamp-user-submodule-id="661005">
                <!-- klasy dla section: completed current comments -->
                    <div class="card-block submodule-header clearfix">
                        <i class="fa fa-check-circle-o fa-2x"></i>
                        <i class="fa fa-play-circle-o fa-2x"></i>
                        <i class="fa fa-exclamation-circle fa-2x"></i>
                        <i class="fa fa-send-o fa-2x"></i>
                        <h2 class="bootcamp-submodule-name">27.3. <span>Komunikacja z użytkownikiem</span></h2>
                                            </div>
                    <div class="card-block">
                        <div class="submodule-content">
                            <p>Na razie budowane przez nas serwery były bardzo statyczne – klient mógł odwiedzić tylko kilka stron i nie miał żadnej możliwości interakcji. W tym module postaramy się to zmienić.</p>
<p>Tak naprawdę ten temat nie jest dla Ciebie zbyt dużą nowością. Podczas kursu używaliśmy serwerów w ten sposób – wykonywaliśmy np. połączenia AJAXowe, które zależnie od parametrów w linku, zwracały Ci odpowiednie dane albo nawet dodawały nowe (requesty z metodą <code>POST</code>). Wtedy jednak nie tworzyliśmy takiego serwera sami, tylko korzystaliśmy z niego jako klient. Teraz postawimy się po drugiej stronie barykady.</p>
<p>Większą nowością może być za to przesyłanie danych bez użycia AJAX-u, w bardziej klasyczny sposób, bezpośrednio z formularzy. Prawdopodobnie częściej w swojej pracy będziesz korzystać z tej pierwszej opcji, warto jednak znać również inne możliwości.</p>
<h3 id="273-komunikacja-z-uzytkownikiem-nodemon-automatyczne-odswiezanie-zmian">Nodemon – automatyczne odświeżanie zmian</h3>
<p>Zanim przejdziemy do dzieła, poznamy narzędzie, które bardzo ułatwi nam pracę. Z frontendu znasz już pomysł automatycznego odświeżania aplikacji po zmianach w plikach źródłowych. Bez tego rozwiązania dotychczasowa praca z serwerem mogła być dla Ciebie niezwykle irytująca, bowiem każda zmiana zmuszała nas do zatrzymania obecnego procesu i uruchomienia serwera od nowa. Na szczęście, tak jak na frontendzie, istnieje narzędzie do automatycznego odświeżania. Nazywa się – <strong>Nodemon</strong>.</p>
<p>Jego użycie jest dość proste. Wystarczy pobrać i zainstalować&nbsp;globalnie tę paczkę:</p>
<pre class=" language-markup"><code class=" language-markup">yarn global add nodemon</code></pre>
<p>Od tej chwili możemy już uruchamiać nasz serwer z opcją automatycznego odświeżania przy użyciu prostej komendy:</p>
<pre class=" language-markup"><code class=" language-markup">nodemon server.js</code></pre>
<p>Oczywiście, dla innej nazwy pliku komenda brzmiałaby analogicznie (np. <code>nodemon app.js</code>, <code>nodemon index.js</code>).</p>
<p>W ramach ćwiczenia pobierz tę paczkę do projektu, który wykonywaliśmy podczas poprzedniego submodułu, a następnie przetestuj jej działanie. Uwaga – chodzi o projekt opisany w treści rozdziału, a nie Twoje zadanie końcowe.</p>
<h3 id="273-komunikacja-z-uzytkownikiem-przekazujemy-proste-informacje">Przekazujemy proste informacje</h3>
<p>Zaczniemy od najprostszej formy komunikacji, a więc przekazywania danych w samym linku.</p>
<p>Jest to coś, co już robiliśmy przy okazji poznawania routingu po stronie klienta. Pamiętasz tak skonstruowane route'y?</p>
<pre class=" language-jsx"><code class=" language-jsx">&lt;Route path="/posts/:id" exact component={Post} /&gt;</code></pre>
<p>Przypomnijmy. <code>:id</code> w powyższym przykładzie jest placeholderem. To, co wpiszemy w linku na jego miejscu, powinno być odbierane przez komponent jako parametr o nazwie <code>id</code>.</p>
<p>Przykładowo, wejście w link <code>/posts/1</code> wyrenderowałoby komponent <code>Post</code>, z parametrem <code>id</code> o wartości <code>1</code>.</p>
<p>Analogicznie działa to też w Expressie.</p>
<pre class=" language-js"><code class=" language-js">app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/post/:id'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Id postu to </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>req<span class="token punctuation">.</span><span class="token property-access">params</span><span class="token punctuation">.</span><span class="token property-access">id</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Jedyną różnicą jest to, że podczas pracy z Reactem parametry z route'ów znajdowaliśmy w <code>match.params</code>, a tutaj szukamy ich w obiekcie <code>req.params</code>. To zapewne Cię nie dziwi. Już na początku mówiliśmy, że <code>req</code> to właśnie obiekt <code>requestu</code> (żądania), który będzie dostarczał nam informacje od użytkownika i o użytkowniku. Jeszcze nie raz go wykorzystamy.</p>
<h4>Czas na praktykę!</h4>
<p>Aby zastosować naszą nową wiedzę w praktyce, wykonamy małe zadanie. <strong>Wciąż będziemy rozwijać aplikację budowaną w trakcie poprzedniego submodułu</strong>,  a naszym celem jest utworzenie nowego endpointu <code>/hello/:name</code>, który po wejściu w ten link będzie witał użytkownika komunikatem <code>Witaj :name!</code>. Zatem np. dla linku <code>/hello/John</code> aplikacja zwróci tekst <code>Witaj John!</code>. Na razie objedziemy się jeszcze bez pliku HTML i zwrócimy zwykły tekst za pomocą <code>res.send</code>.</p>
<p>Spróbuj poradzić sobie bez naszej pomocy. W razie czego, poniżej możesz podejrzeć gotowy kod.</p>
<p class="text-center">
  <span class="collapse-toggles">
    <a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#collapse--xxEtKXKC-toggle" class="btn btn-primary collapsed" data-toggle="collapse">Pokaż kod</a>
    <a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#collapse--xxEtKXKC-toggle" class="btn btn-primary collapsed" data-toggle="collapse">Ukryj kod</a>
  </span>
</p>
<div id="collapse--xxEtKXKC-toggle" class="collapse">
<pre class=" language-js"><code class=" language-js">app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/hello/:name'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Hello </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>req<span class="token punctuation">.</span><span class="token property-access">params</span><span class="token punctuation">.</span><span class="token property-access">name</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
</div>
<p>Efekt powinien być następujący:</p>
<a href="./Moduł_ 27. Express – własny serwer HTTP_files/Express7.png" class="img-modal-group"><img src="./Moduł_ 27. Express – własny serwer HTTP_files/Express7.png" alt="image" style="width: auto;"></a>
<h4>Przenosimy treść do pliku HTML</h4>
<p>Jak widzisz, poszło nam całkiem łatwo. Do tej pory jednak treść wszystkich podstron umieszczaliśmy w osobnych plikach HTML, dobrze byłoby więc trzymać się tej konwencji. W związku z tym pojawia się pewien problem.</p>
<p>Wszystkie pliki HTML, z których korzystaliśmy, były statyczne – miały swoją zapisaną treść, która nigdy się nie zmieniała. Serwer po prostu je ładował i bez żadnych zmian zwracał klientowi. Sytuacja z naszą nową podstroną jest jednak inna – potrzebujemy plik, którego fragment treści będzie zależny od zmiennej z aplikacji (<code>req.params.name</code>).</p>
<h3 id="273-komunikacja-z-uzytkownikiem-renderowanie-templateow">Renderowanie template'ów</h3>
<p>Wyjściem z sytuacji może być zastosowanie silnika do renderowania template'ów, który pozwoliłby na modyfikację wybranej części pliku HTML, zanim zostanie on zwrócony klientowi. Czy ta idea jest dla Ciebie nowością? Raczej nie, prawda? Taką mniej więcej rolę pełnił np. używany przez nas już w kursie <strong>Handlebars</strong>.</p>
<p>Pomysł był następujący:</p>
<p><strong>1</strong>. W pliku HTML przygotowywaliśmy statyczne template'y. Statyczne, ale jednak z placeholderami, które sugerowały, że przy renderowaniu te informacje będą podmienione na wartość otrzymaną z zewnątrz.</p>
<p>Na przykład:</p>
<pre class=" language-html"><code class=" language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>template-article-link<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text/x-handlebars-template<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token operator">&lt;</span>li<span class="token operator">&gt;</span><span class="token operator">&lt;</span>a href<span class="token operator">=</span><span class="token string">"#{{ id }}"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span>span<span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span> title <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>a<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span></code></pre>
<p><strong>2</strong>. W JS-ie ładowaliśmy wybrany template (lub template'y) i przygotowywaliśmy go do działania za pomocą funkcji <code>compile</code>.</p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> templates <span class="token operator">=</span> <span class="token punctuation">{</span>
  articleLink<span class="token operator">:</span> <span class="token maybe-class-name">Handlebars</span><span class="token punctuation">.</span><span class="token method function property-access">compile</span><span class="token punctuation">(</span><span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">querySelector</span><span class="token punctuation">(</span><span class="token string">'#template-article-link'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token property-access">innerHTML</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span></code></pre>
<p><strong>3</strong>. Następnie bardzo łatwo mogliśmy w JS-ie wygenerować na tej podstawie treść HTML, ustawiając przy tym, jakie mają być wartości placeholderów.</p>
<p>Na przykład:</p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> linkHTMLData <span class="token operator">=</span> <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> title<span class="token operator">:</span> <span class="token string">'Lorem Ipsum'</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> linkHTML <span class="token operator">=</span> templates<span class="token punctuation">.</span><span class="token method function property-access">articleLink</span><span class="token punctuation">(</span>linkHTMLData<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// outputs: &lt;li&gt;&lt;a href="#1"&gt;&lt;span&gt;Lorem Ipsum&lt;/span&gt;&lt;/a&gt;&lt;/li&gt;</span></code></pre>
<p>Podsumowując – pobieraliśmy template (z placeholderami, np. <code>{{ title }}</code>), podmienialiśmy placeholdery na wybrane wartości (np. <code>{{ title }}</code> na <code>Lorem Ipsum</code>), a na końcu zwracaliśmy zmienioną treść użytkownikowi.</p>
<p>Właśnie takiej funkcjonalności potrzebujemy też w naszej aplikacji – z tą różnicą, że teraz template'em/widokiem będzie cały plik.</p>
<p>Tworzymy HTML, który ma sztywną treść (np. cały <code>&lt;head&gt;</code>), ale też jakieś placeholdery (np. <code>{{ name }}</code>). Gdy użytkownik wejdzie pod nasz endpoint, chcemy, aby Express najpierw podmienił placeholdery na wybrane przez nas wartości (np. <code>{{ name }}</code> na <code>req.params.name</code>), a następnie zwrócił zmienioną treść klientowi. Brzmi podobnie? Tak, to wręcz ten sam pomysł.</p>
<p>Co najlepsze, możemy użyć tego samego narzędzia, a więc właśnie <strong>Handlebars</strong>! Oczywiście jego implementacja będzie nieco różniła się od tej, którą znamy z frontendu. Do tego Express wspiera używanie silników template'ów, dostarczając nam gotowe wbudowane metody do ich obsługi, zatem nie będzie to bardzo trudne zadanie.</p>
<h3 id="273-komunikacja-z-uzytkownikiem-templatey-w-praktyce">Template'y w praktyce</h3>
<p>Zacznijmy od pobrania Handlebars do naszego projektu:</p>
<pre class=" language-js"><code class=" language-js">yarn add express<span class="token operator">-</span>handlebars@<span class="token number">3.1</span><span class="token number">.0</span></code></pre>
<p>Następnie zaimportujmy paczkę w <code>server.js</code>.</p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> hbs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express-handlebars'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Teraz musimy jeszcze odpowiednio zintegrować ją z samym Expressem. Nie jest to trudne, ponieważ&nbsp;Express udostępnia wbudowane metody, które mogą nam w tym pomóc.</p>
<pre class=" language-js"><code class=" language-js">app<span class="token punctuation">.</span><span class="token method function property-access">engine</span><span class="token punctuation">(</span><span class="token string">'.hbs'</span><span class="token punctuation">,</span> <span class="token function">hbs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token method function property-access">set</span><span class="token punctuation">(</span><span class="token string">'view engine'</span><span class="token punctuation">,</span> <span class="token string">'.hbs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Zacznijmy od pierwszej linijki: <code>app.engine</code> pozwala zdefiniować nam, że dane pliki powinny być renderowane przez dany silnik.</p>
<pre class=" language-js"><code class=" language-js">app<span class="token punctuation">.</span><span class="token method function property-access">engine</span><span class="token punctuation">(</span><span class="token string">'.hbs'</span><span class="token punctuation">,</span> <span class="token function">hbs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>W powyższym kodzie informujemy Express o tym, że pliki o rozszerzeniu <code>.hbs</code> powinny być obsługiwane przez silnik <code>hbs</code> (czyli nasz załadowany Handlebars).</p>
<pre class=" language-js"><code class=" language-js">app<span class="token punctuation">.</span><span class="token method function property-access">set</span><span class="token punctuation">(</span><span class="token string">'view engine'</span><span class="token punctuation">,</span> <span class="token string">'.hbs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Ten fragment mówi, że w aplikacji używamy widoków właśnie o tym rozszerzeniu. Dzięki temu, przy kompilacji, będziemy mogli wskazywać tylko jego nazwę, a Express sam domyśli się, że ma szukać pliku z odpowiednią końcówką.</p>
<div class="bc-note alert-info">
<h4 class="alert-heading text-center">Zbędna kropka</h4>
<p>Jeśli chcesz, możesz pozbyć się kropki przy <code>.hbs</code>.</p>
<pre class=" language-js"><code class=" language-js">app<span class="token punctuation">.</span><span class="token method function property-access">engine</span><span class="token punctuation">(</span><span class="token string">'hbs'</span><span class="token punctuation">,</span> <span class="token function">hbs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token method function property-access">set</span><span class="token punctuation">(</span><span class="token string">'view engine'</span><span class="token punctuation">,</span> <span class="token string">'hbs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Express domyśla się, że w tym miejscu chcemy przekazywać rozszerzenie, więc jeśli nie wpiszemy kropki, doda ją sobie sam.</p>
</div>
<p>Warto wiedzieć, że wywołując <code>hbs()</code>, możemy również odpowiednio skonfigurować nasz silnik, np. definiując ścieżkę, w której będzie szukał widoków/template'ów (domyślnie Handlebars robi to w katalogu <code>views</code>). Na razie nie będziemy jednak tego robić.</p>
<h4>Pierwszy template</h4>
<p>Przygotuj teraz nowy plik naszego widoku – <code>hello.hbs</code> i umieść go w katalogu <code>views</code>. Nadaj mu następującą treść:</p>
<pre class=" language-html"><code class=" language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span> <span class="token attr-name">dir</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ltr<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Hello!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>Hello {{ name }}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span></code></pre>
<p>Jak widzisz, większość treści nie będzie się zmieniać, ale mamy też jeden placeholder (<code>{{ name }}</code>). W założeniu to właśnie Handlebars będzie odpowiadał za odpowiednie wyrenderowanie tego pliku. Teraz wystarczy jeszcze zmodyfikować nasz endpoint tak, żeby z niego korzystał.</p>
<p>Pojawi się tutaj nowa wbudowana w Express funkcja – <code>render</code>. Dotychczas zwracaliśmy dane od razu i bez zmian, niezależnie czy był to jakiś tekst (<code>res.send</code>), czy też plik (<code>res.sendFile</code>). Metoda <code>render</code> działa inaczej i zanim zwróci klientowi odpowiedź, przepuści nasz plik przez silnik. Jaki? Ten, który zdefiniowaliśmy wcześniej za pomocą <code>app.set</code>, czyli w naszej sytuacji – Handlebars.</p>
<pre class=" language-js"><code class=" language-js">res<span class="token punctuation">.</span><span class="token method function property-access">render</span><span class="token punctuation">(</span><span class="token string">'template-file'</span><span class="token punctuation">,</span> placeholderValuesObj<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Funkcja <code>render</code> ma dwa parametry. Pierwszy ustala nazwę widoku, który chcemy wykorzystać, a drugi przekazuje obiekt z wartościami dla placeholderów (oczywiście nie musimy ustawiać tego parametru, jeśli widok nie ma placeholderów).</p>
<p>Czyli na przykład u nas będzie to wyglądało tak:</p>
<pre class=" language-js"><code class=" language-js">app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/hello/:name'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">render</span><span class="token punctuation">(</span><span class="token string">'hello'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> req<span class="token punctuation">.</span><span class="token property-access">params</span><span class="token punctuation">.</span><span class="token property-access">name</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Taki kod możemy rozumieć jak rozkaz: wczytaj szablon <code>./views/hello.hbs</code>, podmień placeholder <code>name</code> na <code>req.params.name</code>, a na końcu zwróć już zmienioną treść jako odpowiedź dla klienta.</p>
<p>Oczywiście można przy renderowaniu definiować wartość większej ilości placeholderów, jeśli szablon ich używa. Na przykład:</p>
<pre class=" language-js"><code class=" language-js">app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/post/:id/:name'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">render</span><span class="token punctuation">(</span><span class="token string">'hello'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> id<span class="token operator">:</span> req<span class="token punctuation">.</span><span class="token property-access">params</span><span class="token punctuation">.</span><span class="token property-access">id</span><span class="token punctuation">,</span> name<span class="token operator">:</span> req<span class="token punctuation">.</span><span class="token property-access">params</span><span class="token punctuation">.</span><span class="token property-access">name</span><span class="token punctuation">,</span> date<span class="token operator">:</span> <span class="token string">'21-02-2019'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Wróćmy jednak do naszego przykładu. Skąd silnik wie, że <code>hello</code> ma szukać właśnie w <code>views</code> pod nazwą <code>hello.hbs</code>? Tak jak mówiliśmy już wcześniej, <code>views</code> to domyślny katalog, w którym szukane są szablony (oczywiście można w konfiguracji ustawić inny). Rozszerzenie również jest znane, ponieważ&nbsp;ustawiliśmy je za pomocą <code>app.set</code>.</p>
<p>Zanim sprawdzisz, czy wszystko działa, zróbmy jeszcze jedną rzecz.</p>
<p>W drugim parametrze <code>render</code>, oprócz ustawienia wartości dla placeholderów, możemy wybrać również kilka opcji, które zdefiniują, jak silnik ma zachować się w danej sytuacji. Jeśli tego nie zrobimy, użyje on ustawień domyślnych.</p>
<p>Handlebars korzysta z pomysłu "layoutów" (nie wchodzimy teraz w szczegóły, powiemy o tym za moment), a my na razie chcemy po prostu wyrenderować jeden prosty widok, bez kombinacji. Dlatego wyłączymy tę opcję.</p>
<pre class=" language-js"><code class=" language-js">app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/hello/:name'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">render</span><span class="token punctuation">(</span><span class="token string">'hello'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> layout<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> name<span class="token operator">:</span> req<span class="token punctuation">.</span><span class="token property-access">params</span><span class="token punctuation">.</span><span class="token property-access">name</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Podsumujmy jeszcze raz ten proces.</p>
<p>Wcześniej, kiedy wchodziliśmy pod jakiś endpoint, serwer od razu zwracał nam treść.</p>
<a href="./Moduł_ 27. Express – własny serwer HTTP_files/Express10.png" class="img-modal-group"><img src="./Moduł_ 27. Express – własny serwer HTTP_files/Express10.png" alt="image" style="width: auto;"></a>
<p>Teraz, w naszym nowym endpoincie, zanim plik zostanie zwrócony, jest przepuszczony przez silnik Handlebars. Ten najpierw podmienia placehodlery na pożądane przez nas wartości i dopiero zwraca plik.</p>
<a href="./Moduł_ 27. Express – własny serwer HTTP_files/Express9.png" class="img-modal-group"><img src="./Moduł_ 27. Express – własny serwer HTTP_files/Express9.png" alt="image" style="width: auto;"></a>
<p>Okej, to już wszystko. Możesz teraz sprawdzić nasz endpoint <code>/hello/:name</code>. Powinien pokazywać różnie powitania, zależnie od wartości parametru <code>name</code>.</p>
<a href="./Moduł_ 27. Express – własny serwer HTTP_files/Express8.gif" class="img-modal-group"><img src="./Moduł_ 27. Express – własny serwer HTTP_files/Express8.gif" alt="image" style="width: auto;"></a>
<p>Jeśli wszystko działa poprawnie, może rozpierać Cię duma. Udało Ci się z sukcesem zaimplementować silnik template'ów.</p>
<div class="bc-note alert-info">
<h4 class="alert-heading text-center">Nie tylko Handlebars</h4>
<img src="./Moduł_ 27. Express – własny serwer HTTP_files/Express11.png" class="img-inline img-right">
<p>Oczywiście na rynku jest większy wybór narzędzi do renderowania widoków. Express nie narzuca żadnego z góry. Oprócz <strong>Handlebars</strong> możemy więc skorzystać m.in. z <strong>Mustache.js</strong>, <strong>Dot.js</strong>, czy bardzo popularnego – <strong>Pug</strong>.</p>
<p>Ten ostatni cechuje się ogromnym uproszczeniem HTML. Nie musimy w nim używać nawet znaków <code>&lt;</code> i <code>&gt;</code>.</p>
<pre class=" language-pug"><code class=" language-pug">doctype html
html(lang='en')
 head
   title Pug
 body
   h1 Pug Examples
   div.container
     p Cool Pug example!</code></pre>
<p>Oczywiście podczas renderowania, Pug konwertuje kod do zwykłego HTML-a.</p>
</div>
<h3 id="273-komunikacja-z-uzytkownikiem-unifikacja-widokow">Unifikacja widoków</h3>
<p>Wszystko działa już zgodnie z założeniem, narobiliśmy jednak trochę bałaganu. To niezbyt dobry pomysł, żeby jedne widoki były przechowywane jako pliki <code>.html</code> i obsługiwane przez <code>res.show</code> (czyli tak naprawdę <code>res.sendFile</code>), a inne jako <code>.hbs</code> i obsługiwane przez <code>res.render</code>. Dobrze byłoby zdecydować się na jeden format.</p>
<p>Oczywiście domyślasz się, który wybierzemy – Handlebars. Używanie takiego silnika do zwykłych statycznych plików HTML wydaje się przerostem formy nad treścią, jednak niekoniecznie tak jest.</p>
<p>Po pierwsze, <strong>całkiem możliwe, że w przyszłości będziemy chcieli dodać do tych plików jakąś dynamiczną treść</strong>. Wtedy, obsługujący je już Handlebars, będzie jak znalazł.</p>
<p>Po drugie, <strong>silnik pozwala nam też na importowanie plików oraz budowanie layoutów aplikacji</strong>. To na pewno nam się przyda. Będziemy mogli stworzyć jeden główny plik ze stałym headerem i footerem, a pojedyncze widoki będą zawierały już tylko samą treść podstrony. Powiemy jeszcze o tym za chwilę.</p>
<p>Po trzecie, <strong>funkcja <code>render</code> nie wymaga ustawiania dokładnej ścieżki do pliku</strong>. Zamiast tego, domyślnie szuka ich w <code>views</code>. Dzięki temu moglibyśmy pozbyć się kodu z middlewarem dodającym funkcję <code>.show</code>.</p>
<h4>Do roboty!</h4>
<p>Zacznij od zmian rozszerzenia plików w katalogu <code>views</code>. Teraz zamiast <code>.html</code>, zawsze będziemy używać <code>.hbs</code>. Oczywiście, nie musimy zmieniać treści w środku. To wciąż mają być te same statyczne pliki.</p>
<p>Następnie usuń middleware dodający funkcję <code>res.show</code>, nie będziemy już go potrzebować. Tak jak mówiliśmy wcześniej – <code>res.render</code> samo domyślnie szuka widoków w <code>views</code>.</p>
<p>W kolejnym kroku podmień we wszystkich endpointach metodę <code>res.show</code> na <code>res.render</code> oraz wskaż nową nazwę pliku. <strong>Pamiętaj, że wystarcza sama nazwa (np. <code>index</code>), Express wie już bowiem jakiego rozszerzenia ma szukać.</strong> Nie zapomnij dodać też drugiego parametru <code>{ layout: false }</code>, na razie nie chcemy używać layoutów. Zatem na przykład <code>res.show('index.html');</code> zmieni się na <code>res.render('index', { layout: false })</code>.</p>
<p>Jeśli nie masz pewności, czy udało Ci się wykonać powyższe instrukcje poprawnie, poniżej znajduje się gotowy kod.</p>
<p class="text-center">
  <span class="collapse-toggles">
    <a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#collapse-x8IG-Sr0S7-toggle" class="btn btn-primary collapsed" data-toggle="collapse">Pokaż gotowy kod</a>
    <a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#collapse-x8IG-Sr0S7-toggle" class="btn btn-primary collapsed" data-toggle="collapse">Ukryj gotowy kod</a>
  </span>
</p>
<div id="collapse-x8IG-Sr0S7-toggle" class="collapse">
<pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'path'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> hbs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express-handlebars'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token method function property-access">engine</span><span class="token punctuation">(</span><span class="token string">'hbs'</span><span class="token punctuation">,</span> <span class="token function">hbs</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token method function property-access">set</span><span class="token punctuation">(</span><span class="token string">'view engine'</span><span class="token punctuation">,</span> <span class="token string">'hbs'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token method function property-access">static</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token method function property-access">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'/public'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">render</span><span class="token punctuation">(</span><span class="token string">'index'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> layout<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/hello/:name'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">render</span><span class="token punctuation">(</span><span class="token string">'hello'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> layout<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span> name<span class="token operator">:</span> req<span class="token punctuation">.</span><span class="token property-access">params</span><span class="token punctuation">.</span><span class="token property-access">name</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/about'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">render</span><span class="token punctuation">(</span><span class="token string">'about'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> layout<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/contact'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">render</span><span class="token punctuation">(</span><span class="token string">'contact'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> layout<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/info'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">render</span><span class="token punctuation">(</span><span class="token string">'info'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> layout<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/history'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">render</span><span class="token punctuation">(</span><span class="token string">'history'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> layout<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token string">'404 not found...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>

app<span class="token punctuation">.</span><span class="token method function property-access">listen</span><span class="token punctuation">(</span><span class="token number">8000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'Server is running on port: 8000'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
</div>
<p>Oczywiście końcowy efekt się nie zmienił. Nasza aplikacja wygląda tak samo, jak wcześniej. "Pod maską" udało nam się ją jednak skrócić i wzbogacić o możliwość renderowania różnych odpowiedzi z tych samych widoków (o ile mamy taką potrzebę).</p>
<h3 id="273-komunikacja-z-uzytkownikiem-layouty-aplikacji">Layouty aplikacji</h3>
<p>Bardzo często podstrony witryn mają wiele części wspólnych, na przykład nagłówek z nawigacją albo stopkę. Moglibyśmy w takiej sytuacji po prostu kopiować ten sam kod do każdego z plików, ale co jeśli będziemy chcieli zrobić jakąś modyfikację? Musielibyśmy zmieniać każdą z podstron!</p>
<p>O wiele lepszym pomysłem jest wykorzystanie layoutów dostępnych w Handlebars. Co więcej, twórcy silnika uważają, że ich użycie jest czymś tak naturalnym, że z góry założyli, iż domyślnie powinny być uruchomione. Stąd też, jeśli nie chcieliśmy ich używać, musieliśmy wcześniej skorzystać z opcji <code>{ layout: false }</code>.</p>
<p>Layouty pojawiły się już w kursie, chociażby podczas pracy nad Reactem.</p>
<p>Założenie jest następujące. Mamy plik layoutu (Handlebars domyślnie proponuje nazwę <code>main.hbs</code>), który posiada jakąś stałą treść (np. header i footer) oraz jeden placeholder. Ten ostatni rezerwuje miejsce na treść, którą layout otrzyma z zewnątrz.</p>
<p>Może on wyglądać np. tak:</p>
<pre class=" language-html"><code class=" language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span> <span class="token attr-name">dir</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ltr<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>App<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>header</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>It's an awesome app!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>header</span><span class="token punctuation">&gt;</span></span>

    {{{ body }}}

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>footer</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>All rights reserved<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>footer</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span></code></pre>
<p><code>{{{ body }}}</code> to właśnie nasz placeholder. Nazwa nie jest przypadkowa – koniecznie musimy użyć tutaj <code>body</code>. Jak pamiętasz z Handlebars, trzy klamerki (<code>{{{</code>) mówią, że placeholder może być treścią HTML. Będzie nią to, co wskaże Handlebars, czyli po prostu widok załadowany zgodnie z tym, co ustawiliśmy przy wywołaniu funkcji <code>render</code>.</p>
<p>Jak to działa w praktyce? Kiedy Handlebars wie, że ma korzystać z szablonu, to tego typu instrukcje nie będą już bezpośrednio renderowane dla klienta:</p>
<pre class=" language-js"><code class=" language-js">res<span class="token punctuation">.</span><span class="token method function property-access">render</span><span class="token punctuation">(</span><span class="token string">'home'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Zamiast tego Handlebars załaduje najpierw layout (domyślnie szuka pliku <code>main.handlebars</code>), w miejscu placeholdera wczyta wybrany dokument (tutaj <code>home.hbs</code>) i dopiero taki plik (layout wraz z treścią widoku) zwróci klientowi.</p>
<p>Pokazuje to poniższy schemat.</p>
<a href="./Moduł_ 27. Express – własny serwer HTTP_files/Express12.png" class="img-modal-group"><img src="./Moduł_ 27. Express – własny serwer HTTP_files/Express12.png" alt="image" style="width: auto;"></a>
<p>Podsumujmy. Załóżmy, że plik <code>hello.hbs</code> wyglądałby tak:</p>
<pre class=" language-html"><code class=" language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span>Home<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>

<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>Welcome home!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span></code></pre>
<p>W podanym przykładzie klient otrzymałby następującą odpowiedź serwera:</p>
<pre class=" language-html"><code class=" language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span> <span class="token attr-name">dir</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ltr<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>App<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>header</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>It's an awesome app!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>header</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span>Home<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>Welcome home!<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>footer</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>All rights reserved<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>footer</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span></code></pre>
<p>Czas na zastosowanie nowej wiedzy w praktyce!</p>

                        </div>
                    </div>
                                        <div class="card-block task-card">
                        <h3 id="273-komunikacja-z-uzytkownikiem-zadanie-tworzymy-layout-aplikacji">Zadanie: <span class="task-title">tworzymy layout aplikacji</span></h3>
                        <div class="task-content">
                            <p>Twoim zadaniem będzie stworzenie głównego layoutu strony, zawierającego nawigację oraz stopkę. Nie bój się jednak, poprowadzimy Cię za rękę.</p>
<p><strong>1</strong>. Zacznij od stworzenia pliku szablonu. Domyślnie Handlebars będzie szukać go w katalogu <code>views\layouts\</code> pod nazwą <code>main.handlebars</code>, więc należałoby go stworzyć właśnie tam. Jeśli jednak masz ochotę skonfigurować inną ścieżkę oraz inne rozszerzenie, wystarczy zmodyfikować wywołanie <code>hbs()</code> na początku skryptu.</p>
<p>Na przykład taki kod...</p>
<pre class=" language-js"><code class=" language-js">app<span class="token punctuation">.</span><span class="token method function property-access">engine</span><span class="token punctuation">(</span><span class="token string">'hbs'</span><span class="token punctuation">,</span> <span class="token function">hbs</span><span class="token punctuation">(</span><span class="token punctuation">{</span> extname<span class="token operator">:</span> <span class="token string">'hbs'</span><span class="token punctuation">,</span> layoutsDir<span class="token operator">:</span> <span class="token string">'./layouts'</span><span class="token punctuation">,</span> defaultLayout<span class="token operator">:</span> <span class="token string">'main'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>...spowodowałby, że Handlebars chciałby przy renderowaniu korzystać z layoutu <code>main.hbs</code>, dostępnego w folderze <code>layouts</code>.</p>
<p>Następnie dodaj do niego następującą treść:</p>
<pre class=" language-html"><code class=" language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span> <span class="token attr-name">dir</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ltr<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>utf-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>App<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/style.css<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>header</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>My personal page<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>nav</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Home<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/about<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>About<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/contact<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Contact<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/info<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Info<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/history<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>History<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>nav</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>header</span><span class="token punctuation">&gt;</span></span>

    {{{ body }}}

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>footer</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>All rights reserved<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>footer</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span></code></pre>
<p><strong>2</strong>. Zmodyfikuj endpointy, zabierając z wywołania metody <code>render</code> opcję <code>{ layout: false }</code>. Od tej pory będziemy już korzystać z layoutów.</p>
<p>Zatem np.</p>
<pre class=" language-js"><code class=" language-js">app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/about'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">render</span><span class="token punctuation">(</span><span class="token string">'about'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> layout<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>zmodyfikuj na:</p>
<pre class=" language-js"><code class=" language-js">app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/about'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">render</span><span class="token punctuation">(</span><span class="token string">'about'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p><strong>3</strong>. Zmień wszystkie podstrony. Nie muszą już posiadać znaczników <code>head</code> ani <code>body</code>, wystarczy nam teraz sama treść. Reszta będzie dokładana przez layout przy renderowaniu. Przy okazji zmień też poziom nagłówka z <code>h1</code> na <code>h2</code>.</p>
<p>Na końcu Twoja aplikacja powinna działać następująco:</p>
<a href="./Moduł_ 27. Express – własny serwer HTTP_files/Express13.gif" class="img-modal-group"><img src="./Moduł_ 27. Express – własny serwer HTTP_files/Express13.gif" alt="image" style="width: auto;"></a>
<h4>Dla ambitnych</h4>
<p>Jeśli chcesz potrenować, mamy dla Ciebie kolejne wyzwanie.</p>
<p>Handlebars pozwala na korzystanie z większej ilości layoutów, dzięki czemu możemy przygotowywać układy stron w kilku wersjach. Na przykład <code>main.js</code> (domyślny layout) mógłby używać jasnego i prostego motywu, a <code>dark.js</code> pokazywałby stronę w ciemniejszych barwach i oferował trochę inny układ headeru.</p>
<p>Który z nich ma być użyty w danej sytuacji, możemy określić bardzo prosto za pomocą opcji <code>layout</code>.</p>
<p>Na przykład:</p>
<pre class=" language-js"><code class=" language-js">app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/about'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">render</span><span class="token punctuation">(</span><span class="token string">'about.hbs'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> layout<span class="token operator">:</span> <span class="token string">'dark'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Twoim zadaniem jest przygotowanie drugiego layoutu <code>dark</code>, w którym kolor tła jest ciemny, tekst jasny, a nazwa strony nie występuje. Następnie należy wykorzystać go dla jednego z endpointów.</p>

                        </div>
                    </div>
                                        <div class="card-block submodule-footer clearfix  completed ">
                                                <div class="clearfix">
                                                                                <a href="https://kodilla.com/pl/bootcamp-task/407/661005" target="_blank" class="btn btn-info-outline">Podgląd zadania</a>
                            <form target="_blank" class="form-inline project-link-form">
                                <div class="form-group">
                                    <input type="text" name="link" class="form-control" value="https://github.com/skwiryt/first-express">
                                </div>
                                <button type="submit" class="btn  btn-primary ">Wyślij link <i class="fa fa-check"></i></button>
                            </form>
                                                                                                    </div>
                    </div>
                </section>
                                    
                <section id="submodule-1119" class="card submodule completed" data-bootcamp-user-submodule-id="661006">
                <!-- klasy dla section: completed current comments -->
                    <div class="card-block submodule-header clearfix">
                        <i class="fa fa-check-circle-o fa-2x"></i>
                        <i class="fa fa-play-circle-o fa-2x"></i>
                        <i class="fa fa-exclamation-circle fa-2x"></i>
                        <i class="fa fa-send-o fa-2x"></i>
                        <h2 class="bootcamp-submodule-name">27.4. <span>Testowanie połączeń HTTP</span></h2>
                                            </div>
                    <div class="card-block">
                        <div class="submodule-content">
                            <p>Wiemy już, w jaki sposób możemy przekazywać proste informacje serwerowi – wystarczy do tego odpowiednio skonfigurowany endpoint.</p>
<p>Na przykład:</p>
<pre class=" language-js"><code class=" language-js">app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'/hello/:name'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">Hello </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>req<span class="token punctuation">.</span><span class="token property-access">params</span><span class="token punctuation">.</span><span class="token property-access">name</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Często chcemy jednak przekazywać znacznie bardziej skomplikowane informacje jak np. obiekty czy tablice o sporym rozmiarze. W takiej sytuacji metoda <code>GET</code> już nie podoła.</p>
<p>Istnieje jednak inna metoda, dla której taka rola to chleb powszedni. Mowa o <code>POST</code>. Jak z pewnością pamiętasz z modułu o AJAX i API, pozwala ona na przesyłanie wraz z żądaniem całego <code>body</code>. W tym przypadku <code>body</code> może być prostym obiektem z jednym parametrem, ale i ogromnym, z wieloma rozgałęzieniami. Do tego, możemy za jego pomocą przesyłać nawet pliki!</p>
<h3 id="274-testowanie-polaczen-http-nowy-endpoint">Nowy endpoint</h3>
<p>Przejdźmy od razu do praktyki. Otwórz projekt, który rozwijamy od początku modułu.</p>
<p>Zacznijmy od utworzenia nowego endpointu.</p>
<pre class=" language-js"><code class=" language-js">app<span class="token punctuation">.</span><span class="token method function property-access">post</span><span class="token punctuation">(</span><span class="token string">'/contact/send-message'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Początek jest jasny. Do obsługi endpointu użyliśmy metody <code>.post</code>, zamiast <code>.get</code>. Link <code>/contact/send-message</code> nie jest przypadkowy. Endpoint, który teraz testowo tworzymy, wykorzystamy w dalszej części submodułu.</p>
<p>Metoda <code>res.json</code> nie powinna być dla Ciebie nowością. Co prawda, nie używaliśmy jej w praktyce, ale wspomnieliśmy o niej. To po prostu odpowiednik <code>res.send</code>, jednak służący do zwracania danych w formacie JSON. W tej chwili będzie to konieczny wybór, bo <code>req.body</code> powinien być obiektem. Nie możemy przecież zwrócić obiektu jako tekstu (a do tego służy <code>res.send</code>). Zapewne dziwisz się, że wszystkie endpointy zwracały pliki HTML, a nagle mamy dane w formacie JSON. Spokojnie, to tylko chwilowe działanie i w dalszej części submodułu to się zmieni.</p>
<p><code>body</code> to po prostu atrybut obiektu zapytania zawierający dane wysyłane wraz z żądaniem. Są one dostępne w obiekcie <code>request</code>, bo tak naprawdę <strong>wszystkie informacje o użytkowniku i od użytkownika są zawarte właśnie w nim.</strong></p>
<p>Podsumowując powyższy kod, powinien on zadziałać następująco: po wejściu pod link <code>/contact/send-message</code> (za pomocą metody <code>POST</code>), serwer powinien odczytać wysyłany przez użytkownika <code>body</code> i zwrócić go w formacie JSON. Sprawdźmy, czy rzeczywiście tak jest! Tylko jak?</p>
<h3 id="274-testowanie-polaczen-http-postman">Postman</h3>
<img src="./Moduł_ 27. Express – własny serwer HTTP_files/Postman.png" class="img-inline img-right">
<p>Do przetestowania requestu innego niż <code>GET</code>, będziemy potrzebować pomocy. Musimy zmusić przeglądarkę, by w danej sytuacji użyła metody <code>POST</code>, bo akurat takiej potrzebujemy do testu. Podobny problem pojawi się również później, kiedy będziemy chcieli przetestować w praktyce metody <code>DELETE</code> czy <code>PUT</code>.</p>
<p>Na szczęście istnieje program, który to ułatwi. Mowa o <strong>Postmanie</strong>, czyli aplikacji, która pozwala na łatwe symulowanie wybranych połączeń HTTP. Dzięki niej możemy wykonywać różnorakie requesty z wybranym endpointem i za pomocą dowolnej metody. Jesteśmy również w stanie ustalić jakie dane (<code>body</code>) będą wysyłane wraz z linkiem!</p>
<p>Pobierz ją teraz. Możesz zrobić to <a href="https://www.getpostman.com/downloads/" target="_blank">tutaj</a>.</p>
<h4>Pierwsze uruchomienie</h4>
<p>Po pobraniu, od razu uruchom program. Postman wymaga posiadania konta, zatem konieczne będzie jego utworzenie (lub zalogowanie za pomocą Google). Przy kolejnych uruchomieniach, Postman loguje się już automatycznie.</p>
<a href="./Moduł_ 27. Express – własny serwer HTTP_files/Postman2.png" class="img-modal-group"><img src="./Moduł_ 27. Express – własny serwer HTTP_files/Postman2.png" alt="image" style="width: auto; max-width: 50%;"></a>
<h4>Tworzymy kolekcję</h4>
<p>Postman pozwala grupować requesty w kolekcje, dzięki czemu możemy łatwo kojarzyć wybrane zapytania z danym projektem. Powrót do nich w przyszłości będzie o wiele łatwiejszy, jeśli zechcemy ponowić dany test. Warto wiedzieć, że raz wykonany request, może być zapisany na stałe w programie i potem wielokrotnie powtarzany.</p>
<p>Stwórz teraz nową kolekcję dla naszego projektu. Aby to zrobić, odnajdź przycisk <strong>New Collection</strong> w panelu po lewej stronie. Po wybraniu tej opcji Postman pokaże Ci formularz. Musisz nadać kolekcji dowolną nazwę, ewentualnie również opis.</p>
<a href="./Moduł_ 27. Express – własny serwer HTTP_files/Postman3.png" class="img-modal-group"><img src="./Moduł_ 27. Express – własny serwer HTTP_files/Postman3.png" alt="image" style="width: auto; max-width: 50%;"></a>
<p>Następnie kliknij przycisk <strong>Create</strong>. Kolekcja powinna zostać utworzona.</p>
<a href="./Moduł_ 27. Express – własny serwer HTTP_files/Postman4.png" class="img-modal-group"><img src="./Moduł_ 27. Express – własny serwer HTTP_files/Postman4.png" alt="image" style="width: auto; max-width: 50%;"></a>
<p>Obok Twojej kolekcji może znajdować się też folder "Postman Echo". To po prostu zbiór testowych requestów. Nie zaprzątaj sobie nim głowy.</p>
<p>Przyszedł czas na utworzenie pierwszego requestu! Przetestujemy nasz świeżo utworzony endpoint <code>/contact/send-message</code>.</p>
<h4>Pierwszy request</h4>
<p>Kliknij teraz przycisk <strong>New</strong> (lewy górny róg), a następnie w otwartym oknie, wybierz "Request".</p>
<p>W formularzu wpisz dowolną nazwę oraz wskaż swoją kolekcję (o ile nie jest ona zaznaczona domyślnie).</p>
<a href="./Moduł_ 27. Express – własny serwer HTTP_files/Postman5.png" class="img-modal-group"><img src="./Moduł_ 27. Express – własny serwer HTTP_files/Postman5.png" alt="image" style="width: auto; max-width: 50%;"></a>
<p>Następnie kliknij przycisk <strong>"Save..."</strong>. Request został dodany i zapisany, ale musimy jeszcze ustalić, z czym dokładnie się łączymy i w jaki sposób.</p>
<p>Teraz ustawmy odpowiednią metodę. Domyślnie program proponuje <code>GET</code>, a my chcemy testować nasz endpoint używając <code>POST</code>.</p>
<p>Jeśli chodzi o link, wpisz po prostu ścieżkę do naszego endpointu – <code>http://localhost:8000/contact/send-message</code>.</p>
<p>Pozostaje nam tylko ustalenie, jakie <code>body</code> ma być wysłane wraz z linkiem (w końcu do tego służy <code>POST</code> – do przesyłania danych). Możemy zrobić to w zakładce <code>body</code>.</p>
<p>Wybierz "typ" <strong>x-www-form-urlencoded</strong> i dodaj kilka informacji tekstowych:</p>
<ul>
<li><code>author</code> o wartości <code>John Doe</code>.</li>
<li><code>sender</code> o wartości <code>johndoe@example.com</code>.</li>
<li><code>title</code> o wartości <code>Lorem Ipsum</code>.</li>
<li><code>message</code> o wartości <code>Hello world!</code>.</li>
</ul>
<p>Na końcu nasz request powinien wyglądać następująco:</p>
<a href="./Moduł_ 27. Express – własny serwer HTTP_files/Postman6.png" class="img-modal-group"><img src="./Moduł_ 27. Express – własny serwer HTTP_files/Postman6.png" alt="image" style="width: auto; max-width: 50%;"></a>
<div class="bc-note alert-info">
<h4 class="alert-heading text-center">x-www-form-url-encoded vs multipart/form-data</h4>
<p>Pewnie zastanawiasz się, czym różni się wybrany przez nas typ <code>x-www-form-url-encoded</code> od <code>form-data</code>, również oferowanego przez Postmana. Jeśli sprawdzisz, jak wygląda sposób dodawania danych, to w obu przypadkach jest podobnie – możemy po prostu ustawiać nazwę (<code>key</code>) i wartość (<code>value</code>).</p>
<p>Zatem rola jest faktycznie taka sama – wysłanie listy danych w formacie (klucz -&gt; wartość). Różnica kryje się jednak w sposobie osiągnięcie tego celu.</p>
<p>Gdy przesyłamy dane za pomocą <code>x-www-form-urlencoded</code>, to tak naprawdę są one przekazywane w formie jednego wielkiego stringu. Pojedyncze atrybuty są oddzielane za pomocą <code>&amp;</code>, a znaki inne niż litery i liczby zamieniane na reprezentację kodu ASCII, czyli np. u nas wyglądałby on tak:</p>
<pre class=" language-markup"><code class=" language-markup">author=John%20Doe&amp;sender=johndoe%64example%46com&amp;title=Lorem%20Ipsum&amp;message=Hello%20World</code></pre>
<p>Zauważ, że znak spacji czy też kropki, jest reprezentowany aż przez trzy bity. Czasami jest to mało wydajny pomysł, a do tego ciężko wyobrazić sobie wysyłanie w taki sposób plików.</p>
<p>W przypadku <code>form-data</code> pojedyncza informacja jest wysyłana jako osobny fragment. Każdy z nich może mieć swoją wartość, ale też własny <code>content-type</code> (np. <code>text/plain</code> czy <code>text/json</code>), dzięki czemu jesteśmy w stanie wskazać czym tak naprawdę są konkretne dane i w jaki sposób mają zostać obsłużone. Typ <code>form-data</code> jest doskonałym wyborem przy wysyłaniu plików. Poniżej przedstawiamy przykład, jak mógłby wyglądać request:</p>
<pre class=" language-markup"><code class=" language-markup">content-disposition: form-data; name=”title”

value:
Lorem Ipsum

======================

content-disposition: form-data; name=”message”

value:
Hello World

======================

content-disposition: form-data; name=”file_to_upload”; filename=”file.txt”
Content-Type: text/plain

content:
Lorem Ipsum!</code></pre>
<p>Typ <code>form-data</code> nie generuje niepotrzebnie większej ilości bitów, ale za to wymaga od przeglądarki obsługi każdej informacji z osobna. Tym samym w przypadku obsługi prostych informacji będzie mniej wydajny od <code>x-www-form-urlencoded</code>.</p>
<p>Dlatego najlepiej <strong>do prostych danych używaj typu <code>x-www-form-urlencoded</code></strong>, a do <strong>bardziej skomplikowanych, oraz w sytuacji, kiedy wysyłasz też pliki – <code>form-data</code></strong>.</p>
</div>
<p>Czas w końcu go wysłać (przycisk <strong>Send</strong>) i sprawdzić, co zwróci serwer. Czy zareaguje poprawnie? <strong>Nie zapomnij tylko, aby przed wykonywaniem testu go uruchomić!</strong></p>
<h4>Bolesne rozczarowanie</h4>
<p>Jeśli udało Ci się poprawnie podążać za naszymi wskazówkami, to okno odpowiedzi zwróci Ci pusty tekst... O co chodzi?</p>
<a href="./Moduł_ 27. Express – własny serwer HTTP_files/Postman7.png" class="img-modal-group"><img src="./Moduł_ 27. Express – własny serwer HTTP_files/Postman7.png" alt="image" style="width: auto; max-width: 50%;"></a>
<p>Możemy przeprowadzić małe śledztwo. Czy wskazaliśmy zły endpoint? Nie, bo przecież w takiej sytuacji nasz serwer zwraca tekst "404 not found". Zresztą kod odpowiedzi też wskazuje sukces (kod 200). Wiemy zatem, że serwer na pewno zatrzymuje się na naszym endpoincie, a jednak nie widzimy treści. Wychodzi więc na to, że puste jest po prostu <code>req.body</code>. Dziwna sprawa, bo przecież <code>body</code> w requeście przekazywaliśmy...</p>
<p>Dlaczego tak jest?</p>
<div class="bc-note alert-success">
<h4 class="alert-heading text-center">Twoja decyzja</h4>
<p>Pamiętasz, gdy podczas nauki Node.js mówiliśmy, że posiada on wiele wbudowanych modułów, ale nie narzuca ich wykorzystania? Były one dostępne, ale żeby ich użyć, należało je zaimportować.</p>
<p>Podobnie sprawy miały się już w samym Expressie z middlewarem <code>express.static</code> – ta funkcjonalność nie była od razu wbudowana w główny proces. Zamiast tego została dostarczona jako middleware, który <strong>możemy dodać do naszej aplikacji, ale nie musimy</strong>. To sensowne, bo nie zawsze będziemy potrzebować każdej funkcjonalności, a prosty serwer API, który ma służyć tylko jako pośrednik bazy danych, raczej nie potrzebuje <code>express.static</code>.</p>
<p>Tak samo jest z obsługą formularzy. Express nie pomaga na siłę, ale dostarcza middleware, którego możemy użyć, jeśli chcemy je obsługiwać.</p>
</div>
<h4><code>express.urlencoded</code> i <code>express.json</code></h4>
<p>Zatem jaki gotowe middleware powinniśmy dołączyć, aby formularz zaczął być poprawnie obsługiwany?</p>
<p>Jeśli chcesz umożliwić obsługę formularzy <code>x-www-form-urlencoded</code>, dodaj middleware <code>express.urlencoded</code>.</p>
<pre class=" language-js"><code class=" language-js">app<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token method function property-access">urlencoded</span><span class="token punctuation">(</span><span class="token punctuation">{</span> extended<span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Jeśli dodatkowo chcesz odbierać dane w formacie JSON (mogą być wysyłane za pomocą <code>form-data</code>), to również <code>express.json</code>:</p>
<pre class=" language-js"><code class=" language-js">app<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>My oczywiście w naszym przykładzie potrzebujemy tylko pierwszego. Najczęściej jednak będziesz korzystać z obu.</p>
<div class="bc-note alert-info">
<h4 class="alert-heading text-center"><code>{ extended: false }</code> vs <code>{ extended: true }</code></h4>
<p>Co to w ogóle za opcja? Warto wiedzieć, że <code>x-www-form-urlencoded</code> pozwala również na przesyłanie zagnieżdżonych danych, np. <code>person[name]=John&amp;person[age]=25</code>. Opcja <code>extended</code> ustala po prostu, czy chcemy, aby Express odczytywał takie dane faktycznie jako zagnieżdżone czy nie.</p>
<p>Dla wspomnianego przykładu <code>extended: true</code> dałoby nam <code>req.body</code>:</p>
<pre class=" language-js"><code class=" language-js"><span class="token punctuation">{</span>
  person<span class="token operator">:</span> <span class="token punctuation">{</span>
    name<span class="token operator">:</span> <span class="token string">'John'</span><span class="token punctuation">,</span>
    age<span class="token operator">:</span> <span class="token string">'25'</span> <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>...natomiast <code>extended: false</code>:</p>
<pre class=" language-js"><code class=" language-js"><span class="token punctuation">{</span>
  person<span class="token punctuation">[</span>name<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token string">'John'</span><span class="token punctuation">,</span>
  person<span class="token punctuation">[</span>age<span class="token punctuation">]</span><span class="token operator">:</span> <span class="token string">'25'</span>
<span class="token punctuation">}</span></code></pre>
<p>Oczywiście w naszym requeście dane nie są zagnieżdżone, stąd wybranie opcji <code>extended: false</code>.</p>
</div>
<p>Dodaj więc teraz middleware <code>app.use(express.urlencoded({ extended: false }));</code> i ponownie uruchom request w Postmanie. Tym razem powinien dać Ci już następujący rezultat:</p>
<a href="./Moduł_ 27. Express – własny serwer HTTP_files/Postman8.png" class="img-modal-group"><img src="./Moduł_ 27. Express – własny serwer HTTP_files/Postman8.png" alt="image" style="width: auto; max-width: 50%;"></a>
<p>Brawo! Serwer od teraz poprawnie przyjmuje wysłane dane i zwraca właściwą odpowiedź.</p>
<h3 id="274-testowanie-polaczen-http-strona-kontaktu">Strona kontaktu</h3>
<p>Serwer odbiera już dane, ale wysyłaliśmy je za pomocą Postmana. Teraz zmodyfikujemy witrynę tak, aby było to możliwe także z jej poziomu. Zajmiemy się stroną "Kontakt", bo to ona będzie w założeniu wykorzystywać endpoint <code>/contact/send-message</code>.</p>
<p>Naszym zadaniem jest dodanie niezbyt rozbudowanego formularza kontaktowego z przyciskiem "Wyślij". Użytkownik będzie mógł wpisywać dowolne dane, a gdy kliknie na ten button, formularz powinien zostać wysłany na serwer. Co ważne, <strong>nie użyjemy tutaj AJAX-u</strong>, ani nie obsłużymy go za pomocą JS-a. Wykorzystamy jedynie serwer, który sprawdzi poprawność danych i jeśli będą w porządku, zwróci użytkownikowi informację, że "Email został wysłany". W przypadku pojawienia się błędów wyświetli się ich lista.</p>
<p>Całość powinna działać mniej więcej tak:</p>
<a href="./Moduł_ 27. Express – własny serwer HTTP_files/Express15.gif" class="img-modal-group"><img src="./Moduł_ 27. Express – własny serwer HTTP_files/Express15.gif" alt="image" style="width: auto; max-width: 50%;"></a>
<h4>Dodajemy formularz</h4>
<p>Zaczniemy od najprostszego – dodania na podstronie formularza. Będzie on zawierał cztery pola: "author" (kto się kontaktuje?), "sender" (jaki jest adres email nadawcy?), "title" (tytuł wiadomość) i "message" (treść wiadomości).</p>
<p>Zmodyfikuj więc teraz <code>contact.hbs</code> następująco:</p>
<pre class=" language-html"><code class=" language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span>Contact me<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span><span class="token punctuation">&gt;</span></span>
    Your name: <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>author<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span><span class="token punctuation">&gt;</span></span>
    Your email: <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>email<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>sender<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span><span class="token punctuation">&gt;</span></span>
    Title: <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>title<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span><span class="token punctuation">&gt;</span></span>
    Message: <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>textarea</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>message<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>textarea</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Send message<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span></code></pre>
<p>Czy mamy tutaj coś nowego? Nie używamy atrybutów <code>id</code>, a zamiast nich definiujemy <code>name</code>. Nie bez powodu. Serwer właśnie po <code>name</code> będzie identyfikował dane pole z wysłanego formularza. Pamiętasz, jak w Postmanie ustawialiśmy w body <code>key</code>? Tutaj <code>name</code> w każdym polu to właśnie <code>key</code> (nazwa) danej informacji.</p>
<p>Zauważ, że gdybyśmy chcieli teraz podążać tokiem pracy, jakiego używaliśmy we wcześniejszych modułach, kolejnym etapem byłoby zablokowanie domyślnego zachowania formularza na jego evencie <code>submit</code>, a następnie obsłużenie kliknięcia na button w taki sposób, że wszystko byłoby walidowane w JS-ie.</p>
<p>Tym razem zrobimy jednak inaczej. Nie zablokujemy domyślnego procesu wysyłania formularza, a to dlatego, że teraz mamy już możliwość odebrania go na serwerze. Po raz pierwszy postąpimy więc zgodnie z założeniami twórców tej funkcjonalności.</p>
<div class="bc-note alert-success">
<h4 class="alert-heading text-center">Klasyczna obsługa formularzy</h4>
<img src="./Moduł_ 27. Express – własny serwer HTTP_files/Form.png" class="img-inline img-right">
<p>Musisz uświadomić sobie jedną rzecz: <strong>kiedy obsługujesz formularz za pomocą JS-a i nie wysyłasz go na serwer, tak naprawdę działasz wbrew jego założeniom</strong>.</p>
<p>Zauważ, że pierwszą rzeczą, którą robiliśmy dotychczas przy pracy z formularzami, było przypinanie funkcji do jego eventu <code>submit</code> i wyłączanie funkcjonalności (<code>event.preventDefault()</code>). <strong>Robiliśmy to, aby zablokować domyślne działanie formularzy</strong>.</p>
<p>W założeniu jednak kliknięcie "Submit" powinno być równoznaczne z wysłaniem danych na serwer, gdzie będą mogły być należycie obsłużone.</p>
<p>Ta idea to oczywiście pozostałość "starego porządku", a więc czasów, kiedy JS jeszcze raczkował, a od frontendu oczekiwano bardzo niewiele. Całą logiką zajmował się serwer, choć oczywiście było to trochę uciążliwe. W czasach, gdy AJAX jeszcze nie istniał, wykonywanie jakiejkolwiek operacji na stronie było równoznaczne z jej przeładowaniem.</p>
<p>Wiedząc to, łatwo możemy zrozumieć, dlaczego formularze tak ochoczo chcą być przesyłane do serwera. Przecież nawet nie musimy tworzyć specjalnego buttonu o typie <code>submit</code> – kliknięcie na zwykły przycisk z automatu powoduje wysyłkę formularza. Kiedyś było to standardem i nawet nie wyobrażano sobie innej możliwości.</p>
<p>Oczywiście czasy się zmieniły i dziś bardzo często unikamy domyślnego zachowania formularzy. Wolimy całą obsługę zrobić od razu, ewentualnie wysłać żądanie w tle, aby strona nie musiała się niepotrzebnie przeładowywać. Dzięki temu zapewniamy użytkownikowi znacznie lepszy <em>user experience</em>.</p>
<p>Swoją drogą, klasyczny sposób obsługi formularzy jeszcze nie wymarł. W rozbudowanych aplikacjach frontendowych oczywiście raczej go nie uświadczymy, ale bardzo dużo witryn, zwłaszcza tych opartych na PHP, wciąż korzysta z niego na co dzień.</p>
</div>
<p>Pozostaje jeszcze jedna sprawa – dokąd tak konkretnie wyśle się ten formularz i za pomocą jakiej metody? Możemy jakoś wskazać, że chodzi właśnie o <code>/contact/send-message</code>?</p>
<p>Domyślnie formularz jest wysyłany pod ten sam link, z którego zainicjowano operację. Jeśli znajduje się na stronie <code>/contact</code>, to trafi właśnie pod ten adres. Domyślną metodą jest <code>GET</code>. Jak się domyślasz, to niezbyt dobra idea do wysyłki danych, bo przecież powodowałaby wysłanie informacji z formularza w... linku (np. <code>contact?author=John%20Doe&amp;sender...</code>).</p>
<p>Na szczęście łatwo możemy zmienić oba ustawienia za pomocą zwykłych atrybutów w elemencie <code>form</code>. Użycie <code>action</code> pozwala zdefiniować link, pod który chcemy wysłać formularz, a <code>method</code> oczywiście metodę. My ustawimy sobie połączenie <code>POST</code>, a sam link określmy jako <code>./contact/send-message</code>.</p>
<pre class=" language-html"><code class=" language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span>Contact me<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/contact/send-message<span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>POST<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span><span class="token punctuation">&gt;</span></span>
  ...</code></pre>
<h4>Testujemy</h4>
<p>Sprawdźmy teraz, czy wszystko działa. Wejdź na podstronę kontaktu, wpisz do formularza te same dane, które wcześniej wprowadzaliśmy przy testowaniu endpointu w Postmanie i kliknij na przycisk "Send message".</p>
<p>Efekt powinien być dokładnie taki sam, jak w przypadku symulacji w Postmanie. Wysyłamy formularz o takim samym typie (<code>form</code> domyślnie używa <code>x-www-form-urlencoded</code>), z takimi samymi danymi, pod ten sam adres i za pomocą tej samej metody, zatem endpoint powinien otrzymać dokładnie taki sam request.</p>
<p>Faktycznie tak jest:</p>
<a href="./Moduł_ 27. Express – własny serwer HTTP_files/Express14.png" class="img-modal-group"><img src="./Moduł_ 27. Express – własny serwer HTTP_files/Express14.png" alt="image" style="width: auto; max-width: 50%;"></a>
<h4>Walidacja</h4>
<p>Czas na rozwinięcie roli naszego serwera. W tej chwili tylko odbiera request i zwraca, co otrzymał. W założeniu powinien najpierw zwalidować te dane.</p>
<p>Nie zrobimy tutaj niczego zaawansowanego, po prostu sprawdzimy, czy pola zostały w ogóle wypełnione. Jeśli któreś będzie puste, poinformujemy użytkownika o błędzie, a gdy wszystko okaże się w porządku, zwrócimy komunikat o wysłaniu wiadomości. Oczywiście na tym etapie niczego nie wyślemy i zakończymy nasz projekt na pokazaniu samego komunikatu.</p>
<p>Zmodyfikuj teraz swój endpoint <code>/contact/send-message</code>:</p>
<pre class=" language-js"><code class=" language-js">app<span class="token punctuation">.</span><span class="token method function property-access">post</span><span class="token punctuation">(</span><span class="token string">'/contact/send-message'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>

  <span class="token keyword">const</span> <span class="token punctuation">{</span> author<span class="token punctuation">,</span> sender<span class="token punctuation">,</span> title<span class="token punctuation">,</span> message <span class="token punctuation">}</span> <span class="token operator">=</span> req<span class="token punctuation">.</span><span class="token property-access">body</span><span class="token punctuation">;</span>

  <span class="token keyword control-flow">if</span><span class="token punctuation">(</span>author <span class="token operator">&amp;&amp;</span> sender <span class="token operator">&amp;&amp;</span> title <span class="token operator">&amp;&amp;</span> message<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token string">'The message has been sent!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword control-flow">else</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token string">'You can\'t leave fields empty!'</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span>

<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Nie jest to walidacja najwyższych lotów, ponieważ sprawdzamy tylko, czy pola nie są puste. Nie informujemy nawet, które dokładnie. Dla naszego małego przykładu to jednak wystarczy.</p>
<p>Przetestuj teraz dwukrotnie formularz kontaktu. Za pierwszym razem poprawnie wypełnij wszystkie pola. Serwer powinien zwrócić komunikat "The message has been sent!". Za drugim razem celowo omiń jedno pole i pozostaw je pustym. Zobaczysz wtedy komunikat "You can't leave fields empty!".</p>
<p>Jeśli właśnie tak się stało, walidacja jest gotowa :)</p>
<h4>Dopracowujemy odpowiedź</h4>
<p>Pokazywanie samych komunikatów tekstowych nie wygląda zbyt profesjonalnie. Zgodnie z założeniami, musimy zwracać plik HTML z formularzem (<code>contact.hbs</code>), oraz nasz komunikat, w zależności od efektów – pozytywny lub negatywny.</p>
<p>Sytuacja jest więc podobna do tej z poprzedniego submodułu, gdzie ostatecznie wspomogliśmy się Handlebars. Mamy bowiem plik, którego jedna część jest stała (formularz), a druga dynamiczna (pojawienie się komunikatu). Skoro Handlebars i tak mamy już przygotowane, spokojnie możemy skorzystać z jego usług w trochę bardziej zaawansowany sposób niż tylko zwracanie statycznego pliku HTML.</p>
<p>Zacznij od modyfikacji <code>contact.hbs</code>. Spróbuj to zrobić bez naszej pomocy. Celem jest dodanie dwóch divów z komunikatami, przy czym powinny być one zależne od sytuacji.</p>
<p>Warunkowanie w Handlebars wygląda następująco:</p>
<pre class=" language-js"><code class=" language-js"><span class="token punctuation">{</span><span class="token punctuation">{</span>#<span class="token keyword control-flow">if</span> yourCondition<span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token maybe-class-name">Your</span> content
<span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token operator">/</span><span class="token keyword control-flow">if</span><span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre>
<p>Czyli np.</p>
<pre class=" language-js"><code class=" language-js"><span class="token punctuation">{</span><span class="token punctuation">{</span>#<span class="token keyword control-flow">if</span> isSomethingValid<span class="token punctuation">}</span><span class="token punctuation">}</span>
<span class="token maybe-class-name">Something</span> is valid<span class="token operator">!</span>
<span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token operator">/</span><span class="token keyword control-flow">if</span><span class="token punctuation">}</span><span class="token punctuation">}</span></code></pre>
<p>Załóż, że u nas zmiennymi warunkowymi będą <code>isError</code> i <code>isSent</code>. Wykorzystamy je przy sprawdzeniu, czy dany komunikat ma się pokazać. Jeśli <code>isSent</code> jest <code>true</code>, to potrzebujemy komunikatu "The message has been sent!", a jeśli <code>isError</code> jest <code>true</code>, to "You can't leave fields empty!".</p>
<p>Spróbuj wykonać tę modyfikację bez naszej pomocy. Oba komunikaty zamknij w divach i nadaj im klasy – <code>.isSent</code> (dla tekstu o sukcesie) i <code>.isError</code> (dla tekstu o porażce).</p>
<p>Następnie wystarczy wykorzystać nasz zmodyfikowany plik przy renderowaniu odpowiedzi w <code>contact/send-message</code>:</p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword control-flow">if</span><span class="token punctuation">(</span>author <span class="token operator">&amp;&amp;</span> sender <span class="token operator">&amp;&amp;</span> title <span class="token operator">&amp;&amp;</span> message<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">render</span><span class="token punctuation">(</span><span class="token string">'contact'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> isSent<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword control-flow">else</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">render</span><span class="token punctuation">(</span><span class="token string">'contact'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> isError<span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<p>Od teraz nasza aplikacja powinna wyglądać następująco:</p>
<a href="./Moduł_ 27. Express – własny serwer HTTP_files/Express14.gif" class="img-modal-group"><img src="./Moduł_ 27. Express – własny serwer HTTP_files/Express14.gif" alt="image" style="width: auto;"></a>
<h3 id="274-testowanie-polaczen-http-stylujemy-aplikacje">Stylujemy aplikację</h3>
<p>Pozostała nam tylko praca nad wyglądem. Nie musisz jednak robić tego na własną rękę. Poniżej znajduje się kod, który wystarczy skopiować do Twojego arkusza <code>style.css</code>.</p>
<pre class=" language-css"><code class=" language-css"><span class="token atrule"><span class="token rule">@import</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span><span class="token string url">'https://fonts.googleapis.com/css?family=Open+Sans&amp;display=swap'</span><span class="token punctuation">)</span></span><span class="token punctuation">;</span></span>

<span class="token selector">body</span> <span class="token punctuation">{</span>
  <span class="token property">background</span><span class="token punctuation">:</span> <span class="token hexcode color">#282c34</span><span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode color">#fff</span><span class="token punctuation">;</span>
  <span class="token property">font-family</span><span class="token punctuation">:</span> <span class="token string">'Open Sans'</span><span class="token punctuation">,</span> sans-serif<span class="token punctuation">;</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">30</span><span class="token unit">px</span><span class="token punctuation">;</span>
  <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">h1</span> <span class="token punctuation">{</span>
  <span class="token property">font-weight</span><span class="token punctuation">:</span> lighter<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">p</span> <span class="token punctuation">{</span>
  <span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode color">#999</span><span class="token punctuation">;</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token number">0.8</span><span class="token unit">rem</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">a</span> <span class="token punctuation">{</span>
  <span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode color">#999</span><span class="token punctuation">;</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token number">0.8</span><span class="token unit">rem</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">label</span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span>
  <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token unit">rem</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">input<span class="token punctuation">,</span>
textarea</span> <span class="token punctuation">{</span>
  <span class="token property">background</span><span class="token punctuation">:</span> <span class="token color"><span class="token function">rgba</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0.2</span><span class="token punctuation">)</span></span><span class="token punctuation">;</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">0.6</span><span class="token unit">rem</span> <span class="token number">1</span><span class="token unit">rem</span><span class="token punctuation">;</span>
  <span class="token property">border</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
  <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">0</span> <span class="token number">1</span><span class="token unit">rem</span><span class="token punctuation">;</span>
  <span class="token property">border-radius</span><span class="token punctuation">:</span> <span class="token number">0.5</span><span class="token unit">rem</span><span class="token punctuation">;</span>
  <span class="token property">outline</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode color">#fff</span><span class="token punctuation">;</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> inherit<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">textarea</span> <span class="token punctuation">{</span>
  <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token unit">rem</span> auto<span class="token punctuation">;</span>
  <span class="token property">width</span><span class="token punctuation">:</span> <span class="token number">400</span><span class="token unit">px</span><span class="token punctuation">;</span>
  <span class="token property">height</span><span class="token punctuation">:</span> <span class="token number">200</span><span class="token unit">px</span><span class="token punctuation">;</span>
  <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">button</span> <span class="token punctuation">{</span>
  <span class="token property">background</span><span class="token punctuation">:</span> <span class="token hexcode color">#0064e7</span><span class="token punctuation">;</span>
  <span class="token property">border</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
  <span class="token property">border-radius</span><span class="token punctuation">:</span> <span class="token number">15</span><span class="token unit">px</span><span class="token punctuation">;</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token unit">px</span> <span class="token number">25</span><span class="token unit">px</span><span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode color">#fff</span><span class="token punctuation">;</span>
  <span class="token property">font-family</span><span class="token punctuation">:</span> inherit<span class="token punctuation">;</span>
  <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">20</span><span class="token unit">px</span> <span class="token number">10</span><span class="token unit">px</span><span class="token punctuation">;</span>
  <span class="token property">text-transform</span><span class="token punctuation">:</span> uppercase<span class="token punctuation">;</span>
  <span class="token property">outline</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
  <span class="token property">transition</span><span class="token punctuation">:</span> <span class="token number">.2</span><span class="token unit">s</span><span class="token punctuation">;</span>
  <span class="token property">cursor</span><span class="token punctuation">:</span> pointer<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector"><span class="token class">.isError</span></span> <span class="token punctuation">{</span>
  <span class="token property">background</span><span class="token punctuation">:</span> <span class="token hexcode color">#fff</span><span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode color">#000</span><span class="token punctuation">;</span>
  <span class="token property">border-left</span><span class="token punctuation">:</span> <span class="token number">4</span><span class="token unit">px</span> solid <span class="token hexcode color">#111</span><span class="token punctuation">;</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">0.9</span><span class="token unit">rem</span> <span class="token number">0.8</span><span class="token unit">rem</span><span class="token punctuation">;</span>
  <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token unit">rem</span> auto <span class="token number">1.5</span><span class="token unit">rem</span> auto<span class="token punctuation">;</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">opacity</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token property">font-weight</span><span class="token punctuation">:</span> lighter<span class="token punctuation">;</span>
  <span class="token property">box-shadow</span><span class="token punctuation">:</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token color"><span class="token function">rgba</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0.2</span><span class="token punctuation">)</span></span><span class="token punctuation">;</span>
  <span class="token property">max-width</span><span class="token punctuation">:</span> <span class="token number">15</span><span class="token unit">rem</span><span class="token punctuation">;</span>
  <span class="token property">border-radius</span><span class="token punctuation">:</span> <span class="token number">4</span><span class="token unit">px</span><span class="token punctuation">;</span>
  <span class="token property">background</span><span class="token punctuation">:</span> <span class="token hexcode color">#ff5d6c</span><span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode color">#fff</span><span class="token punctuation">;</span>
  <span class="token property">border-color</span><span class="token punctuation">:</span><span class="token hexcode color">#ea2027</span><span class="token punctuation">;</span>
  <span class="token property">-webkit-animation-name</span><span class="token punctuation">:</span> fadeIn<span class="token punctuation">;</span>
  <span class="token property">animation-name</span><span class="token punctuation">:</span> fadeIn<span class="token punctuation">;</span>
  <span class="token property">animation-duration</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token unit">s</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector"><span class="token class">.isSent</span></span> <span class="token punctuation">{</span>
  <span class="token property">background</span><span class="token punctuation">:</span> <span class="token hexcode color">#fff</span><span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode color">#000</span><span class="token punctuation">;</span>
  <span class="token property">border-left</span><span class="token punctuation">:</span> <span class="token number">4</span><span class="token unit">px</span> solid <span class="token hexcode color">#111</span><span class="token punctuation">;</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">0.9</span><span class="token unit">rem</span> <span class="token number">0.8</span><span class="token unit">rem</span><span class="token punctuation">;</span>
  <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token unit">rem</span> auto <span class="token number">1.5</span><span class="token unit">rem</span> auto<span class="token punctuation">;</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">opacity</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token property">font-weight</span><span class="token punctuation">:</span> lighter<span class="token punctuation">;</span>
  <span class="token property">box-shadow</span><span class="token punctuation">:</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token color"><span class="token function">rgba</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0.2</span><span class="token punctuation">)</span></span><span class="token punctuation">;</span>
  <span class="token property">max-width</span><span class="token punctuation">:</span> <span class="token number">15</span><span class="token unit">rem</span><span class="token punctuation">;</span>
  <span class="token property">border-radius</span><span class="token punctuation">:</span> <span class="token number">4</span><span class="token unit">px</span><span class="token punctuation">;</span>
  <span class="token property">background</span><span class="token punctuation">:</span> <span class="token hexcode color">#26c281</span><span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode color">#fff</span><span class="token punctuation">;</span>
  <span class="token property">border-color</span><span class="token punctuation">:</span><span class="token hexcode color">#01916d</span><span class="token punctuation">;</span>
  <span class="token property">-webkit-animation-name</span><span class="token punctuation">:</span> fadeIn<span class="token punctuation">;</span>
  <span class="token property">animation-name</span><span class="token punctuation">:</span> fadeIn<span class="token punctuation">;</span>
  <span class="token property">animation-duration</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token unit">s</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token atrule"><span class="token rule">@-webkit-keyframes</span> fadeIn</span> <span class="token punctuation">{</span>
  <span class="token selector">from</span> <span class="token punctuation">{</span>
    <span class="token property">opacity</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token selector">to</span> <span class="token punctuation">{</span>
    <span class="token property">opacity</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token atrule"><span class="token rule">@keyframes</span> fadeIn</span> <span class="token punctuation">{</span>
  <span class="token selector">from</span> <span class="token punctuation">{</span>
    <span class="token property">opacity</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token selector">to</span> <span class="token punctuation">{</span>
    <span class="token property">opacity</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>I gotowe! :)</p>

                        </div>
                    </div>
                                        <div class="card-block task-card">
                        <h3 id="274-testowanie-polaczen-http-zadanie-rozwijamy-podstrone-kontaktu">Zadanie: <span class="task-title">rozwijamy podstronę kontaktu</span></h3>
                        <div class="task-content">
                            <p>Czas na pracę samodzielną. Twoim zadaniem będzie rozwinięcie formularza kontaktu o jeszcze jedno pole "Project design", które pozwoli wysyłać na serwer plik obrazkowy. Co ważne – <strong>wcale nie będziemy przechowywać go na dysku</strong>. Ty musisz tylko umożliwić wysłanie wybranego pliku za pomocą formularza, odebrać go na serwerze i zwrócić komunikat, że plik o danej nazwie został "rzekomo" wysłany wraz z samą wiadomością.</p>
<p>Funkcjonalność powinna być zaimplementowana następująco:</p>
<ol>
<li>Formularz musi rozszerzyć się o jedno nowe pole do wybrania pliku (<code>&lt;input type="file"&gt;</code>). Użytkownik powinien być w stanie wybrać dowolny plik, ale tylko jeśli jego rozszerzeniem jest .png, .jpg, .jpeg albo .gif.</li>
<li>Po wysłaniu formularza na serwer, nowe pole powinno być zwalidowane tak samo, jak pozostałe.</li>
<li>Jeśli wszystkie pola zostały wypełnione, użytkownik powinien na końcu otrzymywać ten sam komunikat co wcześniej "The message has been sent!", ale tym razem jeszcze z nową linijką "File <em>nazwapliku</em> has been saved", czyli np. jeśli plik nazywał się test.png, to komunikat wyglądałby tak: "The message has been sent! File test.png has been saved!".</li>
</ol>
<p>Efekt powinien wyglądać następująco:</p>
<a href="./Moduł_ 27. Express – własny serwer HTTP_files/Express16.gif" class="img-modal-group"><img src="./Moduł_ 27. Express – własny serwer HTTP_files/Express16.gif" alt="image" style="width: auto; max-width: 50%;"></a>
<p>Jeśli uważasz, że dasz sobie radę bez naszej pomocy, od razu bierz się do pracy. Możliwe jednak, że przydadzą Ci się poniższe wskazówki:</p>
<ol>
<li>
<p>Pamiętaj, że domyślny typ przesyłania formularza (<code>x-www-form-urlencoded</code>) nie jest idealny do transferowania plików, koniecznie ustaw więc <code>multipart/form-data</code>. Możesz to zrobić przy użyciu atrybutu <code>enctype</code> w <code>form</code>.</p>
<div class="bc-note alert-warning">
<h4 class="alert-heading text-center">Uwaga! </h4>
<p>Domyślnie Express nie pomaga nam w obsłudze formularzy <code>multipart/form-data</code>. Nie daje nam łatwego dostępu do uploadowanych plików ani nawet samego <code>req.body</code>. Dlatego też konieczne będzie użycie dodatkowej paczki middleware, takiej jak np. Multer czy Formiddable.</p>
</div>
</li>
<li>
<p>Aby filtrować pokazywane użytkownikowi pliki (w dialogu systemowym), możesz użyć atrybutu <code>accept</code>.</p>
</li>
<li>
<p>Nowe pole z plikiem powinno być teraz od zawsze wymagane. Zmiana treści komunikatu sukcesu może być więc "sztywna", musimy jednak wstawić tam również jeden placeholder na nazwę pliku. Potem przy renderowaniu trzeba dynamicznie ustalać jego wartość.</p>
</li>
</ol>
<h4>Dla chętnych</h4>
<p>Jeśli uważasz, że to dla Ciebie za mało, mamy jeszcze jedno wyzwanie. W tej chwili komunikat o sukcesie pokazuje tylko nazwę pliku, który udało nam się wysłać wraz z formularzem. Spróbuj tak zmodyfikować kod, aby zamiast niego, pokazywał się sam obrazek.</p>
<p>Pomocne będzie faktyczne załadowanie pliku do folderu, w którym jest nasz serwer (najlepiej do <code>public</code>, aby dostęp do niego był od razu ułatwiony). Możesz to zrobić na wiele sposobów, nawet z użyciem gotowych pluginów. Internet będzie tutaj Twoim sprzymierzeńcem.</p>

                        </div>
                    </div>
                                        <div class="card-block submodule-footer clearfix  completed ">
                                                <div class="clearfix">
                                                                                <a href="https://kodilla.com/pl/bootcamp-task/407/661006" target="_blank" class="btn btn-info-outline">Podgląd zadania</a>
                            <form target="_blank" class="form-inline project-link-form">
                                <div class="form-group">
                                    <input type="text" name="link" class="form-control" value="https://github.com/skwiryt/first-express">
                                </div>
                                <button type="submit" class="btn  btn-primary ">Wyślij link <i class="fa fa-check"></i></button>
                            </form>
                                                                                                    </div>
                    </div>
                </section>
                                    
                <section id="submodule-1120" class="card submodule completed" data-bootcamp-user-submodule-id="661007">
                <!-- klasy dla section: completed current comments -->
                    <div class="card-block submodule-header clearfix">
                        <i class="fa fa-check-circle-o fa-2x"></i>
                        <i class="fa fa-play-circle-o fa-2x"></i>
                        <i class="fa fa-exclamation-circle fa-2x"></i>
                        <i class="fa fa-send-o fa-2x"></i>
                        <h2 class="bootcamp-submodule-name">27.5. <span>REST API w praktyce</span></h2>
                                            </div>
                    <div class="card-block">
                        <div class="submodule-content">
                            <p>Dowiedzieliśmy się już całkiem sporo. Umiemy przy użyciu Expressu tworzyć własne serwery, wiemy jak obsługiwać wybrane endpointy, co znajduje się w obiekcie żądania (request) oraz w jaki sposób zwracać odpowiedzi (response). Dowiedzieliśmy się jak pomocnym narzędziem, również w backendzie, może być silnik do renderowania szablonów. Dodatkowo poznaliśmy sposób klasycznej obsługi formularzy, który teraz nie ma przed nami żadnych tajemnic.</p>
<p>Warto powiedzieć jednak, że w naszej pracy backend niezbyt często będzie pełnił aż tak ważną rolę. Zazwyczaj jego zadanie ograniczy się do pośredniczenia w kontakcie z bazą danych przy użyciu endpointów (mówimy wtedy o <strong>Serwerze API</strong>) lub/i zwracania gotowej aplikacji pod głównym linkiem.</p>
<p>Taki właśnie serwer zbudujemy teraz w ramach szlifowania naszej wiedzy.</p>
<h3 id="275-rest-api-w-praktyce-serwer-api-standaryzacja">Serwer API, standaryzacja</h3>
<p>Czym jest serwer API? <strong>To szczególny typ serwera, którego głównym (a najczęściej jedynym) zadaniem jest pośredniczenie w dostępie do jakichś danych</strong>. Przeważnie chodzi tutaj o duże rozbudowane bazy np. stworzone przy pomocy MongoDB (ten temat pojawi się jeszcze u nas w kursie). Serwer nie zawsze musi być bardzo zaawansowany. <strong>Jego rolą jest po prostu udostępnianie zestawu endpointów, za pomocą których możemy dostać się do danych, a czasem również je modyfikować.</strong></p>
<p>O ile niektóre funkcje, które wykonywaliśmy za pomocą serwera w poprzednich submodułach, mogły być dla Ciebie czymś całkiem nowym, to teraz poczujesz się zapewne jak ryba w wodzie. Prawdopodobnie przed tym modułem właśnie tak postrzegałeś temat serwerów.</p>
<p>Skoro jego rola jest tak mała, dlaczego w ogóle go potrzebujemy? Czy klient nie może bezpośrednio komunikować się z bazą danych? Odpowiedź jest prosta – nie może. Jednak faktycznie, rola serwera często sprowadza się właśnie do tego – <strong>pośredniczenia w kontakcie klienta z bazą danych</strong>. Gdy na przykład potrzebujemy jakieś dane, prosimy o nie serwer – on wyciąga je z bazy i zwraca. Chcemy dodać nowy rekord? Wysyłamy serwerowi informację, co chcemy dodać, on wprowadza nowe dane do bazy i powiadamia nas o sukcesie albo porażce. Sama komunikacja to "proszenie" o którym teraz pisaliśmy, odbywa się oczywiście poprzez podstawowy protokół komunikacyjny klient-serwer, czyli HTTP. Korzystamy tu z mechanizmu "request-response".</p>
<p>Przykładowy serwer API, udostępniający bazę z użytkownikami, mógłby oferować np. takie endpointy:</p>
<ul>
<li><code>GET</code> <code>/users</code> – pobiera wszystkie dane z bazy i zwraca je.</li>
<li><code>GET</code> <code>/users/:id</code> – pobiera z bazy użytkownika o id równym parametrowi <code>:id</code> i zwraca go.</li>
<li><code>POST</code> <code>/users</code> – dodaje do bazy nowego użytkownika.</li>
<li><code>DELETE</code> <code>/users/:id</code> – usuwa użytkownika o id równym parametrowi <code>:id</code>.</li>
<li><code>PUT</code> <code>/users/:id</code> – modyfikuje użytkownika o id równym parametrowi <code>:id</code>.</li>
</ul>
<p>Pobieranie listy użytkowników w aplikacji wyglądałoby tak:</p>
<a href="./Moduł_ 27. Express – własny serwer HTTP_files/SerwerAPI.png" class="img-modal-group"><img src="./Moduł_ 27. Express – własny serwer HTTP_files/SerwerAPI.png" alt="image" style="width: auto;"></a>
<p>Zatem:</p>
<ol>
<li>Klient (np. za pomocą AJAX-a) wysyła <code>request</code> do serwera pod link <code>/users</code>, używając metody <code>GET</code>.</li>
<li>Serwer odbiera żądanie i łączy się z bazą danych w celu pobrania wszystkich użytkowników.</li>
<li>Po odebraniu danych zwraca je w formie <code>response</code> (odpowiedzi) klientowi.</li>
</ol>
<p>To właśnie technika, którą w kursie już niejednokrotnie wykorzystywaliśmy, z tą różnicą, że wcześniej część serwerowa była gotowa, a teraz zbudujemy ją sami.</p>
<p>Warto dodać jeszcze jedną rzecz – <strong>najczęściej przesyłanie tych danych w jedną i drugą stronę odbywa się przy wykorzystaniu formatu JSON.</strong></p>
<h3 id="275-rest-api-w-praktyce-rest-podazamy-za-standardem">REST – podążamy za standardem</h3>
<p>We wcześniejszym przykładzie pokazaliśmy, że serwer do kontaktu z bazą danych mógłby udostępniać następujące endpointy:</p>
<ul>
<li><code>GET</code> <code>/users</code></li>
<li><code>GET</code> <code>/users/:id</code></li>
<li><code>POST</code> <code>/users</code></li>
<li><code>DELETE</code> <code>/users/:id</code></li>
<li><code>PUT</code> <code>/users/:id</code></li>
</ul>
<p>Wykorzystany format może wydawać Ci się intuicyjny i znajomy, ale czy coś stoi na przeszkodzie, aby te same funkcjonalności ukryć np. pod takimi endpointami?</p>
<ul>
<li><code>GET</code> <code>/get-users</code></li>
<li><code>GET</code> <code>/get-user-by-id/:id</code></li>
<li><code>POST</code> <code>/add-user</code></li>
<li><code>DELETE</code> <code>/delete-user/:id</code></li>
<li><code>PUT</code> <code>/edit-user/:id</code></li>
</ul>
<p>Albo jeszcze innymi, np. <code>/users/getAll</code>, <code>users/byId/:id</code>?</p>
<p>Oczywiście, możemy tak zrobić. To programista decyduje jaki format wykorzysta, a co za tym idzie – w każdym projekcie mógłby zastosować inny. Nie jest to jednak praktyczne. W ten sposób kod mógłby okazać się nieczytelny dla innych developerów, a tworzenie nazw endpointów niekonsekwentne. Dlatego wskazane jest przestrzeganie konwencji i standardów.</p>
<div class="bc-note alert-success">
<h4 class="alert-heading text-center">REST – <strong>Re</strong>spresentation <strong>S</strong>tate <strong>T</strong>ransfer</h4>
<p>Prawdopodobnie najpopularniejszym standardem na rynku jest <strong>REST</strong>. Korzystaliśmy z niego budując endpointy, zarówno w tym, jak i we wcześniejszych modułach.</p>
<p>Konwencja ta określa m.in. sposób komunikacji oraz konstruowania endpointów. W jej zamyśle sam link ma być tylko nazwą kolekcji (i ewentualnie miejscem na parametr), czyli np. <code>users</code> albo <code>users/1</code>. Natomiast to, co powinno być robione z danym zasobem, ma być określane za pomocą metody. Dlatego nawet ten sam link, przy połączeniu z inną metodą, może powodować inną zmianę w bazie danych – np. <code>GET</code> <code>/posts</code> zwróci nam liczbę postów, a <code>DELETE</code> <code>/posts</code> usunie je.</p>
</div>
<h3 id="275-rest-api-w-praktyce-przykladowa-aplikacja">Przykładowa aplikacja</h3>
<p>Aby wykorzystać naszą wiedzę w praktyce, zbudujemy teraz własny serwer API. Co ważne, skonstruujemy tylko część backendową, a do testowania endpointów użyjemy Postmana.</p>
<p>Naszym zadaniem będzie zbudowanie serwera API do obsługi księgi klientów firmy, który udostępni następujące endpointy:</p>
<ul>
<li><code>GET</code> <code>/testimonials</code> – zwracanie całej listy wpisów.</li>
<li><code>GET</code> <code>/testimonials/:id</code> – zwracanie konkretnego wpisu.</li>
<li><code>GET</code> <code>/testimonials/random</code> – zwracanie losowego wpisu.</li>
<li><code>POST</code> <code>/testimonials</code> – dodawanie nowego wpisu na bazie <code>req.body</code>, otrzymanego od części frontendowej.</li>
<li><code>PUT</code> <code>/testimonials/:id</code> – modyfikacja wpisu o danym id na bazie <code>req.body</code> otrzymanego od części frontendowej.</li>
<li><code>DELETE</code> <code>/testimonials/:id</code> – usunięcie wpisu o konkretnym id.</li>
</ul>
<div class="bc-note alert-warning">
<h4 class="alert-heading text-center">Uwaga</h4>
<p>Nasza pomoc w tym module będzie już bardzo ograniczona. Wszystko, czego potrzebujesz, było już wcześniej przedstawione. Naprowadzimy Cię na rozwiązanie, ale nie pojawi się wiele snippetów. Potraktuj to jako powtórkę zdobytej wiedzy.</p>
</div>
<h4>Tworzymy szkielet</h4>
<p>Zacznijmy od stworzenia szkieletu serwera. Utwórz nowy folder projektu, pobierz Express, następnie dodaj plik <code>server.js</code> i dopisz kod odpowiadający za tworzenie serwera na dowolnym porcie (np. <code>8000</code>). Na razie nie dodawaj jeszcze żadnych endpointów ani middleware. Możesz również zainstalować Nodemon, aby nie musieć po każdej zmianie odświeżać serwera.</p>
<p>Jeśli masz z tym problem, zajrzyj do submodułów powyżej, gdzie robiliśmy to razem.</p>
<h4>Dodajemy podstawowy middleware</h4>
<p>Czas na dodanie middleware. Oczywiście możesz stwierdzić, że nie wiemy jeszcze jak dokładnie będą wyglądać nasze endpointy. Po kilku projektach łatwo jednak stwierdzić, że jest już&nbsp;stały zestaw middleware, które są swego rodzaju standardem. Oczywiście, jeśli zajdzie potrzeba, zawsze możemy dołożyć kolejne później.</p>
<p>Jak myślisz, które z poznanych przez Ciebie wbudowanych middleware Expressu, przydadzą się nam w tym przykładzie? Pamiętaj, że zakładamy budowę wyłącznie serwera API, nie będziemy renderować żadnego widoku, a jedynie zwracać dane lub komunikaty w formacie JSON.</p>
<p>Podpowiemy, że dotychczas poznaliśmy następujące middleware:</p>
<ul>
<li><code>express.static</code></li>
<li><code>express.urlencoded</code></li>
<li><code>express.json</code></li>
</ul>
<p class="text-center">
  <span class="collapse-toggles">
    <a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#collapse-j-sm2xv9U-toggle" class="btn btn-primary collapsed" data-toggle="collapse">Pokaż odpowiedź</a>
    <a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#collapse-j-sm2xv9U-toggle" class="btn btn-primary collapsed" data-toggle="collapse">Ukryj odpowiedź</a>
  </span>
</p>
<div id="collapse-j-sm2xv9U-toggle" class="collapse">
<p>Z powyższych, tylko <code>express.static</code> będzie w naszym przypadku zbędny. Nie musimy renderować żadnego skomplikowanego widoku ani nie będziemy korzystać z CSS-a lub plików zewnętrznych.</p>
</div>
<p>Dołącz potrzebne middleware do Twojej aplikacji. Pamiętaj, że powinny być one umieszczone w kodzie dość wysoko, najlepiej po utworzeniu serwera, a koniecznie przez samymi konkretnymi endpointami, które wkrótce dodamy.</p>
<div class="bc-note alert-info">
<h4 class="alert-heading text-center">Publiczne API a CORS</h4>
<p>W tym momencie warto powiedzieć o jeszcze jednym użytecznym middleware – <a href="https://www.npmjs.com/package/cors" target="_blank">CORS</a>. Nie jest on wbudowany w Express, ale przydaje się podobnie jak <code>express.json</code> czy <code>express.static</code>. Nie w każdym serwerze będziemy musieli z niego skorzystać, ale warto poznać go na przyszłość.</p>
<p>Mechanizm CORS zapewne nie jest Ci całkiem obcy. Został on zaimplementowany przez wszystkie nowoczesne przeglądarki i stoi za funkcjonalnością wykonywania żądań AJAX-owych. Jedną z jego ważnych opcji jest również możliwość ograniczania połączeń. Możemy np. ustawić, że nasze API pozwala na połączenie tylko i wyłączne z konkretnej domeny oraz z konkretnych metod, albo – co istotne dla publicznych API – z każdej domeny.</p>
<p>Niestety sama konfiguracja CORS jest dość kłopotliwa, więc do gry musi wejść paczka middleware <code>cors</code>. Pozwala ona w łatwy sposób odblokować wszystkie połączenia.</p>
<pre class=" language-js"><code class=" language-js">app<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span><span class="token function">cors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Można też sprecyzować inne ustawienia, na przykład:</p>
<pre class=" language-js"><code class=" language-js">app<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span><span class="token function">cors</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  <span class="token string">"origin"</span><span class="token operator">:</span> <span class="token string">"https://kodilla.com"</span><span class="token punctuation">,</span> <span class="token comment">//origin sets domains that we approve</span>
  <span class="token string">"methods"</span><span class="token operator">:</span> <span class="token string">"GET,POST"</span><span class="token punctuation">,</span> <span class="token comment">//we allow only GET and POST methods</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Zastanów się, czy będziemy potrzebować tej paczki w naszym API?</p>
</div>
<h3 id="275-rest-api-w-praktyce-dodajemy-baze-danych">Dodajemy "bazę danych"</h3>
<p>Aby przechowywać referencje od klientów firmy, potrzebna będzie nam jakaś baza danych. Oczywiście, na tym etapie kursu jeszcze ich nie omawialiśmy, więc w naszym przypadku tą bazą będzie tylko zwykła tablica. Naturalnie w większym projekcie byłoby to strasznie niewygodne, a same dane ginęłyby przy restarcie serwera, ale do naszych potrzeb na razie wystarczy.</p>
<p>Stwórz więc teraz nową tablicę <code>db</code> i umieść w niej kilka rekordów w poniższym formacie:</p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> db <span class="token operator">=</span> <span class="token punctuation">[</span>
  <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> author<span class="token operator">:</span> <span class="token string">'John Doe'</span><span class="token punctuation">,</span> text<span class="token operator">:</span> <span class="token string">'This company is worth every coin!'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> author<span class="token operator">:</span> <span class="token string">'Amanda Doe'</span><span class="token punctuation">,</span> text<span class="token operator">:</span> <span class="token string">'They really know how to make you happy.'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">;</span></code></pre>
<p>Możesz nawet skopiować dokładnie te same dane.</p>
<h3 id="275-rest-api-w-praktyce-czas-na-endpointy">Czas na endpointy</h3>
<p>Teraz czas na najważniejszą część zadania, czyli dodanie wszystkich potrzebnych endpointów.</p>
<ul>
<li><code>GET</code> <code>/testimonials</code> – ma po prostu zwracać całą zawartość tablicy.</li>
<li><code>GET</code> <code>/testimonials/:id</code> – zwracamy tylko jeden element tablicy, zgodny z <code>:id</code>.</li>
<li><code>GET</code> <code>/testimonials/random</code> – zwracamy losowy element z tablicy.</li>
<li><code>POST</code> <code>/testimonials</code> – dodajemy nowy element do tablicy. Możesz założyć, że <code>body</code> przekazywane przez klienta będzie obiektem z dwoma atrybutami <code>author</code> i <code>text</code>. Id dodawanego elementu musisz losować.</li>
<li><code>PUT</code> <code>/testimonials/:id</code> – modyfikujemy atrybuty <code>author</code> i <code>text</code> elementu tablicy o pasującym <code>:id</code>. Załóż, że <code>body</code> otrzymane w requeście będzie obiektem z atrybutami <code>author</code> i <code>text</code>.</li>
<li><code>DELETE</code> <code>/testimonials/:id</code> – usuwamy z tablicy wpis o podanym id.</li>
</ul>
<p>Dodatkowo:</p>
<ul>
<li>Wszystkie dane mają być zwracane w formacie JSON. Express dostarcza gotową metodę w obiekcie <code>response</code>, która Ci w tym pomoże.</li>
<li>W przypadku endpointów dla <code>POST</code>, <code>PUT</code> czy <code>DELETE</code> zwracaj po prostu obiekt <code>{ message: 'OK' }</code>.</li>
<li>Do losowania id możesz użyć zewnętrznej biblioteki, np. <code>uuid</code>.</li>
<li>Walidacja nie jest wymagana, ale jeśli masz ochotę, możesz również sprawdzać, czy wszystkie dane zostały przekazane i jeśli nie, zwracać komunikat z błędem – koniecznie jednak w formacie JSON. Nie zapomnij w takiej sytuacji o ustawieniu odpowiedniego kodu odpowiedzi.</li>
<li>Do testowania endpointów użyj Postmana, który pozwoli Ci upewnić się, czy wszystkie działają zgodnie z planem.</li>
</ul>
<div class="bc-note alert-info">
<h4 class="alert-heading text-center">Upewnij się</h4>
<p>Zakładamy, że Twój kod w endpoincie prawdopodobnie nie będzie sprawdzał, czy operacja modyfikacji albo usunięcia się udała, tylko zawsze zwróci <code>{ message: 'OK' }</code>. Nie jest to może idealne rozwiązanie, ale w naszym prostym przykładzie tak to będzie wyglądać. Aby mieć pewność, że endpointy <code>POST</code>, <code>DELETE</code> i <code>PUT</code> działają poprawnie, możesz po ich wykonaniu ponownie odpalać <code>GET</code> <code>/testimonials</code>, który pokaże Ci, czy faktycznie doszło do zmian w tablicy.</p>
</div>
<h3 id="275-rest-api-w-praktyce-wylapujemy-wadliwe-linki">Wyłapujemy wadliwe linki</h3>
<p>Na końcu, po wszystkich endpointach, dodaj jeszcze jeden middleware. Taki, który będzie wyłapywał wszystkie wadliwe linki i zwracał obiekt JSON <code>{ message: 'Not found...' }</code> z kodem odpowiedzi 404.</p>
<h3 id="275-rest-api-w-praktyce-gotowe">Gotowe!</h3>
<p>Jeśli wszystko poszło dobrze, endpointy powinny działać następująco:</p>
<a href="./Moduł_ 27. Express – własny serwer HTTP_files/Express17.gif" class="img-modal-group"><img src="./Moduł_ 27. Express – własny serwer HTTP_files/Express17.gif" alt="image" style="width: auto;"></a>
<h3 id="275-rest-api-w-praktyce-dobre-praktyki-grupowanie-endpointow">Dobre praktyki – grupowanie endpointów</h3>
<p>Dopóki liczba endpointów nie jest duża, spokojnie możemy trzymać wszystkie w jednym pliku – nawet w tym samym, w którym tworzymy serwer. Gdy ich ilość wzrasta, wtedy warto zastanowić się nad wydzieleniem grup endpointów do osobnych plików. Nie jest to zbyt trudne, zwłaszcza że Express oferuje wsparcie takiej idei <em>out of the box</em>.</p>
<p>Możemy tworzyć zewnętrzne pliki, które przechowują same endpointy przy użyciu funkcjonalności <code>express.Router</code>.</p>
<p>Na przykład:</p>
<pre class=" language-js"><code class=" language-js"><span class="token comment">// post.routes.js</span>

<span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> router <span class="token operator">=</span> express<span class="token punctuation">.</span><span class="token method function property-access"><span class="token maybe-class-name">Router</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> db <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./../db'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// get all posts</span>
router<span class="token punctuation">.</span><span class="token method function property-access">route</span><span class="token punctuation">(</span><span class="token string">'/posts'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span>db<span class="token punctuation">.</span><span class="token property-access">posts</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">/* ... */</span>

module<span class="token punctuation">.</span><span class="token property-access">exports</span> <span class="token operator">=</span> router<span class="token punctuation">;</span></code></pre>
<p>Importujemy Express, przygotowujemy pusty router i ściągamy tablicę z danymi (w tym przykładzie jest ona zawarta w osobnym pliku <code>db.js</code>). Następnie dodajemy do routera endpointy i go eksportujemy.</p>
<p>Oczywiście takich plików z routerami możemy trzymać wiele, np. jeden do przechowywania endpointów obsługujących dane <code>users</code>, drugi do <code>comments</code>, a trzeci jeszcze innych.</p>
<p>Żeby korzystać z nich już na samym serwerze, musimy je po prostu zaimportować i dostarczyć (za pomocą <code>app.use</code>).</p>
<p>Na przykład:</p>
<pre class=" language-js"><code class=" language-js"><span class="token comment">/* ... */</span>
<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// import routes</span>
<span class="token keyword">const</span> postRoutes <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./routes/post.routes'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> usersRoutes <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'./routes/users.routes'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span><span class="token function">cors</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token method function property-access">urlencoded</span><span class="token punctuation">(</span><span class="token punctuation">{</span> extended<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token method function property-access">json</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
app<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span><span class="token string">'/api'</span><span class="token punctuation">,</span> postRoutes<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// add post routes to server</span>
app<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span><span class="token string">'/api'</span><span class="token punctuation">,</span> usersRoutes<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// add user routes to server</span>

<span class="token comment">/* ... */</span></code></pre>
<p>Ustawienie ścieżki <code>path</code> w middleware sprawia, że nasze endpointy (np. <code>/posts</code> czy <code>/users</code>) będą dostępne tylko po wejściu na nie z wybranym przedrostkiem (<code>/api/posts</code>, <code>/api/users</code>). Oczywiście, jeśli chcesz, aby Twoje endpointy były dostępne bezpośrednio, możesz ustawić podstawowy path <code>/</code>.</p>
<p>Takie wydzielanie route'ów jest bardzo pożyteczne. W ten sposób zmniejszamy ilość kodu w głównym dokumencie, a dzięki umieszczeniu endpointów w osobnych plikach, łatwiej możemy je potem odnaleźć i modyfikować. Przydaje się to zwłaszcza, kiedy będziemy mówić o bardzo dużym API i sporej liczbie endpointów.</p>
<p>Jeszcze jedna sprawa – fakt, że pliki umieściliśmy w folderze <code>routes</code>, a ich rozszerzenia to <code>routes.js</code> (np. <code>users.routes.js</code>), nie jest niczym obligatoryjnym. To tylko konwencja, której możesz się trzymać, ale nie musisz. Równie dobrze pliki z endpointami mogłyby mieć końcówkę <code>end.js</code>, a folder nazywać się <code>/endpoints</code>.</p>
<p>Nie zawsze musimy też wydzielać endpointy. Czasami, przy małych aplikacjach, nie będzie to potrzebne. Dotychczas w module tego nie robiliśmy. Warto jednak wiedzieć, że istnieje taka możliwość i jest całkiem łatwa w implementacji.</p>

                        </div>
                    </div>
                                        <div class="card-block task-card">
                        <h3 id="275-rest-api-w-praktyce-zadanie-grupujemy-endpointy">Zadanie: <span class="task-title">grupujemy endpointy</span></h3>
                        <div class="task-content">
                            <p>Nasz serwer API oferuje na razie zestaw endpointów do obsługi danych <code>testimonials</code>. Teraz dodamy kolejne dwie kolekcje danych i nowe endpointy do ich obsługi.</p>
<h4>Etap 1 – Modyfikujemy "bazę danych"</h4>
<p>Zacznij od modyfikacji tablicy z danymi.</p>
<ol>
<li>Po pierwsze wyciągnij ją do zewnętrznego pliku <code>db.js</code>.</li>
<li>Następnie zmień jej strukturę – z tablicy na obiekt, przy czym obecne dane powinny być tablicą dostępną pod atrybutem <code>testimonials</code> tego obiektu. Do tego przygotuj dwa kolejne atrybuty (również tablice) o nazwach <code>concerts</code> i <code>seats</code>.</li>
<li>Jako zawartość <code>concerts</code> i <code>seats</code> posłuży poniższy kod.</li>
</ol>
<p><em>db.concerts</em></p>
<pre class=" language-js"><code class=" language-js"><span class="token punctuation">[</span>
  <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> performer<span class="token operator">:</span> <span class="token string">'John Doe'</span><span class="token punctuation">,</span> genre<span class="token operator">:</span> <span class="token string">'Rock'</span><span class="token punctuation">,</span> price<span class="token operator">:</span> <span class="token number">25</span><span class="token punctuation">,</span> day<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> image<span class="token operator">:</span> <span class="token string">'/img/uploads/1fsd324fsdg.jpg'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> performer<span class="token operator">:</span> <span class="token string">'Rebekah Parker'</span><span class="token punctuation">,</span> genre<span class="token operator">:</span> <span class="token string">'R&amp;B'</span><span class="token punctuation">,</span> price<span class="token operator">:</span> <span class="token number">25</span><span class="token punctuation">,</span> day<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> image<span class="token operator">:</span> <span class="token string">'/img/uploads/2f342s4fsdg.jpg'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span> performer<span class="token operator">:</span> <span class="token string">'Maybell Haley'</span><span class="token punctuation">,</span> genre<span class="token operator">:</span> <span class="token string">'Pop'</span><span class="token punctuation">,</span> price<span class="token operator">:</span> <span class="token number">40</span><span class="token punctuation">,</span> day<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> image<span class="token operator">:</span> <span class="token string">'/img/uploads/hdfh42sd213.jpg'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span></code></pre>
<p><em>db.seats</em></p>
<pre class=" language-js"><code class=" language-js"><span class="token punctuation">[</span>
  <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> day<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> seat<span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span> client<span class="token operator">:</span> <span class="token string">'Amanda Doe'</span><span class="token punctuation">,</span> email<span class="token operator">:</span> <span class="token string">'amandadoe@example.com'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> day<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> seat<span class="token operator">:</span> <span class="token number">9</span><span class="token punctuation">,</span> client<span class="token operator">:</span> <span class="token string">'Curtis Johnson'</span><span class="token punctuation">,</span> email<span class="token operator">:</span> <span class="token string">'curtisj@example.com'</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span> day<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> seat<span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">,</span> client<span class="token operator">:</span> <span class="token string">'Felix McManara'</span><span class="token punctuation">,</span> email<span class="token operator">:</span> <span class="token string">'felxim98@example.com'</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span> day<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> seat<span class="token operator">:</span> <span class="token number">26</span><span class="token punctuation">,</span> client<span class="token operator">:</span> <span class="token string">'Fauna Keithrins'</span><span class="token punctuation">,</span> email<span class="token operator">:</span> <span class="token string">'mefauna312@example.com'</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token number">5</span><span class="token punctuation">,</span> day<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> seat<span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> client<span class="token operator">:</span> <span class="token string">'Felix McManara'</span><span class="token punctuation">,</span> email<span class="token operator">:</span> <span class="token string">'felxim98@example.com'</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token number">6</span><span class="token punctuation">,</span> day<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> seat<span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span> client<span class="token operator">:</span> <span class="token string">'Molier Lo Celso'</span><span class="token punctuation">,</span> email<span class="token operator">:</span> <span class="token string">'moiler.lo.celso@example.com'</span>  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span></code></pre>
<ol start="4">
<li>Wyeksportuj ten obiekt i zaimportuj go do pliku, w którym aktualnie przechowujesz endpointy.</li>
</ol>
<div class="bc-note alert-info">
<h4 class="alert-heading text-center">Uwaga</h4>
<p>Zauważ, że do importu i eksportu nie używamy na serwerze frontowego <code>import ... export</code>, tylko <code>require</code>. Jeśli nie pamiętasz z poprzedniego modułu, jak to wyglądało, potraktuj przykład z wydzielaniem endpointów z tego submodułu jako ściągawkę.</p>
</div>
<ol start="5">
<li>Nie zapomnij jeszcze zmienić dostępu do bazy w endpointach <code>/testimonials</code>. Teraz kolekcja, do której się odwołujemy to <code>db.testimionals</code>, a nie <code>db</code>.</li>
</ol>
<h4>Etap 2 – Nowe endpointy</h4>
<p>Czas na dodanie nowych endpointów do obsługi <code>concerts</code> i <code>seats</code>. Potrzebujemy następujących:</p>
<ul>
<li><code>GET</code> <code>/concerts</code></li>
<li><code>GET</code> <code>/concerts/:id</code></li>
<li><code>POST</code> <code>/concerts</code></li>
<li><code>DELETE</code> <code>/concerts/:id</code></li>
<li><code>PUT</code> <code>/concerts/:id</code></li>
<li><code>GET</code> <code>/seats</code></li>
<li><code>GET</code> <code>/seats/:id</code></li>
<li><code>POST</code> <code>/seats</code></li>
<li><code>DELETE</code> <code>/seats/:id</code></li>
<li><code>PUT</code> <code>/seats/id</code></li>
</ul>
<p>Ich działanie ma być analogiczne do endpointów z grupy <code>testimonials</code>, które już wcześniej przygotowano, czyli np. <code>GET</code> <code>/concerts</code> powinno zwracać listę wszystkich koncertów.</p>
<h4>Etap 3 – Wydzielamy endpointy</h4>
<p>Zgodnie ze wskazówkami z ostatniego rozdziału submodułu, wydziel wszystkie trzy grupy endpointów <code>testimonials</code>, <code>concerts</code> i <code>seats</code> do zewnętrznych plików (<code>testimonials.routes.js</code>, <code>concerts.routes.js</code> i <code>seats.routes.js</code>), a najlepiej również do nowego folderu (np. <code>routes</code>). Następnie zaimportuj je do pliku <code>server.js</code>.</p>
<div class="bc-note alert-warning">
<h4 class="alert-heading text-center">Uwaga</h4>
<p>W przykładzie endpointy były dołączane w taki sposób, aby działały tylko z przedrostkiem <code>/api</code>. Teraz także zastosujemy się do tej konwencji. Pamiętaj jednak, że w takim przypadku nie będą już dostępne pod linkami typu <code>/testimonials</code> czy <code>/testimionals/:id</code>, a wyłącznie pod <code>/api/testimonials</code> oraz <code>/api/testimonials:id</code>.</p>
</div>
<h4>Etap 4 – Małe ułatwienie</h4>
<p>Na końcu dodaj do <code>package.json</code> skrypt <code>start</code>, który będzie skrótem do uruchomienia komendy <code>nodemon server.js</code>.</p>
<h4>Gotowe</h4>
<p>Sprawdź za pomocą Postmana, czy endpointy działają poprawnie. Jeśli tak, wszystko gotowe!</p>
<h4>Dla ambitnych</h4>
<p>Walidacja danych nie jest wymagana, ale jeśli masz ochotę, możesz również sprawdzać, czy wszystkie dane są przekazywane do każdego z endpointów zgodnie z założeniami. Jeśli nie, serwer powinien podać komunikat z błędem, koniecznie w formacie JSON. Nie zapomnij w takiej sytuacji również o ustawieniu odpowiedniego kodu odpowiedzi.</p>

                        </div>
                    </div>
                                        <div class="card-block submodule-footer clearfix  completed ">
                                                <div class="clearfix">
                                                                                <a href="https://kodilla.com/pl/bootcamp-task/407/661007" target="_blank" class="btn btn-info-outline">Podgląd zadania</a>
                            <form target="_blank" class="form-inline project-link-form">
                                <div class="form-group">
                                    <input type="text" name="link" class="form-control" value="https://github.com/skwiryt/testimonials">
                                </div>
                                <button type="submit" class="btn  btn-primary ">Wyślij link <i class="fa fa-check"></i></button>
                            </form>
                                                                                                    </div>
                    </div>
                </section>
                                    
                <section id="submodule-1121" class="card submodule completed" data-bootcamp-user-submodule-id="661008">
                <!-- klasy dla section: completed current comments -->
                    <div class="card-block submodule-header clearfix">
                        <i class="fa fa-check-circle-o fa-2x"></i>
                        <i class="fa fa-play-circle-o fa-2x"></i>
                        <i class="fa fa-exclamation-circle fa-2x"></i>
                        <i class="fa fa-send-o fa-2x"></i>
                        <h2 class="bootcamp-submodule-name">27.6. <span>Publikujemy aplikację</span></h2>
                                            </div>
                    <div class="card-block">
                        <div class="submodule-content">
                            <p>Pisząc nasz serwer API, tak naprawdę nie wiedzieliśmy, do czego będzie on wykorzystywany. Dostaliśmy po prostu założenia, których musieliśmy się trzymać. To nic nadzwyczajnego, bardzo często w pracy mierzymy się z taką sytuacją – nie znamy szczegółów całego projektu i wykonujemy jakąś część zadań, bazując na otrzymanej specyfikacji.</p>
<p>Naszą rolą była tylko implementacja serwera API, a część frontedowa została powierzona innemu developerowi. Przygotował on cały front, wraz z jego integracją z backendem (po prostu wykorzystał nasz gotowy serwer API). Niestety nie zdążył opublikować aplikacji i wprowadzić kilku zmian, o które klient dodatkowo poprosił. Naszym zadaniem będzie dokończenie tych zadań.</p>
<h3 id="276-publikujemy-aplikacje-pare-slow-o-projekcie">Parę słów o projekcie</h3>
<p>Będziemy pracować nad witryną festiwalu muzycznego "New Wave Festival", która ma tylko trzy podstrony:</p>
<ol>
<li><strong>Home</strong> – mamy tu karuzelę oraz informacje o występujących artystach (dane pobrane z API).</li>
<li><strong>Prices</strong> – podstrona z informacją o cenach.</li>
<li><strong>Order a ticket</strong> – możemy tutaj zamówić bilet na wybrany koncert. Podstrona wykorzystuje informację z serwera o ilości wolnych miejsc. Dzięki temu użytkownik może zarezerwować tylko dostępne miejscówki.</li>
</ol>
<p>Nas interesuje tylko trzecia podstrona. To tutaj będziemy wprowadzać wszystkie modyfikacje.</p>
<h3 id="276-publikujemy-aplikacje-lista-zadan">Lista zadań</h3>
<p>Co mamy do zrobienia?</p>
<h4>Etap 1</h4>
<p>W tej chwili aplikacja pobiera listę miejsc tylko raz – po wejściu na podstronę "Order a ticket". Problem w tym, że w czasie, gdy wpisujemy dane i wybieramy miejsce, może ono zostać zajęte przez innego użytkownika. Powinniśmy częściej odświeżać te informacje.</p>
<h4>Etap 2</h4>
<p>Drugie zadanie łączy się z pierwszym. Nawet jeśli informacje będą odświeżały się co dwie minuty i tak nie mamy pewności, że w tym czasie ktoś nie zajął miejsca. Musimy więc zmodyfikować serwer API, żeby odpowiedni endpoint sprawdzał przy bukowaniu, czy miejsce jest wolne i jeśli nie, zwracał informację o błędzie.</p>
<h4>Publikacja</h4>
<p>Kiedy wszystko będzie już gotowe, musimy opublikować aplikację na Heroku.</p>
<h3 id="276-publikujemy-aplikacje-bierzemy-sie-do-pracy">Bierzemy się do pracy</h3>
<p>Zanim zaczniemy pracować nad samymi zadaniami, musisz pobrać materiały frontendowe. Możesz to zrobić pod <a href="https://uploads.kodilla.com/bootcamp/wdp/27.express/NewWaveFest-v2.zip" target="_blank">tym linkiem</a>. Po pobraniu umieść całość w nowym katalogu <code>client</code> w Twojej aplikacji z serwerem.</p>
<p>Developer użył Reacta i Reduksa oraz wykorzystał React Router, do tego bazował na szablonie startowym Create React App, więc wszystko powinno wyglądać dla Ciebie znajomo.</p>
<p>Po pobraniu frontu aplikacji zainstaluj pakiety zdefiniowane w <code>package.json</code> za pomocą komendy <code>yarn</code> (lub <code>yarn install</code> – oba są odpowiednikiem <code>npm install</code>), a następnie uruchom. Wystartuj również proces serwera.</p>
<div class="bc-note alert-warning">
<h4 class="alert-heading text-center">Uwaga!</h4>
<p>Podgląd aplikacji reactowej otwiera się pod adresem <code>localhost:3000</code>, a więc port jest inny niż ten używany przez serwer. Skoro adresy są różne, koniecznie należy odpowiednio skonfigurować serwer – musi pozwalać na połączenia z "obcych" serwerów. Jeśli więc wcześniej na Twoim serwerze API nie zastosowano middleware <code>cors</code>, czas to zmienić.</p>
</div>
<h3 id="276-publikujemy-aplikacje-etap-1">Etap 1</h3>
<p>Zaczniemy od podstrony "Order a ticket" do zamawiania biletów. Posiada ona funkcjonalność wyboru miejsca i pokazuje aktualny stan wypełnienia sali.</p>
<a href="./Moduł_ 27. Express – własny serwer HTTP_files/Express18.png" class="img-modal-group"><img src="./Moduł_ 27. Express – własny serwer HTTP_files/Express18.png" alt="image" style="width: auto; max-width: 50%;"></a>
<p>Niestety informacje o zajętych miejscach ładowane są tylko raz, po wejściu na podstronę. Jeśli użytkownik decyduje się dość długo, możliwe, że w tym czasie liczba i układ wolnych miejsc się zmieni.</p>
<p>Za odświeżanie danych o zajętych miejscach (w <code>SeatChooser</code>) odpowiada metoda <code>loadSeats</code>, dostępna w propsach (dispatchuje akcję w Reduksie). W tej chwili jest ona odpalana tylko raz, w bloku <code>componentDidMount</code> komponentu <code>seatChooser</code>. Twoim zadaniem jest dodanie funkcjonalności uruchamiania tej metody również po zarezerwowaniu biletu (jeśli wypełniono wszystkie pola) oraz cyklicznie – co dwie minuty.</p>
<div class="bc-note alert-info">
<h4 class="alert-heading text-center">Uwaga!</h4>
<p>Zauważ, że bilet jest fizycznie zarezerwowany dopiero po wykonaniu asynchronicznego requestu na serwerze.</p>
<p>Nawet jeśli odpalisz <code>loadSeats</code> bezpośrednio po metodzie <code>addSeat</code>, obie uruchomią się asynchronicznie. Istnieje zatem prawdopodobieństwo, że to właśnie <code>loadSeats</code> wykona się jako pierwsza, mimo tego, że w kodzie występuje jako druga.</p>
<p>W takiej sytuacji możemy wspomóc się mechanizmem async-await. Zauważ, że funkcja <code>submitForm</code> ma już nawet przedrostek <code>async</code>, czyli spokojnie możemy użyć wewnątrz niej <code>await</code>, przed wywołaniem <code>addSeat</code>. Dzięki temu zmusimy JSa, by poczekał do momentu, aż request <code>addSeat</code> się wykona.</p>
</div>
<p>Spróbuj zrobić to zadanie bez naszej pomocy.</p>
<p class="text-center">
  <span class="collapse-toggles">
    <a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#collapse-yWEabdvYA-toggle" class="btn btn-primary collapsed" data-toggle="collapse">Pokaż podpowiedź</a>
    <a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#collapse-yWEabdvYA-toggle" class="btn btn-primary collapsed" data-toggle="collapse">Ukryj podpowiedź</a>
  </span>
</p>
<div id="collapse-yWEabdvYA-toggle" class="collapse">
<ol>
<li>Pamiętaj, że funkcja, która sprawdza, czy dane są poprawne i rezerwuje bilet, to już część komponentu rodzica – <code>orderTicketForm</code>. <code>loadSeats</code> nie jest jednak indywidualną funkcją <code>SeatChooser</code>, tylko akcją z reducera. Możesz mieć więc do niej dostęp również w innym komponencie – <code>orderTicketForm</code>, który ma już nawet przygotowany container. Wystarczy więc zmapować odpowiednią akcję, aby móc jej użyć również w nim.</li>
<li>Do cyklicznego wywoływania wybranej funkcji możesz użyć nawet zwykłego <code>setInterval</code>. Nie zapomnij jednak o wyczyszczeniu tego interwału, gdy komponent jest odmontowywany (<code>componentWillUnmount</code>).</li>
</ol>
</div>
<h3 id="276-publikujemy-aplikacje-etap-2">Etap 2</h3>
<p>W tej chwili Twój endpoint <code>POST</code> <code>/seats</code> nie sprawdza, czy dane miejsce na koncercie było już zarezerwowane. Ewentualnie, jeśli zostało wykonane zadanie dla ambitnych, walidujesz tylko, czy otrzymujemy prawidłowe dane.</p>
<p>Nie możemy liczyć na aplikację klienta, że to ona zablokuje możliwość zajęcia zarezerwowanego miejsca. Wiesz już bowiem, że nawet po naszych zmianach, dane nie są w stu procentach zsynchronizowane z tym, co znajduje się w "bazie danych". Do tego część kliencka zawsze jest podatna na manipulacje – każdy może wejść do konsoli i za pomocą narzędzi developerskich narobić wielu szkód, np. wyłączyć walidację. Nawet jeśli byłaby optymalna, to i tak musielibyśmy, na wszelki wypadek, sprawdzić dostępność miejsca jeszcze raz, na serwerze.</p>
<p>To będzie nasze zadanie. Musimy tak zmodyfikować serwer, by w przypadku, gdy wybrane miejsce jest zajęte, zwrócił komunikat o treści: <code>{ message: "The slot is already taken..." }</code>. Koniecznie ustaw też odpowiedni kod statusu.</p>
<p>Spróbuj wykonać to zadanie bez naszej pomocy.</p>
<div class="bc-note alert-info">
<h4 class="alert-heading text-center">Uwaga!</h4>
<p>Pamiętaj, że mamy trzy koncerty (trzy dni). Sprawdzaj więc nie tylko, czy dany <code>seat</code> już się pojawił, ale konkretnie – czy jest on zajęty na wybrany dzień (koncert).</p>
</div>
<p class="text-center">
  <span class="collapse-toggles">
    <a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#collapse-BIRH85itAS-toggle" class="btn btn-primary collapsed" data-toggle="collapse">Pokaż podpowiedź</a>
    <a href="https://kodilla.com/pl/bootcamp-module/407/276/5935#collapse-BIRH85itAS-toggle" class="btn btn-primary collapsed" data-toggle="collapse">Ukryj podpowiedź</a>
  </span>
</p>
<div id="collapse-BIRH85itAS-toggle" class="collapse">
<p>Możesz skorzystać z pomocy wbudowanej funkcji <code>some</code>, która sprawdza, czy dany element chociaż raz pojawia się w tablicy. Jeśli tak, zwraca <code>true</code>. Więcej informacji znajdziesz pod <a href="https://developer.mozilla.org/pl/docs/Web/JavaScript/Referencje/Obiekty/Array/some" target="_blank">tym linkiem</a>.</p>
</div>

                        </div>
                    </div>
                                        <div class="card-block task-card">
                        <h3 id="276-publikujemy-aplikacje-zadanie-publikacja-na-heroku">Zadanie: <span class="task-title">publikacja na Heroku</span></h3>
                        <div class="task-content">
                            <p>Przed Tobą ostatni etap, czyli opublikowanie aplikacji na Heroku.</p>
<h4>Nowa rola serwera</h4>
<p>Najpierw musimy poczynić jednak małe zmiany.</p>
<p>W tej chwili nasza aplikacja działa na dwóch serwerach lokalnych. Jeden operuje na porcie 8000 i obsługuje nasze połączenia do API, drugi jest uruchamiany na porcie 3000 i zajmuje się prezentowaniem podglądu części frontendowej. Podczas prac developerskich zwyczajnie nie mamy innej opcji – nie możemy wykorzystać serwera podglądu Webpacka również jako serwera API.</p>
<p>Problem w tym, że Heroku nie przyjmie takiej konfiguracji. Serwis ten pozwala na hostowanie tylko kompletnych stron, które są utrzymywane na jednym serwerze.</p>
<p>Musimy więc nieco zmodyfikować naszą aplikację. Jak sobie z tym poradzimy?</p>
<p>W dość łatwy sposób – po prostu zrezygnujemy przy publikacji z jednego serwera. Którego? Oczywiście z Webpacka, bo potrzebujemy go tylko na etapie developerskim. Gdy wygenerujemy gotową aplikację (za pomocą komendy <code>yarn build</code>), otrzymamy folder <code>dist</code>, zawierający zwykły plik HTML, oraz dodatkowo – pliki ze zbundlowanymi skryptami i stylami. Do ich odpalenia nie będzie nam już potrzebny <em>webpack-dev-server</em>, a zatem serwer Express bez trudu przejmie rolę pokazywania zbudowanego projektu.</p>
<h4>Przygotowanie do budowy</h4>
<p>Zanim zbudujemy naszą aplikację, warto wprowadzić jeszcze kilka zmian. Odnajdź w kliencie pliki subreducerów i usuń wszystkie niepotrzebne setTimeouty. Służyły one tylko do symulacji długiego ładowania danych przez serwer zdalny. Nie będzie nam to już potrzebne.</p>
<p>Przy okazji, nie zapomnij zmienić ścieżki do serwera API w <code>config.js</code>. Nie powinniśmy już kierować się zawsze do localhostu. Zamiast tego, najlepiej ustawić, aby ścieżka była zależna od środowiska. Jeśli <code>process.env</code> jest produkcyjny, to powinniśmy szukać endpointów od razu na tym samym serwerze, wystarczy więc tylko ścieżka <code>/api</code>. W środowisku developerskim nadal powinien być to stary adres, bo do lokalnych prac będziemy potrzebować webpackowego podglądu Reacta, a dopiero z niego połączymy się z serwerem API.</p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword module">export</span> <span class="token keyword">const</span> <span class="token constant">API_URL</span> <span class="token operator">=</span> <span class="token punctuation">(</span>process<span class="token punctuation">.</span><span class="token property-access">env</span><span class="token punctuation">.</span><span class="token constant">NODE_ENV</span> <span class="token operator">===</span> <span class="token string">'production'</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token string">'/api'</span> <span class="token operator">:</span> <span class="token string">'http://localhost:8000/api'</span><span class="token punctuation">;</span></code></pre>
<h4>Budujemy naszą aplikację</h4>
<p>Wejdź do konsoli w folderze <code>client</code> i zbuduj aplikację za pomocą komendy:</p>
<pre class=" language-markup"><code class=" language-markup">yarn build</code></pre>
<p>Nasza gotowa aplikacja powinna być dostępna w folderze <code>build</code>. Jest to już dystrybucja odpowiednio przygotowana przez Webpacka, którą możemy uruchomić bez żadnych dodatkowych skryptów. To właśnie ona stanie się widoczna po zmianach, gdy użytkownik wejdzie na nasz serwer Express. Będziemy serwować ją pod endpointem <code>/</code>.</p>
<h4>Modyfikacja serwera</h4>
<p>Aby było to możliwe, musimy zmodyfikować nasz serwer. Zacznijmy od dodania nowego endpointu, który będzie zwracał naszą aplikację.</p>
<p>Wejdź do pliku <code>server.js</code> i pod middleware z naszymi grupami endpointów dodaj następujący kod:</p>
<pre class=" language-js"><code class=" language-js">app<span class="token punctuation">.</span><span class="token method function property-access">get</span><span class="token punctuation">(</span><span class="token string">'*'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">sendFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token method function property-access">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'/client/build/index.html'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Koniecznie musi on znajdować się <strong>pod middleware, które dodawały nasze endpointy z API</strong>. Kod będzie starał się wyłapywać wszystkie możliwe linki, więc gdyby znalazł się przed naszymi endpointami z zewnętrznych plików, przechwytywałby również ich adresy (np. <code>/seats</code> czy <code>/concerts</code>).</p>
<p>Od teraz wejście w każdy link, którego serwer nie dopasował do wcześniejszych endpointów, będzie powodować po prostu zwrócenie w przeglądarce naszej reactowej aplikacji.</p>
<p>Musimy przygotować jeszcze obsługę pozostałych plików z <code>client/build</code>, takich jak np. bundle skryptów JS-owych i CSS.</p>
<pre class=" language-js"><code class=" language-js"><span class="token comment">// Serve static files from the React app</span>
app<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span>express<span class="token punctuation">.</span><span class="token method function property-access">static</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token method function property-access">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">'/client/build'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<div class="bc-note alert-warning">
<h4 class="alert-heading text-center">Uwaga!</h4>
<p>Żeby korzystać z <code>path</code>, musimy najpierw zaimportować ten moduł.</p>
</div>
<p>Jak widzisz, ostatecznie skorzystamy również z wbudowanego middleware <code>express.static</code> :)</p>
<p>Na koniec warto zmienić port serwera. Zamiast sztywnej wartości powinniśmy pozwalać na pobieranie jej ze zmiennych konfiguracyjnych Heroku.</p>
<pre class=" language-js"><code class=" language-js">app<span class="token punctuation">.</span><span class="token method function property-access">listen</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span><span class="token property-access">env</span><span class="token punctuation">.</span><span class="token constant">PORT</span> <span class="token operator">||</span> <span class="token number">8000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'Server is running on port: 8000'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Teraz lokalnie wciąż będziemy korzystali z portu 8000, ale Heroku na repo zdalnym będzie wykorzystywać informacje zapisane w konfiguracji.</p>
<p>Zrestartuj aplikację serwera. Od teraz po wejściu w link <code>http://localhost:8000</code> powinniśmy widzieć naszą reactową aplikację! Oznacza to, że zarówno serwer, jak i klient, znajdują się od tego momentu w jednym miejscu. Po prostu pod endpointami <code>/api/...</code> mamy teraz funkcjonalności serwera API (a więc dostęp do danych), a pod endpointem głównym <code>/</code> serwujemy aplikację klienta.</p>
<h4>Przygotowujemy serwer Heroku</h4>
<p>Nasza aplikacja jest już gotowa do publikacji, musimy jeszcze przygotować nasz zdalny host.</p>
<p>Zacznij od zalogowania się&nbsp;na stronie <code>https://www.heroku.com/</code>.</p>
<p>W panelu wybierz <strong>New</strong>.</p>
<a href="./Moduł_ 27. Express – własny serwer HTTP_files/Heroku1.png" class="img-modal-group"><img src="./Moduł_ 27. Express – własny serwer HTTP_files/Heroku1.png" alt="image" style="width: auto; max-width: 50%;"></a>
<p>Następnie kliknij opcję <strong>Create New App</strong>.</p>
<p>Heroku spyta teraz o podstawowe ustawienia dla nowej aplikacji:</p>
<a href="./Moduł_ 27. Express – własny serwer HTTP_files/Heroku2.png" class="img-modal-group"><img src="./Moduł_ 27. Express – własny serwer HTTP_files/Heroku2.png" alt="image" style="width: auto; max-width: 50%;"></a>
<p>Nazwa aplikacji może być dowolna. Jako region wybierz Europę.</p>
<p>Następnie kliknij w przycisk <strong>Create App</strong>. Nasz serwer jest od tego momentu gotowy! Ale... jest też pusty. Musimy przesłać do niego aplikację, która czeka na naszym komputerze.</p>
<h4>Publikujemy aplikację na Heroku</h4>
<p>Aby opublikować aplikację na Heroku, możemy skorzystać z trzech opcji:</p>
<ol>
<li>Wykorzystać Heroku CLI.</li>
<li>Połączyć nasze repo GIT z Heroku.</li>
<li>Wykorzystać dockerowy container.</li>
</ol>
<p>My skorzystamy z pierwszej, która jest najbardziej intuicyjna dla osób zaznajomionych z Gitem.</p>
<p>Będziemy do tego potrzebować dodatkowego narzędzia – <strong>Heroku CLI</strong>. Jeśli jeszcze go nie masz, możesz je pobrać pod <a href="https://devcenter.heroku.com/articles/heroku-cli#download-and-install" target="_blank">tym linkiem</a>.</p>
<p>Zacznijmy od zalogowania się do Heroku. Wejdź do konsoli w katalogu domowym naszej aplikacji i uruchom komendę:</p>
<pre class=" language-markup"><code class=" language-markup">heroku login</code></pre>
<p>Po zalogowaniu zainicjuj repo git (jeśli Twój projekt jeszcze nim nie jest). W kolejnym kroku utworzymy połączenie ze zdalnym repo, które stworzyliśmy wcześniej na Heroku:</p>
<pre class=" language-markup"><code class=" language-markup">heroku git:remote -a app-name</code></pre>
<p>Na przykład:</p>
<pre class=" language-markup"><code class=" language-markup">heroku git:remote -a calm-ravine-17050</code></pre>
<p>Nazwę aplikacji możesz przypomnieć sobie, zaglądając do panelu administracyjnego w Heroku.</p>
<p>Czas na małą modyfikację naszego <code>package.json</code> w głównym katalogu. Chcielibyśmy, aby Heroku przy każdym deployu aplikacji budowało od nowa aplikację reactową w folderze <code>build</code>. Oczywiście możemy robić to ręcznie przed każdym pushem, ale wygodniej będzie to zautomatyzować.</p>
<p>Dodaj więc nowy skrypt <code>"build"</code>, który będzie mówił, co powinno dziać się wraz z deployem:</p>
<pre class=" language-markup"><code class=" language-markup">"build": "cd client &amp;&amp; yarn install &amp;&amp; yarn build"</code></pre>
<p>Następnie wyślij w commicie wszystkie zmiany i wypchnij repo na nasz serwer zdalny:</p>
<pre class=" language-markup"><code class=" language-markup">git push heroku master</code></pre>
<div class="bc-note alert-warning">
<h4 class="alert-heading text-center">Uwaga</h4>
<p>Przed commitem warto utworzyć <code>.gitignore</code>, ignorujący katalog <code>/node_modules</code>, aby nie pushować niepotrzebnie tego folderu na repo Heroku.</p>
</div>
<p>Gotowe!</p>
<p>Możesz sprawdzić, czy wszystko poszło dobrze, korzystając z komendy <code>heroku open</code>. Przekieruję Cię ona od razu pod adres Twojej strony.</p>
<p>Link do działającej aplikacji umieść w pliku <code>Readme.md</code> na Twoim repo na GitHubie. Następnie wyślij adres do repozytorium swojemu mentorowi.</p>

                        </div>
                    </div>
                                        <div class="card-block submodule-footer clearfix  completed ">
                                                <div class="clearfix">
                                                                                <a href="https://kodilla.com/pl/bootcamp-task/407/661008" target="_blank" class="btn btn-info-outline">Podgląd zadania</a>
                            <form target="_blank" class="form-inline project-link-form">
                                <div class="form-group">
                                    <input type="text" name="link" class="form-control" value="https://github.com/skwiryt/testimonials">
                                </div>
                                <button type="submit" class="btn  btn-primary ">Wyślij link <i class="fa fa-check"></i></button>
                            </form>
                                                                                                    </div>
                    </div>
                </section>
                                    
                <section id="submodule-1122" class="card submodule completed" data-bootcamp-user-submodule-id="661009">
                <!-- klasy dla section: completed current comments -->
                    <div class="card-block submodule-header clearfix">
                        <i class="fa fa-check-circle-o fa-2x"></i>
                        <i class="fa fa-play-circle-o fa-2x"></i>
                        <i class="fa fa-exclamation-circle fa-2x"></i>
                        <i class="fa fa-send-o fa-2x"></i>
                        <h2 class="bootcamp-submodule-name">27.7. <span>Podsumowanie</span></h2>
                                            </div>
                    <div class="card-block">
                        <div class="submodule-content">
                            <p>W tym module krok po kroku powiększaliśmy wachlarz naszych umiejętności, rozpoczynając od budowy prostego serwera, a kończąc na kompletnym serwerze API oraz jego integracji z klientem. W końcu możesz nazwać się fullstackowym developerem! :)</p>
<p>Sama koncepcja serwera oczywiście nie była Ci obca przed tym modułem. Teraz jednak udało nam się dotknąć tego tematu bezpośrednio i przyznaj – nie było aż tak źle. Duża w tym zasługa Expressu, który sporo rzeczy nam ułatwił. Dobrze go zapamiętaj, bo jeszcze nie raz skorzystasz z jego pomocy.</p>

                        </div>
                    </div>
                                        <div class="card-block submodule-footer clearfix  completed ">
                                                <small>Jeśli masz wątpliwości do powyższego materiału, to - zanim zatwierdzisz - zapytaj na czacie :)</small>
                                                <div class="clearfix">
                                                                                <button class="btn  btn-primary "><i class="fa fa-check"></i><span>Zapoznałe(a)m się!</span></button>
                                                                                                    </div>
                    </div>
                </section>
                                    
                <section id="submodule-1123" class="card submodule completed" data-bootcamp-user-submodule-id="661010">
                <!-- klasy dla section: completed current comments -->
                    <div class="card-block submodule-header clearfix">
                        <i class="fa fa-check-circle-o fa-2x"></i>
                        <i class="fa fa-play-circle-o fa-2x"></i>
                        <i class="fa fa-exclamation-circle fa-2x"></i>
                        <i class="fa fa-send-o fa-2x"></i>
                        <h2 class="bootcamp-submodule-name">27.8. <span>Quiz powtórkowy</span></h2>
                                            </div>
                    <div class="card-block">
                        <div class="submodule-content">
                            <p>Na koniec tego modułu przygotowaliśmy dla Ciebie quiz powtórkowy. Pomoże Ci on utrwalić wiedzę z poprzednich modułów.</p>
<p>Odpowiedzi nie są nigdzie zapisywane, pozostają tylko do Twojej wiadomości. Ten quiz ma Ci posłużyć jako pomoc w nauce – dlatego pod każdym pytaniem znajdziesz guzik, który sprawdzi poprawność Twoich odpowiedzi oraz poda Ci wyjaśnienie zagadnienia poruszanego w tym pytaniu.</p>

        <div class="kodilla-quiz">
      
        <article class="question initiated" data-type="multiple-choice">
      
        <header>
          <p><em>1.</em> Kod JavaScript uruchamiany za pomocą Node.js:</p>

        </header>
        <ol type="a" class="answers" data-correct="0,1,2,4,6,7">
          <li><label><input type="checkbox"> ma dostęp do plików na dysku komputera, na którym został uruchomiony skrypt</label></li>
<li><label><input type="checkbox"> może korzystać z importów i eksportów, aby kod JS był podzielony na wiele plików</label></li>
<li><label><input type="checkbox"> może korzystać również z pakietów NPM zainstalowanych w projekcie</label></li>
<li><label><input type="checkbox"> używa przeglądarki Chrome do kompilowania kodu JS</label></li>
<li><label><input type="checkbox"> pozwala na używanie <code>console.log</code>, którego komunikaty wyświetlają się w terminalu</label></li>
<li><label><input type="checkbox"> może korzystać z obiektów <code>window</code> i <code>document</code>, tak samo jak kod JS uruchamiany w przeglądarce</label></li>
<li><label><input type="checkbox"> umożliwia komunikację z użytkownikiem uruchamiającym ten skrypt, np. za pomocą terminala</label></li>
<li><label><input type="checkbox"> może łączyć się z serwerami dostępnymi w internecie</label></li>
        </ol>
        <div class="buttons text-center">
          <button class="button-ok btn btn-primary">Sprawdź odpowiedź</button>
        </div>
      
      
        <div class="explanation">
          <div class="bc-note alert-success">
            <h4 class="alert-heading text-center">Wyjaśnienie</h4>
      <p>Node.js to osobny silnik JavaScriptu, który nie jest zawarty w przeglądarce. Do korzystania z Node.js nie musimy w ogóle mieć zainstalowanej przeglądarki.</p>
<p>Daje on nam prawie wszystkie możliwości, które znamy z JS-a pisanego dla przeglądarki. Tak samo używamy zmiennych, pętli, etc. Podobnie jak w przeglądarkowym JS-ie możemy korzystać z importów i eksportów (tyle że za pomocą <code>require</code>) i łączyć się z serwerami (np. API).</p>
<p>W samym Node.js nie znajdziemy za to obiektów <code>window</code> i <code>document</code> – skoro nie ma przeglądarki, to nie ma też jej okna, ani dokumentu w tym oknie. Te obiekty mogą jednak być dodane przez jakiś pakiet NPM – mieliśmy okazję spotkać się z nimi przy okazji korzystania z Electrona.</p>
<p>Jednocześnie, Node.js daje nam dużo szersze możliwości w zakresie dostępu do plików na dysku komputera, na którym został uruchomiony, a także komunikację z użytkownikiem za pomocą terminala lub GUI stworzonego np. za pomocą Electrona.</p>

          </div>
        </div>
      
        </article>
      
        <article class="question initiated" data-type="multiple-choice">
      
        <header>
          <p><em>2.</em> Możemy używać Node.js do:</p>

        </header>
        <ol type="a" class="answers" data-correct="0,1,2">
          <li><label><input type="checkbox"> tworzenia przydatnych narzędzi, które będziemy wykorzystywać w naszym task runnerze</label></li>
<li><label><input type="checkbox"> budowania aplikacji desktopowych, np. z wykorzystaniem Electrona</label></li>
<li><label><input type="checkbox"> implementacji własnego serwera HTTP, w tym serwera REST API</label></li>
        </ol>
        <div class="buttons text-center">
          <button class="button-ok btn btn-primary">Sprawdź odpowiedź</button>
        </div>
      
      
        <div class="explanation">
          <div class="bc-note alert-success">
            <h4 class="alert-heading text-center">Wyjaśnienie</h4>
      <p>Wszystkie powyższe odpowiedzi są poprawne – wyliczają&nbsp;główne zastosowania aplikacji uruchamianych w Node.js. O ile na początku skupiliśmy się na zastosowaniach nie-webowych, aby lepiej poznać możliwości Node.js, przez resztę kursu zajmiemy się głównie wykorzystaniem Node.js w zakresie backendu, czyli aplikacji uruchamianej na serwerze, odpowiedzialnej za serwowanie naszych projektów oraz pełniącej funkcję API.</p>

          </div>
        </div>
      
        </article>
      
        <article class="question initiated" data-type="multiple-choice">
      
        <header>
          <p><em>3.</em> Możemy publikować własne pakiety w repozytorium NPM, dzięki czemu:</p>

        </header>
        <ol type="a" class="answers" data-correct="0,3">
          <li><label><input type="checkbox"> mogą być wykorzystywane przez innych developerów</label></li>
<li><label><input type="checkbox"> muszą być publicznie dostępne dla wszystkich</label></li>
<li><label><input type="checkbox"> nasz kod zostanie automatycznie sprawdzony pod względem poprawności</label></li>
<li><label><input type="checkbox"> z łatwością możemy używać tych pakietów w wielu projektach</label></li>
<li><label><input type="checkbox"> nowe wersje naszych pakietów będą automatycznie instalowane w projektach, w których zostały wykorzystane</label></li>
        </ol>
        <div class="buttons text-center">
          <button class="button-ok btn btn-primary">Sprawdź odpowiedź</button>
        </div>
      
      
        <div class="explanation">
          <div class="bc-note alert-success">
            <h4 class="alert-heading text-center">Wyjaśnienie</h4>
      <p>Głównym celem publikacji modułów w repozytorium NPM jest umożliwienie ich instalacji za pomocą komend <code>npm install ...</code> lub <code>yarn add ...</code>. Może to być przydatne zarówno dla innych developerów, jak i dla nas samych w sytuacjach, kiedy potrzebujemy pewną funkcjonalność załączać w wielu projektach.</p>
<p>Warto jednak wspomnieć, że pakiety nie muszą być publicznie dostępne. NPM umożliwia założenie płatnego konta lub nawet utrzymywanie prywatnego serwera z pakietami. W obu podejściach trzeba jednak liczyć się z kosztami, więc na tym etapie nauki nie warto korzystać z tych rozwiązań.</p>
<p>Pamiętaj też, że kod dostępny w repozytorium NPM nie jest w żaden sposób sprawdzany. Jeśli popełnisz błąd, pakiet zostanie z nim opublikowany. Co więcej, nowa (poprawiona) wersja paczki nie zostanie automatycznie zainstalowana w projektach, które z niej korzystają.</p>
<p>Wyjątkiem jest sytuacja, gdy nie zmieni się główny (<em>major</em>) numer wersji, czyli np. zmienisz <code>1.9.3</code> na <code>1.9.4</code>, a potem sklonujesz na nowo repozytorium i uruchomisz <code>npm install</code> (lub <code>yarn</code> albo <code>yarn install</code>). Wtedy może być zainstalowana nowa wersja, ale jest to sytuacja brzegowa. W większości wypadków aktualizacja pakietu będzie wymagała ręcznej podmiany wersji wykorzystywanej w danym projekcie.</p>

          </div>
        </div>
      
        </article>
      
        </div>
        
<style>
  .kodilla-quiz .question {
    margin-bottom: 1.5em;
  }
  .kodilla-quiz .explanation {
    display: none;
  }
  .kodilla-quiz li>label {
    display: inline-block;
    padding-top: 1px;
    vertical-align: top;
  }
</style>
<script>
  if(typeof initQuizzes == 'undefined'){
    function initQuizzes(){
      var types = {
        'multiple-choice': initMultipleChoice,
      };

      var questions = document.querySelectorAll('.kodilla-quiz .question');

      for(var i=0; i<questions.length; i++){
        var question = questions[i];
        var initFunc = types[question.dataset.type];

        if(typeof(initFunc) != 'undefined' && !question.classList.contains('initiated')){
          question.classList.add('initiated');
          initFunc(question);
        }
      }
    }

    function initMultipleChoice(question){
      var answers = question.querySelector('.answers');
      var inputs = answers.querySelectorAll('input');
      var buttons = question.querySelector('.buttons');
      var buttonOK = buttons.querySelector('.button-ok');
      var explanation = question.querySelector('.explanation');
      var correct = question.querySelector('[data-correct]').dataset.correct.split(',');

      buttonOK.addEventListener('click', function(e){
        e.preventDefault();

        var inputsChecked = answers.querySelectorAll('input:checked');
        if(inputsChecked.length == 0){
          alert('Wybierz co najmniej jedna odpowiedź');
          return;
        }

        correct.forEach(function(index){
          inputs[index].parentNode.parentNode.classList.add('text-success', 'text-bold');
        });

        for (var i = 0; i < inputs.length; i++) {
          var input = inputs[i];
          var li = input.parentNode.parentNode;
          input.setAttribute('disabled', true);
          
          if(input.checked){
            li.classList.add('text-bold');
            
            if(!li.classList.contains('text-success')){
              li.classList.add('text-danger');
            }
          }

        }
        
        if(explanation) explanation.style.display = 'block';
        buttons.setAttribute('hidden', true);
      });
    }
  }
  initQuizzes();
</script>

      
                        </div>
                    </div>
                                        <div class="card-block submodule-footer clearfix  completed ">
                                                <small>Jeśli masz wątpliwości do powyższego materiału, to - zanim zatwierdzisz - zapytaj na czacie :)</small>
                                                <div class="clearfix">
                                                                                <button class="btn  btn-primary "><i class="fa fa-check"></i><span>Zapoznałe(a)m się!</span></button>
                                                                                                    </div>
                    </div>
                </section>
                            </main>
        </div>
    </section>
</main>
;
<script async="" src="./Moduł_ 27. Express – własny serwer HTTP_files/ei.js"></script>
<script type="text/x-translation" data-translation-name="SentBootcampLinkReviewFormMessage">Wysłano link do zatwierdzenia</script>
    <div id="alerts">
    <div class="alert alert-danger" role="alert" style="display: none;">
        <i class="fa fa-exclamation" aria-hidden="true"></i>
        <button type="button" class="close" data-hide="alert" aria-label="Zamknij">
            <span aria-hidden="true">×</span>
            <span class="sr-only">Zamknij</span>
        </button>
        <ul>
                        </ul>
    </div>
    <div class="alert alert-success" role="alert" style="display: none;">
        <i class="fa fa-check" aria-hidden="true"></i>
        <button type="button" class="close" data-hide="alert" aria-label="Zamknij">
            <span aria-hidden="true">×</span>
            <span class="sr-only">Zamknij</span>
        </button>
        <ul>
                </ul>
    </div>
    <div class="alert alert-warning" role="alert" style="display: none;">
        <i class="fa fa-warning" aria-hidden="true"></i>
        <button type="button" class="close" data-hide="alert" aria-label="Zamknij">
            <span aria-hidden="true">×</span>
            <span class="sr-only">Zamknij</span>
        </button>
        <ul>
                </ul>
    </div>
    <div class="alert alert-info" role="alert" style="display: none;">
        <i class="fa fa-info" aria-hidden="true"></i>
        <button type="button" class="close" data-hide="alert" aria-label="Zamknij">
            <span aria-hidden="true">×</span>
            <span class="sr-only">Zamknij</span>
        </button>
        <ul>
                    </ul>
    </div>
    <div class="container">
        <div class="alert alert-notify" role="alert" style="display: none;">
            <i class="fa fa-info" aria-hidden="true"></i>
            <button type="button" class="close" data-hide="alert" aria-label="Zamknij">
                <span aria-hidden="true">×</span>
                <span class="sr-only">Zamknij</span>
            </button>
            <ul>
                            </ul>
        </div>
    </div>
</div>
    <div class="modal fade informator-modal" id="informator" tabindex="-1" role="dialog" aria-labelledby="informatorModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <img src="./Moduł_ 27. Express – własny serwer HTTP_files/logo-menu.png" alt="Logo Kodilla" class="brand-logo">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <i class="fa fa-times" aria-hidden="true"></i>
                </button>
            </div>
            <div class="modal-body content-container">
                <h3>Zamów szczegółowy informator</h3>
                <form class="row js-ajax-form" data-view-class="InformatorForm" action="https://kodilla.com/pl/download-informator" method="post">
                    <input type="hidden" name="ga-pobieranie-informatora-z-modala" value="wypelnienie">
                    <input type="hidden" name="tags[0]" value="informator">
                                        <div class="user-data-container">
                        <input type="text" class="form-control" name="firstname" placeholder="Imię">
                        <input type="text" class="form-control" name="surname" placeholder="Nazwisko">
                    </div>
                    <div class="user-data-container">
                        <input type="email" class="form-control" name="email" placeholder="Email" required="">
                        <input type="tel" class="form-control" name="phone" placeholder="Numer telefonu" pattern="^([\+][0-9]{1,3}([ \.\-])?)?([\(]{1}[0-9]{3}[\)])?([0-9 \.\-]{1,15})$" title="Wpisz poprawny numer telefonu, np. 453 674 897" minlength="9" maxlength="15" data-custom-message="Wpisz poprawny numer telefonu, np. 453 674 897">
                    </div>
                    <div class="terms-box">
                        <label>
                            <input name="accept_terms" value="true" data-custom-message="Prosimy o zaakceptowanie regulaminu" type="checkbox" class="form-control input-checkbox" required="">
                            <span>Akceptuję <a target="_blank" href="https://kodilla.com/pl/regulamin">regulamin</a>  i nie wnoszę zastrzeżeń</span>
                        </label>
                    </div>
                    <div class="personal-terms-box">
                        <label>
                            <input name="accept_marketing" value="true" data-custom-message="Jeśli chcesz otrzymać dostęp do materiałów, konieczna jest akceptacja obydwu zgód" type="checkbox" class="form-control input-checkbox" required="">
                            <span>Chcę otrzymywać newsletter, informacje o promocjach i produktach dostępnych w Kodilla.
                                <span class="details-button" data-action="show-details" data-identifier="personal-terms-details-informator">Czytaj więcej</span>
                                <span class="display-none" data-identifier="personal-terms-details-informator">Wyrażam zgodę na otrzymywanie informacji handlowych od Kodilla na podany przeze mnie adres e-mail. Zgoda jest dobrowolna, jednakże niezbędna do otrzymywania informacji o produktach, promocjach i o tym, co u nas słychać. Administratorem danych jest Codemy S.A. z siedzibą we Wrocławiu, Plac Powstańców Śląskich 13/4. Mam prawo cofnąć zgodę w każdym czasie, jednak wtedy nie będę otrzymywać informacji. Dane mogą być przetwarzane pomimo cofnięcia zgody wyłącznie w takim zakresie i celu, w jakim ich przetwarzanie jest niezbędne do ustalenia, dochodzenia lub obrony roszczeń Administratora w związku z udzieloną zgodą. Mam prawo dostępu do danych, sprostowania, usunięcia, ograniczenia przetwarzania, prawo wniesienia sprzeciwu, skargi do organu nadzorczego i przeniesienia danych. Szczegółowe informacje znajdują się na stronie kodilla.com, zakładka "Polityka Prywatności".</span>
                            </span>
                        </label>
                    </div>
                    <div class="display-none">
                        <input type="text" name="myName" value="">
                    </div>
                    <div class="">
                        <button type="submit" class="btn btn-primary">
                            Pobierz Informator
                            <i data-role="loading-icon" class="fa fa-spinner fa-spin fa-1x fa-fw display-none"></i>
                        </button>
                    </div>
                </form>
                <a href="https://kodilla.com/pl/informator" id="informator-link" target="_blank" class="display-none"></a>
            </div>
            <div class="modal-footer">
                <p>Pobranie informatora do niczego nie zobowiązuje</p>
            </div>
        </div>
    </div>
</div>
<footer class="site-footer">
                <section class="footer-lower">
            <nav class="container">
                <a class="navbar-img" href="https://kodilla.com/pl">
                    <svg id="kodilla-logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 168 29.553" width="168" height="30">
                        <defs>
                            <style>
                                .footer-logo-fill {
                                    fill: #fff;
                                }
                            </style>
                        </defs>
                        <g id="Group_1" data-name="Group 1" transform="translate(23.59)">
                            <path id="KODILLA_copy_5_1_" class="footer-logo-fill" d="M78.058,0a14.758,14.758,0,1,0,.075,0Zm0,23.739a8.939,8.939,0,0,1-8.944-8.907V14.8c0-4.957,4.584-.708,8.907-.708,4.919,0,9.019-4.211,9.019.708a8.978,8.978,0,0,1-8.981,8.944Z" transform="translate(-63.3)"></path>
                            <ellipse id="eye_copy_4_1_" class="footer-logo-fill" cx="3.876" cy="3.876" rx="3.876" ry="3.876" transform="translate(9.462 13.2) rotate(-28.436)"></ellipse>
                        </g>
                        <path id="Path_1" data-name="Path 1" class="footer-logo-fill" d="M0,29.819V.9H6.671V13.347L17.255.9h7.491L13.938,13.794,25.491,29.819h-7.6l-8.2-11.665-3.019,3.13v8.5H0Z" transform="translate(0 -0.565)"></path>
                        <path id="Path_2" data-name="Path 2" class="footer-logo-fill" d="M151.4,29.819V.9h10.807a15.515,15.515,0,0,1,6.261,1.155,12.966,12.966,0,0,1,4.509,3.093A12.918,12.918,0,0,1,175.7,9.732a17.245,17.245,0,0,1,.932,5.59,16.821,16.821,0,0,1-1.006,5.963,12.227,12.227,0,0,1-2.907,4.547,13.484,13.484,0,0,1-4.547,2.944,15.964,15.964,0,0,1-5.925,1.043Zm18.41-14.5a11.274,11.274,0,0,0-.522-3.466,7.723,7.723,0,0,0-1.491-2.72,6.616,6.616,0,0,0-2.385-1.752,8.055,8.055,0,0,0-3.205-.6h-4.1v17.18h4.1a7.985,7.985,0,0,0,3.242-.634,6.8,6.8,0,0,0,2.385-1.826,8.286,8.286,0,0,0,1.453-2.72A11.634,11.634,0,0,0,169.81,15.322Z" transform="translate(-94.978 -0.565)"></path>
                        <path id="Path_3" data-name="Path 3" class="footer-logo-fill" d="M228.3,29.819V.9h6.671V29.819Z" transform="translate(-143.219 -0.565)"></path>
                        <path id="Path_4" data-name="Path 4" class="footer-logo-fill" d="M259.9,29.819V.9h6.671V23.968h14.012v5.851Z" transform="translate(-163.043 -0.565)"></path>
                        <path id="Path_5" data-name="Path 5" class="footer-logo-fill" d="M327.371,23.931V.9H320.7V29.819h18.522l2.124-5.851H327.371Z" transform="translate(-201.185 -0.565)"></path>
                        <path id="Path_6" data-name="Path 6" class="footer-logo-fill" d="M388.547.9h6.037L405.13,29.819h-6.857l-2.236-6.484h-9.019l-2.2,6.484H378Zm6.373,17.851L391.528,8.54l-3.466,10.211Z" transform="translate(-237.13 -0.565)"></path>
                    </svg>
                </a>
                <ul class="nav">
                    <li>
                        <a href="https://kodilla.com/pl/regulamin" rel="nofollow">Regulamin</a>
                    </li>
                    <li>
                        <a href="https://kodilla.com/pl/polityka-prywatnosci" rel="nofollow">Polityka prywatności</a>
                    </li>
                    <li class="nav-item nav-item-last">© 2021 Kodilla</li>
                </ul>
            </nav>
        </section>
    </footer>

<!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KN2WWBH" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->

    <script src="./Moduł_ 27. Express – własny serwer HTTP_files/jquery-2.1.4.min.js"></script>
<script src="./Moduł_ 27. Express – własny serwer HTTP_files/js.cookie-2.1.0.min.js"></script>
<script src="./Moduł_ 27. Express – własny serwer HTTP_files/jquery-dateFormat.min.js"></script>
<script src="./Moduł_ 27. Express – własny serwer HTTP_files/bootstrap.min.js"></script>
<script>
    (function () {
        $(document).ready(function () {
            if (window.location.hash === '#informator-modal') {
                showInformator();
            }
        });

        $('[data-action="show-modal"]').click(function() {
            showInformator();
        });

        function showInformator() {
            $('#informator').modal('show');
        }
    })();
</script>
<script src="./Moduł_ 27. Express – własny serwer HTTP_files/fb-412414a519.js" async=""></script>
<script src="./Moduł_ 27. Express – własny serwer HTTP_files/call-us-261b222cf4.js"></script>
<script>
    if (document.querySelector('main.editor')) {
        document.querySelector('body').classList.add('editor');
    }
</script>

<script type="text/javascript" async="">
  setTimeout(function (){
      (function(e,t,o,n,p,r,i){e.visitorGlobalObjectAlias=n;e[e.visitorGlobalObjectAlias]=e[e.visitorGlobalObjectAlias]||function(){(e[e.visitorGlobalObjectAlias].q=e[e.visitorGlobalObjectAlias].q||[]).push(arguments)};e[e.visitorGlobalObjectAlias].l=(new Date).getTime();r=t.createElement("script");r.src=o;r.async=true;i=t.getElementsByTagName("script")[0];i.parentNode.insertBefore(r,i)})(window,document,"https://diffuser-cdn.app-us1.com/diffuser/diffuser.js","vgo");
      vgo('setAccount', '649095895');
      vgo('setTrackByDefault', true);

      vgo('process');
  }, 3000);

</script>

<script>
    document.addEventListener("DOMContentLoaded", yall);
    window.environment = 'production';
    window.loggedIn = true;
    window.domain = 'https://kodilla.com';
            window.fbAppId = 1449248938627896;
    window.chatService = 'LiveAgent';
    window.useMessenger = window.chatService === 'Messenger';
    window.locale = 'pl';
    window.lang = 'pl';

    window.serverUTC       = 1627846301000;
    window.serverOffset    = 120;
    window.userDate        = new Date();
    window.userUTC         = userDate.getTime();
    window.userOffset      = userDate.getTimezoneOffset() * (-1);
    window.userClockDiff   = userUTC - serverUTC;
    window.diffRounded     = Math.round( userClockDiff / ( 1000 * 60 * 15 ) );
    window.isDifferentZone = ( userOffset - serverOffset !== 0 ) ? 1 : 0;
    window.hasWrongTime    = ( diffRounded !== 0 ) ? 1 : 0;
    window.dateTooltipText = 'Data i godzina są podane dla Twojej strefy czasowej GMT. <br>W razie wątpliwości napisz: <u>support@kodilla.com</u>.';
    window.wrongHourNotice = 'Godzina na Twoim urządzeniu r&oacute;żni się od godziny obowiązującej w strefie czasowej wybranej w ustawieniach Twojego urządzenia.';

    window.PAYU_HASH_ALGORITHM = 'SHA-256';
    window.PAYU_POS_ID = 1429452;
    window.PAYU_MD5_SECOND_KEY = 'f3627be5fab5a4238c8474936f057908';

    var moment = undefined,
        momentReady = function( method, method2, count ){
            var c = ( count ) ? count : 0;

            if      ( isDifferentZone && moment !== undefined ){
                if      ( method ) { method(); }
                else    { return false; }
            }
            else if ( isDifferentZone && moment === undefined ) {
                if ( c < 20 ) {
                    c++;
                    setTimeout( function() { momentReady( method, method2, c ); }
                        , 300 );
                } else {
                    if      ( method2 === true && method )  { method(); }
                    else if ( method2 !== true && method2 ) { method2(); }
                }
            }
            else {
                if      ( method2 === true && method )  { method(); }
                else if ( method2 !== true && method2 ) { method2(); }
                else    { return false; }
            }
        };

    if ( window.isDifferentZone && moment === undefined ) {
        var script = document.createElement("script");
        script.type = "text/javascript";
        script.src = '/static/js/libs/moment.timezone.locales.min.js?v=2.22.2';
        document.getElementsByTagName("head")[0].appendChild(script);
    }
</script>
<script src="./Moduł_ 27. Express – własny serwer HTTP_files/OneSignalSDK.js" async=""></script>
<script>
    var OneSignal = window.OneSignal || [];
    OneSignal.push(function() {
        OneSignal.init({
            appId: "92552bb5-b477-4ea2-8260-dba65be198d9",
        });
    });
</script>
<script data-ad-client="ca-pub-9483216428129091" async="" src="./Moduł_ 27. Express – własny serwer HTTP_files/f.txt"></script>
<script>
    (function(h,o,t,j,a,r){
        h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
        h._hjSettings={hjid:2404285,hjsv:6};
        a=o.getElementsByTagName('head')[0];
        r=o.createElement('script');r.async=1;
        r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
        a.appendChild(r);
    })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
</script>
        <script src="./Moduł_ 27. Express – własny serwer HTTP_files/underscore-min.js"></script>
<script src="./Moduł_ 27. Express – własny serwer HTTP_files/backbone-min.js"></script>
<script src="./Moduł_ 27. Express – własny serwer HTTP_files/backbone-relational.min.js"></script>
<script src="./Moduł_ 27. Express – własny serwer HTTP_files/backbone-super.min.js"></script>
<script src="./Moduł_ 27. Express – własny serwer HTTP_files/handlebars-v4.0.5.min.js"></script>
<script src="./Moduł_ 27. Express – własny serwer HTTP_files/handlebars-ifCond-139a2339f7.js"></script>
<script src="./Moduł_ 27. Express – własny serwer HTTP_files/application-0dcfdc1306.js"></script>
<script src="./Moduł_ 27. Express – własny serwer HTTP_files/main-cf3b73d734.js"></script>
<script src="./Moduł_ 27. Express – własny serwer HTTP_files/settings-5fc44a761b.js"></script>
<script src="./Moduł_ 27. Express – własny serwer HTTP_files/delete-account-da2b3de486.js"></script>
<script type="text/x-translation" data-translation-name="checkAccountDeleteCalculationMessage">Wynik jest nieprawidłowy</script>
<script src="./Moduł_ 27. Express – własny serwer HTTP_files/forms-222ea01b08.js"></script>
<script src="./Moduł_ 27. Express – własny serwer HTTP_files/alerts-66650c3acb.js"></script>
<script>
    App.Views.InpageAlertManager = Backbone.View.extend({
        events: {
            'click [data-alert-type][data-alert-text]': 'showAlert'
        },
        showAlert: function(e) {
            var $el = $(e.currentTarget);
            App.alertsView['show'+$el.data('alertType')]([App.Translations($el.data('alertText'))]);
        }
    });
</script>
<script src="./Moduł_ 27. Express – własny serwer HTTP_files/collections-c07e1162e2.js"></script>
<script src="./Moduł_ 27. Express – własny serwer HTTP_files/models-4e0e4fcffb.js"></script>
<script src="./Moduł_ 27. Express – własny serwer HTTP_files/knowledge-base-61f71273c9.js"></script>
<script>
    App.Views.LearningProgram = Backbone.View.extend({
        events: {
            'click [data-technology-desc-expander]' : 'expandTechnologyDesc'
        },

        initialize: function() {
            this.$allTechnologyDesc = this.$el.find('[data-technology-desc]');
            this.$allTechnologyExpanderIcons = this.$el.find('[data-technology-expander-icon]');
        },

        expandTechnologyDesc: function() {
            this.$allTechnologyDesc.each(function(){
                var $desc = $(this);
                $desc.slideToggle('fast');
            });
            this.$allTechnologyExpanderIcons.each(function(){
                var $icon = $(this);
                $icon.toggleClass("fa-minus");
            });
        },
    });
</script>

    <script src="./Moduł_ 27. Express – własny serwer HTTP_files/tether.min.js"></script>
    <script src="./Moduł_ 27. Express – własny serwer HTTP_files/prism.min.js"></script>

    <script src="./Moduł_ 27. Express – własny serwer HTTP_files/bootcamp-1522c7c010.js"></script>
    <script src="./Moduł_ 27. Express – własny serwer HTTP_files/jquery.seourl.min.js"></script>
    <script src="./Moduł_ 27. Express – własny serwer HTTP_files/perfect-scrollbar.jquery.min.js"></script>
    <script src="./Moduł_ 27. Express – własny serwer HTTP_files/jquery.fancybox.min.js"></script>
    <script src="./Moduł_ 27. Express – własny serwer HTTP_files/moment.timezone.locales.min.js"></script>
    <script src="./Moduł_ 27. Express – własny serwer HTTP_files/bootstrap-datetimepicker.min.js"></script>
    <script type="text/javascript">
        $(document).ready(function() {
            $("a.img-modal-group").fancybox();
        });
    </script>

<div class="modal fade" tabindex="-1" role="dialog" id="call-us-modal">
    <div class="modal-dialog modal-dialog-callus" role="document">
        <div class="modal-content call-modal">
            <div id="call-us-step1">
                <h2>Umów się na rozmowę z doradcą Kodilli</h2>
                <p>Krok <span>1/2:</span> Podaj numer telefonu</p>
                <form action="https://kodilla.com/pl/call-center/dates/phone_calls" method="post" id="call-us-form1">
                    <input type="tel" name="phone" id="call-us-input-phone" class="call-center-input" placeholder="731771787">
                    <p class="error-message display-none" id="validation-message-phone">Pole Numer Telefonu jest wymagane. Nieprawidłowy format.</p>
                    <button class="btn btn-success" id="call-us-submit-phone">Zarezerwuj rozmowę</button>
                </form>
                <p id="call-us-counter-holder" style="display: none;">Dzisiaj już  <span id="call-us-counter" class="call-counter" data-url="https://kodilla.com/pl/call-center/counter/phone_calls">-</span> <span id="call-us-counter-text" data-one=" osoba zamówiła rozmowę z nami." data-few=" osoby zamówiły rozmowę z nami." data-more=" osób zamówiło rozmowę z nami."></span></p>
                <div class="data-protection">
                    <p>Twój numer telefonu nie będzie wykorzystywany w celach marketingowych ani przekazany dalej. Tylko oddzwonimy. Dane są przetwarzane zgodnie z <a href="https://kodilla.com/pl/polityka-prywatnosci">Polityką Prywatności</a>.</p>
                </div>
            </div>

            <div id="call-us-step2" style="display: none;">
                <h2>Wybierz dogodny termin i godzinę na rozmowę z doradcą</h2>
                <p>Krok <span>2/2:</span>
                </p><form action="https://kodilla.com/pl/call-center/step2/phone_calls" method="post" id="call-us-form2">
                    <div class="select-date">
                        <select name="date" id="call-us-input-date">
                        </select>
                        <select name="time" id="call-us-input-time">
                        </select>
                    </div>
                    <button class="btn btn-success" id="call-us-submit-call">Oddzwońcie do mnie!</button>
                </form>
            </div>

            <div id="call-us-step3" style="display: none;">
                <div class="thanks">
                    <i class="fa fa-check-circle" aria-hidden="true"></i>
                    <h2>Dziękujemy za zamowienie rozmowy! Do usłyszenia w wybranym terminie!</h2>
                </div>
            </div>
        </div>
    </div>
</div>



                <style type="text/css">
    .embeddedServiceHelpButton .helpButton .uiButton {
        background-color: #1EA71C;
        font-family: "Arial", sans-serif;
    }
    .embeddedServiceHelpButton .helpButton .uiButton:focus {
        outline: 1px solid #1EA71C;
    }
</style>
<script>
    function openChat(){
        $('.helpButtonEnabled').trigger('click');
    }
</script>
<script type="text/javascript" src="./Moduł_ 27. Express – własny serwer HTTP_files/esw.min.js"></script>

<script type="text/javascript">
    var initESW = function(gslbBaseURL) {
        let firstName = 'Marek Baberowski'.split(" ")[0];
        let lastName = 'Marek Baberowski'.split(" ")[1];
        console.log(name);
        embedded_svc.settings.displayHelpButton = true;
        embedded_svc.settings.language = '';

        embedded_svc.settings.defaultMinimizedText =  'Skontaktuj się z nami';
        embedded_svc.settings.disabledMinimizedText = ' ';

        embedded_svc.settings.loadingText = 'Ładowanie';
        embedded_svc.settings.storageDomain = 'kodilla.com';

        embedded_svc.settings.prepopulatedPrechatFields = {
            'FirstName': firstName,
            'LastName': lastName,
            'Email': 'm.z.baberowski@gmail.com'
        };
        embedded_svc.settings.offlineSupportMinimizedText = 'Napisz do nas';

        embedded_svc.settings.enabledFeatures = ['LiveAgent'];
        embedded_svc.settings.entryFeature = 'LiveAgent';

        embedded_svc.init(
            'https://kodilla.my.salesforce.com',
            'https://kodillacommunity.force.com',
            gslbBaseURL,
            '00D1i000000VBFH',
            'Support_Kodilla',
            {
                baseLiveAgentContentURL: 'https://c.la1-c2-fra.salesforceliveagent.com/content',
                deploymentId: '5721i00000009s9',
                buttonId: '5731i0000000AJN',
                baseLiveAgentURL: 'https://d.la1-c2-fra.salesforceliveagent.com/chat',
                eswLiveAgentDevName: 'Support_Kodilla',
                isOfflineSupportEnabled: true
            }
        );
    };

    if (!window.embedded_svc) {
        var s = document.createElement('script');
        s.setAttribute('src', 'https://kodilla.my.salesforce.com/embeddedservice/5.0/esw.min.js');
        s.onload = function() {
            initESW(null);
        };
        document.body.appendChild(s);
    } else {
        initESW('https://service.force.com');
    }
</script><script id="common-script" type="text/javascript" src="./Moduł_ 27. Express – własny serwer HTTP_files/common.min.js"></script>
        <div data-role="notifications-wrapper" class="notifications-wrapper"></div>
<!-- Facebook Pixel Code -->
    <script>
        setTimeout(function(){
            !function(f,b,e,v,n,t,s)
            {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
                n.callMethod.apply(n,arguments):n.queue.push(arguments)};
                if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
                n.queue=[];t=b.createElement(e);t.async=!0;
                t.src=v;s=b.getElementsByTagName(e)[0];
                s.parentNode.insertBefore(t,s)}(window, document,'script',
                'https://connect.facebook.net/en_US/fbevents.js');
            fbq('init', 389137334769464 );
            fbq('track', 'PageView');
        }, 3000);
    </script>
    <!-- End Facebook Pixel Code -->

    <!-- Google Tag Manager -->
    <script>
        setTimeout(function () {
            (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
            })(window,document,'script','dataLayer','GTM-KN2WWBH');
        }, 3000);

    </script>
    <!-- End Google Tag Manager -->

    
    

<iframe name="_hjRemoteVarsFrame" title="_hjRemoteVarsFrame" id="_hjRemoteVarsFrame" src="./Moduł_ 27. Express – własny serwer HTTP_files/box-25a418976ea02a6f393fbbe77cec94bb.html" style="display: none !important; width: 1px !important; height: 1px !important; opacity: 0 !important; pointer-events: none !important;"></iframe><script id="liveagent-esw-script" type="text/javascript" src="./Moduł_ 27. Express – własny serwer HTTP_files/liveagent.esw.min.js"></script><form id="fileUploadForm" enctype="multipart/form-data" method="post" target="fileUploadIframe"><input type="file" id="fileSelector" name="file" style="display: none;"><input name="filename" type="hidden"></form><iframe id="fileUploadIframe" name="fileUploadIframe" title="FileUploadFrame" style="display: none;" src="./Moduł_ 27. Express – własny serwer HTTP_files/saved_resource.html"></iframe><iframe id="esw_storage_iframe" src="./Moduł_ 27. Express – własny serwer HTTP_files/esw.html" title="Live Chat Metadata" style="display: none;"></iframe><script type="text/javascript" src="./Moduł_ 27. Express – własny serwer HTTP_files/EmbeddedServiceConfig.jsonp"></script><script id="invite-esw-script" type="text/javascript" src="./Moduł_ 27. Express – własny serwer HTTP_files/invite.esw.min.js"></script><div class="embeddedServiceHelpButton"><div class="helpButton"><button class="helpButtonEnabled uiButton" href="javascript:void(0)"><span class="embeddedServiceIcon" aria-hidden="true" data-icon="" style="display: inline-block;"></span><span class="helpButtonLabel" id="helpButtonSpan" aria-live="polite" aria-atomic="true"><span class="assistiveText">Live chat:</span><span class="message">Napisz do nas</span></span></button></div></div><script id="inert-script" type="text/javascript" src="./Moduł_ 27. Express – własny serwer HTTP_files/inert.min.js"></script><script type="text/javascript" src="./Moduł_ 27. Express – własny serwer HTTP_files/EmbeddedServiceConfig(1).jsonp"></script><div id="fb-root" class=" fb_reset"><div style="position: absolute; top: -10000px; width: 0px; height: 0px;"><div></div></div></div>
<script type="text/javascript" id="">window._tfa=window._tfa||[];window._tfa.push({notify:"event",name:"page_view",id:1209537});!function(a,b,d,c){document.getElementById(c)||(a.async=1,a.src=d,a.id=c,b.parentNode.insertBefore(a,b))}(document.createElement("script"),document.getElementsByTagName("script")[0],"//cdn.taboola.com/libtrc/unip/1209537/tfa.js","tb_tfa_script");</script>
<noscript>
  <img src="//trc.taboola.com/1209537/log/3/unip?en=page_view" width="0" height="0" style="display:none">
</noscript>


<script type="text/javascript" id="">window._adftrack=Array.isArray(window._adftrack)?window._adftrack:window._adftrack?[window._adftrack]:[];window._adftrack.push({pm:2049944});(function(){var a=document.createElement("script");a.type="text/javascript";a.async=!0;a.src="https://track.adform.net/serving/scripts/trackpoint/async/";var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)})();</script>
<noscript>
    <p style="margin:0;padding:0;border:0;">
        <img src="https://track.adform.net/Serving/TrackPoint/?pm=2049944" width="1" height="1" alt="">
    </p>
</noscript>

<script type="text/javascript" id="">(function(){window.__insp=window.__insp||[];__insp.push(["wid",794470694]);var c=function(){if("undefined"==typeof window.__inspld){window.__inspld=1;var a=document.createElement("script");a.type="text/javascript";a.async=!0;a.id="inspsync";a.src=("https:"==document.location.protocol?"https":"http")+"://cdn.inspectlet.com/inspectlet.js?wid\x3d794470694\x26r\x3d"+Math.floor((new Date).getTime()/36E5);var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)}};setTimeout(c,0)})();</script>
</body></html>