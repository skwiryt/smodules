<!DOCTYPE html>
<!-- saved from url=(0051)https://kodilla.com/pl/bootcamp-module/407/277/5935 -->
<html lang="pl" class=""><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="ahrefs-site-verification" content="c2d3c04b9f125c5b8c98d89f738d343f69d841f035150344a932150235c5639a">
    
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="csrf-token" content="RtYZFGj83q4iSrSPWWX0bG3bzYwVu4VNaOaoyGGq">

<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="https://kodilla.com/static/img/icons/apple-touch-icon-60x60.png?00000">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="https://kodilla.com/static/img/icons/apple-touch-icon-76x76.png?00000">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="https://kodilla.com/static/img/icons/apple-touch-icon-120x120.png?00000">
<link rel="apple-touch-icon" type="image/png" sizes="152x152" href="https://kodilla.com/static/img/icons/apple-touch-icon-152x152.png?00000">
<link rel="icon" type="image/png" sizes="32x32" href="https://kodilla.com/static/img/icons/favicon-32x32.png?00000">
<link rel="icon" type="image/png" sizes="96x96" href="https://kodilla.com/static/img/icons/favicon-96x96.png?00000">
<link rel="icon" type="image/png" sizes="16x16" href="https://kodilla.com/static/img/icons/favicon-16x16.png?00000">

    <link rel="canonical" href="https://kodilla.com/pl/bootcamp-module/407/277/5935">

    <meta name="robots" content="noindex, follow">
    <title>    Moduł: 28. Websocket – natychmiastowa komunikacja
</title>
        <script type="text/javascript" src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/saved_resource"></script><script type="text/javascript" async="" src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/js"></script><script type="text/javascript" async="" id="inspsync" src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/inspectlet.js"></script><script type="text/javascript" async="" src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/saved_resource(1)"></script><script async="" src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/tfa.js" id="tb_tfa_script"></script><script type="text/javascript" async="" src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/insight.min.js"></script><script type="text/javascript" async="" src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/analytics.js"></script><script type="text/javascript" async="" src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/analytics.js"></script><script type="text/javascript" async="" src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/js(1)"></script><script async="" src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/gtm.js"></script><script src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/389137334769464" async=""></script><script async="" src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/fbevents.js"></script><script src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/sdk.js" async="" crossorigin="anonymous"></script><script id="facebook-jssdk" src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/sdk(1).js"></script><script src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/diffuser.js" async=""></script><script>document.documentElement.classList.remove("no-js")</script>
<script src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/yall.min.js"></script>
<link rel="stylesheet" href="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/bootstrap.min.css" as="style" onload="this.rel=&#39;stylesheet&#39;">
<link href="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/font-awesome.min.css" rel="stylesheet">
<link rel="stylesheet" href="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/main-b3cf79332c.css" as="style" onload="this.rel=&#39;stylesheet&#39;">
            
    <link href="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/prism.min.css" rel="stylesheet">

    <link href="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/bootcamp-6d0888d826.css" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/perfect-scrollbar.css">
    <link rel="stylesheet" href="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/jquery.fancybox.min.css" type="text/css" media="screen">
    <link href="https://kodilla.com/static/css/libs/bootstrap-datetimepicker.min.css?00000">
    <link rel="stylesheet" href="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/content.css">

<script async="" src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/hotjar-2404285.js"></script><script src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/OneSignalPageSDKES6.js" async=""></script><style type="text/css">.fancybox-margin{margin-right:15px;}</style><script async="" src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/modules.2ec2062e86adda67b2fe.js" charset="utf-8"></script><style type="text/css">iframe#_hjRemoteVarsFrame {display: none !important; width: 1px !important; height: 1px !important; opacity: 0 !important; pointer-events: none !important;}</style><link href="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/esw.min.css" type="text/css" rel="stylesheet"><style id="inert-style">
[inert] {
	pointer-events: none;
	cursor: default;
}

[inert], [inert] * {
	user-select: none;
	-webkit-user-select: none;
	-moz-user-select: none;
	-ms-user-select: none;
}
</style><script type="text/javascript" charset="utf-8" src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/saved_resource(2)" async=""></script><style type="text/css" data-fbcssmodules="css:fb.css.base css:fb.css.dialog css:fb.css.iframewidget css:fb.css.customer_chat_plugin_iframe">.fb_hidden{position:absolute;top:-10000px;z-index:10001}.fb_reposition{overflow:hidden;position:relative}.fb_invisible{display:none}.fb_reset{background:none;border:0;border-spacing:0;color:#000;cursor:auto;direction:ltr;font-family:"lucida grande", tahoma, verdana, arial, sans-serif;font-size:11px;font-style:normal;font-variant:normal;font-weight:normal;letter-spacing:normal;line-height:1;margin:0;overflow:visible;padding:0;text-align:left;text-decoration:none;text-indent:0;text-shadow:none;text-transform:none;visibility:visible;white-space:normal;word-spacing:normal}.fb_reset>div{overflow:hidden}@keyframes fb_transform{from{opacity:0;transform:scale(.95)}to{opacity:1;transform:scale(1)}}.fb_animate{animation:fb_transform .3s forwards}
.fb_dialog{background:rgba(82, 82, 82, .7);position:absolute;top:-10000px;z-index:10001}.fb_dialog_advanced{border-radius:8px;padding:10px}.fb_dialog_content{background:#fff;color:#373737}.fb_dialog_close_icon{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 0 transparent;cursor:pointer;display:block;height:15px;position:absolute;right:18px;top:17px;width:15px}.fb_dialog_mobile .fb_dialog_close_icon{left:5px;right:auto;top:5px}.fb_dialog_padding{background-color:transparent;position:absolute;width:1px;z-index:-1}.fb_dialog_close_icon:hover{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -15px transparent}.fb_dialog_close_icon:active{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yq/r/IE9JII6Z1Ys.png) no-repeat scroll 0 -30px transparent}.fb_dialog_iframe{line-height:0}.fb_dialog_content .dialog_title{background:#6d84b4;border:1px solid #365899;color:#fff;font-size:14px;font-weight:bold;margin:0}.fb_dialog_content .dialog_title>span{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/yd/r/Cou7n-nqK52.gif) no-repeat 5px 50%;float:left;padding:5px 0 7px 26px}body.fb_hidden{height:100%;left:0;margin:0;overflow:visible;position:absolute;top:-10000px;transform:none;width:100%}.fb_dialog.fb_dialog_mobile.loading{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/ya/r/3rhSv5V8j3o.gif) white no-repeat 50% 50%;min-height:100%;min-width:100%;overflow:hidden;position:absolute;top:0;z-index:10001}.fb_dialog.fb_dialog_mobile.loading.centered{background:none;height:auto;min-height:initial;min-width:initial;width:auto}.fb_dialog.fb_dialog_mobile.loading.centered #fb_dialog_loader_spinner{width:100%}.fb_dialog.fb_dialog_mobile.loading.centered .fb_dialog_content{background:none}.loading.centered #fb_dialog_loader_close{clear:both;color:#fff;display:block;font-size:18px;padding-top:20px}#fb-root #fb_dialog_ipad_overlay{background:rgba(0, 0, 0, .4);bottom:0;left:0;min-height:100%;position:absolute;right:0;top:0;width:100%;z-index:10000}#fb-root #fb_dialog_ipad_overlay.hidden{display:none}.fb_dialog.fb_dialog_mobile.loading iframe{visibility:hidden}.fb_dialog_mobile .fb_dialog_iframe{position:sticky;top:0}.fb_dialog_content .dialog_header{background:linear-gradient(from(#738aba), to(#2c4987));border-bottom:1px solid;border-color:#043b87;box-shadow:white 0 1px 1px -1px inset;color:#fff;font:bold 14px Helvetica, sans-serif;text-overflow:ellipsis;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0;vertical-align:middle;white-space:nowrap}.fb_dialog_content .dialog_header table{height:43px;width:100%}.fb_dialog_content .dialog_header td.header_left{font-size:12px;padding-left:5px;vertical-align:middle;width:60px}.fb_dialog_content .dialog_header td.header_right{font-size:12px;padding-right:5px;vertical-align:middle;width:60px}.fb_dialog_content .touchable_button{background:linear-gradient(from(#4267B2), to(#2a4887));background-clip:padding-box;border:1px solid #29487d;border-radius:3px;display:inline-block;line-height:18px;margin-top:3px;max-width:85px;padding:4px 12px;position:relative}.fb_dialog_content .dialog_header .touchable_button input{background:none;border:none;color:#fff;font:bold 12px Helvetica, sans-serif;margin:2px -12px;padding:2px 6px 3px 6px;text-shadow:rgba(0, 30, 84, .296875) 0 -1px 0}.fb_dialog_content .dialog_header .header_center{color:#fff;font-size:16px;font-weight:bold;line-height:18px;text-align:center;vertical-align:middle}.fb_dialog_content .dialog_content{background:url(https://static.xx.fbcdn.net/rsrc.php/v3/y9/r/jKEcVPZFk-2.gif) no-repeat 50% 50%;border:1px solid #4a4a4a;border-bottom:0;border-top:0;height:150px}.fb_dialog_content .dialog_footer{background:#f5f6f7;border:1px solid #4a4a4a;border-top-color:#ccc;height:40px}#fb_dialog_loader_close{float:left}.fb_dialog.fb_dialog_mobile .fb_dialog_close_icon{visibility:hidden}#fb_dialog_loader_spinner{animation:rotateSpinner 1.2s linear infinite;background-color:transparent;background-image:url(https://static.xx.fbcdn.net/rsrc.php/v3/yD/r/t-wz8gw1xG1.png);background-position:50% 50%;background-repeat:no-repeat;height:24px;width:24px}@keyframes rotateSpinner{0%{transform:rotate(0deg)}100%{transform:rotate(360deg)}}
.fb_iframe_widget{display:inline-block;position:relative}.fb_iframe_widget span{display:inline-block;position:relative;text-align:justify}.fb_iframe_widget iframe{position:absolute}.fb_iframe_widget_fluid_desktop,.fb_iframe_widget_fluid_desktop span,.fb_iframe_widget_fluid_desktop iframe{max-width:100%}.fb_iframe_widget_fluid_desktop iframe{min-width:220px;position:relative}.fb_iframe_widget_lift{z-index:1}.fb_iframe_widget_fluid{display:inline}.fb_iframe_widget_fluid span{width:100%}
.fb_mpn_mobile_landing_page_slide_out{animation-duration:200ms;animation-name:fb_mpn_landing_page_slide_out;transition-timing-function:ease-in}.fb_mpn_mobile_landing_page_slide_out_from_left{animation-duration:200ms;animation-name:fb_mpn_landing_page_slide_out_from_left;transition-timing-function:ease-in}.fb_mpn_mobile_landing_page_slide_up{animation-duration:500ms;animation-name:fb_mpn_landing_page_slide_up;transition-timing-function:ease-in}.fb_mpn_mobile_bounce_in{animation-duration:300ms;animation-name:fb_mpn_bounce_in;transition-timing-function:ease-in}.fb_mpn_mobile_bounce_out{animation-duration:300ms;animation-name:fb_mpn_bounce_out;transition-timing-function:ease-in}.fb_mpn_mobile_bounce_out_v2{animation-duration:300ms;animation-name:fb_mpn_fade_out;transition-timing-function:ease-in}.fb_customer_chat_bounce_in_v2{animation-duration:300ms;animation-name:fb_bounce_in_v2;transition-timing-function:ease-in}.fb_customer_chat_bounce_in_from_left{animation-duration:300ms;animation-name:fb_bounce_in_from_left;transition-timing-function:ease-in}.fb_customer_chat_bounce_out_v2{animation-duration:300ms;animation-name:fb_bounce_out_v2;transition-timing-function:ease-in}.fb_customer_chat_bounce_out_from_left{animation-duration:300ms;animation-name:fb_bounce_out_from_left;transition-timing-function:ease-in}.fb_customer_chat_bubble_animated_no_badge{box-shadow:0 3px 12px rgba(0, 0, 0, .15);transition:box-shadow 150ms linear}.fb_customer_chat_bubble_animated_no_badge:hover{box-shadow:0 5px 24px rgba(0, 0, 0, .3)}.fb_customer_chat_bubble_animated_with_badge{box-shadow:-5px 4px 14px rgba(0, 0, 0, .15);transition:box-shadow 150ms linear}.fb_customer_chat_bubble_animated_with_badge:hover{box-shadow:-5px 8px 24px rgba(0, 0, 0, .2)}.fb_invisible_flow{display:inherit;height:0;overflow-x:hidden;width:0}.fb_new_ui_mobile_overlay_active{overflow:hidden}@keyframes fb_mpn_landing_page_slide_in{0%{border-radius:50%;margin:0 24px;width:60px}40%{border-radius:18px}100%{margin:0 12px;width:100% - 24px}}@keyframes fb_mpn_landing_page_slide_in_from_left{0%{border-radius:50%;left:12px;margin:0 24px;width:60px}40%{border-radius:18px}100%{left:12px;margin:0 12px;width:100% - 24px}}@keyframes fb_mpn_landing_page_slide_out{0%{margin:0 12px;width:100% - 24px}60%{border-radius:18px}100%{border-radius:50%;margin:0 24px;width:60px}}@keyframes fb_mpn_landing_page_slide_out_from_left{0%{left:12px;width:100% - 24px}60%{border-radius:18px}100%{border-radius:50%;left:12px;width:60px}}@keyframes fb_mpn_landing_page_slide_up{0%{bottom:0;opacity:0}100%{bottom:24px;opacity:1}}@keyframes fb_mpn_bounce_in{0%{opacity:.5;top:100%}100%{opacity:1;top:0}}@keyframes fb_mpn_fade_out{0%{bottom:30px;opacity:1}100%{bottom:0;opacity:0}}@keyframes fb_mpn_bounce_out{0%{opacity:1;top:0}100%{opacity:.5;top:100%}}@keyframes fb_bounce_in_v2{0%{opacity:0;transform:scale(0, 0);transform-origin:bottom right}50%{transform:scale(1.03, 1.03);transform-origin:bottom right}100%{opacity:1;transform:scale(1, 1);transform-origin:bottom right}}@keyframes fb_bounce_in_from_left{0%{opacity:0;transform:scale(0, 0);transform-origin:bottom left}50%{transform:scale(1.03, 1.03);transform-origin:bottom left}100%{opacity:1;transform:scale(1, 1);transform-origin:bottom left}}@keyframes fb_bounce_out_v2{0%{opacity:1;transform:scale(1, 1);transform-origin:bottom right}100%{opacity:0;transform:scale(0, 0);transform-origin:bottom right}}@keyframes fb_bounce_out_from_left{0%{opacity:1;transform:scale(1, 1);transform-origin:bottom left}100%{opacity:0;transform:scale(0, 0);transform-origin:bottom left}}@keyframes fb_bounce_out_v2_mobile_chat_started{0%{opacity:1;top:0}100%{opacity:0;top:20px}}@keyframes fb_customer_chat_bubble_bounce_in_animation{0%{bottom:6pt;opacity:0;transform:scale(0, 0);transform-origin:center}70%{bottom:18pt;opacity:1;transform:scale(1.2, 1.2)}100%{transform:scale(1, 1)}}@keyframes slideInFromBottom{0%{opacity:.1;transform:translateY(100%)}100%{opacity:1;transform:translateY(0)}}@keyframes slideInFromBottomDelay{0%{opacity:0;transform:translateY(100%)}97%{opacity:0;transform:translateY(100%)}100%{opacity:1;transform:translateY(0)}}</style><script type="text/javascript" charset="utf-8" src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/t_prism_sitemessages.php" async=""></script></head>
<body class="student callus-enabled" cz-shortcut-listen="true">
<!-- Facebook Pixel Code -->
<noscript><img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id=389137334769464&ev=PageView&noscript=1"/></noscript>
<!-- End Facebook Pixel Code -->
<script>
    document.getElementsByTagName('body')[0].classList.remove('no-js');
    if ( window.isDifferentZone ) {
        document.querySelector('body').classList.add('time-conversion-applied');
    }
    if ( window.hasWrongTime ) {
        document.querySelector('body').classList.add('wrong-hour');
    }
</script>

    <nav class="navbar-main hidden-sm-down dark navbar">
    <div class="nav-container">
        <div class="navbar-header clearfix">
            <button class="navbar-toggler hidden-md-up pull-right" type="button" data-toggle="collapse" data-target="#collapsingNavbarUpper"><i class="fa fa-bars"></i></button>
        </div>
        <div class="collapse navbar-toggleable-sm container" id="collapsingNavbarUpper">
            <ul class="nav navbar-nav navbar-nav-left">
                                    <li class="nav-item nav-contact">
    <span>Skontaktuj się z nami:</span>
    <a href="mailto:support@kodilla.com">
        <i class="fa fa-envelope-o"></i>
        support@kodilla.com
    </a>
    <span>lub</span>
    <a href="javascript:openChat();">
        <i class="fa fa-comments"></i>
        porozmawiaj na czacie
    </a>
</li>
                                </ul>
            <ul class="nav navbar-nav pull-right">
                                <li class="nav-item">
                    <a href="https://kodilla.com/pl/informator" class="nav-link" target="_blank">
        Informator
    </a>
                </li>
                <li class="nav-item hidden-sm-down">
    <a href="https://kodilla.com/pl/account" class="nav-link">Konto</a>
</li>
        <li class="nav-item">
    <a class="analytics-track nav-link nav-link-accent" data-event="account_logout" href="https://kodilla.com/pl/sign-out">Wyloguj</a>
</li>
                            </ul>
        </div>
    </div>
</nav>
<nav class="navbar-main light navbar">
    <div class="container clearfix">
        <a class="navbar-brand" href="https://kodilla.com/pl">
            <img src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/kodilla-nav-logo.svg" alt="Kodilla - szkoła programowania">
        </a>
        <span class="contact-us-button-container"></span>
        <button class="navbar-toggler pull-right collapsed" type="button" data-toggle="collapse" data-target="#navbar-main">
            <i class="fa fa-bars navbar-ico-open"></i>
            <i class="fa fa-times navbar-ico-close"></i>
        </button>
        <ul id="navbar-main" class="nav navbar-nav pull-right collapse">
            <li class="nav-item hidden-sm-down">
    <a class="dropdown-toggle nav-link" href="https://kodilla.com/pl/poznaj-nasze-bootcampy">
        Szkolenia Bootcamp
    </a>
    <ul class="bootcamp-list">
                    <li class="list-sub list-sub-fe">
                <img src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/menu_fer.svg" class="menu-svg" width="32px" height="32px" title="menu_fer_logo">
                <a href="https://kodilla.com/pl/bootcamp/front-end">
                    <h4 class="bootcamp-name">Front-end: React</h4>
                    <p>Naucz się tworzyć front-end aplikacji w 4 miesiące</p>
                </a>
            </li>
            <li class="list-sub">
                <img src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/menu_wd.svg" class="menu-svg" width="32px" height="32px" title="menu_wd_logo">
                <a href="https://kodilla.com/pl/bootcamp/webdeveloper?type=wdp">
                    <h4 class="bootcamp-name">Web Developer</h4>
                    <p>Naucz&nbsp;się tworzyć aplikacje internetowe od&nbsp;podstaw</p>
                    <span class="bootcamp-label">FRONT-END i BACK-END</span>
                </a>
            </li>

            <li class="list-sub">
                <img src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/menu_java.svg" class="menu-svg" width="32px" height="32px" title="menu_java_logo">
                <a href="https://kodilla.com/pl/bootcamp/java?type=jdp">
                    <h4 class="bootcamp-name">Java Developer</h4>
                    <p>Poznaj najpopularniejszy na&nbsp;świecie język programowania od&nbsp;zera</p>
                </a>
            </li>
            <li class="list-sub">
                <img src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/menu_python.svg" class="menu-svg" width="32px" height="32px" title="menu_python_logo">
                <a href="https://kodilla.com/pl/bootcamp/python">
                    <h4 class="bootcamp-name">Python Developer</h4>
                    <p>Zdobądź kompetencje do tworzenia rozwiązań webowych</p>
                </a>
            </li>
            <li class="list-sub">
                <img src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/menu_tester.svg" class="menu-svg" width="32px" height="32px" title="menu_tester_logo">
                <a href="https://kodilla.com/pl/bootcamp/tester-automatyzujacy">
                    <h4 class="bootcamp-name">Tester Automatyzujący</h4>
                    <p>Poznaj podstawy testowania automatycznego w Javie</p>
                </a>
            </li>
            <li class="list-sub">
                <img src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/menu_game.svg" class="menu-svg" width="32px" height="32px" title="menu_mage_logo">
                <a href="https://kodilla.com/pl/bootcamp/game-dev">
                    <h4 class="bootcamp-name">Mobile Game Developer</h4>
                    <p>Zdobądź kompetencje do tworzenia gier</p>
                    <span class="bootcamp-label">nowość</span>
                </a>
            </li>
            </ul>
</li>

                        <li class="nav-item hidden-sm-down">
    <a class="dropdown-toggle nav-link" href="https://kodilla.com/pl/szkolenia-pro">
        Szkolenia Pro
    </a>
    <ul>
        <li><a href="https://kodilla.com/pl/szkolenia-pro/mikroserwisy" class="nav-link">Mikroserwisy w Javie</a></li>
        <li><a href="https://kodilla.com/pl/szkolenia-pro/spring-hibernate" class="nav-link">Spring i Hibernate</a></li>
        <li><a href="https://kodilla.com/pl/szkolenia-pro/wielowatkowosc" class="nav-link">Wielowątkowość w Javie</a></li>
        <li><a href="https://kodilla.com/pl/szkolenia-pro/django" class="nav-link">Aplikacje webowe z Django</a></li>
        <li><a href="https://kodilla.com/pl/szkolenia-pro/wizualizacja-danych" class="nav-link">Analiza danych w Pythonie</a></li>
        <li><a href="https://kodilla.com/pl/szkolenia-pro/machine-learning" class="nav-link">Podstawy Machine Learning</a></li>
        <li><a href="https://kodilla.com/pl/szkolenia-pro/bigdata-pyspark" class="nav-link">Big Data z PySpark</a></li>
        <li><a href="https://kodilla.com/pl/szkolenia-pro/automatyzacja-testow" class="nav-link">Automatyzacja testów</a></li>
        <li><a href="https://kodilla.com/pl/szkolenia-pro/vanilla-js" class="nav-link">Advanced Vanilla JS</a></li>
        <li><a href="https://kodilla.com/pl/szkolenia-pro/typescript" class="nav-link">TypeScript - kurs praktyczny</a></li>
        <li><a href="https://kodilla.com/pl/szkolenia-pro/vue3" class="nav-link">Vue3 - kompletny przewodnik</a></li>
        <li><a href="https://kodilla.com/pl/szkolenia-pro/zaawansowany-backend" class="nav-link">Backend zaawansowany</a></li>
    </ul>
</li>
            <li class="nav-item hidden-sm-down">
    <a class="dropdown-toggle nav-link">
        Strefa kursanta
    </a>
    <ul>
                    <li><a href="https://kodilla.com/pl/bootcamp-dashboard/407" class="nav-link">Bootcamp WD PLUS 2020-12</a></li>
                    <li><a class="nav-link" href="https://kodilla.com/pl/kursy">Samodzielne kursy</a></li>
                    <li><a class="nav-link" href="https://chat.kodilla.com/" target="_blank">Komunikator</a></li>
                    <li><a class="nav-link" href="https://kodilla.com/pl/projects">Moje projekty</a></li>
    </ul>
</li>
                            <li class="nav-item hidden-sm-down">
    <a class="dropdown-toggle nav-link">
        O nas
    </a>
    <ul class="about-us">
        <li><a href="https://kodilla.com/pl/mentorzy" class="nav-link">Mentorzy</a></li>
        <li><a href="https://kodilla.com/pl/zespol" class="nav-link">Zespół Kodilli</a></li>
        <li><a href="https://kodilla.com/pl/o-nas" class="nav-link">O firmie</a></li>
    </ul>
</li>
                                                                    <li class="nav-item hidden-md-up nav-group">
    <span class="mobile-menu-separator">Szkolenia Bootcamp</span>
    <ul>
                    <li class="nav-item list-sub-fe">
                <a class="nav-link nav-link-with-label" href="https://kodilla.com/pl/bootcamp/front-end">Bootcamp Front-end: React
                </a>
            </li>
                <li class="nav-item">
            <a class="nav-link nav-link-with-label" href="https://kodilla.com/pl/bootcamp/webdeveloper">Bootcamp Web Developer
                <span class="bootcamp-label">FRONT-END i BACK-END</span>
            </a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="https://kodilla.com/pl/bootcamp/java">Bootcamp Java</a>
        </li>
        <li class="nav-item list-sub-fe">
            <a class="nav-link nav-link-with-label" href="https://kodilla.com/pl/bootcamp/tester-automatyzuj%C4%85cy">Bootcamp Tester Automatyzujący
            </a>
        </li>
        <li class="nav-item list-sub-fe">
            <a class="nav-link nav-link-with-label" href="https://kodilla.com/pl/bootcamp/python">Python Developer
            </a>
        </li>
        <li class="nav-item list-sub-fe">
            <a class="nav-link nav-link-with-label" href="https://kodilla.com/pl/bootcamp/game-dev">Mobile Game Developer
                <span class="bootcamp-label">nowość</span>
            </a>
        </li>
    </ul>
</li>
<li class="nav-item hidden-md-up nav-group">
    <a class="nav-link-bold" href="https://kodilla.com/pl/szkolenia-pro">Szkolenia Pro</a>
</li>
            <li class="nav-item hidden-md-up nav-group">
            <span class="mobile-menu-separator">Strefa kursanta</span>
            <ul>
                <li class="nav-item ">
                                            <a class="nav-link" href="https://kodilla.com/pl/bootcamp-dashboard/407">
                            Bootcamp   WD PLUS 2020-12
                        </a>
                                    </li>
                <li class="nav-item ">
                    <a class="nav-link" href="https://kodilla.com/pl/kursy">Samodzielne kursy</a>
                </li>
                                    <li class="nav-item ">
                        <a class="nav-link" href="https://chat.kodilla.com/" target="_blank">Komunikator</a>
                    </li>
                                <li class="nav-item">
                    <a class="nav-link" href="https://kodilla.com/pl/projects">Moje projekty</a>
                </li>
            </ul>
        </li>
    
        
            <li class="nav-item hidden-md-up nav-group">
            <span class="mobile-menu-separator">O nas</span>
            <ul>
                <li class="nav-item">
                    <a href="https://kodilla.com/pl/mentorzy" class="nav-link">Mentorzy</a>
                </li>
                <li class="nav-item">
                    <a href="https://kodilla.com/pl/zespol" class="nav-link">Zespół Kodilli</a>
                </li>
                <li class="nav-item">
                    <a href="https://kodilla.com/pl/o-nas" class="nav-link">O firmie</a>
                </li>
            </ul>
        </li>
    
<li class="nav-item hidden-md-up nav-group">
    <span class="mobile-menu-separator">Pozostałe</span>
    <ul>
                                        
        <li class="nav-item">
            <a href="https://kodilla.com/pl/informator" class="nav-link" target="_blank">
        Informator
    </a>
        </li>
    </ul>

</li>

    <li class="nav-item hidden-md-up">
        <a class="nav-link" href="https://kodilla.com/pl/account">Konto</a>
    </li>
    <li class="nav-item hidden-md-up">
        <a class="nav-link analytics-track" data-event="account_logout" href="https://kodilla.com/pl/sign-out">Wyloguj</a>
    </li>

        
    <li class="nav-item hidden-md-up nav-group">
        <span class="mobile-menu-separator">Skontaktuj się z nami</span>
        <ul>
            <li class="nav-item">
                <a href="mailto:support@kodilla.com" class="nav-link">
                    <i class="fa fa-envelope-o"></i>
                    support@kodilla.com
                </a>
            </li>
            <li class="nav-item">
                <a href="javascript:openChat();" class="nav-link">
                    <i class="fa fa-comments"></i>
                    <span>Porozmawiaj na czacie</span>
                </a>
            </li>
        </ul>
    </li>
        </ul>
    </div>
</nav>
<main class="bootcamp module page-height-fix" id="bootcamp-module">
    <div class="aside-toggle hidden-md-up">
        <button class="navbar-toggler pull-left collapsed" type="button" data-toggle="collapse" data-target="#aside-sticky" aria-expanded="false">
            <i class="fa fa-bars navbar-ico-open"></i>
            <i class="fa fa-times navbar-ico-close"></i>
        </button>
    </div>
    <div class="table-of-contents aside-sticky collapsed collapse fixed" id="aside-sticky" style="transform: translateY(0px);">
        <section class="container">
            <div class="row">
                <aside class="module-nav col-md-4 col-md-offset-8">
                    <section class="card">
                        <div class="card-header">
                            <h4 class="card-title">Spis treści modułu</h4>
                        </div>
                        <ul class="list-group list-group-flush ps-container ps-theme-default ps-active-y" data-ps-id="69949f63-01b3-fbe8-a51b-57438c43f69d">
                                                        <li class="list-group-item completed">
                                <a href="https://kodilla.com/pl/bootcamp-module/407/277/5935#submodule-1135" class="clearfix">
                                    <p>28.1. Jak to działa? AJAX vs WebSocket</p>
                                    <i class="fa fa-check-circle-o"></i>
                                    <i class="fa fa-play-circle-o"></i>
                                    <i class="fa fa-send-o"></i>
                                    <i class="fa fa-exclamation-circle"></i>
                                </a>
                            </li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/277/5935#281-jak-to-dziala-ajax-vs-websocket-krotka-powtorka" class="clearfix">Krótka powtórka</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/277/5935#281-jak-to-dziala-ajax-vs-websocket-websocket" class="clearfix">WebSocket</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/277/5935#281-jak-to-dziala-ajax-vs-websocket-ajax-vs-websocket" class="clearfix">AJAX vs WebSocket</a></li>
                                                        <li class="list-group-item completed">
                                <a href="https://kodilla.com/pl/bootcamp-module/407/277/5935#submodule-1136" class="clearfix">
                                    <p>28.2. Pierwsza aplikacja – przygotowania</p>
                                    <i class="fa fa-check-circle-o"></i>
                                    <i class="fa fa-play-circle-o"></i>
                                    <i class="fa fa-send-o"></i>
                                    <i class="fa fa-exclamation-circle"></i>
                                </a>
                            </li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/277/5935#282-pierwsza-aplikacja-przygotowania-koncept-aplikacji-do-czego-dazymy" class="clearfix">Koncept aplikacji – do czego dążymy?</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/277/5935#282-pierwsza-aplikacja-przygotowania-pierwsze-kroki-klient" class="clearfix">Pierwsze kroki – klient</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/277/5935#282-pierwsza-aplikacja-przygotowania-pierwsze-kroki-serwer" class="clearfix">Pierwsze kroki – serwer</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/277/5935#282-pierwsza-aplikacja-przygotowania-podsumowanie" class="clearfix">Podsumowanie</a></li><li class="list-group-item list-group-flush sub task"><a href="https://kodilla.com/pl/bootcamp-module/407/277/5935#282-pierwsza-aplikacja-przygotowania-zadanie-pierwsze-kroki" class="clearfix">Zadanie: pierwsze kroki</a></li>
                                                        <li class="list-group-item completed">
                                <a href="https://kodilla.com/pl/bootcamp-module/407/277/5935#submodule-1137" class="clearfix">
                                    <p>28.3. Wprowadzamy WebSockety</p>
                                    <i class="fa fa-check-circle-o"></i>
                                    <i class="fa fa-play-circle-o"></i>
                                    <i class="fa fa-send-o"></i>
                                    <i class="fa fa-exclamation-circle"></i>
                                </a>
                            </li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/277/5935#283-wprowadzamy-websockety-koncept" class="clearfix">Koncept</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/277/5935#283-wprowadzamy-websockety-przygotowujemy-klienta" class="clearfix">Przygotowujemy klienta</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/277/5935#283-wprowadzamy-websockety-przygotowujemy-serwer" class="clearfix">Przygotowujemy serwer</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/277/5935#283-wprowadzamy-websockety-podsumowanie" class="clearfix">Podsumowanie</a></li><li class="list-group-item list-group-flush sub task"><a href="https://kodilla.com/pl/bootcamp-module/407/277/5935#283-wprowadzamy-websockety-zadanie-nowe-funkcjonalnosci" class="clearfix">Zadanie: nowe funkcjonalności</a></li>
                                                        <li class="list-group-item completed">
                                <a href="https://kodilla.com/pl/bootcamp-module/407/277/5935#submodule-1138" class="clearfix">
                                    <p>28.4. WebSockety w praktyce – aplikacja To-Do list</p>
                                    <i class="fa fa-check-circle-o"></i>
                                    <i class="fa fa-play-circle-o"></i>
                                    <i class="fa fa-send-o"></i>
                                    <i class="fa fa-exclamation-circle"></i>
                                </a>
                            </li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/277/5935#284-websockety-w-praktyce-aplikacja-to-do-list-zalozenia" class="clearfix">Założenia</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/277/5935#284-websockety-w-praktyce-aplikacja-to-do-list-krok-po-kroku" class="clearfix">Krok po kroku</a></li><li class="list-group-item list-group-flush sub task"><a href="https://kodilla.com/pl/bootcamp-module/407/277/5935#284-websockety-w-praktyce-aplikacja-to-do-list-zadanie-lepsza-identyfikacja" class="clearfix">Zadanie: lepsza identyfikacja</a></li>
                                                        <li class="list-group-item completed">
                                <a href="https://kodilla.com/pl/bootcamp-module/407/277/5935#submodule-1139" class="clearfix">
                                    <p>28.5. WebSockety w praktyce – zamawianie biletów</p>
                                    <i class="fa fa-check-circle-o"></i>
                                    <i class="fa fa-play-circle-o"></i>
                                    <i class="fa fa-send-o"></i>
                                    <i class="fa fa-exclamation-circle"></i>
                                </a>
                            </li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/277/5935#285-websockety-w-praktyce-zamawianie-biletow-jak-to-rozegramy" class="clearfix">Jak to rozegramy?</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/277/5935#285-websockety-w-praktyce-zamawianie-biletow-pierwsze-kroki-serwer" class="clearfix">Pierwsze kroki – serwer</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/277/5935#285-websockety-w-praktyce-zamawianie-biletow-pierwsze-kroki-klient" class="clearfix">Pierwsze kroki – klient</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/277/5935#285-websockety-w-praktyce-zamawianie-biletow-rozwijamy-serwer" class="clearfix">Rozwijamy serwer</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/277/5935#285-websockety-w-praktyce-zamawianie-biletow-rozwijamy-klienta" class="clearfix">Rozwijamy klienta</a></li><li class="list-group-item list-group-flush sub "><a href="https://kodilla.com/pl/bootcamp-module/407/277/5935#285-websockety-w-praktyce-zamawianie-biletow-podsumowanie" class="clearfix">Podsumowanie</a></li><li class="list-group-item list-group-flush sub task"><a href="https://kodilla.com/pl/bootcamp-module/407/277/5935#285-websockety-w-praktyce-zamawianie-biletow-zadanie-wolne-miejsca" class="clearfix">Zadanie: wolne miejsca</a></li>
                                                        <li class="list-group-item completed">
                                <a href="https://kodilla.com/pl/bootcamp-module/407/277/5935#submodule-1140" class="clearfix">
                                    <p>28.6. Podsumowanie</p>
                                    <i class="fa fa-check-circle-o"></i>
                                    <i class="fa fa-play-circle-o"></i>
                                    <i class="fa fa-send-o"></i>
                                    <i class="fa fa-exclamation-circle"></i>
                                </a>
                            </li>
                                                        <li class="list-group-item completed">
                                <a href="https://kodilla.com/pl/bootcamp-module/407/277/5935#submodule-1141" class="clearfix">
                                    <p>28.7. Quiz powtórkowy</p>
                                    <i class="fa fa-check-circle-o"></i>
                                    <i class="fa fa-play-circle-o"></i>
                                    <i class="fa fa-send-o"></i>
                                    <i class="fa fa-exclamation-circle"></i>
                                </a>
                            </li>
                                                    <div class="ps-scrollbar-x-rail" style="left: 0px; bottom: 3px;"><div class="ps-scrollbar-x" tabindex="0" style="left: 0px; width: 0px;"></div></div><div class="ps-scrollbar-y-rail" style="top: 0px; height: 606px; right: 3px;"><div class="ps-scrollbar-y" tabindex="0" style="top: 0px; height: 249px;"></div></div></ul>
                        <div class="card-block text-center">
                                                                                                <a href="https://kodilla.com/pl/bootcamp-dashboard/407">Powrót do dashboardu</a>
                                                                                    </div>
                    </section>
                </aside>
            </div>
        </section>
    </div>
    <section class="container module-content">
        <div class="row">
            <main class="col-md-8">
                <section class="card">
                    <div class="card-block module-header clearfix  completed ">
                        <h1 class="card-title">28. Websocket – natychmiastowa komunikacja</h1>
                                                <i class="fa fa-bookmark fa-3x" aria-hidden="true"></i>
                    </div>
                                        <div class="card-block challenge">
                        <h3>Wyzwania:</h3>
                        <ul>
<li>dowiesz się jakie ograniczenia ma AJAX,</li>
<li>poznasz mechanizm komunikacji w czasie rzeczywistym,</li>
<li>wykorzystasz sockety w praktyce.</li>
</ul>
<p>Dotychczas główną technologią, której używaliśmy w naszych aplikacjach do komunikacji klient-serwer był AJAX. Pozwalał on na łatwe tworzenie requestów i odbieranie odpowiedzi, przy czym strona nie musiała się nawet przeładowywać. Mimo wielu zalet nie zawsze jest to rozwiązanie optymalne. Przekonaliśmy się o tym, chociażby w poprzednim module, gdzie podstrona do rezerwacji biletów miała problem z pokazywaniem aktualnych danych o liczbie zajętych miejsc. Rozwiązaniem tego oraz wielu innych problemów, może być technologia, którą poznasz w tym module, a mianowicie <strong>WebSocket</strong>.</p>
<p>AJAX bazuje na komunikacji bez stałego połączenia, która może być inicjowana tylko z jednej strony (klient wysyła request do serwera), natomiast WebSocket pozwala na stałą łączność oraz wysyłanie danych przez oba podmioty. Dzięki temu wymiana danych między hostami może być natychmiastowa. Takie rozwiązanie ma ogromną liczbę zastosowań.</p>
<p>Przykładami użycia mogą być:</p>
<ul>
<li>aplikacje czatu,</li>
<li>edytory z opcją kolaboracji live,</li>
<li>transmisje tekstowe live na stronach,</li>
<li>indeksy giełdowe aktualizowane w czasie rzeczywistym,</li>
<li>gry z opcją multiplayer.</li>
</ul>

                    </div>
                                    </section>
                                    
                <section id="submodule-1135" class="card submodule completed" data-bootcamp-user-submodule-id="663633">
                <!-- klasy dla section: completed current comments -->
                    <div class="card-block submodule-header clearfix">
                        <i class="fa fa-check-circle-o fa-2x"></i>
                        <i class="fa fa-play-circle-o fa-2x"></i>
                        <i class="fa fa-exclamation-circle fa-2x"></i>
                        <i class="fa fa-send-o fa-2x"></i>
                        <h2 class="bootcamp-submodule-name">28.1. <span>Jak to działa? AJAX vs WebSocket</span></h2>
                                            </div>
                    <div class="card-block">
                        <div class="submodule-content">
                            <h3 id="281-jak-to-dziala-ajax-vs-websocket-krotka-powtorka">Krótka powtórka</h3>
<p>Zacznijmy od przypomnienia, jak działa AJAX.</p>
<p>Gdy tylko zachodzi potrzeba komunikacji z serwerem, wysyłamy żądanie (request) i otrzymujemy odpowiedź (response). Co ważne – <strong>nie mamy stałego połączenia</strong>, a komunikujemy się tylko na chwilę, w celu otrzymania odpowiedzi, po czym tracimy kontakt aż do momentu, kiedy wyślemy kolejne żądanie. W niektórych aplikacjach robimy to tylko raz (np. pobierając startowe dane), a czasami częściej (np. cyklicznie odświeżamy listę).</p>
<a href="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/Ajax.gif" class="img-modal-group"><img src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/Ajax.gif" alt="image" style="width: auto;"></a>
<p>W tym przypadku mamy aż trzech klientów łączących się co jakiś czas z serwerem za pomocą requestów AJAX-u. Nawet gdyby wysyłali je co kilka sekund, to i tak przez chwilę nie będą mieli kontaktu z serwerem. Ponadto zbyt częste żądania generują ogromne przeciążenie – wyobraź sobie, że w tym czasie serwer musi obsłużyć request od stu czy tysiąca klientów. Nie jest to komfortowa sytuacja.</p>
<p>Oczywiście taki sposób komunikacji niekoniecznie musi być wadą. Jeśli wykorzystujemy serwer sporadycznie, do aktualizacji czy pobierania jakichś danych, często będzie to dobra opcja. Zresztą, z doświadczenia wiesz już, że AJAX w większości przypadków radzi sobie świetnie.</p>
<p>Są jednak sytuacje, w których brak stałego połączenia będzie nam szczególnie doskwierał – zwłaszcza gdy często wymieniamy informacje z serwerem, albo nie wiemy, kiedy powinniśmy je zaktualizować.</p>
<p>Przypomnij sobie przykład witryny festiwalu muzycznego z poprzedniego modułu. Przez większość czasu "zajętość" miejsc w bazie wcale się nie zmienia. Możliwa jest sytuacja, że nawet przez kilka godzin żaden użytkownik nic nie zarezerwuje, a w tym czasie aplikacja (klient) i tak będzie uparcie "pytać" serwer, jaki jest aktualny stan.</p>
<p>Tutaj ujawnia się jeszcze inna wada AJAXu: <strong>serwer sam nie może rozpoczynać połączenia</strong>, więc tak naprawdę <strong>komunikacja może być inicjowana tylko w jedną stronę</strong>. Dopiero kiedy sami o coś zapytamy (wyślemy request), serwer ma okazję odpowiedzieć. To duża wada. Często byłoby lepiej, aby to on sam informował, że sytuacja się&nbsp;zmieniła i np. należy coś zaktualizować.</p>
<p>Skorzystałaby na tym na pewno nasza strona festiwalu, ale cóż... AJAX tego nie potrafi.</p>
<div class="bc-note alert-success">
<h4 class="alert-heading text-center">Kłopotliwa organizacja pracy</h4>
<img src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/Ajax2.png" class="img-inline img-right">
<p>Aby lepiej zobrazować to, o czym mówimy, posłużymy się przykładem.</p>
<p>Wyobraź sobie średniej wielkości software house, gdzie przydziałem zadań zajmuje się jedna, zamknięta swoim biurze osoba. Powiedzmy, że jest nią PM (Project Manager). Pozostała część zespołu to szeregowi developerzy, z których każdy pracuje w swoim biurze.</p>
<h4>Scenariusz A</h4>
<p>Załóżmy, że PM ustala rano taski na dany dzień. Wtedy też każdy developer przychodzi do jego biura, a zadania zostają rozdzielone. Następnie wszyscy programiści udają się do swoich stanowisk i pracują tam sami do końca dnia. Jeśli potrzebują o coś zapytać, po prostu odwiedzają PM-a. On sam nigdy nie opuszcza biura.</p>
<p>Czy w takim scenariuszu, to że przez praktycznie cały dzień pracownicy nie mają kontaktu z PM-em jest jakimś problemem? Niespecjalnie. Tak naprawdę ciągła komunikacja nie byłaby tu potrzebna. Nawet to, że PM nigdy sam nie ruszy się ze swojego biura, nikomu nie przeszkadza.</p>
<p>Owszem, poranna audiencja u PM-a, kiedy odwiedzają go wszyscy developerzy, może być dla niego przez chwilę męczącą, ale w gruncie rzeczy praca przebiega prawidłowo. Programiści przychodzą dodatkowo o różnych porach (8:05, 8:15, 9:00), więc nie jest to zbyt dużym problemem.</p>
<h4>Scenariusz B</h4>
<p>Teraz wyobraźmy sobie drugi scenariusz. PM nadal ma własne biuro, z którego się nie rusza, a developerzy pracują w swoich. Taski nie są jednak układane rano przed pracą, lecz PM zajmuje się ich tworzeniem na bieżąco podczas całego dnia. Do tego ciągle rozmawia przez telefon ze zleceniodawcą i nie można się do niego dodzwonić. Tym samym developerzy są zmuszeni, co jakiś czas opuszczać swoje biuro i zaglądać do PM-a z pytaniem, czy może pojawiło się już jakieś nowe zadanie. Oczywiście wiele takich podróży będzie bezowocnych.</p>
<p>Widzisz, jaki mamy tu problem? Ten system jest kompletnie niewydajny. Pracownicy, zamiast pracować, co chwilę spacerują, aby w większości przypadków usłyszeć "wybacz, nic jeszcze dla Ciebie nie mam". Sam PM też nie może spokojnie pracować, bo co chwila odwiedzają go developerzy i musi im odpowiadać.</p>
<h4>Analogia</h4>
<p>Dostrzegasz tutaj analogię do AJAX-u? PM to nasz serwer, a developerzy to klienci. Oczywiście AJAX nie musi być zły, ale pamiętajmy o jego ograniczeniach.</p>
</div>
<h3 id="281-jak-to-dziala-ajax-vs-websocket-websocket">WebSocket</h3>
<p>WebSocket również służy – podobnie jak AJAX – do komunikacji klienta z serwerem, ale zarządza nią w trochę inny sposób.</p>
<p>Po pierwsze, <strong>połączenie jest ciągłe</strong>. Inicjuje się, gdy po raz pierwszy uruchomimy aplikację (np. otwierając ją w zakładce przeglądarki) i zamyka dopiero wtedy, kiedy zostanie ona wyłączona. Warto dodać, że każda kolejna zakładka to nowy klient (w WebSocket nazywany "socketem"), a więc nowy kanał komunikacyjny. W szczegóły zagłębimy się za chwilę.</p>
<p>Po drugie, <strong>kontakt może być inicjowany przez obie strony</strong>. Serwer nie musi oczekiwać na klienta, tylko sam jest w stanie coś mu przesłać.</p>
<p>Możesz zastanawiać się nad wydajnością takiego rozwiązania. Jak to jest skonstruowane? Klient i serwer ciągle wymieniają między sobą dane? Nie. WebSocket wykorzystuje znany Ci już koncept emitowania akcji i nasłuchiwania. Krótko mówiąc, komunikacja polega na wzajemnym nasłuchiwaniu się obu stron – kiedy jedna coś nada (wyemituje jakiś event), druga może jakoś zareagować. Przez dłuższy czas może nie dziać się nic, jednak kiedy tylko jedna ze stron wyśle w eter jakąś informację, druga od razu ją odbierze. Co ważne, komunikacja jest ciągła, więc <strong>wszystko odbywa się w czasie rzeczywistym</strong>.</p>
<p>Opowiedzmy teraz dokładnie, jak to wygląda krok po kroku.</p>
<h4>Etap 1 – uścisk dłoni</h4>
<p>Kiedy klient łączy się z serwerem, powstaje między nimi <strong>kanał komunikacyjny</strong>. Od tego momentu oba podmioty są ze sobą w ciągłym kontakcie. Nie muszą koniecznie ciągle czegoś przesyłać, niemniej jednak <strong>bez przerwy nasłuchują, czy drugi nie ma czegoś do powiedzenia</strong>.</p>
<div class="bc-note alert-success">
<h4 class="alert-heading text-center">Handshake</h4>
<p>Możesz zobrazować to sobie jako uścisk dłoni. Witasz się z kimś i od tej chwili jesteście w kontakcie – jeden słucha, co drugi ma do powiedzenia. Nie musicie mówić ciągle, ale nawet jeśli nastanie cisza, słuchacie i oczekujecie na to, co za chwilę powie druga osoba.</p>
</div>
<a href="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/WebSocket.gif" class="img-modal-group"><img src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/WebSocket.gif" alt="image" style="width: auto;"></a>
<p>Spójrz na fioletową linię symbolizującą kanał komunikacyjny, nie znika ona nawet na sekundę. Klient i serwer są w ciągłym kontakcie.</p>
<p>Co mamy na myśli mówiąc "klient łączy się z serwerem"? Chodzi tutaj o rozpoczęcie pracy – kiedy otworzysz np. <code>localhost:8000</code>, na którym jest Twój serwer lokalny, to w tej chwili stajesz się "klientem", a WebSocket tworzy kanał komunikacyjny.</p>
<h4>Etap 2 – komunikacja w obie strony</h4>
<p>Po utworzeniu kanału komunikacyjnego obie strony są w trybie nasłuchu. Sami decydujemy, na co dokładnie serwer czy klient ma zwrócić uwagę, dodając nasłuchiwacze. Pomysł ten nie jest dla Ciebie niczym nowym, mówiliśmy o nich już od samego początku nauki JS-a. Dzięki nim serwer może np. oczekiwać na zdarzenie <code>join</code>, a po jego wykryciu, dodać użytkownika do bazy danych. Jeśli klient wyemituje akcję, to serwer od razu na nią zareaguje. Naturalnie, nawet gdybyśmy nie ustawili nasłuchiwacza, serwer też by ją wykrył, tylko zwyczajnie nic by z tym nie zrobił.</p>
<p>Oczywiście nie zapominajmy, że WebSocket to komunikacja w obie strony, więc <strong>nasłuchiwać na zdarzenie oraz emitować je może zarówno klient, jak i serwer</strong>.</p>
<div class="bc-note alert-success">
<h4 class="alert-heading text-center">Przygotowujemy się do rozmowy</h4>
<p>Wciąż możemy pozostać przy analogii rozmowy. Przed spotkaniem obie strony mogą spodziewać się, o co zapyta druga osoba i przygotować właściwe odpowiedzi. Wyobraź sobie np. rozmowę o pracę. Możesz przed nią założyć, że jeśli tylko usłyszysz pytanie o zarobki, postarasz się nie zejść poniżej założonej kwoty, a potem szybko zmienisz temat, aby ta informacja nie zwaliła rekrutera z nóg ;)</p>
<p>Taka rozmowa byłaby konwersacją w stylu emitowanie/nasłuchiwanie. Od początku rozmowy zakładasz, że może paść pytanie o zarobki i w razie czego masz gotową odpowiedź.</p>
<p>Oczywiście pozostając przy analogii do WebSocketów, rekruter również mógłby przygotować się wcześniej na kilka pytań z Twojej strony.</p>
</div>
<p>Warto dodać jeszcze dwie rzeczy. Po pierwsze, nie musimy emitować tylko "suchej" akcji (np. <code>join</code>). <strong>Wraz ze zdarzeniem możemy wysyłać również jakieś informacje</strong>, np. użytkownik wpisuje login, a następnie emituje zdarzenie <code>join</code> wraz z danymi <code>{ login: 'JohnDoe' }</code>. Dzięki temu serwer będzie wiedział o kim mowa.</p>
<p>Po drugie, choć łączność jest nieco bardziej zaawansowana niż przy użyciu AJAX-u, jedna rzecz się nie zmienia – <strong>WebSocket to tylko komunikacja klient-serwer</strong>. Nie możemy łączyć się bezpośrednio pomiędzy samymi <em>socketami</em> (klientami). Do tego musimy użyć serwera jako pośrednika. O tym, jak dokładnie możemy to osiągnąć, opowiemy jednak trochę później.</p>
<p>Na koniec mały przykład:</p>
<a href="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/WebSocket2.gif" class="img-modal-group"><img src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/WebSocket2.gif" alt="image" style="width: auto;"></a>
<p>Tutaj sytuacja jest następująca:</p>
<ol>
<li>Serwer nasłuchuje na zdarzenie <code>join</code>, a klient na <code>userAdded</code>. Oba podmioty są w ciągłym kontakcie.</li>
<li>Gdy klient emituje <code>join</code> (wraz z danymi o użytkowniku), serwer od razu reaguje. Z racji tego, że oczekiwał na ten event, gdy tylko dowiaduje się, że on nastąpił, wykonuje wcześniej założone instrukcje, a więc – dodaje użytkownika do swojej tablicy z danymi i emituje w drugą stronę zdarzenie <code>userAdded</code> (tym razem bez żadnych danych).</li>
<li>Klient natychmiast wykrywa to zdarzenie i również wykonuje wcześniej założoną w nasłuchiwaczu operację – pokazuje użytkownikowi alert.</li>
</ol>
<h4>Etap 3 – koniec rozmowy</h4>
<p>Gdy jedna ze stron się rozłączy (np. zamknie zakładkę aplikacji klienta), kanał komunikacyjny po prostu zniknie, a konwersacja dobiegnie końca.</p>
<a href="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/WebSocket4.gif" class="img-modal-group"><img src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/WebSocket4.gif" alt="image" style="width: auto;"></a>
<div class="bc-note alert-success">
<h4 class="alert-heading text-center">Komunikacja na miarę czasów</h4>
<img src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/WebSocket3.png" class="img-inline img-right">
<p>Pamiętasz naszą analogię z firmą, którą przedstawiliśmy, aby zobrazować ograniczenia AJAX-u?</p>
<p>Przypomnijmy, jak wyglądał <strong>scenariusz B</strong>. PM był cały dzień zamknięty w biurze, a developerzy pracowali w swoich. Między nimi nie było żadnej bezpośredniej komunikacji. Aby dowiedzieć się, czy jest coś do zrobienia (PM przygotowuje taski na bieżąco), programiści musieli osobiście fatygować się co jakiś czas do PM-a. Co ważne, bardzo często te podróże były bezowocne. Odwzorowało to ograniczenia komunikacji AJAX-a, w której to klient zawsze musiał inicjować requesty.</p>
<p>Jak moglibyśmy rozwiązać taki problem w analogii do WebSocketów?</p>
<p>Wyobraź sobie, że w każdym biurze zamontowano głośnik i mikrofon. Teraz programiści mogliby spokojnie pracować albo czekać na zadania u siebie. Gdyby PM coś dla nich przygotował, poinformowałby ich za pomocą mikrofonu (analogia do serwera emitującego event). Słysząc komunikat, programista odpowiednio by zareagował (nasłuchiwanie na event). Co ważne jednak sam także łatwo mógłby w każdej chwili dopytać PM-a o jakieś szczegóły (klient też może emitować event).</p>
<p>Oczywiście wciąż byłaby to komunikacja PM–&gt;programista (serwer–&gt;klient) albo programista–&gt;PM (klient–&gt;serwer) i nie byłoby kontaktu między samymi developerami (klientami). W każdej chwili mogliby jednak skorzystać z pośrednictwa PM-a, tak aby w razie potrzeby przekazywał wiadomości od jednego do drugiego (serwer jako pośrednik między socketami).</p>
<p>Przyznaj, taka komunikacja wygląda o wiele bardziej obiecująco :)</p>
</div>
<h3 id="281-jak-to-dziala-ajax-vs-websocket-ajax-vs-websocket">AJAX vs WebSocket</h3>
<p>Na koniec podsumujmy oba rozwiązania.</p>
<p><strong>AJAX</strong> to:</p>
<ul>
<li>brak stałej/ciągłej komunikacji,</li>
<li>komunikacja z serwerem w systemie <em>request–&gt;response</em>,</li>
<li>tylko jedna ze stron inicjująca kontakt (klient).</li>
</ul>
<p><strong>WebSocket</strong> to:</p>
<ul>
<li>ciągła komunikacja od początku do końca,</li>
<li>komunikacja między serwerem a klientem odbywająca się poprzez emitowanie i odbieranie eventów,</li>
<li>komunikacja inicjowana przez obie strony,</li>
<li>komunikacja w czasie rzeczywistym.</li>
</ul>
<p>Czy możemy powiedzieć, że któryś jest lepszy lub gorszy? Nie. Tak naprawdę, <strong>wszystko zależy od sytuacji</strong>. Czasem wystarczy AJAX, bo WebSocket tylko skomplikowałby nasz kod. Innym razem AJAX nie podoła, a WebSocket będzie idealny. Jak zawsze, ostateczny wybór należy do nas.</p>

                        </div>
                    </div>
                                        <div class="card-block submodule-footer clearfix  completed ">
                                                <small>Jeśli masz wątpliwości do powyższego materiału, to - zanim zatwierdzisz - zapytaj na czacie :)</small>
                                                <div class="clearfix">
                                                                                <button class="btn  btn-primary "><i class="fa fa-check"></i><span>Zapoznałe(a)m się!</span></button>
                                                                                                    </div>
                    </div>
                </section>
                                    
                <section id="submodule-1136" class="card submodule completed" data-bootcamp-user-submodule-id="663634">
                <!-- klasy dla section: completed current comments -->
                    <div class="card-block submodule-header clearfix">
                        <i class="fa fa-check-circle-o fa-2x"></i>
                        <i class="fa fa-play-circle-o fa-2x"></i>
                        <i class="fa fa-exclamation-circle fa-2x"></i>
                        <i class="fa fa-send-o fa-2x"></i>
                        <h2 class="bootcamp-submodule-name">28.2. <span>Pierwsza aplikacja – przygotowania</span></h2>
                                            </div>
                    <div class="card-block">
                        <div class="submodule-content">
                            <p>Dość teorii. Czas na wykorzystanie technologii WebSocket w praktyce. Aplikacją, który razem wykonamy, będzie prosty czat. To flagowy przykład użycia WebSocketów – potrzebujemy bowiem szybkiej wymiany danych, najlepiej w czasie rzeczywistym, ważna jest też spora wydajność.</p>
<h3 id="282-pierwsza-aplikacja-przygotowania-koncept-aplikacji-do-czego-dazymy">Koncept aplikacji – do czego dążymy?</h3>
<p>Efektem będzie aplikacja czatu działająca w następujący sposób.</p>
<h4>Klient</h4>
<ol>
<li>Aplikacja przy wejściu powinna pytać o nazwę użytkownika.</li>
<li>Po ustaleniu nazwy użytkownika formularz powinien zniknąć. Zamiast tego musi pokazać się lista wiadomości, aktualizowana w czasie rzeczywistym.</li>
<li>Wraz z listą wiadomości pokazywać musi się również formularz – pole tekstowe i guzik "Send". Kliknięcie na button powinno dodać nową wiadomość.</li>
</ol>
<h4>Serwer</h4>
<ol>
<li>Powinien przechowywać tablicę wiadomości.</li>
<li>Pod głównym adresem <code>/</code> powinien zwracać naszą aplikację klienta.</li>
<li>Gdy pojawi się nowa wiadomość, powinien aktualizować tablicę oraz informować o nowym wpisie wszystkich użytkowników.</li>
</ol>
<p>Nie wchodzimy tu jeszcze w szczegóły, ale z samego opisu możesz już wywnioskować, że <strong>komunikacja pomiędzy serwerem i klientem będzie opierać się na technice emitowania i nasłuchiwania akcji</strong>.</p>
<div class="bc-note alert-info">
<h4 class="alert-heading text-center">Jeszcze jedno założenie</h4>
<p>W przypadku czatów publicznych bardzo popularną koncepcją jest niepokazywanie archiwalnych wiadomości. Użytkownik nie wie, co było pisane na danym kanale przed jego przyjściem. My też zastosujemy się do takiego pomysłu.</p>
</div>
<h4>Ostateczny efekt</h4>
<p>Na końcu aplikacja powinna wyglądać następująco:</p>
<a href="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/WebSocket12.gif" class="img-modal-group"><img src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/WebSocket12.gif" alt="image" style="width: auto; max-width: 50%;"></a>
<p>Nie martw się wyglądem, style zostaną Ci dostarczone, tak byśmy mogli skupić się na stworzeniu samej logiki aplikacji.</p>
<h3 id="282-pierwsza-aplikacja-przygotowania-pierwsze-kroki-klient">Pierwsze kroki – klient</h3>
<p>Na początek przygotujemy strukturę HTML i podstawową logikę JS.</p>
<p>Zacznij od założenia katalogu projektu, a w nim folderu <code>client</code>. Tutaj będziemy przechowywać naszą aplikację klienta.</p>
<p>Następnie utwórz w nim trzy pliki: <code>index.html</code>, <code>style.css</code> oraz <code>app.js</code>.</p>
<p>Plik <code>index.html</code> będzie miał następująco strukturę:</p>
<pre class=" language-html"><code class=" language-html"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1.0<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">http-equiv</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>X-UA-Compatible<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>ie=edge<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">&gt;</span></span>Chat App<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>link</span> <span class="token attr-name">rel</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>stylesheet<span class="token punctuation">"</span></span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>style.css<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>main</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>app<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- HEADER --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>header</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">&gt;</span></span>Chat.app<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>header</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- WELCOME FORM --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>welcome-form<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>welcome-form show<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span>Log in<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text-input<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>username<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Type your name here<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Join<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>

    <span class="token comment">&lt;!-- MESSAGES SECTION --&gt;</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>section</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>messages-section show<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>messages-section<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">&gt;</span></span>Messages<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">&gt;</span></span>

      <span class="token comment">&lt;!-- messages list --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>ul</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>messages-section__list<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>messages-list<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>message<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>message__author<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>John Doe<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>message__content<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
            Hello!
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>message message--self<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>message__author<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>You<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">&gt;</span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>message__content<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
              Hi!
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>li</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>message message--self message--received<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>message__author<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>You<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">&gt;</span></span>
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>message__content<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
            It's great to see you again!
          <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>li</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>ul</span><span class="token punctuation">&gt;</span></span>

      <span class="token comment">&lt;!-- messages form --&gt;</span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>add-messages-form<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text-input<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Type your message here<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>message-content<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span>Send<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">&gt;</span></span>
      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">&gt;</span></span>

    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>section</span><span class="token punctuation">&gt;</span></span>

  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>main</span><span class="token punctuation">&gt;</span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>app.js<span class="token punctuation">"</span></span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>module<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">&gt;</span></span></code></pre>
<p>Mamy tu jeden prosty formularz do logowania (<code>#welcome-form</code>), a drugi do wysyłania wiadomości (<code>#add-messages-form</code>), oraz samą listę (<code>#messages-list</code>). Oczywiście niedługo będziemy zajmować się odpowiednią obsługą tych elementów. Klasy zostały nadane w celu łatwego ostylowania (zaraz dodamy arkusz), a identyfikatory (<code>id</code>) ułatwią dostęp do elementów, gdy zaczniemy pisać kod JS.</p>
<p>Arkusz <code>style.css</code> powinien wyglądać następująco:</p>
<pre class=" language-css"><code class=" language-css"><span class="token atrule"><span class="token rule">@import</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span><span class="token string url">'https://fonts.googleapis.com/css?family=Open+Sans&amp;display=swap'</span><span class="token punctuation">)</span></span><span class="token punctuation">;</span></span>

<span class="token selector">body</span> <span class="token punctuation">{</span>
  <span class="token property">background</span><span class="token punctuation">:</span> <span class="token hexcode color">#282c34</span><span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode color">#fff</span><span class="token punctuation">;</span>
  <span class="token property">font-family</span><span class="token punctuation">:</span> <span class="token string">'Open Sans'</span><span class="token punctuation">,</span> sans-serif<span class="token punctuation">;</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">30</span><span class="token unit">px</span><span class="token punctuation">;</span>
  <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">h1</span> <span class="token punctuation">{</span>
  <span class="token property">font-weight</span><span class="token punctuation">:</span> lighter<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">p</span> <span class="token punctuation">{</span>
  <span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode color">#999</span><span class="token punctuation">;</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token number">0.8</span><span class="token unit">rem</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector"><span class="token class">.btn</span></span> <span class="token punctuation">{</span>
  <span class="token property">background</span><span class="token punctuation">:</span> <span class="token hexcode color">#0064e7</span><span class="token punctuation">;</span>
  <span class="token property">border</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
  <span class="token property">border-radius</span><span class="token punctuation">:</span> <span class="token number">15</span><span class="token unit">px</span><span class="token punctuation">;</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token unit">px</span> <span class="token number">25</span><span class="token unit">px</span><span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode color">#fff</span><span class="token punctuation">;</span>
  <span class="token property">font-family</span><span class="token punctuation">:</span> inherit<span class="token punctuation">;</span>
  <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">20</span><span class="token unit">px</span> <span class="token number">10</span><span class="token unit">px</span><span class="token punctuation">;</span>
  <span class="token property">text-transform</span><span class="token punctuation">:</span> uppercase<span class="token punctuation">;</span>
  <span class="token property">outline</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
  <span class="token property">transition</span><span class="token punctuation">:</span> <span class="token number">.2</span><span class="token unit">s</span><span class="token punctuation">;</span>
  <span class="token property">cursor</span><span class="token punctuation">:</span> pointer<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector"><span class="token class">.btn</span><span class="token pseudo-class">:hover</span></span> <span class="token punctuation">{</span>
  <span class="token property">box-shadow</span><span class="token punctuation">:</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">20</span><span class="token unit">px</span> <span class="token color"><span class="token function">rgba</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0.2</span><span class="token punctuation">)</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector"><span class="token class">.text-input</span></span> <span class="token punctuation">{</span>
  <span class="token property">background</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
  <span class="token property">border</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode color">#fff</span><span class="token punctuation">;</span>
  <span class="token property">border-bottom</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token unit">px</span> solid <span class="token hexcode color">#0064e7</span><span class="token punctuation">;</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">8</span><span class="token unit">px</span> <span class="token number">25</span><span class="token unit">px</span> <span class="token number">8</span><span class="token unit">px</span> <span class="token number">5</span><span class="token unit">px</span><span class="token punctuation">;</span>
  <span class="token property">font-family</span><span class="token punctuation">:</span> inherit<span class="token punctuation">;</span>
  <span class="token property">outline</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
  <span class="token property">opacity</span><span class="token punctuation">:</span> <span class="token number">0.6</span><span class="token punctuation">;</span>
  <span class="token property">transition</span><span class="token punctuation">:</span> <span class="token number">.3</span><span class="token unit">s</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector"><span class="token class">.text-input</span><span class="token pseudo-class">:focus</span></span> <span class="token punctuation">{</span>
  <span class="token property">opacity</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector"><span class="token class">.welcome-form</span></span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector"><span class="token class">.messages-section</span></span> <span class="token punctuation">{</span>
  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> <span class="token number">100</span><span class="token unit">px</span><span class="token punctuation">;</span>
  <span class="token property">display</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector"><span class="token class">.messages-section__list</span></span> <span class="token punctuation">{</span>
  <span class="token property">max-width</span><span class="token punctuation">:</span> <span class="token number">400</span><span class="token unit">px</span><span class="token punctuation">;</span>
  <span class="token property">list-style-type</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">20</span><span class="token unit">px</span> auto <span class="token number">40</span><span class="token unit">px</span> auto<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector"><span class="token class">.message</span></span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">flex-direction</span><span class="token punctuation">:</span> column<span class="token punctuation">;</span>
  <span class="token property">justify-content</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
  <span class="token property">align-items</span><span class="token punctuation">:</span> flex-start<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector"><span class="token class">.message--self</span></span> <span class="token punctuation">{</span>
  <span class="token property">align-items</span><span class="token punctuation">:</span> flex-end<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector"><span class="token class">.message--received</span></span> <span class="token punctuation">{</span>
    <span class="token property">animation</span><span class="token punctuation">:</span> fadeIn<span class="token punctuation">;</span>
    <span class="token property">animation-duration</span><span class="token punctuation">:</span> <span class="token number">3</span><span class="token unit">s</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector"><span class="token class">.message__author</span></span> <span class="token punctuation">{</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token number">0.8</span><span class="token unit">rem</span><span class="token punctuation">;</span>
  <span class="token property">font-weight</span><span class="token punctuation">:</span> bold<span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode color">#999</span><span class="token punctuation">;</span>
  <span class="token property">text-align</span><span class="token punctuation">:</span> right<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector"><span class="token class">.message__content</span></span> <span class="token punctuation">{</span>
  <span class="token property">background</span><span class="token punctuation">:</span> <span class="token color"><span class="token function">rgb</span><span class="token punctuation">(</span><span class="token number">68</span><span class="token punctuation">,</span> <span class="token number">68</span><span class="token punctuation">,</span> <span class="token number">68</span><span class="token punctuation">)</span></span><span class="token punctuation">;</span>
  <span class="token property">border</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
  <span class="token property">border-radius</span><span class="token punctuation">:</span> <span class="token number">15</span><span class="token unit">px</span> <span class="token number">5</span><span class="token unit">px</span> <span class="token number">15</span><span class="token unit">px</span> <span class="token number">15</span><span class="token unit">px</span><span class="token punctuation">;</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token unit">px</span> <span class="token number">25</span><span class="token unit">px</span><span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode color">#fff</span><span class="token punctuation">;</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token number">0.9</span><span class="token unit">rem</span><span class="token punctuation">;</span>
  <span class="token property">max-width</span><span class="token punctuation">:</span> <span class="token number">200</span><span class="token unit">px</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector"><span class="token class">.message--self</span> <span class="token class">.message__content</span></span> <span class="token punctuation">{</span>
  <span class="token property">background</span><span class="token punctuation">:</span> <span class="token hexcode color">#3498db</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector"><span class="token class">.show</span></span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token atrule"><span class="token rule">@-webkit-keyframes</span> fadeIn</span> <span class="token punctuation">{</span>
  <span class="token selector">from</span> <span class="token punctuation">{</span>
    <span class="token property">opacity</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token selector">to</span> <span class="token punctuation">{</span>
    <span class="token property">opacity</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token atrule"><span class="token rule">@keyframes</span> fadeIn</span> <span class="token punctuation">{</span>
  <span class="token selector">from</span> <span class="token punctuation">{</span>
    <span class="token property">opacity</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token selector">to</span> <span class="token punctuation">{</span>
    <span class="token property">opacity</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre>
<p>Nie musisz specjalnie wczytywać się w ten plik, chodzi nam tylko o to, by aplikacja jakoś się prezentowała. Sama sprawa doboru odpowiednich klas nie nastręczy wielu problemów – w pliku HTML są już zastosowane na przykładowych danych, więc będziemy mieli na czym się wzorować.</p>
<p>Zwróćmy uwagę na trzy klasy, które będą dla nas bardzo istotne.</p>
<ul>
<li><code>.show</code> – to znana Ci już technika. Nasze dwa podstawowe elementy, a więc formularz powitalny i sekcja z wiadomościami, są domyślnie ukryte. Nadanie tej klasy pozwoli na ich pokazanie, a jej zabranie spowoduje, że elementy staną się ponownie niewidoczne.</li>
<li><code>.message--self</code> – lekko modyfikuje podstawowy styl wiadomości i odróżnia ją od tych wysłanych przez innych użytkowników.</li>
<li><code>.message--received</code> – użyta na wiadomości pokazuje ją z opóźnieniem, z efektem "fadeIn" (płynne wejście).</li>
</ul>
<p>Na tym etapie, po uruchomieniu w przeglądarce pliku <code>index.html</code>, powinniśmy zobaczyć następujący widok:</p>
<a href="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/Chat1.png" class="img-modal-group"><img src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/Chat1.png" alt="image" style="width: auto; max-width: 50%;"></a>
<h4>Dodajemy logikę JS</h4>
<p>Na razie nie będziemy jeszcze używać WebSocketów, przygotujemy tylko bazową logikę. Nie spotkasz się więc z niczym nowym, a cały kod, który teraz napiszemy, powinien być już dla Ciebie łatwy do implementacji i zrozumienia.</p>
<h5>Etap 1 – referencje do HTML-a</h5>
<p>Otwórz plik <code>app.js</code> i zacznij od przygotowania referencji do HTML-a.</p>
<p>Ustaw następujące stałe:</p>
<ul>
<li><code>loginForm</code> – referencja do formularza logowania.</li>
<li><code>messagesSection</code> – referencja do sekcji z wiadomościami.</li>
<li><code>messagesList</code> – referencja do samej listy wiadomości.</li>
<li><code>addMessageForm</code> – referencja do formularza dodawania wiadomości.</li>
<li><code>userNameInput</code> – referencja do pola tekstowego z formularza logowania.</li>
<li><code>messageContentInput</code> – referencja do pola tekstowego z formularza do wysyłania wiadomości.</li>
</ul>
<p>Możesz wybrać je bezpośrednio po przygotowanych w HTML-u <code>id</code>.</p>
<h5>Etap 2 – Zmienne globalne</h5>
<p>Jak myślisz, przydadzą nam się jakieś zmienne globalne? Na pewno można w ten sposób przechowywać login użytkownika, aby mieć do niego łatwy dostęp w każdym miejscu aplikacji, a nie tylko na etapie sprawdzania, co wpisano w pole tekstowe. Będziemy potrzebować go np. przy funkcji służącej do wysyłania wiadomości. W końcu musimy powiedzieć serwerowi nie tylko co wysyłamy, ale też kim jesteśmy.</p>
<p>Dodaj więc nową zmienną globalną. Nazwij ją <code>userName</code>.</p>
<p>A co, jeśli chodzi o wiadomości? Czy przyda nam się jakaś tablica, w której przechowywalibyśmy aktualną ich listę? Mówiliśmy już, że serwer zawsze będzie informował tylko o nowych wiadomościach. Kiedy więc wchodzisz na czat, nie masz dostępu do wpisów, które pojawiały się przed Twoim dołączeniem. Wydaje się więc, że przetrzymywanie tych danych w tablicy jest zbędne. Po otrzymaniu informacji o nowej wiadomości możemy dodać ją bezpośrednio do HTML-a i nie potrzebujemy jej magazynować w JS-ie.</p>
<h5>Etap 3 – chowamy listę wiadomości</h5>
<p>Na starcie cała sekcja <code>messages</code> (lista i formularz do dodawania wiadomości) powinna być ukryta. Nie chcemy bowiem, aby użytkownik mógł wysyłać wiadomości jako bezimienny.</p>
<p>W tej chwili działa na nią klasa <code>.show</code>, więc musisz ją odebrać temu elementowi. Możesz to zrobić bezpośrednio w pliku HTML.</p>
<p>Oczywiście na późniejszym etapie nadamy klasę <code>.show</code> temu elementowi, ale dopiero wtedy, kiedy ustalimy już, jaki login wybrał użytkownik.</p>
<h5>Etap 4 – obsługa pierwszego formularza</h5>
<p>Czas na pierwszy formularz – <code>#loginForm</code>, który pozwala na wpisywanie nazwy użytkownika.</p>
<p>W tej chwili po kliknięciu na button "Join" strona się odświeża. Pamiętasz dlaczego? To po prostu domyślne zachowanie – kliknięcie na button równa się wysłaniu formularza. Teraz tego nie chcemy, dlatego musisz zadziałać wbrew założeniom twórców rozwiązania.</p>
<p>Dodaj w <code>app.js</code> nasłuchiwacz na ten formularz. Po wykryciu zdarzenia <code>submit</code> powinien on odpalać funkcję <code>login</code>. Stwórz ją. Funkcja ta powinna przyjmować informacje o evencie oraz blokować domyślne zachowanie przeglądarki (<code>preventDefault</code>).</p>
<p>Następnie rozwiniemy funkcję <code>login</code>. Dodaj do niej walidację wartości <code>userNameInput</code>. Kod powinien sprawdzać, czy pole nie jest puste. Jeśli tak, należy zwrócić komunikat o błędzie (wystarczy zwykły alert). Gdy wszystko w porządku, nasz kod powinien przypisać wartość tego pola do zmiennej <code>userName</code>, schować formularz logowania oraz pokazać sekcję wiadomości. Pamiętaj, że mechanizm chowania/pokazywania tych elementów w naszej aplikacji opiera się na obecności klasy <code>.show</code>.</p>
<p>Efektem Twoich działań w tej chwili powinno być poprawne obsługiwanie buttonu "Join".</p>
<h5>Etap 5 – obsługa drugiego formularza</h5>
<p>Tym razem zajmiemy się formularzem <code>#addMessageForm</code>, który ma służyć dodawaniu wiadomości.</p>
<p>Ponownie zaczniemy od zablokowania domyślnego zachowania przeglądarki. Do eventu <code>submit</code> dodaj nasłuchiwacz, który uruchomi funkcję <code>sendMessage</code>. Ta ostatnia powinna przyjmować informacje o evencie oraz blokować domyślne zachowanie przeglądarki.</p>
<p>Co należy zrobić, jeśli wiemy, że użytkownik chce wysłać wiadomość? Najpierw sprawdźmy, czy w ogóle coś wpisał. Dodaj więc walidację pola tekstowego w tym formularzu i jeśli nie ma w nim treści, pokaż użytkownikowi alert z odpowiednim komunikatem. Gdy wszystko jest w porządku, wywołaj funkcję <code>addMessage</code>, a jako argument przekaż jej wartość <code>userName</code>, oraz wpisaną&nbsp;treść <code>#messageContentInput</code> (<code>addMessage(userName, messageContentInput.value)</code>). Na końcu wyczyść to pole tekstowe.</p>
<p>Na tym zakończyliśmy budowę funkcji <code>sendMessage</code> w jej prostym wydaniu. Oczywiście później dodamy do niej jeszcze kilka elementów, będziemy np. informować serwer, że pojawiła się nowa wiadomość i trzeba rozesłać ją reszcie użytkowników.</p>
<p>Co do funkcji <code>addMessage</code>, na razie ma przyjmować informację o autorze wiadomości oraz jej treści i generować odpowiedni kod HTML, czyli po prostu dodać nowy element <code>li</code> do naszej listy z wiadomościami. Musi przy tym zachować odpowiedni format (nagłówek to autor, treść ma być w divie o klasie <code>.message</code> itd.).</p>
<p>Funkcja <code>addMessage</code> ma bezpośredni dostęp do globalnej zmiennej <code>userName</code>, dlaczego więc ją przekazujemy? Robimy tak z prostego powodu. Funkcja <code>addMessage</code> ma pozwalać na dodawanie wiadomości od różnych osób i nie zakłada z góry, że będzie to tylko <code>userName</code>. Ona po prostu oczekuje, że dostanie tę informację z zewnątrz, właśnie w formie argumentu. Może to być faktycznie wartość otrzymana z <code>userName</code>, ale równie dobrze całkiem inna (np. z serwera wraz z treścią wiadomości). Funkcja ta nie jest zainteresowana, skąd pochodzą dane – z pola tekstowego, ze zmiennej globalnej, czy może z odpowiedzi serwera. Ona tylko je dostaje i generuje element HTML.</p>
<p>Stwórz teraz tę funkcję (koniecznie przygotuj dwa parametry – <code>author</code> i <code>content</code>), a następnie dodaj do niej logikę zgodną z poniższym planem:</p>
<ol>
<li>Na starcie stwórz nowy element <code>li</code> i dodaj go do stałej <code>message</code>.</li>
<li>Następnie dodaj do niego klasę <code>.message</code> oraz <code>.message--received</code>, która zadba o eleganckie wyłonienie się elementu.</li>
<li>Jeśli <code>author</code> jest równe zmiennej globalnej <code>userName</code>, to dodaj do <code>li</code> również klasę <code>.message--self</code>. Będzie ona rozróżniała nasze wiadomości od tych wysłanych przez inne osoby.</li>
<li>Następnie dodaj jako jego treść dwa kolejne elementy – nagłówek <code>h3</code> o klasie <code>message__author</code> i diva o klasie <code>message__content</code>. Skąd wiemy, że akurat tak ma wyglądać struktura <code>li</code>? Po prostu w naszym pliku <code>index.html</code> mamy już&nbsp;przykładowe wiadomości, które wskazują, jak powinna być zbudowana ta struktura.</li>
<li>Jako treść nagłówka wpisz wartość <code>author</code> lub <code>You</code> (jeśli <code>author</code> jest równe <code>userName</code>).</li>
<li>Jako treść diva wpisz zawartość <code>content</code>.</li>
<li>Na końcu dodaj element <code>message</code> do <code>#messagesList</code>.</li>
</ol>
<p>Efekt powinien być następujący:</p>
<p class="text-center">
  <span class="collapse-toggles">
    <a href="https://kodilla.com/pl/bootcamp-module/407/277/5935#collapse-DqpTqOsRt-toggle" class="btn btn-primary collapsed" data-toggle="collapse">Pokaż kod</a>
    <a href="https://kodilla.com/pl/bootcamp-module/407/277/5935#collapse-DqpTqOsRt-toggle" class="btn btn-primary collapsed" data-toggle="collapse">Ukryj kod</a>
  </span>
</p>
<div id="collapse-DqpTqOsRt-toggle" class="collapse">
<pre class=" language-js"><code class=" language-js"><span class="token keyword">function</span> <span class="token function">addMessage</span><span class="token punctuation">(</span><span class="token parameter">author<span class="token punctuation">,</span> content</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> message <span class="token operator">=</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">createElement</span><span class="token punctuation">(</span><span class="token string">'li'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  message<span class="token punctuation">.</span><span class="token property-access">classList</span><span class="token punctuation">.</span><span class="token method function property-access">add</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  message<span class="token punctuation">.</span><span class="token property-access">classList</span><span class="token punctuation">.</span><span class="token method function property-access">add</span><span class="token punctuation">(</span><span class="token string">'message--received'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword control-flow">if</span><span class="token punctuation">(</span>author <span class="token operator">===</span> userName<span class="token punctuation">)</span> message<span class="token punctuation">.</span><span class="token property-access">classList</span><span class="token punctuation">.</span><span class="token method function property-access">add</span><span class="token punctuation">(</span><span class="token string">'message--self'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  message<span class="token punctuation">.</span><span class="token property-access">innerHTML</span> <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">
    &lt;h3 class="message__author"&gt;</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>userName <span class="token operator">===</span> author <span class="token operator">?</span> <span class="token string">'You'</span> <span class="token operator">:</span> author <span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">&lt;/h3&gt;
    &lt;div class="message__content"&gt;
      </span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>content<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">
    &lt;/div&gt;
  </span><span class="token template-punctuation string">`</span></span><span class="token punctuation">;</span>
  messagesList<span class="token punctuation">.</span><span class="token method function property-access">appendChild</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
</div>
<p>Po wszystkim usuń wpisane "na sztywno" wiadomości z HTML-a.</p>
<p>Od tej chwili nasza aplikacja powinna działać jak na poniższej animacji:</p>
<a href="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/WebSocket5.gif" class="img-modal-group"><img src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/WebSocket5.gif" alt="image" style="width: auto; max-width: 50%;"></a>
<h4>Jeszcze jedna rzecz...</h4>
<p>Być może udało Ci się zauważyć, że w jednym i drugim polu tekstowym, przeglądarka stara się podpowiedzieć, co chcemy napisać. To ogólnie dość pomocna cecha formularzy, zwłaszcza jeśli chodzi np. o wpisywanie loginów czy e-maili, w czacie jednak raczej chcielibyśmy się jej pozbyć. Możesz użyć do tego atrybutu <code>autoComplete</code>. Jeśli ustawisz na inpucie jego wartość jako <code>off</code>,  przeglądarka przestanie nam "podpowiadać".</p>
<h4>Podsumowanie</h4>
<p>Nasz klient jest już prawie gotowy na wprowadzenie WebSocketów. Potrzebujemy jeszcze jednej ważnej rzeczy.</p>
<h3 id="282-pierwsza-aplikacja-przygotowania-pierwsze-kroki-serwer">Pierwsze kroki – serwer</h3>
<p>Czas na podstawową wersję serwera. Przypomnijmy sobie, jaką ma pełnić rolę w naszej aplikacji:</p>
<ul>
<li>Powinien przechowywać tablicę wiadomości.</li>
<li>Pod głównym adresem <code>/</code> powinien zwracać naszą aplikację klienta.</li>
<li>Gdy pojawi się nowa wiadomość, powinien aktualizować tablicę oraz informować o nowym wpisie wszystkich użytkowników.</li>
</ul>
<p>Oczywiście trzeciego punktu na razie nie wykonamy, bo to już funkcjonalność, którą oprzemy na WebSocketach. Możemy jednak spokojnie zająć się dwoma pierwszymi zadaniami.</p>
<p>Podobnie jak w przygotowaniach klienta, nie będziemy Ci bardzo pomagać, ani przeszkadzać ;) Wskażemy tylko, co powinno zostać wykonane, bo nie ma tu na razie żadnych nowości.</p>
<h4>Etap 1 – tworzymy szkielet serwera</h4>
<p>Zacznij od utworzenia szkieletu serwera – <code>package.json</code> i pliku <code>server.js</code> (w głównym katalogu projektu). Następnie pobierz Express i tak zmodyfikuj <code>server.js</code>, aby po jego uruchomieniu tworzył serwer lokalny pod portem 8000. Jeśli chcesz, możesz też na tym etapie pobrać Nodemona (pamiętaj, by zainstalować go jako zależność projektu, a nie globalnie: <code>npm install --save-dev nodemon</code>) i dodać do <code>package.json</code> task, który uruchamiałby pod <code>start</code> nasz <code>server.js</code> z jego pomocą – <code>nodemon server.js</code>.</p>
<p>Następnie zastanów się nad podstawowym middleware. Czy któreś z nich Ci się przyda?</p>
<p class="text-center">
  <span class="collapse-toggles">
    <a href="https://kodilla.com/pl/bootcamp-module/407/277/5935#collapse-Cqd1Oti5Hc-toggle" class="btn btn-primary collapsed" data-toggle="collapse">Pokaż podpowiedź</a>
    <a href="https://kodilla.com/pl/bootcamp-module/407/277/5935#collapse-Cqd1Oti5Hc-toggle" class="btn btn-primary collapsed" data-toggle="collapse">Ukryj podpowiedź</a>
  </span>
</p>
<div id="collapse-Cqd1Oti5Hc-toggle" class="collapse">
<p>Nasz serwer nie będzie prawdopodobnie obsługiwał żadnych formularzy, nie potrzebujemy więc tych middleware, które miałyby nam przy nich pomagać. Serwer i klient będą do tego spójną aplikacją, więc nie przyda się również żadna pomoc przy CORS.</p>
</div>
<h4>Etap 2 – dodajemy tablicę wiadomości</h4>
<p>Tutaj komentarz jest zbędny. Dodaj do serwera kod inicjujący tablicę <code>messages</code>.</p>
<h4>Etap 3 – dodajemy wyświetlanie klienta pod <code>/</code></h4>
<p>Czas na dodanie funkcjonalności pokazywania aplikacji umieszczonej w <code>/client</code> pod głównym linkiem. Jak możemy to osiągnąć?</p>
<p>Przypomnij sobie poprzedni moduł i sytuację, kiedy musieliśmy rozwijać nasz serwer API, aby pod linkiem <code>/</code> pokazywał aplikację reactową z folderu <code>client/build</code>. Możesz potraktować tamto zadanie jako ściągę.</p>
<p class="text-center">
  <span class="collapse-toggles">
    <a href="https://kodilla.com/pl/bootcamp-module/407/277/5935#collapse-W733bbjsoY-toggle" class="btn btn-primary collapsed" data-toggle="collapse">Pokaż podpowiedź</a>
    <a href="https://kodilla.com/pl/bootcamp-module/407/277/5935#collapse-W733bbjsoY-toggle" class="btn btn-primary collapsed" data-toggle="collapse">Ukryj podpowiedź</a>
  </span>
</p>
<div id="collapse-W733bbjsoY-toggle" class="collapse">
<p>Musisz stworzyć po prostu endpoint wyłapujący wszystkie linki i renderujący plik <code>index.html</code> z <code>./client</code>.</p>
</div>
<p>Dodatkowo pamiętaj, że nasza aplikacja korzysta też z plików zewnętrznych (<code>style.css</code> oraz <code>app.js</code>), musimy więc dodać middleware, który pozwoli na ich udostępnianie przez serwer. Nie musisz robić pojedynczych endpointów do ich obsługi. Wystarczy, że użyjesz wbudowany middleware <code>express.static</code>. Pamiętasz go? W razie problemów znowu odsyłamy do poprzedniego modułu.</p>
<h4>Gotowe!</h4>
<p>To wszystko. Uruchom teraz serwer i sprawdź, czy faktycznie pod adresem <code>localhost:8000</code> pokazuje naszą aplikację. Jeśli tak, to połowę zadania mamy już z głowy :)</p>
<h3 id="282-pierwsza-aplikacja-przygotowania-podsumowanie">Podsumowanie</h3>
<p>Szkielet jest już gotowy. Mamy podwaliny serwera, który pod głównym linkiem otwiera naszą aplikację klienta. Sam klient też potrafi już całkiem sporo – obsługuje formularze, ma również gotową funkcję, która dokleja kolejne wiadomości do listy. Właściwie brakuje nam tylko jednego – komunikacji między klientem a serwerem. Tym zajmiemy się już w kolejnym submodule. W końcu wykorzystamy WebSockety w praktyce!</p>

                        </div>
                    </div>
                                        <div class="card-block task-card">
                        <h3 id="282-pierwsza-aplikacja-przygotowania-zadanie-pierwsze-kroki">Zadanie: <span class="task-title">pierwsze kroki</span></h3>
                        <div class="task-content">
                            <p>Stwórz repozytorium, prześlij wszystkie zmiany i opublikuj repo na GitHubie. Link wyślij swojemu mentorowi.</p>
<p>Na tym etapie:</p>
<ul>
<li>serwer powinien działać na porcie 8000 i zwracać pod głównym linkiem aplikację z folderu <code>/client</code>,</li>
<li>klient powinien pozwalać na logowanie oraz lokalne dodawanie wiadomości do listy. W przypadku pozostawienia pustego pola tekstowego i próbie zalogowania lub wysłania wiadomości, powinny pojawiać się alerty z komunikatem o błędzie.</li>
</ul>

                        </div>
                    </div>
                                        <div class="card-block submodule-footer clearfix  completed ">
                                                <div class="clearfix">
                                                                                <a href="https://kodilla.com/pl/bootcamp-task/407/663634" target="_blank" class="btn btn-info-outline">Podgląd zadania</a>
                            <form target="_blank" class="form-inline project-link-form">
                                <div class="form-group">
                                    <input type="text" name="link" class="form-control" value="https://github.com/skwiryt/czat">
                                </div>
                                <button type="submit" class="btn  btn-primary ">Wyślij link <i class="fa fa-check"></i></button>
                            </form>
                                                                                                    </div>
                    </div>
                </section>
                                    
                <section id="submodule-1137" class="card submodule completed" data-bootcamp-user-submodule-id="663635">
                <!-- klasy dla section: completed current comments -->
                    <div class="card-block submodule-header clearfix">
                        <i class="fa fa-check-circle-o fa-2x"></i>
                        <i class="fa fa-play-circle-o fa-2x"></i>
                        <i class="fa fa-exclamation-circle fa-2x"></i>
                        <i class="fa fa-send-o fa-2x"></i>
                        <h2 class="bootcamp-submodule-name">28.3. <span>Wprowadzamy WebSockety</span></h2>
                                            </div>
                    <div class="card-block">
                        <div class="submodule-content">
                            <p>Przyszedł czas, by w końcu nawiązać nić porozumienia między klientami a serwerem. W zadaniu tym pomogą, na razie głównie teoretycznie, WebSockety.</p>
<h3 id="283-wprowadzamy-websockety-koncept">Koncept</h3>
<p>Zanim przejdziemy do realizacji, zastanówmy się, jak powinien zachowywać się nasz serwer i klient po zmianach. Do czego w ogóle dążymy?</p>
<h4>Klient</h4>
<p>Zgodnie z założeniami, klient <strong>musi bezustannie nasłuchiwać na akcję nowej wiadomości</strong> (nazwijmy ją <code>message</code>). Jeśli wykryje takie zdarzenie, powinien dodać nowy element <code>li</code> z treścią tej wiadomości do listy. Oprócz tego klient <strong>powinien być też w stanie sam emitować akcję</strong> <code>message</code> <strong>(wraz z treścią), kiedy użytkownik doda nową wiadomość</strong> – tak, aby poinformować serwer, że pojawiło się coś nowego.</p>
<p>Zatem jakie nasłuchiwacze i emittery powinniśmy przygotować?</p>
<p><strong>Nasłuchiwacze</strong>:</p>
<ul>
<li>Na <code>message</code> – gdy klient wykryje to zdarzenie, odbierze nową wiadomość (w założeniu będzie ona otrzymywana od serwera wraz z samym zdarzeniem) i doda ją do HTML-a.</li>
</ul>
<p><strong>Emittery</strong></p>
<ul>
<li><code>message</code> – klient powinien emitować to zdarzenie, gdy dodaje własną wiadomość i chce o tym poinformować serwer. Oczywiście, koniecznie musimy wraz z samą akcją informować, kto wysyła tę wiadomość i jaka jest jej treść.</li>
</ul>
<h4>Serwer</h4>
<p>Zgodnie z założeniem, serwer <strong>powinien również bezustannie nasłuchiwać na</strong> <code>message</code>. Kiedy tylko wykryje to zdarzenie, musi dodać wpis do swojej tablicy (tak, abyśmy po prostu mieli gdzieś log wszystkich wiadomości) oraz przekazać tę wiadomość dalej (wyemitować ją do pozostałych użytkowników).</p>
<div class="bc-note alert-success">
<h4 class="alert-heading text-center">Pośrednik w komunikacji</h4>
<img src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/WebSocket6.png" class="img-inline img-right">
<p>Już wcześniej powiedzieliśmy, że WebSocket nie zmienia jednej rzeczy – wciąż możemy komunikować się tylko w relacji klient-serwer i nie mamy możliwości bezpośredniej łączności pomiędzy samymi klientami. Nie jest to jednak bardzo uciążliwie, bowiem <strong>serwer w WebSocketach całkiem nieźle radzi sobie w roli pośrednika</strong>.</p>
</div>
<p>Przy okazji, jedna sprawa. Wiemy, że serwer będzie u nas pełnił rolę pośrednika w przekazywaniu postów. Zatem ktoś wysyła wiadomość, serwer natychmiast ją wykrywa (w końcu ciągle nasłuchuje na taką możliwość) i przesyła ją dalej do innych. Mówiliśmy też, że nowy użytkownik nie będzie otrzymywał archiwalnych wiadomości, a na jego liście będą pojawiały się tylko nowe.</p>
<p>Po co więc stworzyliśmy na serwerze tablicę <code>messages</code>? W jakim celu chcemy przechowywać wiadomości, skoro na dobrą sprawę dalibyśmy sobie radę bez tej funkcjonalności? Chcieliśmy pokazać Ci, że serwer może być tutaj czymś więcej niż tylko pośrednikiem – jest w stanie np. przechowywać jakieś dane, kontrolować to, co przepływa pomiędzy klientami. Potraktuj tę tablicę jako np. log wszystkich wiadomości, do którego zawsze może zajrzeć administrator czatu.</p>
<h4>Podsumowanie</h4>
<p>Wiemy już mniej więcej, jak muszą wyglądać klient oraz serwer po zmianach. Klient będzie ciągle nasłuchiwał na <code>message</code>. Jeśli wykryje to zdarzenie, doda do swojej listy nową wiadomość, zgodnie z informacjami, które otrzyma wraz z samym eventem. Równocześnie, gdy będzie dodawać wiadomość, sam wyemituje event <code>message</code> do serwera, przesyłając przy tym informację o treści wiadomości oraz swoim loginie. Serwer za to będzie ciągle nasłuchiwał na event <code>message</code> i kiedy go wykryje, dopisze wiadomość do swojej tablicy oraz przekaże ją dalej do pozostałych klientów.</p>
<a href="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/WebSocket6.gif" class="img-modal-group"><img src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/WebSocket6.gif" alt="image" style="width: auto;"></a>
<p>Plan jest prosty? Wydaje się, że tak :) Czas na praktykę!</p>
<h3 id="283-wprowadzamy-websockety-przygotowujemy-klienta">Przygotowujemy klienta</h3>
<h4>Socket.IO</h4>
<p>Zaczniemy od dodania do naszego klienta paczki <strong>Socket.IO</strong>. Na rynku jest również kilka innych rozwiązań, ale ta cieszy się największą popularnością. W teorii nie potrzebujemy żadnego pakietu do działania WebSocketów, jednak komfort pracy, który zaoferuje nam Socket.IO jest wart zachodu.</p>
<p>W pliku HTML dodaj następujący import:</p>
<pre class=" language-js"><code class=" language-js"><span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">"https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.2.0/socket.io.js"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span></code></pre>
<p>Co prawda, w "normalnej" aplikacji pewnie skorzystalibyśmy z Webpacka lub Parcela i użyli komendy <code>import</code> wewnątrz <code>app.js</code>, nie będziemy jednak na siłę komplikować naszego prostego przykładu i skorzystamy z CDN-a.</p>
<p>Teraz czas na zainicjowanie naszego klienta (socketa). Wejdź do pliku <code>app.js</code> i dodaj poniższy kod (na razie wstrzymaj się jeszcze z testami, wszystko zadziała, gdy serwer będzie zaimplementowany).</p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> socket <span class="token operator">=</span> <span class="token function">io</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Potraktuj to, jak rozkaz dla JS-a: zainicjuj nowego klienta socketowego i zachowaj referencje do niego pod stałą <code>socket</code>. Naturalnie nazwa stałej może być zupełnie inna, <code>socket</code> to tylko nasz pomysł, który na pewno ułatwi utrzymywanie porządku w kodzie.</p>
<div class="bc-note alert-success">
<h4 class="alert-heading text-center">Twoja decyzja</h4>
<p>Domyślnie Socket.io zakłada, że serwer, z którym będziemy się komunikować to ten sam, na którym odpalany jest klient (u nas to <code>localhost:8000</code>). Istnieje jednak możliwość zadeklarowania innego adresu. Używamy do tego funkcji <code>connect</code>.</p>
<pre class=" language-js"><code class=" language-js">socket<span class="token punctuation">.</span><span class="token method function property-access">connect</span><span class="token punctuation">(</span><span class="token string">"http://example.com"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Drugim domyślnym ustawieniem, które możemy zmienić, jest automatyczne połączenie. Gdy tylko tworzymy socket, łączy się on z wybranym adresem (domyślnym bądź ustawionym przez nas ręcznie). By to zmienić, wystarczy, że przy inicjacji ustawimy opcję <code>autoConnect</code> na <code>false</code>.</p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> socket <span class="token operator">=</span> <span class="token function">io</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  autoConnect<span class="token operator">:</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>W takiej sytuacji to my sami decydujemy, kiedy kanał komunikacyjny z serwerem zostanie otwarty. Możemy inicjować go za pomocą komendy <code>open</code> (np. <code>socket.open()</code>).</p>
</div>
<h4>Dodajemy nasłuchiwacz</h4>
<p>Czas na dodanie nasłuchiwacza na event <code>message</code>, który w przypadku wykrycia tego zdarzenia spowoduje dodanie wiadomości w HTML-u. Czy ta funkcjonalność jest Ci znajoma? Tak, dokładnie to robi nasza funkcja <code>addMessage</code>. Nasłuchiwacz będzie więc wyglądał następująco:</p>
<pre class=" language-js"><code class=" language-js">socket<span class="token punctuation">.</span><span class="token method function property-access">on</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> addMessage<span class="token punctuation">)</span></code></pre>
<p>Przyznaj, że to dość proste :) Tak właśnie dodajemy nasłuchiwacze w Socket.IO:</p>
<pre class=" language-js"><code class=" language-js"><span class="token function">socket</span><span class="token punctuation">(</span><span class="token string">'event-name'</span><span class="token punctuation">,</span> func<span class="token operator">-</span>to<span class="token operator">-</span>call<span class="token punctuation">)</span></code></pre>
<p>Pozostaje jeszcze kwestia danych otrzymywanych wraz z samą informacją o zdarzeniu. Mówiliśmy, że serwer będzie emitował <code>message</code> wraz z informacją o autorze i treści tej wiadomości.</p>
<p>To, co dokładnie będzie przekazane w evencie, zależy oczywiście od emitującego. Niemniej jednak załóżmy, że serwer zawsze będzie wysyłał wraz z tym eventem po prostu obiekt w formacie <code>{ author: 'John Doe', content: 'Lorem Ipsum' }</code>. Skąd mamy pewność, że serwer właśnie tak będzie emitował ten event? No cóż... W końcu sami piszemy jego logikę ;)</p>
<p>Nasz nasłuchiwacz mógłby więc wyglądać tak:</p>
<pre class=" language-js"><code class=" language-js">socket<span class="token punctuation">.</span><span class="token method function property-access">on</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">event</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token function">addMessage</span><span class="token punctuation">(</span>event<span class="token punctuation">.</span><span class="token property-access">author</span><span class="token punctuation">,</span> event<span class="token punctuation">.</span><span class="token property-access">content</span><span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>
<p>Ten kod możemy czytać jak rozkaz: obserwuj serwer, czekając na zdarzenie <code>message</code>, jeśli je wykryjesz, odpal funkcję, która ma przyjąć przesyłane przez serwer dane jako <code>event</code>, a następnie wykorzystaj je do odpowiedniego wywołania funkcji <code>addMessage</code>. Wiemy, że funkcja <code>addMessage</code> dalej zrobi wszystko, jak trzeba, bo testowaliśmy ją już wcześniej lokalnie.</p>
<p>Naturalnie powyższy kod można łatwo skrócić z wykorzystaniem destrukturyzacji:</p>
<pre class=" language-js"><code class=" language-js">socket<span class="token punctuation">.</span><span class="token method function property-access">on</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter"><span class="token punctuation">{</span> author<span class="token punctuation">,</span> content <span class="token punctuation">}</span></span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token function">addMessage</span><span class="token punctuation">(</span>author<span class="token punctuation">,</span> content<span class="token punctuation">)</span><span class="token punctuation">)</span></code></pre>
<p>Gdzie umiejscowić ten kod? Najlepiej dość wysoko, aby łatwo można go było odnaleźć. Jeśli w przyszłości pojawią się kolejne nasłuchiwacze, to dla porządku warto trzymać je wszystkie obok siebie.</p>
<h4>Dodajemy emitter</h4>
<p>Czas na dodanie emittera, chcemy bowiem, aby wiadomość nie tylko pojawiała się na naszej lokalnej liście (to już u nas działa), ale żeby informację o niej otrzymywał serwer.</p>
<p>Emitowanie akcji będzie równie intuicyjne, jak dodawanie nasłuchiwaczy. Wygląda to następująco:</p>
<pre class=" language-js"><code class=" language-js">socket<span class="token punctuation">.</span><span class="token method function property-access">emit</span><span class="token punctuation">(</span><span class="token string">'event-name'</span><span class="token punctuation">,</span> possible<span class="token operator">-</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Musimy powiedzieć, jaki event chcemy emitować oraz ustalamy jakie dane wraz z nim wysyłamy, przy czym akurat drugi parametr jest opcjonalny. Możemy wysyłać w eter również eventy bez danych:</p>
<pre class=" language-js"><code class=" language-js">socket<span class="token punctuation">.</span><span class="token method function property-access">emit</span><span class="token punctuation">(</span><span class="token string">'event-name'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>W naszym przypadku jednak prześlemy zarówno event, jak i dane, np.</p>
<pre class=" language-js"><code class=" language-js">socket<span class="token punctuation">.</span><span class="token method function property-access">emit</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> author<span class="token operator">:</span> <span class="token string">'John Doe'</span><span class="token punctuation">,</span> content<span class="token operator">:</span> <span class="token string">'Lorem Ipsum'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Przejdźmy do konkretów – jak to będzie wyglądało u nas? Samo emitowanie <code>message</code> powinno odbywać się po kliknięciu na przycisk "Send" w formularzu wiadomości, a więc w funkcji <code>sendMessage</code>. Najlepiej ustawić je po wywołaniu <code>addMessage</code>. Jeśli chodzi o dane, to wartość <code>author</code> pobierzemy z <code>userName</code>, a jako <code>content</code> możemy od razu użyć <code>messageContentInput.value</code>.</p>
<p>Po zmianach funkcja <code>sendMessage</code> powinna wyglądać mniej więcej tak:</p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword">function</span> <span class="token function">sendMessage</span><span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  e<span class="token punctuation">.</span><span class="token method function property-access">preventDefault</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">let</span> messageContent <span class="token operator">=</span> messageContentInput<span class="token punctuation">.</span><span class="token property-access">value</span><span class="token punctuation">;</span>

  <span class="token keyword control-flow">if</span><span class="token punctuation">(</span><span class="token operator">!</span>messageContent<span class="token punctuation">.</span><span class="token property-access">length</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token string">'You have to type something!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token keyword control-flow">else</span> <span class="token punctuation">{</span>
    <span class="token function">addMessage</span><span class="token punctuation">(</span>userName<span class="token punctuation">,</span> messageContent<span class="token punctuation">)</span><span class="token punctuation">;</span>
    socket<span class="token punctuation">.</span><span class="token method function property-access">emit</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> author<span class="token operator">:</span> userName<span class="token punctuation">,</span> content<span class="token operator">:</span> messageContent <span class="token punctuation">}</span><span class="token punctuation">)</span>
    messageContentInput<span class="token punctuation">.</span><span class="token property-access">value</span> <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

<span class="token punctuation">}</span></code></pre>
<h4>Gotowe!</h4>
<p>Jak widzisz, wbrew pozorom, nie było to aż tak trudne. Nasz klient jest już gotowy do komunikacji z serwerem, choć ten na razie jeszcze milczy. Zaraz to zmienimy.</p>
<h3 id="283-wprowadzamy-websockety-przygotowujemy-serwer">Przygotowujemy serwer</h3>
<p>Zaczniemy od dodania do naszego serwera paczki <strong>Socket.IO</strong>. Możemy użyć Yarna.</p>
<pre class=" language-js"><code class=" language-js">yarn add socket<span class="token punctuation">.</span><span class="token property-access">io</span>@<span class="token number">2.2</span><span class="token number">.0</span></code></pre>
<p>To, że pakiet jest już pobrany, oczywiście nie wystarczy. Musimy go jeszcze zaimportować w <code>server.js</code>.</p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> socket <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'socket.io'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Zintegrujmy teraz z naszym serwerem możliwości oferowane przez tę paczkę.</p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> io <span class="token operator">=</span> <span class="token function">socket</span><span class="token punctuation">(</span>server<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Oczywiście powyższy kod zakłada, że serwer jest zapisany u Ciebie właśnie pod stałą <code>server</code>. Jeśli używasz innej nazwy, np. <code>serv</code>, wpisz właściwą.</p>
<div class="bc-note alert-warning">
<h4 class="alert-heading text-center">Uwaga!</h4>
<p>Metoda <code>express()</code> nie uruchamia Twojego serwera. Jest on tworzony dopiero po ustaleniu portu, czyli po użyciu metody <code>listen</code>.</p>
<p>Nie możemy więc zrobić tak:</p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> io <span class="token operator">=</span> <span class="token function">socket</span><span class="token punctuation">(</span>app<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Zamiast tego chodzi nam o gotowy serwer, a więc np.</p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> server <span class="token operator">=</span> app<span class="token punctuation">.</span><span class="token method function property-access">listen</span><span class="token punctuation">(</span><span class="token number">8000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'Server is running on Port:'</span><span class="token punctuation">,</span> <span class="token number">8000</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> io <span class="token operator">=</span> <span class="token function">socket</span><span class="token punctuation">(</span>server<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
</div>
<p>Od tej chwili nasz serwer powinien być już "podatny" na komunikację z klientami. Na razie jeszcze nie będzie na nic reagować – w końcu nie ustawiliśmy tutaj żadnych nasłuchiwaczy.</p>
<h4>Dodajemy nasłuchiwacze</h4>
<p>Przypomnijmy, jak ma to wyglądać na naszym serwerze. Tworzymy nasłuchiwacze na <code>message</code>, a wtedy serwer odbiera informację o nowej wiadomości (treść i autor), zapisuje ją w tablicy i przy pomocy emittera wysyła dalej do pozostałych klientów.</p>
<p>Tylko że od razu pojawia się pewien problem. W kliencie sytuacja była prosta, bo miał on tylko możliwość komunikacji z jednym podmiotem – serwerem. Ustawienie nasłuchiwaczy było łatwe, bez konieczności wskazywania o kogo chodzi, bo wiadomo, że muszą się tyczyć właśnie serwera. Tutaj jest inaczej – może być&nbsp;jeden klient, z którym serwer ma kontakt, ale równie dobrze może ich być&nbsp;setka. Należy więc <strong>ustawiać nasłuchiwacze na każdego z klientów z osobna</strong>.</p>
<p>Na szczęście nie będzie to aż takie trudne. Kiedy uruchamiamy klienta websocketowego, a więc chociażby odpalamy komendę <code>const socket = io();</code>, automatycznie emituje on do serwera akcję <code>connection</code>. Ma ona informować serwer, że pojawił się właśnie nowy podmiot do obsługi. Co ważne, przy tej okazji wysyłana jest też informacja o tym kliencie.</p>
<div class="bc-note alert-info">
<h4 class="alert-heading text-center">Automatyczne eventy</h4>
<p>Oprócz eventu <code>connection</code> automatycznie wysyłanego przy inicjacji połączenia przez socket, istnieje jeszcze drugi analogiczny – <code>disconnect</code>. On także jest uruchamiany automatycznie, tylko że w momencie zamknięcia połączenia (czyli gdy np. użytkownik wyłącza zakładkę z naszą aplikacją).</p>
</div>
<p>Wystarczy więc, że kiedy serwer będzie wykrywał takie połączenie, nada nowemu klientowi potrzebne nasłuchiwacze. Czy jest to dla Ciebie jasne? Jeśli nie do końca, spójrz na ten kod:</p>
<pre class=" language-js"><code class=" language-js">io<span class="token punctuation">.</span><span class="token method function property-access">on</span><span class="token punctuation">(</span><span class="token string">'connection'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">socket</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  socket<span class="token punctuation">.</span><span class="token method function property-access">on</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> doSomething<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Możemy to rozumieć jak następujący rozkaz dla JS-a: kiedy wykryjesz nowe połączenie (nowego socketa), nasłuchuj na nim na zdarzenie <code>message</code>, przy czym, jeśli je wykryjesz, uruchom funkcję <code>doSomething</code>.</p>
<p>Zamysł jest więc prosty. Serwer od uruchomienia będzie ciągle nasłuchiwał na możliwość pojawienia się nowego klienta/socketu i gdy tylko wykryje, że ktoś się pojawił, będzie <strong>indywidualnie</strong> obserwować ten podmiot i oczekiwać na jakieś zdarzenie z jego strony. Owszem, na każdego ustawimy takie same nasłuchiwacze, ale każdy będzie obserwowany z osobna.</p>
<div class="bc-note alert-success">
<h4 class="alert-heading text-center">Analogia z firmą</h4>
<img src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/WebSocket7.png" class="img-inline img-right">
<p>Pamiętasz naszą analogię z firmą? Tu też możemy się nią posłużyć. Powiedzmy, że PM ma założone z góry zadanie, aby obserwować pracę developerów i jeśli któryś z nich przestanie sobie radzić, musi coś z tym zrobić.</p>
<p>Jak by to wyglądało w praktyce? Kiedy tylko jakiś developer wszedłby do biura, nie musiałby nawet nic mówić (tak samo, jak socket nie musi nic "mówić", bo event <code>connection</code> jest nadawany z automatu). Gdy tylko PM (serwer) zauważy pracownika, będzie go bacznie obserwować, podobnie jak każdego kolejnego, który się pojawi. Ostatecznie stanie się więc wyczulony na to samo zdarzenie, czyli słabą pracę każdego developera z osobna.</p>
</div>
<p>Żeby lepiej zobrazować Ci, że faktycznie tak to wygląda, dodaj do serwera następujący kod:</p>
<pre class=" language-js"><code class=" language-js">io<span class="token punctuation">.</span><span class="token method function property-access">on</span><span class="token punctuation">(</span><span class="token string">'connection'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">socket</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'New client! Its id – '</span> <span class="token operator">+</span> socket<span class="token punctuation">.</span><span class="token property-access">id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  socket<span class="token punctuation">.</span><span class="token method function property-access">on</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'Oh, I\'ve got something from '</span> <span class="token operator">+</span> socket<span class="token punctuation">.</span><span class="token property-access">id</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'I\'ve added a listener on message event \n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Jak możemy go rozumieć? Gdy tylko pojawi się nowy klient (np. otworzymy zakładkę z naszą aplikacją), serwer to zauważy (wykryje event <code>connection</code>) i poinformuje nas o tym w konsoli. <code>socket</code>, jak mówiliśmy, to po prostu dostęp do samego klienta, a <code>socket.id</code> to unikalny identyfikator automatycznie nadawany każdemu przy inicjacji połączenia z serwerem. Czasami może być przydatny.</p>
<p>Po wypisaniu informacji o nowym kliencie serwer od razu zaczyna też oczekiwać na zdarzenie <code>message</code>, jeśli je wykryje, to wypisze w konsoli tekst "Oh, I've got something!".</p>
<p>Naturalnie każdy nowy klient (socket) to nowa wiadomość w konsoli i nowy nasłuchiwacz. Tak jak mówiliśmy już wcześniej, <strong>funkcja w</strong> <code>connection</code> <strong>będzie odpalana z osobna dla każdego klienta przy jego dołączeniu.</strong></p>
<p>Sprawdźmy teraz w praktyce, jak to wygląda.</p>
<p>Uruchom swój serwer, a następnie wejdź w przeglądarce pod jego adres <code>http://localhost:8000</code>.</p>
<p>Co pojawi się w konsoli?</p>
<a href="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/WebSocket8.png" class="img-modal-group"><img src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/WebSocket8.png" alt="image" style="width: auto;"></a>
<p>Zgodnie z przewidywaniami – serwer wykrył nowe połączenie (nowy socket), więc odpalił funkcję:</p>
<pre class=" language-js"><code class=" language-js"><span class="token punctuation">(</span><span class="token parameter">socket</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'New client! Its id – '</span> <span class="token operator">+</span> socket<span class="token punctuation">.</span><span class="token property-access">id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  socket<span class="token punctuation">.</span><span class="token method function property-access">on</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'Oh, I\'ve got something from '</span> <span class="token operator">+</span> socket<span class="token punctuation">.</span><span class="token property-access">id</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'I\'ve added a listener on message event \n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Funkcja ta wypisała odpowiednie komunikaty w konsoli, ale też <strong>rozpoczęła nasłuchiwanie na event</strong> <code>message</code> <strong>na tym kliencie</strong>.</p>
<p>Otwórz teraz naszą aplikację w kolejnych dwóch lub trzech zakładkach. Co się okazuje?</p>
<a href="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/WebSocket9.png" class="img-modal-group"><img src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/WebSocket9.png" alt="image" style="width: auto;"></a>
<p>Dla serwera każda zakładka to nowy klient i kanał komunikacyjny, wykrycie pozostałych uruchomiło więc ten sam proces. Serwer napisał w konsoli, że pojawili się kolejni klienci i <strong>na każdym z nich z osobna zaczął nasłuchiwanie na event</strong> <code>message</code>.</p>
<p>Przy okazji możesz zauważyć, że każdy nowy klient (socket), faktycznie otrzymał unikalne id.</p>
<p>Aby już ostatecznie udowodnić, że każdy klient jest traktowany indywidualnie, możemy zrobić jeszcze jeden test.</p>
<p>Gdy dodajemy wiadomość, klient powinien od razu emitować do serwera akcję <code>message</code>. Spróbuj dodać nową wiadomość na każdej z uruchomionych zakładek (a więc na każdym kliencie/sockecie).</p>
<p>Efekt powinien być mniej więcej taki:</p>
<a href="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/WebSocket10.png" class="img-modal-group"><img src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/WebSocket10.png" alt="image" style="width: auto;"></a>
<p>Jak widzisz na grafice (albo i w Twoim własnym terminalu), serwer zawsze dokładnie wskazuje, skąd pochodzi wiadomość, oraz że uruchamia się właściwa funkcja przypięta do nasłuchiwacza konkretnego klienta. Gdy serwer wykrywa zdarzenie <code>message</code> np. na kliencie <code>1PAkNvZFEcNlF1epAAAA</code>, uruchamia funkcję przypiętą do nasłuchiwacza, który obserwował właśnie ten socket. Widzimy więc, że <strong>sockety są obsługiwane indywidualnie</strong>, bo każdy z nich to własny nasłuchiwacz.</p>
<p>Przy okazji przekonaliśmy się też, że komunikacja klient-&gt;serwer już w naszej aplikacji działa ;)</p>
<p>Teraz możemy przetestować jeszcze jedną rzecz – automatyczny event <code>disconnect</code>. Powinien on być wysyłany przez klienta w momencie zamykania połączenia. Możemy to potraktować jako swoiste "pożegnanie".</p>
<p>Dodajmy obserwację tego eventu dla każdego z klientów:</p>
<pre class=" language-js"><code class=" language-js"><span class="token punctuation">(</span><span class="token parameter">socket</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'New client! Its id – '</span> <span class="token operator">+</span> socket<span class="token punctuation">.</span><span class="token property-access">id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  socket<span class="token punctuation">.</span><span class="token method function property-access">on</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'Oh, I\'ve got something from '</span> <span class="token operator">+</span> socket<span class="token punctuation">.</span><span class="token property-access">id</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  socket<span class="token punctuation">.</span><span class="token method function property-access">on</span><span class="token punctuation">(</span><span class="token string">'disconnect'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span> <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'Oh, socket '</span> <span class="token operator">+</span> socket<span class="token punctuation">.</span><span class="token property-access">id</span> <span class="token operator">+</span> <span class="token string">' has left'</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'I\'ve added a listener on message and disconnect events \n'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Możesz przetestować teraz nasz serwer. Po zamknięciu zakładki z klientem powinien on informować nas w konsoli, że konkretny klient o konkretnym id nas opuścił.</p>
<a href="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/WebSocket11.png" class="img-modal-group"><img src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/WebSocket11.png" alt="image" style="width: auto;"></a>
<p>Event ten może być naprawdę pomocny, kiedy np. przechowujemy na serwerze listę zalogowanych użytkowników i chcemy usuwać&nbsp;z niej odchodzących userów.</p>
<h4>Obsługujemy otrzymaną wiadomość</h4>
<p>Nasz serwer potrafi już&nbsp;wykryć pojawienie się klienta, nasłuchiwać na event <code>message</code>, a nawet poinformować o ewentualnym zamknięciu połączenia.</p>
<p>Zgodnie z założeniami, powinien jeszcze dodać do tablicy <code>messages</code> wiadomość odebraną wraz z eventem oraz wyemitować tę akcję dalej, do pozostałych użytkowników (serwer jako pośrednik).</p>
<p>Wprowadźmy tę funkcjonalność.</p>
<p>Zacznijmy od odebrania danych od klienta (socketa). Wiemy, że nasz klient, emitując event <code>message</code>, wysyła wraz z nim informacje o autorze oraz samą treść wiadomości. Przypomnijmy, jak to wygląda w kliencie:</p>
<pre class=" language-js"><code class=" language-js">socket<span class="token punctuation">.</span><span class="token method function property-access">emit</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> author<span class="token operator">:</span> userName<span class="token punctuation">,</span> content<span class="token operator">:</span> messageContent <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Faktycznie, dane są wysyłane, ale musimy je jeszcze odebrać w naszej funkcji przypiętej do nasłuchiwacza, a następnie dodać jako nowy element tablicy <code>messages</code>.</p>
<p>Zaktualizuj więc nasz nasłuchiwacz na event <code>message</code> w serwerze następująco:</p>
<pre class=" language-js"><code class=" language-js">socket<span class="token punctuation">.</span><span class="token method function property-access">on</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">message</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'Oh, I\'ve got something from '</span> <span class="token operator">+</span> socket<span class="token punctuation">.</span><span class="token property-access">id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  messages<span class="token punctuation">.</span><span class="token method function property-access">push</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Pozostaje nam jeszcze wyemitowanie tej wiadomości dalej, do pozostałych klientów. Jak możemy to zrobić?</p>
<p>Najprostszym wyborem byłoby użycie funkcji <code>emit</code> na obiekcie serwera.</p>
<pre class=" language-js"><code class=" language-js">io<span class="token punctuation">.</span><span class="token method function property-access">emit</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>U nas takie rozwiązanie się nie sprawdzi. <code>io.emit</code> <strong>emituje zdarzenie do wszystkich socketów</strong>, a więc dojdzie ono również do tego użytkownika, który sam tę wiadomość wysłał. Z kolei nasz klient działa tak, że zanim wyśle zdarzenie z wiadomością na serwer, wcześniej dodaje ją już&nbsp;do HTML-a. Gdyby odebrał informację o nowej (swojej) wiadomości, dopisałby ją do listy drugi raz.</p>
<p>Na szczęście Socket.IO udostępnia nam jeszcze inną możliwość, a mianowicie obiekt <code>broadcast</code>. <strong>Emitując zdarzenie z użyciem broadcastu (</strong><code>socket.broadcast.emit</code><strong>), nadajemy je do wszystkich socketów, oprócz tego, z którego go wysyłamy</strong>. To właśnie coś dla nas.</p>
<div class="bc-note alert-info">
<h4 class="alert-heading text-center">1 na 1</h4>
<p>Istnieje również możliwość wysyłania zdarzenia do pojedynczych socketów, np. do tego, który aktualnie obsługujemy.</p>
<pre class=" language-js"><code class=" language-js">socket<span class="token punctuation">.</span><span class="token method function property-access">on</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">message</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'Oh, I\'ve got something from '</span> <span class="token operator">+</span> socket<span class="token punctuation">.</span><span class="token property-access">id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  messages<span class="token punctuation">.</span><span class="token method function property-access">push</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
  socket<span class="token punctuation">.</span><span class="token method function property-access">emit</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> message<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Możemy to zrobić także dla wybranego, po jego id:</p>
<pre class=" language-js"><code class=" language-js">socket<span class="token punctuation">.</span><span class="token method function property-access">on</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">message</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'Oh, I\'ve got something from '</span> <span class="token operator">+</span> socket<span class="token punctuation">.</span><span class="token property-access">id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  messages<span class="token punctuation">.</span><span class="token method function property-access">push</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
  io<span class="token punctuation">.</span><span class="token method function property-access">to</span><span class="token punctuation">(</span><span class="token string">'IIr5o6g-jQDfK3vcAAAC'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">emit</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token string">'For your eyes only!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
</div>
<p>Ostatecznie nasza funkcja będzie wyglądać tak:</p>
<pre class=" language-js"><code class=" language-js">socket<span class="token punctuation">.</span><span class="token method function property-access">on</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">message</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'Oh, I\'ve got something from '</span> <span class="token operator">+</span> socket<span class="token punctuation">.</span><span class="token property-access">id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  messages<span class="token punctuation">.</span><span class="token method function property-access">push</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">;</span>
  socket<span class="token punctuation">.</span><span class="token property-access">broadcast</span><span class="token punctuation">.</span><span class="token method function property-access">emit</span><span class="token punctuation">(</span><span class="token string">'message'</span><span class="token punctuation">,</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Gotowe!</p>
<p>Nasza aplikacja czatu powinna od teraz działać już poprawnie.</p>
<a href="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/WebSocket12.gif" class="img-modal-group"><img src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/WebSocket12.gif" alt="image" style="width: auto; max-width: 50%;"></a>
<h3 id="283-wprowadzamy-websockety-podsumowanie">Podsumowanie</h3>
<p>Efekt jest zgodny z oczekiwaniami. Klient na bieżąco nasłuchuje na informacje z serwera. Kiedy dowie się o czymś nowym, doda to do swojej listy w HTML-u. W tym momencie sami też wyemitujemy serwerowi event. Z kolei serwer ciągle nasłuchuje na nowe wiadomości i jeśli takie dostanie, zapisuje je w tablicy <code>messages</code>, oraz przesyła dalej do następnych klientów. Oczywiście wszystko dzieje się w czasie rzeczywistym, bez żadnych opóźnień.</p>
<p>Jak widzisz, WebSocket nie jest zbyt wymagający w implementacji. Prawdopodobnie nawet użycie AJAX-u, który nie dałby nam aż tak dobrego efektu, wymagałoby od nas napisania większej ilości kodu.</p>
<p>Tylko od Ciebie zależy, w jak bardzo zaawansowany sposób wykorzystasz nowe umiejętności. WebSockety mogą przydać się w prostych aplikacjach czatu oraz w bardzo rozbudowanych grach z opcją multiplayer. Podstawowy koncept pozostanie jednak taki sam – komunikacja dwustronna serwer-&gt;klient, serwer jako pośrednik, oraz mechanizm event-&gt;nasłuchiwacz.</p>
<p>Jeśli czujesz, że to, co zrobiliśmy dotychczas, jest już dla Ciebie jasne, pozostaje tylko praktyka :)</p>

                        </div>
                    </div>
                                        <div class="card-block task-card">
                        <h3 id="283-wprowadzamy-websockety-zadanie-nowe-funkcjonalnosci">Zadanie: <span class="task-title">nowe funkcjonalności</span></h3>
                        <div class="task-content">
                            <p>Czas na trochę praktyki! Prawdopodobnie pomysł działania WebSocketów jest już dla Ciebie jasny, ale zapewne nie czujesz się jeszcze zbyt pewnie w tej materii. Dlatego mamy dla Ciebie dwa zadania. Oba będą polegały na rozwinięciu naszej aplikacji czatu. Powinny pozwolić Ci bardziej wgłębić się w temat.</p>
<h4>Zadanie 1</h4>
<p>Przechowywanie listy użytkowników – ten pomysł pojawił się już w materiale, choć nie wprowadzaliśmy go w życie. Teraz się to zmieni.</p>
<p>Twoim zadaniem jest dodanie do serwera tablicy <code>users</code>, która powinna zawsze posiadać aktualną listę użytkowników w formacie <code>{ name: 'John', id: '24423fse544w35' }</code>. Oczywiście, atrybut <code>id</code> musi odpowiadać <code>socket.id</code> danego użytkownika.</p>
<p>Tablica powinna przechowywać <strong>tylko zalogowanych użytkowników</strong>, czyli takich, którzy wybrali już login. To ważna wskazówka. Oznacza bowiem, że nie dodamy naszej funkcjonalności pushowania do tablicy od razu po wykryciu <code>connection</code>. Zamiast tego, klient sam będzie musiał poinformować serwer o tym, że jest na to gotowy, kiedy już będzie wiedział, jaką nazwę wybrał użytkownik.</p>
<p>Usuwanie użytkownika z listy będzie łatwiejsze. Powinien znikać on od razu po zakończeniu komunikacji.</p>
<p>W celu testowania możesz dopisać kod, który po dodaniu nowego usera do tablicy, będzie informował o tym w konsoli. Robiliśmy to już z komunikatem <code>Oh, I\'ve got something from...</code> po dodaniu elementu do <code>messages</code>.</p>
<p class="text-center">
  <span class="collapse-toggles">
    <a href="https://kodilla.com/pl/bootcamp-module/407/277/5935#collapse-41wnXFLIN-toggle" class="btn btn-primary collapsed" data-toggle="collapse">Pokaż wskazówkę nr 1</a>
    <a href="https://kodilla.com/pl/bootcamp-module/407/277/5935#collapse-41wnXFLIN-toggle" class="btn btn-primary collapsed" data-toggle="collapse">Ukryj wskazówkę nr 1</a>
  </span>
</p>
<div id="collapse-41wnXFLIN-toggle" class="collapse">
<p>Do informowania serwera o wybraniu loginu, klient może wykorzystać nowy event np. o nazwie <code>join</code>.</p>
<p>Mogłoby to wyglądać następująco:</p>
<ol>
<li>Kiedy użytkownik wybierze już nazwę i zostanie ona przypisana do <code>userName</code>, klient emituje do serwera event <code>join</code>. Wraz z samym zdarzeniem wysyła oczywiście także login.</li>
<li>Serwer ma ustawiony nasłuchiwacz na <code>join</code>. Kiedy go wykryje, odbiera login i na bazie tej informacji oraz <code>socket.id</code>, dodaje nowy wpis do tablicy.</li>
</ol>
</div>
<p class="text-center">
  <span class="collapse-toggles">
    <a href="https://kodilla.com/pl/bootcamp-module/407/277/5935#collapse-cCvT_hEyOl-toggle" class="btn btn-primary collapsed" data-toggle="collapse">Pokaż wskazówkę nr 2</a>
    <a href="https://kodilla.com/pl/bootcamp-module/407/277/5935#collapse-cCvT_hEyOl-toggle" class="btn btn-primary collapsed" data-toggle="collapse">Ukryj wskazówkę nr 2</a>
  </span>
</p>
<div id="collapse-cCvT_hEyOl-toggle" class="collapse">
<p>Do usuwania użytkownika z listy możesz wykorzystać nasłuchiwacz na zdarzenie <code>disconnect</code>. Jeśli zostaje ono wykryte, to wiemy, że dany użytkownik wyłączył już naszą aplikację.</p>
</div>
<h4>Zadanie 2</h4>
<p>Korzystając z tego, co zrobisz w pierwszym zadaniu, spróbuj rozwinąć ten pomysł.</p>
<p>Twoim zadaniem jest dodanie do naszego czatu nowej funkcjonalności. Powinna ona działać następująco:</p>
<ol>
<li>Gdy do czatu zaloguje się nowy użytkownik (a więc już po wybraniu przez niego imienia), to każdy klient (oprócz tego dołączającego) powinien zostać o tym poinformowany w nowej wiadomości. Ustalmy treść jako <code>User-name has joined the conversation!</code>, a jej autorem niech będzie <code>Chat Bot</code>. Byłoby dobrze, gdyby informacja ta odróżniała się od innych (np. tekst może być pochylony). Oczywiście w miejscu <code>User-name</code> powinna być nazwa dołączającego użytkownika.</li>
<li>Gdy użytkownik opuszcza aplikację, to analogicznie pozostali klienci powinni zostać o tym poinformowani, a na ich listach wiadomości pojawi się informacja <code>User-name has left the conversation... :(</code>.</li>
</ol>
<p class="text-center">
  <span class="collapse-toggles">
    <a href="https://kodilla.com/pl/bootcamp-module/407/277/5935#collapse-SuHRjVm7iW-toggle" class="btn btn-primary collapsed" data-toggle="collapse">Pokaż wskazówkę nr 1</a>
    <a href="https://kodilla.com/pl/bootcamp-module/407/277/5935#collapse-SuHRjVm7iW-toggle" class="btn btn-primary collapsed" data-toggle="collapse">Ukryj wskazówkę nr 1</a>
  </span>
</p>
<div id="collapse-SuHRjVm7iW-toggle" class="collapse">
<ol>
<li>Samą informację o zalogowaniu serwer już posiada (po wykonaniu poprawnie pierwszego zadania), wystarczy więc rozszerzyć tę funkcjonalność. Poprzednio umieszczaliśmy wpis o tej osobie w tablicy <code>users</code>, teraz przesyłaj tę informację dalej, do pozostałych socketów (np. pod zdarzeniem o nazwie <code>newUser</code> albo <code>join</code> – Twój wybór). Pamiętasz jak wcześniej "rozsyłaliśmy" dalej zdarzenie <code>message</code>? Tutaj będzie to wyglądało prawie identycznie.</li>
<li>Pamiętaj, że musimy wysłać to zdarzenie do wszystkich socketów, oprócz inicjującego.</li>
</ol>
</div>
<p class="text-center">
  <span class="collapse-toggles">
    <a href="https://kodilla.com/pl/bootcamp-module/407/277/5935#collapse-xE9CudK45i-toggle" class="btn btn-primary collapsed" data-toggle="collapse">Pokaż wskazówkę nr 2</a>
    <a href="https://kodilla.com/pl/bootcamp-module/407/277/5935#collapse-xE9CudK45i-toggle" class="btn btn-primary collapsed" data-toggle="collapse">Ukryj wskazówkę nr 2</a>
  </span>
</p>
<div id="collapse-xE9CudK45i-toggle" class="collapse">
<p>Każdy klient powinien mieć ustawiony nasłuchiwacz na to zdarzenie, o którym mowa we wskazówce pierwszej (np. <code>newUser</code>). Kiedy je wykryje, powinien dodać nową wiadomość do listy (z wykorzystaniem <code>addMessage</code>). Jako parametr <code>author</code> wpisz <code>Chat Bot</code>, a jako <code>content</code> tekst <code>User-name has joined the conversation!</code>. Przy czym jako <code>User-name</code> przyjmij to, co otrzymasz wraz z eventem (a więc login).</p>
</div>
<p class="text-center">
  <span class="collapse-toggles">
    <a href="https://kodilla.com/pl/bootcamp-module/407/277/5935#collapse-kqrJLnSHwe-toggle" class="btn btn-primary collapsed" data-toggle="collapse">Pokaż wskazówkę nr 3</a>
    <a href="https://kodilla.com/pl/bootcamp-module/407/277/5935#collapse-kqrJLnSHwe-toggle" class="btn btn-primary collapsed" data-toggle="collapse">Ukryj wskazówkę nr 3</a>
  </span>
</p>
<div id="collapse-kqrJLnSHwe-toggle" class="collapse">
<p>Usuwanie użytkownika możesz rozegrać analogicznie. Gdy wykryjesz na serwerze event <code>disconnect</code> w danym sockecie, to wyemituj jakiś event do klientów (np. <code>removeUser</code>). Koniecznie wraz z tym eventem przekaż login użytkownika, który się rozłącza. Login ten możesz pobrać z tablicy <code>users</code>, wyszukując go, chociażby po <code>id</code> (<code>socket.id</code>). Gdy klient wykryje taki event, powinien analogicznie do dołączenia użytkownika, pokazywać wiadomość od <code>Chat Bot</code>, o treści <code>User-name has left the conversation... :(</code>. Znowu możesz skorzystać tutaj z funkcji <code>addMessage</code>.</p>
</div>
<p>Efekt powinien być następujący:</p>
<a href="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/WebSocket13.gif" class="img-modal-group"><img src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/WebSocket13.gif" alt="image" style="width: auto;"></a>

                        </div>
                    </div>
                                        <div class="card-block submodule-footer clearfix  completed ">
                                                <div class="clearfix">
                                                                                <a href="https://kodilla.com/pl/bootcamp-task/407/663635" target="_blank" class="btn btn-info-outline">Podgląd zadania</a>
                            <form target="_blank" class="form-inline project-link-form">
                                <div class="form-group">
                                    <input type="text" name="link" class="form-control" value="https://github.com/skwiryt/czat">
                                </div>
                                <button type="submit" class="btn  btn-primary ">Wyślij link <i class="fa fa-check"></i></button>
                            </form>
                                                                                                    </div>
                    </div>
                </section>
                                    
                <section id="submodule-1138" class="card submodule completed" data-bootcamp-user-submodule-id="663636">
                <!-- klasy dla section: completed current comments -->
                    <div class="card-block submodule-header clearfix">
                        <i class="fa fa-check-circle-o fa-2x"></i>
                        <i class="fa fa-play-circle-o fa-2x"></i>
                        <i class="fa fa-exclamation-circle fa-2x"></i>
                        <i class="fa fa-send-o fa-2x"></i>
                        <h2 class="bootcamp-submodule-name">28.4. <span>WebSockety w praktyce – aplikacja To-Do list</span></h2>
                                            </div>
                    <div class="card-block">
                        <div class="submodule-content">
                            <p>Wiemy już jak w teorii działają WebSockety, udało nam się również wykorzystać je w akcji, tworząc aplikację czatu. Jeden przykład może nie wystarczyć Ci, aby poczuć się wystarczająco pewnie, dlatego zrobimy kolejne zadanie.</p>
<p>Tym razem zabierzemy się za reactową aplikację listy zadań, czyli bardzo prosty przykład, w którym głównie chodzi o utrwalenie wiadomości. Z racji tego, że nie będzie tu żadnych nowości, zamiast zasypywać&nbsp;Cię snippetami, postaramy się pokazywać Ci tylko właściwą ścieżkę. Jeśli jednak czujesz się na siłach i naprowadzenie nie jest Ci potrzebne do szczęścia – przeczytaj tylko założenia i bierz się do pracy :)</p>
<h3 id="284-websockety-w-praktyce-aplikacja-to-do-list-zalozenia">Założenia</h3>
<p>Zamysł jest bardzo prosty.</p>
<ol>
<li>Aplikacja klienta powinna przechowywać lokalnie tablicę zadań (np. <code>['Shopping', 'Go out with a dog']</code>).</li>
<li>Taką samą tablicę chcemy też przechowywać na serwerze.</li>
<li>Uruchomienie aplikacji klienta powinno natychmiastowo zsynchronizować dane tablicy dostępnej z naszą tablicą lokalną.</li>
<li>Aplikacja powinna renderować listę tych zadań z tablicy w formie zwykłej HTML-owej listy (<code>ul</code>).</li>
<li>Każdy element tej listy (<code>li</code>) powinien przedstawiać nie tylko treść zadania, ale oferować również button "Remove".</li>
<li>Kliknięcie na button "Remove" powinno usuwać dany element z tablicy lokalnej, ale też informować serwer o konieczności wprowadzenia tej modyfikacji u siebie. Serwer powinien zaktualizować swoją tablicę oraz przesłać informację o potrzebie usunięcia elementu do pozostałych klientów.</li>
<li>Oprócz listy, w aplikacji klienta powinien znajdować się również formularz do wpisania nowego tasku. Co ważne – podobnie jak przy usuwaniu – po dodaniu elementu do lokalnej listy, należy powiadomić serwer o potrzebie aktualizacji i poinformowania pozostałych klientów.</li>
</ol>
<p>Krótko mówiąc, chcemy mieć aplikację listy zadań, która może być współdzielona przez wielu użytkowników. Po wejściu powinniśmy otrzymywać aktualną listę zadań. Następnie, gdy którykolwiek z klientów coś w tej liście zmienia (czyli doda lub usunie), natychmiast powinni dowiadywać się o tym wszyscy pozostali klienci, tak aby mogli zaktualizować swoje lokalne tablice. Naturalnie pośrednikiem w przekazywaniu tych informacji i danych będzie serwer, a o "natychmiastowość" wszystkich operacji zadba Socket.IO.</p>
<p>Podsumujmy, jak może wyglądać serwer i klient.</p>
<p><strong>Serwer</strong> powinien:</p>
<ul>
<li>Przechowywać tablicę zadań.</li>
<li>Nasłuchiwać na automatyczny event dołączenia socketu (<code>connection</code>) i w sytuacji wykrycia go, podać temu klientowi aktualną listę zadań. Oczywiście będziemy je wysyłać wraz ze zdarzeniem (nazwijmy je <code>updateData</code>).</li>
<li>Nasłuchiwać na event usunięcia zadania przez klienta (nazwijmy go np. <code>removeTask</code>) i w sytuacji wykrycia go, usunąć ten element również ze swojej tablicy zadań, a następnie jeszcze wyemitować zdarzenie dalej, do pozostałych klientów, tak aby mogli dokonać stosownej aktualizacji.</li>
<li>Nasłuchiwać na event dodania zadania przez klienta (nazwijmy go np. <code>addTask</code>) i w sytuacji wykrycia go, dodać ten element do swojej tablicy zadań, oraz emitować to zdarzenie dalej do pozostałych klientów, tak aby mogli dokonać stosownej aktualizacji.</li>
</ul>
<p><strong>Klient</strong> powinien:</p>
<ul>
<li>Przechowywać tablicę zadań.</li>
<li>Renderować elementy tej tablicy w formie listy HTML-owej (wraz z buttonem <code>Remove</code> dla każdego z nich).</li>
<li>Nasłuchiwać na event <code>updateData</code> i w sytuacji wykrycia go, zaktualizować swoją tablicę zadań zgodnie z danymi otrzymanymi wraz z tym zdarzeniem od serwera.</li>
<li>W przypadku kliknięcia na button <code>Remove</code> usuwać dany element z tablicy lokalnej i emitować event <code>removeTask</code> do serwera, wraz z indeksem elementu do usunięcia.</li>
<li>Renderować również formularz HTML z jednym polem (nazwa zadania).</li>
<li>Na submit tego formularza dodawać nowy element do tablicy o treści wcześniej wspomnianego inputu oraz emitować event <code>addTask</code> do serwera wraz z nazwą zadania.</li>
<li>Nasłuchiwać na event <code>removeTask</code> i w sytuacji wykrycia go, usuwać element o otrzymanym id ze swojej tablicy.</li>
<li>Nasłuchiwać na event <code>addTask</code> i w sytuacji wykrycia go, dodawać nowy element o treści otrzymanej wraz ze zdarzeniem do swojej tablicy.</li>
</ul>
<p>Opis jest dość długi, ale pewnie widzisz, że funkcjonalności nie są przekombinowane, a sam sposób działania bardzo przypomina to, co robiliśmy już z czatem.</p>
<p>To jak? Może spróbujesz poradzić sobie całkowicie bez naszego udziału? ;)</p>
<p>Jeśli masz ochotę na wyzwanie, na tym etapie kończy się nasza pomoc. Jeśli jednak nie czujesz się jeszcze zbyt pewnie, poniżej znajdziesz dokładniejszą instrukcję.</p>
<h3 id="284-websockety-w-praktyce-aplikacja-to-do-list-krok-po-kroku">Krok po kroku</h3>
<h4>Etap 1 – tworzymy bazową strukturę</h4>
<p>Rozpocznij od założenia nowego katalogu projektu. Bezpośrednio w nim utwórz plik <code>server.js</code> (to będzie nasz serwer) oraz folder <code>client</code> (na naszą aplikację klienta).</p>
<p>Następnie, w katalogu głównym projektu utwórz plik <code>package.json</code>, pobierz Express, a na końcu zmodyfikuj <code>server.js</code>. Jego zadaniem ma być startowanie serwera pod portem 8000, a gdy się to uda, wypisywanie również w konsoli komunikatu <code>Server is running...</code>. Na ten moment serwer nie musi jeszcze obsługiwać endpointów. Opcjonalnie możesz ustawić jeden middleware, które będzie wyłapywał wszystkie requesty i zwracał komunikat <code>Not found</code>, nie jest to jednak obligatoryjne.</p>
<p class="text-center">
  <span class="collapse-toggles">
    <a href="https://kodilla.com/pl/bootcamp-module/407/277/5935#collapse-MYcWNhulq-toggle" class="btn btn-primary collapsed" data-toggle="collapse">Pokaż wskazówkę</a>
    <a href="https://kodilla.com/pl/bootcamp-module/407/277/5935#collapse-MYcWNhulq-toggle" class="btn btn-primary collapsed" data-toggle="collapse">Ukryj wskazówkę</a>
  </span>
</p>
<div id="collapse-MYcWNhulq-toggle" class="collapse">
<pre class=" language-js"><code class=" language-js"><span class="token keyword">const</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token function">express</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> server <span class="token operator">=</span> app<span class="token punctuation">.</span><span class="token method function property-access">listen</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span><span class="token property-access">env</span><span class="token punctuation">.</span><span class="token constant">PORT</span> <span class="token operator">||</span> <span class="token number">8000</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token console class-name">console</span><span class="token punctuation">.</span><span class="token method function property-access">log</span><span class="token punctuation">(</span><span class="token string">'Server is running...'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

app<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method function property-access">status</span><span class="token punctuation">(</span><span class="token number">404</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token method function property-access">send</span><span class="token punctuation">(</span><span class="token punctuation">{</span> message<span class="token operator">:</span> <span class="token string">'Not found...'</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
</div>
<p>Możesz uruchomić teraz komendę <code>node server.js</code>. Jeśli wszystko poszło dobrze, w konsoli powinien pojawić się komunikat <code>Server is running...</code>.</p>
<p>Warto pobrać na tym etapie również Nodemona oraz dodać do <code>package.json</code> skrypt, który będzie z jego pomocą uruchamiał nasz <code>server.js</code> (<code>"start": "nodemon server.js"</code>).</p>
<p>Następnie, z wykorzystaniem Create React App, wygeneruj w katalogu <code>client</code> reactowy szablon aplikacji.</p>
<p class="text-center">
  <span class="collapse-toggles">
    <a href="https://kodilla.com/pl/bootcamp-module/407/277/5935#collapse-3usCaSsM77-toggle" class="btn btn-primary collapsed" data-toggle="collapse">Pokaż wskazówkę</a>
    <a href="https://kodilla.com/pl/bootcamp-module/407/277/5935#collapse-3usCaSsM77-toggle" class="btn btn-primary collapsed" data-toggle="collapse">Ukryj wskazówkę</a>
  </span>
</p>
<div id="collapse-3usCaSsM77-toggle" class="collapse">
<pre class=" language-js"><code class=" language-js">npx create<span class="token operator">-</span>react<span class="token operator">-</span>app client</code></pre>
</div>
<p>Teraz usuń zbędne elementy z folderu <code>client/src</code>:</p>
<ul>
<li><code>App.css</code></li>
<li><code>App.test.js</code></li>
<li><code>logo.svg</code></li>
<li><code>serviceWorker.js</code></li>
</ul>
<p>Uprość także plik <code>index.js</code>.</p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">React</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">ReactDOM</span></span> <span class="token keyword module">from</span> <span class="token string">'react-dom'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token string">'./index.css'</span><span class="token punctuation">;</span>
<span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">App</span></span> <span class="token keyword module">from</span> <span class="token string">'./App'</span><span class="token punctuation">;</span>

<span class="token maybe-class-name">ReactDOM</span><span class="token punctuation">.</span><span class="token method function property-access">render</span><span class="token punctuation">(</span><span class="token operator">&lt;</span><span class="token maybe-class-name">App</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">,</span> <span class="token dom variable">document</span><span class="token punctuation">.</span><span class="token method function property-access">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Zrób porządek również w <code>App.js</code>.</p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword module">import</span> <span class="token imports"><span class="token maybe-class-name">React</span></span> <span class="token keyword module">from</span> <span class="token string">'react'</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">App</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>

  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">"App"</span><span class="token operator">&gt;</span>
        <span class="token maybe-class-name">Hello</span> world
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword module">export</span> <span class="token keyword module">default</span> <span class="token maybe-class-name">App</span><span class="token punctuation">;</span></code></pre>
<p>Teraz uruchom w <code>client</code> komendę <code>yarn start</code> i sprawdź, czy podgląd naszej (na razie bardzo prostej) aplikacji pojawi się w przeglądarce.</p>
<p>Jeśli tak, to wszystko idzie zgodnie z planem. Mamy przygotowaną strukturę pod klienta oraz serwer.</p>
<h4>Etap 2 – tworzymy widok klienta</h4>
<p>Zacznijmy od stworzenia struktury HTML. Musimy przygotować listę, w której będziemy renderować zadania oraz formularz do ich dodawania.</p>
<p>Wejdź teraz do komponentu <code>App</code> i odpowiednio przygotuj funkcję <code>render</code>. Możesz wspomóc się poniższą ściągą.</p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword control-flow">return</span> <span class="token punctuation">(</span>
  <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token string">"App"</span><span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span>header<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>h1<span class="token operator">&gt;</span><span class="token maybe-class-name">ToDoList</span><span class="token punctuation">.</span><span class="token property-access">app</span><span class="token operator">&lt;</span><span class="token operator">/</span>h1<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>header<span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span>section className<span class="token operator">=</span><span class="token string">"tasks-section"</span> id<span class="token operator">=</span><span class="token string">"tasks-section"</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>h2<span class="token operator">&gt;</span><span class="token maybe-class-name">Tasks</span><span class="token operator">&lt;</span><span class="token operator">/</span>h2<span class="token operator">&gt;</span>

      <span class="token operator">&lt;</span>ul className<span class="token operator">=</span><span class="token string">"tasks-section__list"</span> id<span class="token operator">=</span><span class="token string">"tasks-list"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>li <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"task"</span><span class="token operator">&gt;</span><span class="token maybe-class-name">Shopping</span> <span class="token operator">&lt;</span>button <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"btn btn--red"</span><span class="token operator">&gt;</span><span class="token maybe-class-name">Remove</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>li <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"task"</span><span class="token operator">&gt;</span><span class="token maybe-class-name">Go</span> out <span class="token keyword">with</span> a dog <span class="token operator">&lt;</span>button <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">"btn btn--red"</span><span class="token operator">&gt;</span><span class="token maybe-class-name">Remove</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">&gt;</span>

      <span class="token operator">&lt;</span>form id<span class="token operator">=</span><span class="token string">"add-task-form"</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>input className<span class="token operator">=</span><span class="token string">"text-input"</span> autocomplete<span class="token operator">=</span><span class="token string">"off"</span> type<span class="token operator">=</span><span class="token string">"text"</span> placeholder<span class="token operator">=</span><span class="token string">"Type your description"</span> id<span class="token operator">=</span><span class="token string">"task-name"</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>button className<span class="token operator">=</span><span class="token string">"btn"</span> type<span class="token operator">=</span><span class="token string">"submit"</span><span class="token operator">&gt;</span><span class="token maybe-class-name">Add</span><span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>form<span class="token operator">&gt;</span>

    <span class="token operator">&lt;</span><span class="token operator">/</span>section<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Jeśli chcesz, możesz wydzielić formularz oraz listę do osobnych komponentów, nie jest to jednak konieczne.</p>
<p>Aby aplikacja lepiej się prezentowała, dorzuć jeszcze trochę stylów do <code>index.css</code>:</p>
<pre class=" language-css"><code class=" language-css"><span class="token atrule"><span class="token rule">@import</span> <span class="token url"><span class="token function">url</span><span class="token punctuation">(</span><span class="token string url">'https://fonts.googleapis.com/css?family=Open+Sans&amp;display=swap'</span><span class="token punctuation">)</span></span><span class="token punctuation">;</span></span>

<span class="token selector">body</span> <span class="token punctuation">{</span>
  <span class="token property">background</span><span class="token punctuation">:</span> <span class="token hexcode color">#282c34</span><span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode color">#fff</span><span class="token punctuation">;</span>
  <span class="token property">font-family</span><span class="token punctuation">:</span> <span class="token string">'Open Sans'</span><span class="token punctuation">,</span> sans-serif<span class="token punctuation">;</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">30</span><span class="token unit">px</span><span class="token punctuation">;</span>
  <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">h1</span> <span class="token punctuation">{</span>
  <span class="token property">font-weight</span><span class="token punctuation">:</span> lighter<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector">p</span> <span class="token punctuation">{</span>
  <span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode color">#999</span><span class="token punctuation">;</span>
  <span class="token property">font-size</span><span class="token punctuation">:</span> <span class="token number">0.8</span><span class="token unit">rem</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector"><span class="token class">.btn</span></span> <span class="token punctuation">{</span>
  <span class="token property">background</span><span class="token punctuation">:</span> <span class="token hexcode color">#0064e7</span><span class="token punctuation">;</span>
  <span class="token property">border</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
  <span class="token property">border-radius</span><span class="token punctuation">:</span> <span class="token number">15</span><span class="token unit">px</span><span class="token punctuation">;</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">10</span><span class="token unit">px</span> <span class="token number">25</span><span class="token unit">px</span><span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode color">#fff</span><span class="token punctuation">;</span>
  <span class="token property">font-family</span><span class="token punctuation">:</span> inherit<span class="token punctuation">;</span>
  <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">20</span><span class="token unit">px</span> <span class="token number">10</span><span class="token unit">px</span><span class="token punctuation">;</span>
  <span class="token property">text-transform</span><span class="token punctuation">:</span> uppercase<span class="token punctuation">;</span>
  <span class="token property">outline</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
  <span class="token property">transition</span><span class="token punctuation">:</span> <span class="token number">.2</span><span class="token unit">s</span><span class="token punctuation">;</span>
  <span class="token property">cursor</span><span class="token punctuation">:</span> pointer<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector"><span class="token class">.btn</span><span class="token pseudo-class">:hover</span></span> <span class="token punctuation">{</span>
  <span class="token property">box-shadow</span><span class="token punctuation">:</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">20</span><span class="token unit">px</span> <span class="token color"><span class="token function">rgba</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0.2</span><span class="token punctuation">)</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector"><span class="token class">.btn--red</span></span> <span class="token punctuation">{</span>
  <span class="token property">background</span><span class="token punctuation">:</span> <span class="token hexcode color">#e74c3c</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector"><span class="token class">.text-input</span></span> <span class="token punctuation">{</span>
  <span class="token property">background</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
  <span class="token property">border</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode color">#fff</span><span class="token punctuation">;</span>
  <span class="token property">border-bottom</span><span class="token punctuation">:</span> <span class="token number">2</span><span class="token unit">px</span> solid <span class="token hexcode color">#0064e7</span><span class="token punctuation">;</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">8</span><span class="token unit">px</span> <span class="token number">25</span><span class="token unit">px</span> <span class="token number">8</span><span class="token unit">px</span> <span class="token number">5</span><span class="token unit">px</span><span class="token punctuation">;</span>
  <span class="token property">font-family</span><span class="token punctuation">:</span> inherit<span class="token punctuation">;</span>
  <span class="token property">outline</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
  <span class="token property">opacity</span><span class="token punctuation">:</span> <span class="token number">0.6</span><span class="token punctuation">;</span>
  <span class="token property">transition</span><span class="token punctuation">:</span> <span class="token number">.3</span><span class="token unit">s</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector"><span class="token class">.text-input</span><span class="token pseudo-class">:focus</span></span> <span class="token punctuation">{</span>
  <span class="token property">opacity</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token selector"><span class="token class">.tasks-section</span></span> <span class="token punctuation">{</span>
  <span class="token property">margin-bottom</span><span class="token punctuation">:</span> <span class="token number">100</span><span class="token unit">px</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector"><span class="token class">.tasks-section__list</span></span> <span class="token punctuation">{</span>
  <span class="token property">max-width</span><span class="token punctuation">:</span> <span class="token number">400</span><span class="token unit">px</span><span class="token punctuation">;</span>
  <span class="token property">list-style-type</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
  <span class="token property">padding</span><span class="token punctuation">:</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token property">margin</span><span class="token punctuation">:</span> <span class="token number">20</span><span class="token unit">px</span> auto <span class="token number">40</span><span class="token unit">px</span> auto<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token selector"><span class="token class">.task</span></span> <span class="token punctuation">{</span>
  <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>
  <span class="token property">justify-content</span><span class="token punctuation">:</span> space-between<span class="token punctuation">;</span>
  <span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>
  <span class="token property">border-bottom</span><span class="token punctuation">:</span> <span class="token number">1</span><span class="token unit">px</span> dashed <span class="token color"><span class="token function">rgb</span><span class="token punctuation">(</span><span class="token number">83</span><span class="token punctuation">,</span> <span class="token number">83</span><span class="token punctuation">,</span> <span class="token number">83</span><span class="token punctuation">)</span></span><span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre>
<h4>Punkt kontrolny</h4>
<p>W tej chwili, po uruchomieniu podglądu klienta, powinniśmy zobaczyć mniej więcej taki widok:</p>
<a href="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/WebSocket14.png" class="img-modal-group"><img src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/WebSocket14.png" alt="image" style="width: auto; max-width: 50%;"></a>
<p>Podsumujmy, co na tym etapie udało nam się osiągnąć?</p>
<p>Mamy już działający serwer i cały widok klienta, choć brakuje jeszcze komunikacji między tymi dwoma podmiotami. W tej chwili kompletnie się ignorują i to nawet bardziej niż w aplikacji czatu. Tam też na początku nie było komunikacji, jednak serwer od zawsze zajmował się renderowaniem widoku klienta pod linkiem <code>/</code>. Tutaj nie mamy nawet tego, co więcej, nasz serwer oraz serwer podglądu aplikacji reactowej są uruchamiane na dwóch oddzielnych portach. To nic. Zaraz zmusimy je do współpracy!</p>
<h4>Etap 3 – rozwijamy serwer</h4>
<p>Zajmijmy się odpowiednią modyfikacją serwera.</p>
<p>Zacznij od pobrania paczki Socket.IO i zaimportowania jej na serwerze, następnie zintegruj ją. Pamiętasz jak to zrobić? W razie problemu zajrzyj do przykładu z czatem.</p>
<p>Następnie utwórz tablicę <code>tasks</code>. Na starcie może być pusta, a później będziemy w niej przechowywać listę naszych zadań.</p>
<p>Potem, zgodnie z listą założeń, dodaj nasłuchiwacz na event <code>connection</code>. Przypomnijmy – to event, który jest wysyłany automatycznie przez każdy socket w momencie inicjacji połączenia (czyli np. gdy jakiś użytkownik otwiera naszą aplikację listy zadań). Jako callback dla tego nasłuchiwacza ustaw funkcję, której zadaniem będzie natychmiastowe emitowanie <strong>tylko do tego nowego użytkownika</strong> zdarzenia <code>updateData</code>. Wraz z samym zdarzeniem koniecznie wysyłana musi być też sama tablica <code>tasks</code>.</p>
<p>Pomysł jest prosty. Nowy użytkownik włącza aplikację, serwer od razu to wykrywa i wysyła do niego bieżącą lista zadań, żeby od początku miał u siebie aktualny widok.</p>
<div class="bc-note alert-info">
<h4 class="alert-heading text-center">Kto odbiorcą?</h4>
<p>Pamiętaj – chcesz wysyłać zdarzenie <code>updateData</code> <strong>tylko do jednego socketa</strong>, tego który właśnie zainicjował połączenie. Jeśli nie pamiętasz, jak możemy to osiągnąć, zajrzyj do poprzedniego submodułu.</p>
</div>
<p>Czas na kolejny krok. Chcemy, aby po wykryciu nowego klienta, serwer od razu zaczął nasłuchiwać też na dwa zdarzenia z jego strony.</p>
<p>Twoim zadaniem jest więc dodanie dwóch nasłuchiwaczy – na zdarzenie <code>addTask</code> oraz na <code>removeTask</code>.</p>
<p>W przypadku wykrycia pierwszego załóż że wraz ze zdarzeniem otrzymujesz od klienta również dane – nazwę taska. Właśnie takie zadanie (o nazwie otrzymanej wraz z eventem) dodaj do tablicy <code>tasks</code>, czyli jeśli np. otrzymujemy wraz ze zdarzeniem tekst <code>Shopping</code>, to do tablicy dodamy po prostu nowy element... <code>Shopping</code>. Dodatkowo, po tej operacji, serwer powinien wyemitować to samo zdarzenie (<code>addTask</code>), wraz z tą samą informacją, dalej do pozostałych socketów – <strong>wszystkich, z wyjątkiem tego, który dodał task</strong>.</p>
<p>W przypadku wykryciu drugiego eventu (<code>removeTask</code>), załóż, że to, co otrzymasz wraz ze zdarzeniem, jest indeksem elementu do usunięcia. Na bazie tej informacji serwer powinien usunąć ze swojej tablicy element o zgodnym indeksie. Po wszystkim powinien jeszcze wyemitować ten event wraz z informacją dalej, do pozostałych socketów. Oczywiście znowu z wyjątkiem tego, który usunął ten task.</p>
<p>Założenie obu nasłuchiwaczy jest tutaj proste. Chcemy, aby serwer miał zawsze aktualną listę zadań, oraz aby każdy klient był informowany o zmianach, a tablice ciągle aktualne.</p>
<div class="bc-note alert-info">
<h4 class="alert-heading text-center">Uwaga!</h4>
<p>Jeśli masz problem z niniejszym etapem, sprawdź, jak budowaliśmy nasz serwer w aplikacji z czatem. Rzut oka na kod z tamtego zadania (a dokładnie plik <code>server.js</code>) może Ci wiele wyjaśnić.</p>
</div>
<p>I... to tyle!</p>
<h4>Etap 4 - rozwijamy klienta</h4>
<p>Zacznij od zaimportowania do pliku <code>App.js</code> paczki Socket.IO. W przykładzie z czatem nie mieliśmy Webpacka, więc nie było takiej możliwości. Musieliśmy ładować plik tej paczki w HTML-u przy użyciu tagu <code>&lt;script&gt;</code>. Teraz, skoro korzystamy już z Create React App, nic nie stoi na przeszkodzie, aby zaimportować tę paczkę bezpośrednio z <code>node_modules</code>. Create React App korzysta już bowiem z WebPacka.</p>
<p>Warto wiedzieć jednak, że nie musimy ładować całej funkcjonalności tej paczki. Możemy ograniczyć się&nbsp;do samego modułu odpowiedzialnego za możliwości klienta, bo tylko takie będą nam potrzebne.</p>
<pre class=" language-js"><code class=" language-js"><span class="token keyword module">import</span> <span class="token imports">io</span> <span class="token keyword module">from</span> <span class="token string">'socket.io-client'</span><span class="token punctuation">;</span></code></pre>
<p>Następnie musisz zainicjować nasz socket. Możesz to zrobić w <code>componentDidMount</code> (a więc połączenie z serwerem wystartuje, gdy tylko komponent będzie gotowy).</p>
<div class="bc-note alert-warning">
<h4 class="alert-heading text-center">Uwaga!</h4>
<p>W przykładzie z czatem klient i serwer byli dostępni jako jedna całość. Gdy włączaliśmy aplikację klienta, znajdowaliśmy się od razu na <code>localhost:8000</code>, a więc adresie, pod którym był nasz serwer. Dlatego też, przy inicjacji socketu (<code>const socket = io();</code>) nie musieliśmy podawać dokładnego adresu. Socket.IO domyślnie używa tego, na którym aktualnie się znajduje.</p>
<p>Teraz sytuacja jest inna. Serwer jest uruchamiany pod adresem <code>localhost:8000</code>, ale podgląd klienta już na <code>localhost:3000</code>. Socket.IO będzie starał się użyć tego, na którym aktualnie jesteśmy, a więc (<code>localhost:3000</code>). Koniecznie <strong>przy inicjacji socketu wskaż więc właściwy adres serwera <code>localhost:8000</code></strong>.</p>
</div>
<div class="bc-note alert-info">
<h4 class="alert-heading text-center">Dla ułatwienia...</h4>
<p>W przykładzie z czatem przypisywaliśmy połączenie do stałej <code>socket</code>. Teraz nie byłoby to najlepszym wyjściem, bo stała zainicjowana w bloku jednej funkcji (<code>componentDidMount</code>) nie byłaby już dostępna w innych metodach. Lepiej więc przypisać połączenie do <code>this.socket</code>, a więc jako atrybut dostępny w każdej metodzie naszego komponentu.</p>
</div>
<p>Teraz przejdźmy już do realizacji założeń.</p>
<p>Zacznij od utworzenia tablicy zadań. Możesz nazwać ją <code>tasks</code>. Na starcie powinna być pusta.</p>
<p>Następnie przejdź do metody <code>render</code>. Odnajdź element <code>#tasks-list</code> i zmodyfikuj go w taki sposób, aby zamiast stałych elementów, <code>li</code> w liście były generowane na podstawie tablicy <code>state.tasks</code>. Możesz użyć metody <code>map</code>. Pamiętaj, aby w każdym renderowanym  <code>li</code>, oprócz tekstu, umieścić również button "Remove".</p>
<p>Gdy lista będzie renderować się już poprawnie, zajmij się samym buttonem "Remove". Dodaj do niego nasłuchiwacz na kliknięcie (<code>onClick</code>). W przypadku wykrycia tego eventu powinna uruchamiać się funkcja (nazwijmy ją <code>removeTask</code>), która w założeniu będzie usuwać dany element z tablicy <code>state.tasks</code>. Przy przypinaniu tej funkcji do nasłuchiwacza pamiętaj też o przekazaniu do niej indeksu zadania – w końcu <code>removeTask</code> będzie musiała wiedzieć, który element z listy ma usunąć.</p>
<p>Czas na samą metodę <code>removeTask</code>. Powinna ona przyjmować jeden parametr (nazwijmy go <code>id</code>). Jej zadaniem jest usunięcie elementu z tablicy o indeksie, którego wartość jest równa właśnie <code>id</code>. To jednak jeszcze nie wszystko. Na razie usuwamy dane zadanie tylko lokalnie, a powinniśmy jeszcze poinformować o tym serwer, emitując zdarzenie. Pamiętaj o wysłaniu również <code>id</code>, aby serwer wiedział jaki element w swojej tablicy ma usunąć.</p>
<p>Czas na obsługę formularza do dodawania zadania.</p>
<p>Zacznij od stworzenia nowego atrybutu do stanu. Możesz nazwać go <code>taskName</code>. Następnie zmień pole w formularzu, aby jego wartość była pobierana właśnie ze <code>state.taskName</code>. Dodatkowo tak zmodyfikuj kod aplikacji, aby przy zmianie wartości w inpucie (<code>onChange</code>), automatycznie aktualizowała się też wartość zapisana w stanie (w <code>state.taskName</code>). Chodzi po prostu o to, aby była tam zawsze ta sama treść, która aktualnie jest wpisana również do pola tekstowego. Do samego formularza przypnij też funkcję na event <code>submit</code>. Gdy formularz wykryje to zdarzeniem, niech uruchamia nową metodę – <code>submitForm</code>.</p>
<p>Czas na jej napisanie. <code>submitForm</code> powinna mieć dostęp do obiektu zdarzenia i na samym starcie blokować domyślne zachowanie formularza. Następnie powinna uruchamiać metodę <code>addTask</code> (zaraz ją dodamy). Przy wywołaniu tej metody pierwszy argument powinien mieć wartość <code>state.taskName</code>, aby funkcja <code>addTask</code> wiedziała, jaka ma być treść nowego zadania.</p>
<p>Dlaczego nie mogliśmy od razu zaktualizować stanu? Zauważ, że potrzebujemy funkcji, która przyda się teraz, gdy dodajemy task lokalnie, ale i wtedy, kiedy otrzymamy informację o nowym zadaniu od serwera. Gdyby taką rolę pełnił <code>submitForm</code>, mogłoby się to nie sprawdzić. Zakładamy, że serwer zwróci nam od razu treść nowego tasku, jaki sens mogłoby mieć wtedy np. zatrzymywanie domyślnego zachowania formularza, które jest uruchamiane na starcie <code>submitForm</code>? W takiej sytuacji żaden. W końcu nawet nie obsługiwalibyśmy wtedy formularza tylko dostawalibyśmy od razu treść zadania wraz z nim. Dlatego też pójdziemy w innym kierunku. Stworzymy zaraz nową funkcję <code>addTask</code>, której zadaniem będzie tylko przyjmowanie w formie argumentu stringu z treścią zadania. Nie interesuje jej, czy pochodzi on ze <code>state.taskName</code>, czy może z informacji otrzymanej od serwera. Taka funkcja będzie mogła być używana od razu po wykryciu nowego tasku na serwerze, ale też właśnie przez naszą metodę <code>submitForm</code>.</p>
<p>Wróćmy jeszcze do <code>submitForm</code>. Na razie zatrzymuje ona domyślne zachowanie formularza oraz wywołuje <code>addTask</code>, która ma dodać nasze zadanie do lokalnej tablicy. Czy czegoś tu jeszcze brakuje? W sytuacji dodania przez nas lokalnie tasku, warto by informować o tym również serwer, aby mógł zatkualizować swoją tablicę, ale też podać informację o potrzebie aktualizacji innym klientom. Po wywołaniu metody <code>addTask</code> dodaj więc jeszcze kod, który zajmie się emitowaniem do serwera zdarzenia <code>addTask</code>. Wraz z tym zdarzeniem musi być oczywiście wysyłana sama treść nowego tasku, a więc <code>state.taskName</code>.</p>
<p>Teraz już czas na samą metodę <code>addTask</code>. Powinna przyjmować jeden parametr (nazwijmy go <code>task</code>) i to z niego otrzymamy nowe zadanie do <code>state.tasks</code>.</p>
<p>Od tego momentu dodawanie i usuwanie elementów powinno już w Twojej lokalnej aplikacji działać. Pozostaje nam tylko jedna rzecz – dodanie nasłuchiwaczy na zdarzenia, które może do nas emitować serwer. Chcemy też, aby każdy klient był w stanie umiejętnie reagować na zmiany wprowadzane przez innych użytkowników, o których serwer zawsze będzie nas informował.</p>
<p>Musimy dodać trzy nasłuchiwacze. Pierwszy na zdarzenie <code>addTask</code>, drugi na <code>removeTask</code> oraz trzeci na <code>updateData</code>, czyli event, który jest wysyłany jako swego rodzaju powitanie od serwera. Gdy dodasz je w <code>componentDidMount</code>, wtedy będą nasłuchiwać na wszystkie zdarzenia od momentu, gdy tylko komponent <code>App</code> będzie gotowy.</p>
<p>Kiedy klient wykryje <code>addTask</code>, powinien odebrać dane przekazywane samym eventem, a następnie wywołać lokalną metodę <code>addTask</code>. Jako argument przy wywołaniu tej metody należy przekazać informację otrzymaną od serwera (zakładamy, że serwer podał nam treść zadania dodanego przez innego klienta). Zapewni to nas, że gdy tylko jakiś inny użytkownik dołoży nowe zadanie, to my, poinformowani o tym fakcie przez serwer, też dodamy je do swojej lokalnej tablicy.</p>
<p>Kiedy wykryjemy <code>removeTask</code>, powinniśmy odebrać to, co jest przekazywane do nas wraz z samym eventem (indeks elementu do usunięcia) i wywoływać lokalną metodę <code>removeTask</code>. Jako argument przy wywołaniu należy przekazać indeks, by metoda wiedziała, co właściwie ma usunąć. Dzięki temu, gdy tylko jakiś inny użytkownik skasuje któreś zadanie, to my poinformowani o tym fakcie przez serwer, też pozbędziemy się go ze swojej lokalnej tablicy.</p>
<div class="bc-note alert-warning">
<h4 class="alert-heading text-center">Uwaga!</h4>
<p>Musisz bez naszej pomocy rozwiązać jeszcze jeden problem. W tej chwili nieważne czy otrzymujemy dane o zadaniu do usunięcia od serwera, czy też sami je usuwamy, uruchamiamy <strong>dokładnie tę samą funkcję – <code>removeTask</code></strong>. Nie jest to do końca idealne rozwiązanie. Zobacz, że funkcja ta nie tylko usuwa task z tablicy, ale również emituje informacje o potrzebie usunięcia tego tasku do serwera. Jest to w porządku do momentu, kiedy faktycznie to my usuwamy task i chcemy, aby serwer podał informację o tym do innych klientów.</p>
<p>Wyobraź sobie jednak, że to nie my, lecz inny klient wykonał tę operację. Co uruchomi się u nas w takiej sytuacji? Wiemy, że klient wykryje u nas zdarzenie <code>removeTask</code> i włączy lokalną funkcję <code>removeTask</code>, a ona, zgodnie z informacją od serwera, usunie poprawnie zadanie, ale też... sama wyemituje taką akcję do serwera. Serwer wykryje event i po raz kolejny przekaże informację o potrzebie usunięcia tego konkretnego tasku do pozostałych klientów. Te będą chciały usunąć je u siebie i znowu poinformują serwer o potrzebie usunięcia tej konkretnej wiadomości. Czyli... event będzie krążył&nbsp;w kółko i nigdy nie przestanie.</p>
<p>Musisz więc przemodelować tę funkcję, aby emitowanie zdarzenia do serwera miało miejsce tylko wtedy, gdy akcja usunięcia była wykonana najpierw lokalnie przez dany socket. Jeśli ta funkcja odpali się po informacji o potrzebie aktualizacji od serwera, powinna tylko usunąć odpowiedni element w swojej lokalnej tablicy. Krótko mówiąc, musisz uwarunkować odpowiednio emitowanie zdarzenia <code>removeTask</code> przez metodę <code>removeTask</code>.</p>
</div>
<p>Co do eventu <code>updateData</code>, to serwer przesyła wraz z nim informację o aktualnej tablicy z taskami. Zdarzenie jest emitowane przez serwer do klienta raz, kiedy ten inicjuje połączenie. Chcemy bowiem, aby użytkownik po włączeniu aplikacji zobaczył, jaka jest aktualna tablica zadań, inaczej niż w aplikacji czatu, gdzie archiwalne wiadomości nie były dla nas ważne. Potem już jednak o każdej pojedynczej zmianie klient zostanie informowany na bieżąco (poprzez eventy <code>addTask</code> i <code>removeTask</code>) oraz możliwe stanie się dodawanie i usuwanie elementów. Serwer nie będzie musiał już przesyłać do niego całej tablicy, tylko informować, że trzeba dodać albo usunąć jeden element.</p>
<p>Wykrycie tego eventu powinno powodować wywołanie nowej funkcji (np. <code>updateTasks</code>), której zadaniem będzie przypisanie otrzymanych wraz eventem danych do <code>state.tasks</code>. Tak naprawdę, klient będzie tutaj otrzymywał całą tablicę z taskami, które były dodawane do momentu jego dołączenia i zapisze ją jako swoją lokalną <code>state.tasks</code>. Oczywiście napisanie tej metody (<code>updateTasks</code>) to też Twoje zadanie.</p>
<p>Na razie to tyle!</p>
<p>Klient pozwala od teraz na dodawanie i usuwanie elementów z tablicy. O każdej zmianie natychmiastowo informowany jest serwer, który o potrzebie aktualizacji powiadamia pozostałych klientów. Naturalnie klienci muszą na takie informacje odpowiednio nasłuchiwać, dlatego też dodaliśmy nasłuchiwacze, które powodują, że wykrycie informacji o zmianach w tablicy na którymś z socketów jest równoznaczne z natychmiastową aktualizacją lokalnych danych w kliencie.</p>
<h4>Etap 5 – testowanie</h4>
<p>Pozostaje już tylko przetestować, czy wszystko działa poprawnie. Jeśli udało Ci się dobrze wykonać wszystkie instrukcje, to efekt powinien być następujący:</p>
<a href="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/WebSocket15.gif" class="img-modal-group"><img src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/WebSocket15.gif" alt="image" style="width: auto; max-width: 50%;"></a>

                        </div>
                    </div>
                                        <div class="card-block task-card">
                        <h3 id="284-websockety-w-praktyce-aplikacja-to-do-list-zadanie-lepsza-identyfikacja">Zadanie: <span class="task-title">lepsza identyfikacja</span></h3>
                        <div class="task-content">
                            <p>Jak na razie, struktura danych w naszej tablicy zadań jest bardzo prosta. Tak naprawdę to tylko lista stringów, co powoduje, że identyfikacja elementów jest możliwa jedynie po ich indeksie (w końcu treść zadań może być powtarzalna, nie jest unikalna). Właśnie z takiej opcji korzystaliśmy np. przy ustalaniu, które zadanie ma być usunięte przez metodę <code>removeTask</code>. Jak zapewne się domyślasz, nie jest to najbardziej profesjonalna opcja. Indeksy nadawane są po kolei, a więc usunięcie jednego elementu powoduje, że wszystkie zadania, które miały indeks większy od tego elementu, zwyczajnie otrzymują nagle nowy indeks, mniejszy o jeden.</p>
<p>Twoim zadaniem jest więc takie zmodyfikowanie aplikacji, aby dane były przechowywane w bardziej skomplikowanym formacie. Każdy task powinien być zapisywany w tablicy jako obiekt z dwoma atrybutami – pierwszy (<code>id</code>) powinien przechowywać unikalny identyfikator, a drugi (<code>name</code>) już samą treść zadania. Zatem dane w tablicy będą wyglądały po zmianach np. tak:</p>
<pre class=" language-js"><code class=" language-js"><span class="token punctuation">[</span><span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token string">'dfsadf324s'</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">'Shopping'</span><span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> id<span class="token operator">:</span> <span class="token string">'dfs2ad6724s'</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token string">'Go out with a dog'</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">;</span></code></pre>
<p>Sam identyfikator powinien być nadawany podczas dodawania tasku lokalnie, zanim klient wyśle informację o nim serwerowi. Do wygenerowania unikalnego identyfikatora możesz użyć zewnętrznej paczki (np. <code>uuid</code>).</p>
<p>Oczywiście task będzie wymagał od Ciebie również innych modyfikacji. Przed wykonaniem zadania przejrzyj cały kod serwera oraz klienta i dobrze zastanów się, gdzie będą potrzebne zmiany.</p>
<h4>Dla ambitnych</h4>
<p>Jeśli to dla Ciebie za mało, spróbuj jeszcze zaimplementować do aplikacji funkcjonalność edycji zadań. Podejmiesz rękawicę? ;)</p>

                        </div>
                    </div>
                                        <div class="card-block submodule-footer clearfix  completed ">
                                                <div class="clearfix">
                                                                                <a href="https://kodilla.com/pl/bootcamp-task/407/663636" target="_blank" class="btn btn-info-outline">Podgląd zadania</a>
                            <form target="_blank" class="form-inline project-link-form">
                                <div class="form-group">
                                    <input type="text" name="link" class="form-control" value="https://github.com/skwiryt/to-do-sockets">
                                </div>
                                <button type="submit" class="btn  btn-primary ">Wyślij link <i class="fa fa-check"></i></button>
                            </form>
                                                                                                    </div>
                    </div>
                </section>
                                    
                <section id="submodule-1139" class="card submodule completed" data-bootcamp-user-submodule-id="663637">
                <!-- klasy dla section: completed current comments -->
                    <div class="card-block submodule-header clearfix">
                        <i class="fa fa-check-circle-o fa-2x"></i>
                        <i class="fa fa-play-circle-o fa-2x"></i>
                        <i class="fa fa-exclamation-circle fa-2x"></i>
                        <i class="fa fa-send-o fa-2x"></i>
                        <h2 class="bootcamp-submodule-name">28.5. <span>WebSockety w praktyce – zamawianie biletów</span></h2>
                                            </div>
                    <div class="card-block">
                        <div class="submodule-content">
                            <p>Czas na kolejne zadanie praktyczne. Tym razem będzie krótsze, jednak nieco różniące się od przykładów z czatem i listą zadań.</p>
<p>Do tej pory, gdy używaliśmy WebSocketów, stawały się one od razu najważniejszym elementem aplikacji, a także jedynym środkiem komunikacji pomiędzy serwerem a klientem. Nie zawsze musi tak być. W tym zadaniu dowiesz się, jak łatwo możemy wykorzystywać WebSockety tylko w części aplikacji oraz jak implementować tę technologię obok AJAX-u, a nie zamiast niego.</p>
<p>Będziemy pracować nad witryną festiwalu muzycznego z poprzedniego modułu, a konkretnie – zajmiemy się&nbsp;modyfikacją podstrony do rezerwacji biletów. Mówiliśmy o tym, jak niewydajny jest nasz obecny pomysł na sprawdzanie ilości wolnych miejsc i aby go poprawić, zastosujemy WebSockety.</p>
<h3 id="285-websockety-w-praktyce-zamawianie-biletow-jak-to-rozegramy">Jak to rozegramy?</h3>
<p>Zacznijmy od przeanalizowania tego, jak aktualnie działa nasza aplikacja i jak ma się to zmienić.</p>
<p>W tej chwili informacja o zajętości jest pobierana automatycznie, kiedy użytkownik wchodzi na podstronę "Order a ticket", albo kiedy zarezerwuje miejsce. Oprócz tego jest również odświeżana co dwie minuty. Wiemy jednak, że bardzo często te "cykliczne" żądania są całkowicie zbędne. W końcu może dojść do takiej sytuacji, gdzie przez godzinę nikt nie kupi ani jednego biletu, a klient i tak wykona w tym czasie multum niepotrzebnych requestów.</p>
<p>Teraz zabierzemy się do tego z wykorzystaniem WebSocketów, a więc z użyciem emitterów i nasłuchiwaczy.</p>
<p>Zastanów się chwilę nad tym, jak by to mogło dokładnie wyglądać, a następnie przeczytaj nasz pomysł poniżej i skonfrontuj oba scenariusze.</p>
<p>Nasza propozycja jest następująca. Zamiast wysyłać żądania cyklicznie, co dwie minuty, <strong>klient będzie ciągle nasłuchiwał na jedno zdarzenie z serwera</strong>. Nazwijmy je <code>seatsUpdated</code>. Kiedy je wykryje, to za pomocą danych, które otrzyma wraz ze zdarzeniem, odświeży podgląd "zajętości" miejsc. Sam <strong>serwer będzie emitował to zdarzenie do wszystkich klientów, gdy tylko w bazie danych pojawi się nowa rezerwacja</strong>. Dzięki temu korzystanie z podstrony stanie się o wiele wygodniejsze – nie będziemy co chwilę spoglądać na "loader" informujący o kolejnym połączeniu, a klient zaprzestanie wysyłania zbędnych żądań. Serwer sam poinformuje nas o potrzebie aktualizacji, jeśli ktoś faktycznie zarezerwuje bilet. Wiedząc, że WebSockety działają w czasie rzeczywistym, mamy pewność, że informacja faktycznie jest adekwatna do tego, co znajduje na serwerze, a nie wskazuje stan "sprzed dwóch minut".</p>
<p>A co z samym wysyłaniem rezerwacji? Wciąż możemy korzystać z obecnego rozwiązania. Nie ma potrzeby używania WebSocketów do wysyłki formularza. Oczywiście moglibyśmy to zrobić – wystarczyłoby utworzyć odpowiedni nasłuchiwacz na serwerze, a klientowi kazać emitować zdarzenie po kliknięciu na "Submit". Tylko czy to naprawdę miałoby sens? Musielibyśmy przemodelować kod, nie otrzymując tak naprawdę w zamian żadnej wymiernej korzyści. Nie potrzebujemy tutaj bowiem ani ciągłej komunikacji, ani możliwości inicjacji czegoś przez serwer. Nie zapominaj, że AJAX domyślnie opiera się na mechanizmie request-&gt;response, jest wręcz do niego stworzony, przez co pozwala nam na przekazanie ewentualnych odpowiedzi z informacją o błędzie albo o sukcesie. W przypadku WebSocketów musielibyśmy po całej operacji dodania rezerwacji na serwerze, jeszcze informować o efekcie poprzez emitowanie nowego zdarzenia. Tak naprawdę kod by się wydłużył, więc akurat w tej sytuacji, AJAX będzie zdecydowanie lepszym wyborem.</p>
<h3 id="285-websockety-w-praktyce-zamawianie-biletow-pierwsze-kroki-serwer">Pierwsze kroki – serwer</h3>
<p>Wiemy już, co chcemy osiągnąć i jak to zrobić, lecz zaczniemy od podstawowej konfiguracji. Nie będziemy jeszcze niczego emitować, tylko przygotujemy "obserwacje" na dołączenie nowego socketu (klienta) i będziemy informować o tym w konsoli. Na razie – zero nowości.</p>
<p>Zacznij od znalezienia najnowszej wersji naszej witryny festiwalu, było to ostatnie zadanie w poprzednim module.</p>
<p>Na samym początku pobierz paczkę Socket.IO i zaimportuj ją w Twoim pliku <code>server.js</code>.</p>
<p>W kolejnym kroku zintegruj możliwości tej paczki z naszym serwerem.</p>
<p>Następnie przygotuj nasłuchiwacz na event, który jest domyślnie i automatycznie wysyłany przez klienta przy dołączeniu (<code>connection</code>). Jeśli serwer go wykryje, niech informuje o tym w konsoli za pomocą komunikatu <code>New socket!</code>. To na razie wszystko.</p>
<p>Na tym etapie serwer powinien mieć dostęp do funkcjonalności Socket.IO oraz oczekiwać na dołączenie socketu. Jeśli je wykryje, wypisze w konsoli odpowiedni komunikat.</p>
<h3 id="285-websockety-w-praktyce-zamawianie-biletow-pierwsze-kroki-klient">Pierwsze kroki – klient</h3>
<p>Aby sprawdzić, czy serwer dobrze reaguje na sockety, musimy zmodyfikować samego klienta. W tym miejscu pojawia się pytanie. Czy socketem będzie cała aplikacja? Albo inaczej – czy socketem musi być cała aplikacja? W końcu tak wyglądało to w naszym ostatnim przykładzie z listą zadań. Odpowiedź brzmi – nie. Tak naprawdę, zakładając, że mechanizm WebSocketów jest nam potrzebny tylko na jednej podstronie, nie ma sensu inicjować go zawsze. Zastanów się tylko. Gdybyśmy inicjowali socket w kliencie od razu, np. w komponencie <code>App</code>, to każde wejście na stronę otwierałoby ciągłą i dwustronną komunikację z serwerem, nawet wtedy, gdy użytkownik nie odwiedziłby podstrony rezerwacji biletu. Czy powodowałoby to jakiś błąd? Nie, ale niepotrzebnie wymagałoby od serwera i klienta utrzymywania stałej komunikacji. O wiele lepiej będzie zainicjować socket w kliencie, wtedy kiedy faktycznie potrzebujemy jego możliwości, a więc np. w naszym komponencie <code>SeatChooser</code>. W takim przypadku komunikacja klienta z serwerem będzie startowała tylko wtedy, kiedy użytkownik wejdzie na podstronę rezerwacji biletu.</p>
<p>Otwórz teraz właśnie ten komponent. Na razie nie będziemy jeszcze tworzyć tutaj szczegółowej logiki, chcemy tylko zainicjować socket i sprawdzić, czy faktycznie wejście w naszą aplikację, a następnie skierowanie się do podstrony rezerwacji, będzie odpowiednio zauważone przez serwer.</p>
<p>Zacznij od zaimportowania paczki Socket.IO, nie musi być cała, wystarczy część kliencka.</p>
<p>Następnie w odpowiednim miejscu zainicjuj nasze połączenie z serwerem. Referencje do niego przechowuj w <code>this.socket</code>.</p>
<div class="bc-note alert-info">
<h4 class="alert-heading text-center">Uwaga!</h4>
<p>Pamiętaj, że nasz klient może być na innym adresie niż serwer (<code>localhost:3000</code> – w wersji developerskiej), a czasem na takim samym (<code>localhost:8000</code> lub serwer Heroku – aplikacja po zbudowaniu). Koniecznie warunkuj połączenie od <code>process.env.NODE_ENV</code>. Jeśli jesteśmy w środowisku <code>production</code>, to niech Socket.IO automatycznie wybierze domyślny adres, w innej sytuacji wskaż jednak <code>localhost:8000</code>.</p>
</div>
<p>Teraz uruchom serwer oraz klienta i sprawdź, czy odpalenie podglądu aplikacji, a następnie wejście na podstronę "Order a ticker", zostało odnotowane w konsoli komunikatem <code>New socket!</code>. Jeśli się pojawił, wszystko jest na razie w porządku.</p>
<h3 id="285-websockety-w-praktyce-zamawianie-biletow-rozwijamy-serwer">Rozwijamy serwer</h3>
<p>Skoro wiemy już, że połączenie jest w porządku, czas przejść do realizacji naszego planu. Zacznijmy od serwera.</p>
<p>Chcemy, aby po dodaniu rezerwacji do bazy danych, rozgłosił on wszystkim socketom zdarzenie mówiące o potrzebie aktualizacji. Oczywiście dobrze byłoby wysyłać również aktualną kolekcję z rezerwacjami.</p>
<p>Musisz odnaleźć teraz endpoint, który jest uruchamiany przy żądaniu dodania nowej rezerwacji (<code>/seats</code>, metoda <code>POST</code>). W tej chwili przypięta do niego funkcja jedynie waliduje dane, dodaje nową rezerwację do tablicy, a następnie zwraca komunikat <code>OK</code>. Twoim zadaniem jest taka modyfikacja tej funkcji, aby bezpośrednio po dodaniu rezerwacji do tablicy, serwer wyemitował także odpowiednie zdarzenie do wszystkich klientów. Nazwij je <code>seatsUpdated</code> (zgodnie z wcześniejszymi założeniami). Wraz z samym zdarzeniem wysyłaj też aktualną zawartość kolekcji (<code>db.seats</code>).</p>
<p>Pojawia się tylko jeden problem. Stała <code>io</code>, która jest referencją do naszego serwera i z której moglibyśmy wyemitować zdarzenie, jest obecna w pliku <code>server.js</code>, a nasz endpoint w innym. Nie mamy do tej stałej dostępu. Co możemy z tym zrobić?</p>
<div class="bc-note alert-success">
<h4 class="alert-heading text-center">Middleware zawsze na posterunku</h4>
<p>W poprzednim module bardzo często z opresji ratowało nas użycie middleware. Tym razem będzie podobnie.</p>
<p>Pamiętasz jak na początku poprzedniego modułu tworzyliśmy następujący middleware?</p>
<pre class=" language-js"><code class=" language-js">app<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  res<span class="token punctuation">.</span><span class="token method-variable function-variable method function property-access">show</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">name</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
    res<span class="token punctuation">.</span><span class="token method function property-access">sendFile</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token method function property-access">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">/views/</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>name<span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Jego rolą było dodanie do obiektu <code>res</code> nowej metody, która mogłaby być potem używana w każdym z endpointów. Tego właśnie szukamy. Moglibyśmy w taki sposób w <code>server.js</code> dodać middleware, który będzie uruchamiany przed konkretnymi endpointami (a więc również przed <code>/seats</code> <code>POST</code>) i doda do obiektu <code>req</code> lub <code>res</code> dodatkowy parametr, który będzie referencją do naszego <code>io</code>, na przykład <code>req.io</code>. Dzięki temu mielibyśmy do niego dostęp w każdym endpoincie, nawet w takim, który jest w zewnętrznym pliku.</p>
</div>
<p>Dopisz więc do pliku <code>server.js</code> nowy middleware. Pamiętaj, aby <strong>koniecznie wstawić go przed middleware dodającym endpointy z zewnętrznych plików.</strong></p>
<pre class=" language-js"><code class=" language-js">app<span class="token punctuation">.</span><span class="token method function property-access">use</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span> res<span class="token punctuation">,</span> next</span><span class="token punctuation">)</span> <span class="token arrow operator">=&gt;</span> <span class="token punctuation">{</span>
  req<span class="token punctuation">.</span><span class="token property-access">io</span> <span class="token operator">=</span> io<span class="token punctuation">;</span>
  <span class="token function">next</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p>Teraz w każdym pliku, również zewnętrznym, endpointy będą miały dostęp do naszego serwera WebSocket przy użyciu zwykłego obiektu żądania <code>req</code> (a dokładnie <code>req.io</code>).</p>
<p>Możemy wrócić w tej chwili do naszego endpointu. Skoro masz już dostęp do obiektu <code>io</code>, nie pozostaje Ci nic innego jak dodać w nim kod, który będzie emitował odpowiednie zdarzenie do wszystkich klientów, gdy tylko serwer doda już samą rezerwację do kolekcji w tablicy.</p>
<p>I... to wszystko.</p>
<h3 id="285-websockety-w-praktyce-zamawianie-biletow-rozwijamy-klienta">Rozwijamy klienta</h3>
<p>Czas na klienta. Wiemy już, że serwer, gdy tylko doda nową rezerwację do kolekcji w bazie danych (a raczej tablicy, która taką bazę udaje), od razu wyemituje zdarzenie <code>seatsUpdated</code> do wszystkich klientów. Dzięki temu będą zdawali sobie sprawę, że "zajętość" się zmieniła i trzeba zaktualizować widok miejsc. Oczywiście ustaliliśmy, że serwer z samym zdarzeniem będzie wysyłać również aktualną tablicę rezerwacji. Teraz jednak musimy jeszcze dodać odpowiedni nasłuchiwacz w samym kliencie, tak aby wykrywał ten event i coś w takiej sytuacji robił. Co dokładnie? Najlepiej odświeżał po prostu widok miejsc zgodnie z tym, co dostanie od serwera.</p>
<p>Zacznij od dodania nasłuchiwacza na event <code>seatsUpdated</code>. Przygotuj się też na to, że wraz ze zdarzeniem serwer wysyła tablicę aktualnych rezerwacji – odbieraj je jako argument <code>seats</code>. Następnie zastanówmy się jaką funkcję powinniśmy uruchamiać, gdy wykryjemy ten event. Na razie w naszym komponencie mamy metodę <code>loadSeats</code>, wiemy przy tym, że jest ona odwołaniem do thunka <code>loadSeatsRequest</code>. Ona raczej się nie nada, bo przecież&nbsp;jej podstawowe działanie to... połączenie AJAX-owe do serwera. Po co nam ono, skoro my otrzymujemy już wszystkie potrzebne dane z serwera wraz ze zdarzeniem? Zamiast tego, lepszym pomysłem będzie przygotowanie w containerze funkcji z bezpośrednim wywołaniem dispatchu akcji <code>loadSeats</code> z Reduksa, a następnie wykorzystanie jej w przypadku wykrycia eventu <code>seatsUpdated</code>. Oczywiście jako <code>payload</code> będziemy tutaj przekazywali dane otrzymane od serwera.</p>
<p class="text-center">
  <span class="collapse-toggles">
    <a href="https://kodilla.com/pl/bootcamp-module/407/277/5935#collapse-jyjyTOOjI-toggle" class="btn btn-primary collapsed" data-toggle="collapse">Pokaż wskazówkę</a>
    <a href="https://kodilla.com/pl/bootcamp-module/407/277/5935#collapse-jyjyTOOjI-toggle" class="btn btn-primary collapsed" data-toggle="collapse">Ukryj wskazówkę</a>
  </span>
</p>
<div id="collapse-jyjyTOOjI-toggle" class="collapse">
<ol>
<li>Wejdź do pliku <code>SeatChooserContainer.js</code> i zaimportuj z <code>../../../redux/seatsRedux</code> potrzebny kreator akcji (<code>loadSeats</code>).</li>
<li>W <code>mapDispatchToProps</code> dodaj nowy parametr, np. <code>loadSeatsData</code>. Powinien on być nową funkcją strzałkową, która przyjmuje parametr <code>seats</code>, a następnie uruchamia <code>dispatch(loadSeats(seats))</code>. Od tej chwili w komponencie <code>SeatChooser</code> mamy już dostęp do funkcji, która będzie potrafiła zmodyfikować bezpośrednio nasz store reduksowy.</li>
<li>Następnie wykorzystaj tę funkcję w nasłuchiwaczu na <code>seatsUpdated</code>. Uruchamiaj ją, a jako argument przekazuj dane otrzymane od serwera wraz ze zdarzeniem.</li>
</ol>
</div>
<p>W takim układzie, możemy zrezygnować w końcu z cyklicznego odświeżania liczby zajętych miejsc. Mamy już pewność, że w razie jakiejś zmiany, serwer nas o tym poinformuje, a klient będzie wiedział, co z taką informacją powinien zrobić. Podobnie nie musimy już uruchamiać <code>loadSeats</code> po dodaniu samej rezerwacji. Odnajdź więc funkcję <code>submitForm</code> w komponencie <code>OrderTicketForm</code> i usuń jej wywoływanie. Możesz też usunąć odpowiednią referencję z containera.</p>
<p>To tyle :)</p>
<p>Końcowy efekt działania Twojej aplikacji powinien być następujący:</p>
<a href="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/WebSocket16.gif" class="img-modal-group"><img src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/WebSocket16.gif" alt="image" style="width: auto; max-width: 50%;"></a>
<h3 id="285-websockety-w-praktyce-zamawianie-biletow-podsumowanie">Podsumowanie</h3>
<p>Tym razem musieliśmy napisać o wiele mniej kodu, ale cel tego zadania był inny niż wcześniej. Po prostu chcieliśmy uświadomić Ci, że WebSockety nie zawsze muszą obsługiwać całą komunikację pomiędzy serwerem a klientem.</p>

                        </div>
                    </div>
                                        <div class="card-block task-card">
                        <h3 id="285-websockety-w-praktyce-zamawianie-biletow-zadanie-wolne-miejsca">Zadanie: <span class="task-title">wolne miejsca</span></h3>
                        <div class="task-content">
                            <p>Twoim zadaniem będzie rozwinięcie komponentu <code>SeatChooser</code> tak, aby pod widokiem krzesełek widniało również podsumowanie "zajętości" – wystarczy zwykły akapit w formacie <code>Free seats: 2/15</code>. Oczywiście liczba powinna wskazywać, ile jest wolnych miejsc na wszystkie możliwe, musi też być natychmiastowo aktualizowana w przypadku rezerwacji przez któregokolwiek z użytkowników.</p>
<p>Możesz stworzyć nowe zdarzenia, dodać nasłuchiwacze, a może... już masz wszystkie potrzebne informacje i wystarczy je odpowiednio wykorzystać?</p>
<p>Gdy zadanie będzie gotowe, zapisz zmiany w Gicie, załaduj je na Heroku, a link do opublikowanej witryny wyślij mentorowi.</p>

                        </div>
                    </div>
                                        <div class="card-block submodule-footer clearfix  completed ">
                                                <div class="clearfix">
                                                                                <a href="https://kodilla.com/pl/bootcamp-task/407/663637" target="_blank" class="btn btn-info-outline">Podgląd zadania</a>
                            <form target="_blank" class="form-inline project-link-form">
                                <div class="form-group">
                                    <input type="text" name="link" class="form-control" value="https://skwiryt-testimonials.herokuapp.com/">
                                </div>
                                <button type="submit" class="btn  btn-primary ">Wyślij link <i class="fa fa-check"></i></button>
                            </form>
                                                                                                    </div>
                    </div>
                </section>
                                    
                <section id="submodule-1140" class="card submodule completed" data-bootcamp-user-submodule-id="663638">
                <!-- klasy dla section: completed current comments -->
                    <div class="card-block submodule-header clearfix">
                        <i class="fa fa-check-circle-o fa-2x"></i>
                        <i class="fa fa-play-circle-o fa-2x"></i>
                        <i class="fa fa-exclamation-circle fa-2x"></i>
                        <i class="fa fa-send-o fa-2x"></i>
                        <h2 class="bootcamp-submodule-name">28.6. <span>Podsumowanie</span></h2>
                                            </div>
                    <div class="card-block">
                        <div class="submodule-content">
                            <p>Co musisz zapamiętać z tego modułu? Przede wszystkim, czym jest technologia WebSocketów – jak działa, do czego służy, kiedy warto z niej skorzystać. Na tym etapie tajemnicą nie powinien być dla Ciebie również mechanizm emitowania i nasłuchiwania.</p>
<p>Należy tu przypomnieć jeszcze jeden ważny wniosek. <strong>WebSockety to nie konkurencja dla AJAX-u ani żadna alternatywa</strong>. Obie technologie działają w różny sposób, mają swoje zastosowania i zadania, w których się sprawdzają. Jak zawsze, to developer musi ocenić, który wybór w danej sytuacji będzie właściwy.</p>

                        </div>
                    </div>
                                        <div class="card-block submodule-footer clearfix  completed ">
                                                <small>Jeśli masz wątpliwości do powyższego materiału, to - zanim zatwierdzisz - zapytaj na czacie :)</small>
                                                <div class="clearfix">
                                                                                <button class="btn  btn-primary "><i class="fa fa-check"></i><span>Zapoznałe(a)m się!</span></button>
                                                                                                    </div>
                    </div>
                </section>
                                    
                <section id="submodule-1141" class="card submodule completed" data-bootcamp-user-submodule-id="663639">
                <!-- klasy dla section: completed current comments -->
                    <div class="card-block submodule-header clearfix">
                        <i class="fa fa-check-circle-o fa-2x"></i>
                        <i class="fa fa-play-circle-o fa-2x"></i>
                        <i class="fa fa-exclamation-circle fa-2x"></i>
                        <i class="fa fa-send-o fa-2x"></i>
                        <h2 class="bootcamp-submodule-name">28.7. <span>Quiz powtórkowy</span></h2>
                                            </div>
                    <div class="card-block">
                        <div class="submodule-content">
                            <p>Na koniec tego modułu przygotowaliśmy dla Ciebie quiz powtórkowy. Pomoże Ci on powtórzyć wiedzę z poprzednich modułów.</p>
<p>Odpowiedzi tego quizu nie są nigdzie zapisywane, więc są tylko do Twojej wiadomości. Ten quiz ma Ci posłużyć jako pomoc w nauce – dlatego pod każdym pytaniem znajdziesz guzik, który sprawdzi poprawność Twoich odpowiedzi oraz poda Ci wyjaśnienie zagadnienia poruszanego w tym pytaniu.</p>

        <div class="kodilla-quiz">
      
        <article class="question initiated" data-type="multiple-choice">
      
        <header>
          <p><em>1.</em> Do czego w Expressie służy metoda <code>res.send(arg)</code>?</p>

        </header>
        <ol type="a" class="answers" data-correct="0">
          <li><label><input type="checkbox"> wysyła do przeglądarki zawartość argumentu <code>arg</code> jako kod HTML</label></li>
<li><label><input type="checkbox"> ustawia status odpowiedzi zawarty w argumencie <code>arg</code> (np. <code>404</code> jeśli nie znaleziono pliku)</label></li>
<li><label><input type="checkbox"> wysyła do przeglądarki zawartość pliku, do którego ścieżka zawarta jest w argumencie <code>arg</code></label></li>
<li><label><input type="checkbox"> zwraca <em>middleware</em>, który będzie serwował pliki statyczne z katalogu, do którego ścieżka zawarta jest w argumencie <code>arg</code></label></li>
<li><label><input type="checkbox"> renderuje szablon Handlebars z pliku, którego nazwa znajduje się w argumencie <code>arg</code></label></li>
        </ol>
        <div class="buttons text-center">
          <button class="button-ok btn btn-primary">Sprawdź odpowiedź</button>
        </div>
      
      
        <div class="explanation">
          <div class="bc-note alert-success">
            <h4 class="alert-heading text-center">Wyjaśnienie</h4>
      <p>Tej metody używamy głównie w celu wyświetlenia komunikatów o błędzie.</p>

          </div>
        </div>
      
        </article>
      
        <article class="question initiated" data-type="multiple-choice">
      
        <header>
          <p><em>2.</em> Do czego w Expressie służy metoda <code>express.static(arg)</code>?</p>

        </header>
        <ol type="a" class="answers" data-correct="3">
          <li><label><input type="checkbox"> wysyła do przeglądarki zawartość argumentu <code>arg</code> jako kod HTML</label></li>
<li><label><input type="checkbox"> ustawia status odpowiedzi zawarty w argumencie <code>arg</code> (np. <code>404</code> jeśli nie znaleziono pliku)</label></li>
<li><label><input type="checkbox"> wysyła do przeglądarki zawartość pliku, do którego ścieżka zawarta jest w argumencie <code>arg</code></label></li>
<li><label><input type="checkbox"> zwraca <em>middleware</em>, który będzie serwował pliki statyczne z katalogu, do którego ścieżka zawarta jest w argumencie <code>arg</code></label></li>
<li><label><input type="checkbox"> renderuje szablon Handlebars z pliku, którego nazwa znajduje się w argumencie <code>arg</code></label></li>
        </ol>
        <div class="buttons text-center">
          <button class="button-ok btn btn-primary">Sprawdź odpowiedź</button>
        </div>
      
      
        <div class="explanation">
          <div class="bc-note alert-success">
            <h4 class="alert-heading text-center">Wyjaśnienie</h4>
      <p>Dzięki tej metodzie możemy zdefiniować katalog zawierający pliki, które mają być udostępniane przez nas serwer.</p>

          </div>
        </div>
      
        </article>
      
        <article class="question initiated" data-type="multiple-choice">
      
        <header>
          <p><em>3.</em> Do czego w Expressie służy metoda <code>res.show(arg)</code>?</p>

        </header>
        <ol type="a" class="answers" data-correct="2">
          <li><label><input type="checkbox"> wysyła do przeglądarki zawartość argumentu <code>arg</code> jako kod HTML</label></li>
<li><label><input type="checkbox"> ustawia status odpowiedzi zawarty w argumencie <code>arg</code> (np. <code>404</code> jeśli nie znaleziono pliku)</label></li>
<li><label><input type="checkbox"> wysyła do przeglądarki zawartość pliku, do którego ścieżka zawarta jest w argumencie <code>arg</code></label></li>
<li><label><input type="checkbox"> zwraca <em>middleware</em>, który będzie serwował pliki statyczne z katalogu, do którego ścieżka zawarta jest w argumencie <code>arg</code></label></li>
<li><label><input type="checkbox"> renderuje szablon Handlebars z pliku, którego nazwa znajduje się w argumencie <code>arg</code></label></li>
        </ol>
        <div class="buttons text-center">
          <button class="button-ok btn btn-primary">Sprawdź odpowiedź</button>
        </div>
      
      
        <div class="explanation">
          <div class="bc-note alert-success">
            <h4 class="alert-heading text-center">Wyjaśnienie</h4>
      <p>Chcąc wysyłać do przeglądarki zawartość pliku HTML, użyjemy właśnie tej metody.</p>

          </div>
        </div>
      
        </article>
      
        <article class="question initiated" data-type="multiple-choice">
      
        <header>
          <p><em>4.</em> Do czego w Expressie służy metoda <code>res.render(arg)</code>?</p>

        </header>
        <ol type="a" class="answers" data-correct="4">
          <li><label><input type="checkbox"> wysyła do przeglądarki zawartość argumentu <code>arg</code> jako kod HTML</label></li>
<li><label><input type="checkbox"> ustawia status odpowiedzi zawarty w argumencie <code>arg</code> (np. <code>404</code> jeśli nie znaleziono pliku)</label></li>
<li><label><input type="checkbox"> wysyła do przeglądarki zawartość pliku, do którego ścieżka zawarta jest w argumencie <code>arg</code></label></li>
<li><label><input type="checkbox"> zwraca <em>middleware</em>, który będzie serwował pliki statyczne z katalogu, do którego ścieżka zawarta jest w argumencie <code>arg</code></label></li>
<li><label><input type="checkbox"> renderuje szablon Handlebars z pliku, którego nazwa znajduje się w argumencie <code>arg</code></label></li>
        </ol>
        <div class="buttons text-center">
          <button class="button-ok btn btn-primary">Sprawdź odpowiedź</button>
        </div>
      
      
        <div class="explanation">
          <div class="bc-note alert-success">
            <h4 class="alert-heading text-center">Wyjaśnienie</h4>
      <p>Jeśli używamy widoków opartych o Handlebars, użyjemy tej metody do wyrenderowania kodu HTML na podstawie konkretnego szablonu. Zwykle będziemy dodawać drugi argument, zawierający dane, z których korzysta ten szablon.</p>

          </div>
        </div>
      
        </article>
      
        <article class="question initiated" data-type="multiple-choice">
      
        <header>
          <p><em>5.</em> Do czego w Expressie służy metoda <code>res.status(arg)</code>?</p>

        </header>
        <ol type="a" class="answers" data-correct="1">
          <li><label><input type="checkbox"> wysyła do przeglądarki zawartość argumentu <code>arg</code> jako kod HTML</label></li>
<li><label><input type="checkbox"> ustawia status odpowiedzi zawarty w argumencie <code>arg</code> (np. <code>404</code> jeśli nie znaleziono pliku)</label></li>
<li><label><input type="checkbox"> wysyła do przeglądarki zawartość pliku, do którego ścieżka zawarta jest w argumencie <code>arg</code></label></li>
<li><label><input type="checkbox"> zwraca <em>middleware</em>, który będzie serwował pliki statyczne z katalogu, do którego ścieżka zawarta jest w argumencie <code>arg</code></label></li>
<li><label><input type="checkbox"> renderuje szablon Handlebars z pliku, którego nazwa znajduje się w argumencie <code>arg</code></label></li>
        </ol>
        <div class="buttons text-center">
          <button class="button-ok btn btn-primary">Sprawdź odpowiedź</button>
        </div>
      
      
        <div class="explanation">
          <div class="bc-note alert-success">
            <h4 class="alert-heading text-center">Wyjaśnienie</h4>
      <p>W komunikacji HTTP ważne jest ustawianie statusów, szczególnie kiedy wystąpiła nietypowa sytuacja – np. nie znaleziono żądanego pliku, adres żądanej strony został zmieniony i chcemy przekierować klienta pod nowy adres, użytkownik musi się zalogować, aby uzyskać dostęp do żądanego adresu, etc.</p>

          </div>
        </div>
      
        </article>
      
        </div>
        
<style>
  .kodilla-quiz .question {
    margin-bottom: 1.5em;
  }
  .kodilla-quiz .explanation {
    display: none;
  }
  .kodilla-quiz li>label {
    display: inline-block;
    padding-top: 1px;
    vertical-align: top;
  }
</style>
<script>
  if(typeof initQuizzes == 'undefined'){
    function initQuizzes(){
      var types = {
        'multiple-choice': initMultipleChoice,
      };

      var questions = document.querySelectorAll('.kodilla-quiz .question');

      for(var i=0; i<questions.length; i++){
        var question = questions[i];
        var initFunc = types[question.dataset.type];

        if(typeof(initFunc) != 'undefined' && !question.classList.contains('initiated')){
          question.classList.add('initiated');
          initFunc(question);
        }
      }
    }

    function initMultipleChoice(question){
      var answers = question.querySelector('.answers');
      var inputs = answers.querySelectorAll('input');
      var buttons = question.querySelector('.buttons');
      var buttonOK = buttons.querySelector('.button-ok');
      var explanation = question.querySelector('.explanation');
      var correct = question.querySelector('[data-correct]').dataset.correct.split(',');

      buttonOK.addEventListener('click', function(e){
        e.preventDefault();

        var inputsChecked = answers.querySelectorAll('input:checked');
        if(inputsChecked.length == 0){
          alert('Wybierz co najmniej jedna odpowiedź');
          return;
        }

        correct.forEach(function(index){
          inputs[index].parentNode.parentNode.classList.add('text-success', 'text-bold');
        });

        for (var i = 0; i < inputs.length; i++) {
          var input = inputs[i];
          var li = input.parentNode.parentNode;
          input.setAttribute('disabled', true);
          
          if(input.checked){
            li.classList.add('text-bold');
            
            if(!li.classList.contains('text-success')){
              li.classList.add('text-danger');
            }
          }

        }
        
        if(explanation) explanation.style.display = 'block';
        buttons.setAttribute('hidden', true);
      });
    }
  }
  initQuizzes();
</script>

      
                        </div>
                    </div>
                                        <div class="card-block submodule-footer clearfix  completed ">
                                                <small>Jeśli masz wątpliwości do powyższego materiału, to - zanim zatwierdzisz - zapytaj na czacie :)</small>
                                                <div class="clearfix">
                                                                                <button class="btn  btn-primary "><i class="fa fa-check"></i><span>Zapoznałe(a)m się!</span></button>
                                                                                                    </div>
                    </div>
                </section>
                            </main>
        </div>
    </section>
</main>
;
<script async="" src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/ei.js"></script>
<script type="text/x-translation" data-translation-name="SentBootcampLinkReviewFormMessage">Wysłano link do zatwierdzenia</script>
    <div id="alerts">
    <div class="alert alert-danger" role="alert" style="display: none;">
        <i class="fa fa-exclamation" aria-hidden="true"></i>
        <button type="button" class="close" data-hide="alert" aria-label="Zamknij">
            <span aria-hidden="true">×</span>
            <span class="sr-only">Zamknij</span>
        </button>
        <ul>
                        </ul>
    </div>
    <div class="alert alert-success" role="alert" style="display: none;">
        <i class="fa fa-check" aria-hidden="true"></i>
        <button type="button" class="close" data-hide="alert" aria-label="Zamknij">
            <span aria-hidden="true">×</span>
            <span class="sr-only">Zamknij</span>
        </button>
        <ul>
                </ul>
    </div>
    <div class="alert alert-warning" role="alert" style="display: none;">
        <i class="fa fa-warning" aria-hidden="true"></i>
        <button type="button" class="close" data-hide="alert" aria-label="Zamknij">
            <span aria-hidden="true">×</span>
            <span class="sr-only">Zamknij</span>
        </button>
        <ul>
                </ul>
    </div>
    <div class="alert alert-info" role="alert" style="display: none;">
        <i class="fa fa-info" aria-hidden="true"></i>
        <button type="button" class="close" data-hide="alert" aria-label="Zamknij">
            <span aria-hidden="true">×</span>
            <span class="sr-only">Zamknij</span>
        </button>
        <ul>
                    </ul>
    </div>
    <div class="container">
        <div class="alert alert-notify" role="alert" style="display: none;">
            <i class="fa fa-info" aria-hidden="true"></i>
            <button type="button" class="close" data-hide="alert" aria-label="Zamknij">
                <span aria-hidden="true">×</span>
                <span class="sr-only">Zamknij</span>
            </button>
            <ul>
                            </ul>
        </div>
    </div>
</div>
    <div class="modal fade informator-modal" id="informator" tabindex="-1" role="dialog" aria-labelledby="informatorModalLabel" aria-hidden="true">
    <div class="modal-dialog" role="document">
        <div class="modal-content">
            <div class="modal-header">
                <img src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/logo-menu.png" alt="Logo Kodilla" class="brand-logo">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                    <i class="fa fa-times" aria-hidden="true"></i>
                </button>
            </div>
            <div class="modal-body content-container">
                <h3>Zamów szczegółowy informator</h3>
                <form class="row js-ajax-form" data-view-class="InformatorForm" action="https://kodilla.com/pl/download-informator" method="post">
                    <input type="hidden" name="ga-pobieranie-informatora-z-modala" value="wypelnienie">
                    <input type="hidden" name="tags[0]" value="informator">
                                        <div class="user-data-container">
                        <input type="text" class="form-control" name="firstname" placeholder="Imię">
                        <input type="text" class="form-control" name="surname" placeholder="Nazwisko">
                    </div>
                    <div class="user-data-container">
                        <input type="email" class="form-control" name="email" placeholder="Email" required="">
                        <input type="tel" class="form-control" name="phone" placeholder="Numer telefonu" pattern="^([\+][0-9]{1,3}([ \.\-])?)?([\(]{1}[0-9]{3}[\)])?([0-9 \.\-]{1,15})$" title="Wpisz poprawny numer telefonu, np. 453 674 897" minlength="9" maxlength="15" data-custom-message="Wpisz poprawny numer telefonu, np. 453 674 897">
                    </div>
                    <div class="terms-box">
                        <label>
                            <input name="accept_terms" value="true" data-custom-message="Prosimy o zaakceptowanie regulaminu" type="checkbox" class="form-control input-checkbox" required="">
                            <span>Akceptuję <a target="_blank" href="https://kodilla.com/pl/regulamin">regulamin</a>  i nie wnoszę zastrzeżeń</span>
                        </label>
                    </div>
                    <div class="personal-terms-box">
                        <label>
                            <input name="accept_marketing" value="true" data-custom-message="Jeśli chcesz otrzymać dostęp do materiałów, konieczna jest akceptacja obydwu zgód" type="checkbox" class="form-control input-checkbox" required="">
                            <span>Chcę otrzymywać newsletter, informacje o promocjach i produktach dostępnych w Kodilla.
                                <span class="details-button" data-action="show-details" data-identifier="personal-terms-details-informator">Czytaj więcej</span>
                                <span class="display-none" data-identifier="personal-terms-details-informator">Wyrażam zgodę na otrzymywanie informacji handlowych od Kodilla na podany przeze mnie adres e-mail. Zgoda jest dobrowolna, jednakże niezbędna do otrzymywania informacji o produktach, promocjach i o tym, co u nas słychać. Administratorem danych jest Codemy S.A. z siedzibą we Wrocławiu, Plac Powstańców Śląskich 13/4. Mam prawo cofnąć zgodę w każdym czasie, jednak wtedy nie będę otrzymywać informacji. Dane mogą być przetwarzane pomimo cofnięcia zgody wyłącznie w takim zakresie i celu, w jakim ich przetwarzanie jest niezbędne do ustalenia, dochodzenia lub obrony roszczeń Administratora w związku z udzieloną zgodą. Mam prawo dostępu do danych, sprostowania, usunięcia, ograniczenia przetwarzania, prawo wniesienia sprzeciwu, skargi do organu nadzorczego i przeniesienia danych. Szczegółowe informacje znajdują się na stronie kodilla.com, zakładka "Polityka Prywatności".</span>
                            </span>
                        </label>
                    </div>
                    <div class="display-none">
                        <input type="text" name="myName" value="">
                    </div>
                    <div class="">
                        <button type="submit" class="btn btn-primary">
                            Pobierz Informator
                            <i data-role="loading-icon" class="fa fa-spinner fa-spin fa-1x fa-fw display-none"></i>
                        </button>
                    </div>
                </form>
                <a href="https://kodilla.com/pl/informator" id="informator-link" target="_blank" class="display-none"></a>
            </div>
            <div class="modal-footer">
                <p>Pobranie informatora do niczego nie zobowiązuje</p>
            </div>
        </div>
    </div>
</div>
<footer class="site-footer">
                <section class="footer-lower">
            <nav class="container">
                <a class="navbar-img" href="https://kodilla.com/pl">
                    <svg id="kodilla-logo" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 168 29.553" width="168" height="30">
                        <defs>
                            <style>
                                .footer-logo-fill {
                                    fill: #fff;
                                }
                            </style>
                        </defs>
                        <g id="Group_1" data-name="Group 1" transform="translate(23.59)">
                            <path id="KODILLA_copy_5_1_" class="footer-logo-fill" d="M78.058,0a14.758,14.758,0,1,0,.075,0Zm0,23.739a8.939,8.939,0,0,1-8.944-8.907V14.8c0-4.957,4.584-.708,8.907-.708,4.919,0,9.019-4.211,9.019.708a8.978,8.978,0,0,1-8.981,8.944Z" transform="translate(-63.3)"></path>
                            <ellipse id="eye_copy_4_1_" class="footer-logo-fill" cx="3.876" cy="3.876" rx="3.876" ry="3.876" transform="translate(9.462 13.2) rotate(-28.436)"></ellipse>
                        </g>
                        <path id="Path_1" data-name="Path 1" class="footer-logo-fill" d="M0,29.819V.9H6.671V13.347L17.255.9h7.491L13.938,13.794,25.491,29.819h-7.6l-8.2-11.665-3.019,3.13v8.5H0Z" transform="translate(0 -0.565)"></path>
                        <path id="Path_2" data-name="Path 2" class="footer-logo-fill" d="M151.4,29.819V.9h10.807a15.515,15.515,0,0,1,6.261,1.155,12.966,12.966,0,0,1,4.509,3.093A12.918,12.918,0,0,1,175.7,9.732a17.245,17.245,0,0,1,.932,5.59,16.821,16.821,0,0,1-1.006,5.963,12.227,12.227,0,0,1-2.907,4.547,13.484,13.484,0,0,1-4.547,2.944,15.964,15.964,0,0,1-5.925,1.043Zm18.41-14.5a11.274,11.274,0,0,0-.522-3.466,7.723,7.723,0,0,0-1.491-2.72,6.616,6.616,0,0,0-2.385-1.752,8.055,8.055,0,0,0-3.205-.6h-4.1v17.18h4.1a7.985,7.985,0,0,0,3.242-.634,6.8,6.8,0,0,0,2.385-1.826,8.286,8.286,0,0,0,1.453-2.72A11.634,11.634,0,0,0,169.81,15.322Z" transform="translate(-94.978 -0.565)"></path>
                        <path id="Path_3" data-name="Path 3" class="footer-logo-fill" d="M228.3,29.819V.9h6.671V29.819Z" transform="translate(-143.219 -0.565)"></path>
                        <path id="Path_4" data-name="Path 4" class="footer-logo-fill" d="M259.9,29.819V.9h6.671V23.968h14.012v5.851Z" transform="translate(-163.043 -0.565)"></path>
                        <path id="Path_5" data-name="Path 5" class="footer-logo-fill" d="M327.371,23.931V.9H320.7V29.819h18.522l2.124-5.851H327.371Z" transform="translate(-201.185 -0.565)"></path>
                        <path id="Path_6" data-name="Path 6" class="footer-logo-fill" d="M388.547.9h6.037L405.13,29.819h-6.857l-2.236-6.484h-9.019l-2.2,6.484H378Zm6.373,17.851L391.528,8.54l-3.466,10.211Z" transform="translate(-237.13 -0.565)"></path>
                    </svg>
                </a>
                <ul class="nav">
                    <li>
                        <a href="https://kodilla.com/pl/regulamin" rel="nofollow">Regulamin</a>
                    </li>
                    <li>
                        <a href="https://kodilla.com/pl/polityka-prywatnosci" rel="nofollow">Polityka prywatności</a>
                    </li>
                    <li class="nav-item nav-item-last">© 2021 Kodilla</li>
                </ul>
            </nav>
        </section>
    </footer>

<!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-KN2WWBH" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->

    <script src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/jquery-2.1.4.min.js"></script>
<script src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/js.cookie-2.1.0.min.js"></script>
<script src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/jquery-dateFormat.min.js"></script>
<script src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/bootstrap.min.js"></script>
<script>
    (function () {
        $(document).ready(function () {
            if (window.location.hash === '#informator-modal') {
                showInformator();
            }
        });

        $('[data-action="show-modal"]').click(function() {
            showInformator();
        });

        function showInformator() {
            $('#informator').modal('show');
        }
    })();
</script>
<script src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/fb-412414a519.js" async=""></script>
<script src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/call-us-261b222cf4.js"></script>
<script>
    if (document.querySelector('main.editor')) {
        document.querySelector('body').classList.add('editor');
    }
</script>

<script type="text/javascript" async="">
  setTimeout(function (){
      (function(e,t,o,n,p,r,i){e.visitorGlobalObjectAlias=n;e[e.visitorGlobalObjectAlias]=e[e.visitorGlobalObjectAlias]||function(){(e[e.visitorGlobalObjectAlias].q=e[e.visitorGlobalObjectAlias].q||[]).push(arguments)};e[e.visitorGlobalObjectAlias].l=(new Date).getTime();r=t.createElement("script");r.src=o;r.async=true;i=t.getElementsByTagName("script")[0];i.parentNode.insertBefore(r,i)})(window,document,"https://diffuser-cdn.app-us1.com/diffuser/diffuser.js","vgo");
      vgo('setAccount', '649095895');
      vgo('setTrackByDefault', true);

      vgo('process');
  }, 3000);

</script>

<script>
    document.addEventListener("DOMContentLoaded", yall);
    window.environment = 'production';
    window.loggedIn = true;
    window.domain = 'https://kodilla.com';
            window.fbAppId = 1449248938627896;
    window.chatService = 'LiveAgent';
    window.useMessenger = window.chatService === 'Messenger';
    window.locale = 'pl';
    window.lang = 'pl';

    window.serverUTC       = 1627846214000;
    window.serverOffset    = 120;
    window.userDate        = new Date();
    window.userUTC         = userDate.getTime();
    window.userOffset      = userDate.getTimezoneOffset() * (-1);
    window.userClockDiff   = userUTC - serverUTC;
    window.diffRounded     = Math.round( userClockDiff / ( 1000 * 60 * 15 ) );
    window.isDifferentZone = ( userOffset - serverOffset !== 0 ) ? 1 : 0;
    window.hasWrongTime    = ( diffRounded !== 0 ) ? 1 : 0;
    window.dateTooltipText = 'Data i godzina są podane dla Twojej strefy czasowej GMT. <br>W razie wątpliwości napisz: <u>support@kodilla.com</u>.';
    window.wrongHourNotice = 'Godzina na Twoim urządzeniu r&oacute;żni się od godziny obowiązującej w strefie czasowej wybranej w ustawieniach Twojego urządzenia.';

    window.PAYU_HASH_ALGORITHM = 'SHA-256';
    window.PAYU_POS_ID = 1429452;
    window.PAYU_MD5_SECOND_KEY = 'f3627be5fab5a4238c8474936f057908';

    var moment = undefined,
        momentReady = function( method, method2, count ){
            var c = ( count ) ? count : 0;

            if      ( isDifferentZone && moment !== undefined ){
                if      ( method ) { method(); }
                else    { return false; }
            }
            else if ( isDifferentZone && moment === undefined ) {
                if ( c < 20 ) {
                    c++;
                    setTimeout( function() { momentReady( method, method2, c ); }
                        , 300 );
                } else {
                    if      ( method2 === true && method )  { method(); }
                    else if ( method2 !== true && method2 ) { method2(); }
                }
            }
            else {
                if      ( method2 === true && method )  { method(); }
                else if ( method2 !== true && method2 ) { method2(); }
                else    { return false; }
            }
        };

    if ( window.isDifferentZone && moment === undefined ) {
        var script = document.createElement("script");
        script.type = "text/javascript";
        script.src = '/static/js/libs/moment.timezone.locales.min.js?v=2.22.2';
        document.getElementsByTagName("head")[0].appendChild(script);
    }
</script>
<script src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/OneSignalSDK.js" async=""></script>
<script>
    var OneSignal = window.OneSignal || [];
    OneSignal.push(function() {
        OneSignal.init({
            appId: "92552bb5-b477-4ea2-8260-dba65be198d9",
        });
    });
</script>
<script data-ad-client="ca-pub-9483216428129091" async="" src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/f.txt"></script>
<script>
    (function(h,o,t,j,a,r){
        h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
        h._hjSettings={hjid:2404285,hjsv:6};
        a=o.getElementsByTagName('head')[0];
        r=o.createElement('script');r.async=1;
        r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
        a.appendChild(r);
    })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
</script>
        <script src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/underscore-min.js"></script>
<script src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/backbone-min.js"></script>
<script src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/backbone-relational.min.js"></script>
<script src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/backbone-super.min.js"></script>
<script src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/handlebars-v4.0.5.min.js"></script>
<script src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/handlebars-ifCond-139a2339f7.js"></script>
<script src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/application-0dcfdc1306.js"></script>
<script src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/main-cf3b73d734.js"></script>
<script src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/settings-5fc44a761b.js"></script>
<script src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/delete-account-da2b3de486.js"></script>
<script type="text/x-translation" data-translation-name="checkAccountDeleteCalculationMessage">Wynik jest nieprawidłowy</script>
<script src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/forms-222ea01b08.js"></script>
<script src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/alerts-66650c3acb.js"></script>
<script>
    App.Views.InpageAlertManager = Backbone.View.extend({
        events: {
            'click [data-alert-type][data-alert-text]': 'showAlert'
        },
        showAlert: function(e) {
            var $el = $(e.currentTarget);
            App.alertsView['show'+$el.data('alertType')]([App.Translations($el.data('alertText'))]);
        }
    });
</script>
<script src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/collections-c07e1162e2.js"></script>
<script src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/models-4e0e4fcffb.js"></script>
<script src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/knowledge-base-61f71273c9.js"></script>
<script>
    App.Views.LearningProgram = Backbone.View.extend({
        events: {
            'click [data-technology-desc-expander]' : 'expandTechnologyDesc'
        },

        initialize: function() {
            this.$allTechnologyDesc = this.$el.find('[data-technology-desc]');
            this.$allTechnologyExpanderIcons = this.$el.find('[data-technology-expander-icon]');
        },

        expandTechnologyDesc: function() {
            this.$allTechnologyDesc.each(function(){
                var $desc = $(this);
                $desc.slideToggle('fast');
            });
            this.$allTechnologyExpanderIcons.each(function(){
                var $icon = $(this);
                $icon.toggleClass("fa-minus");
            });
        },
    });
</script>

    <script src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/tether.min.js"></script>
    <script src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/prism.min.js"></script>

    <script src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/bootcamp-1522c7c010.js"></script>
    <script src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/jquery.seourl.min.js"></script>
    <script src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/perfect-scrollbar.jquery.min.js"></script>
    <script src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/jquery.fancybox.min.js"></script>
    <script src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/moment.timezone.locales.min.js"></script>
    <script src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/bootstrap-datetimepicker.min.js"></script>
    <script type="text/javascript">
        $(document).ready(function() {
            $("a.img-modal-group").fancybox();
        });
    </script>

<div class="modal fade" tabindex="-1" role="dialog" id="call-us-modal">
    <div class="modal-dialog modal-dialog-callus" role="document">
        <div class="modal-content call-modal">
            <div id="call-us-step1">
                <h2>Umów się na rozmowę z doradcą Kodilli</h2>
                <p>Krok <span>1/2:</span> Podaj numer telefonu</p>
                <form action="https://kodilla.com/pl/call-center/dates/phone_calls" method="post" id="call-us-form1">
                    <input type="tel" name="phone" id="call-us-input-phone" class="call-center-input" placeholder="731771787">
                    <p class="error-message display-none" id="validation-message-phone">Pole Numer Telefonu jest wymagane. Nieprawidłowy format.</p>
                    <button class="btn btn-success" id="call-us-submit-phone">Zarezerwuj rozmowę</button>
                </form>
                <p id="call-us-counter-holder" style="display: none;">Dzisiaj już  <span id="call-us-counter" class="call-counter" data-url="https://kodilla.com/pl/call-center/counter/phone_calls">-</span> <span id="call-us-counter-text" data-one=" osoba zamówiła rozmowę z nami." data-few=" osoby zamówiły rozmowę z nami." data-more=" osób zamówiło rozmowę z nami."></span></p>
                <div class="data-protection">
                    <p>Twój numer telefonu nie będzie wykorzystywany w celach marketingowych ani przekazany dalej. Tylko oddzwonimy. Dane są przetwarzane zgodnie z <a href="https://kodilla.com/pl/polityka-prywatnosci">Polityką Prywatności</a>.</p>
                </div>
            </div>

            <div id="call-us-step2" style="display: none;">
                <h2>Wybierz dogodny termin i godzinę na rozmowę z doradcą</h2>
                <p>Krok <span>2/2:</span>
                </p><form action="https://kodilla.com/pl/call-center/step2/phone_calls" method="post" id="call-us-form2">
                    <div class="select-date">
                        <select name="date" id="call-us-input-date">
                        </select>
                        <select name="time" id="call-us-input-time">
                        </select>
                    </div>
                    <button class="btn btn-success" id="call-us-submit-call">Oddzwońcie do mnie!</button>
                </form>
            </div>

            <div id="call-us-step3" style="display: none;">
                <div class="thanks">
                    <i class="fa fa-check-circle" aria-hidden="true"></i>
                    <h2>Dziękujemy za zamowienie rozmowy! Do usłyszenia w wybranym terminie!</h2>
                </div>
            </div>
        </div>
    </div>
</div>



                <style type="text/css">
    .embeddedServiceHelpButton .helpButton .uiButton {
        background-color: #1EA71C;
        font-family: "Arial", sans-serif;
    }
    .embeddedServiceHelpButton .helpButton .uiButton:focus {
        outline: 1px solid #1EA71C;
    }
</style>
<script>
    function openChat(){
        $('.helpButtonEnabled').trigger('click');
    }
</script>
<script type="text/javascript" src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/esw.min.js"></script>

<script type="text/javascript">
    var initESW = function(gslbBaseURL) {
        let firstName = 'Marek Baberowski'.split(" ")[0];
        let lastName = 'Marek Baberowski'.split(" ")[1];
        console.log(name);
        embedded_svc.settings.displayHelpButton = true;
        embedded_svc.settings.language = '';

        embedded_svc.settings.defaultMinimizedText =  'Skontaktuj się z nami';
        embedded_svc.settings.disabledMinimizedText = ' ';

        embedded_svc.settings.loadingText = 'Ładowanie';
        embedded_svc.settings.storageDomain = 'kodilla.com';

        embedded_svc.settings.prepopulatedPrechatFields = {
            'FirstName': firstName,
            'LastName': lastName,
            'Email': 'm.z.baberowski@gmail.com'
        };
        embedded_svc.settings.offlineSupportMinimizedText = 'Napisz do nas';

        embedded_svc.settings.enabledFeatures = ['LiveAgent'];
        embedded_svc.settings.entryFeature = 'LiveAgent';

        embedded_svc.init(
            'https://kodilla.my.salesforce.com',
            'https://kodillacommunity.force.com',
            gslbBaseURL,
            '00D1i000000VBFH',
            'Support_Kodilla',
            {
                baseLiveAgentContentURL: 'https://c.la1-c2-fra.salesforceliveagent.com/content',
                deploymentId: '5721i00000009s9',
                buttonId: '5731i0000000AJN',
                baseLiveAgentURL: 'https://d.la1-c2-fra.salesforceliveagent.com/chat',
                eswLiveAgentDevName: 'Support_Kodilla',
                isOfflineSupportEnabled: true
            }
        );
    };

    if (!window.embedded_svc) {
        var s = document.createElement('script');
        s.setAttribute('src', 'https://kodilla.my.salesforce.com/embeddedservice/5.0/esw.min.js');
        s.onload = function() {
            initESW(null);
        };
        document.body.appendChild(s);
    } else {
        initESW('https://service.force.com');
    }
</script><script id="common-script" type="text/javascript" src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/common.min.js"></script>
        <div data-role="notifications-wrapper" class="notifications-wrapper"></div>
<!-- Facebook Pixel Code -->
    <script>
        setTimeout(function(){
            !function(f,b,e,v,n,t,s)
            {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
                n.callMethod.apply(n,arguments):n.queue.push(arguments)};
                if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
                n.queue=[];t=b.createElement(e);t.async=!0;
                t.src=v;s=b.getElementsByTagName(e)[0];
                s.parentNode.insertBefore(t,s)}(window, document,'script',
                'https://connect.facebook.net/en_US/fbevents.js');
            fbq('init', 389137334769464 );
            fbq('track', 'PageView');
        }, 3000);
    </script>
    <!-- End Facebook Pixel Code -->

    <!-- Google Tag Manager -->
    <script>
        setTimeout(function () {
            (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
                    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
            })(window,document,'script','dataLayer','GTM-KN2WWBH');
        }, 3000);

    </script>
    <!-- End Google Tag Manager -->

    
    

<iframe name="_hjRemoteVarsFrame" title="_hjRemoteVarsFrame" id="_hjRemoteVarsFrame" src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/box-25a418976ea02a6f393fbbe77cec94bb.html" style="display: none !important; width: 1px !important; height: 1px !important; opacity: 0 !important; pointer-events: none !important;"></iframe><script id="liveagent-esw-script" type="text/javascript" src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/liveagent.esw.min.js"></script><form id="fileUploadForm" enctype="multipart/form-data" method="post" target="fileUploadIframe"><input type="file" id="fileSelector" name="file" style="display: none;"><input name="filename" type="hidden"></form><iframe id="fileUploadIframe" name="fileUploadIframe" title="FileUploadFrame" style="display: none;" src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/saved_resource.html"></iframe><iframe id="esw_storage_iframe" src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/esw.html" title="Live Chat Metadata" style="display: none;"></iframe><script type="text/javascript" src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/EmbeddedServiceConfig.jsonp"></script><script id="invite-esw-script" type="text/javascript" src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/invite.esw.min.js"></script><div class="embeddedServiceHelpButton"><div class="helpButton"><button class="helpButtonEnabled uiButton" href="javascript:void(0)"><span class="embeddedServiceIcon" aria-hidden="true" data-icon="" style="display: inline-block;"></span><span class="helpButtonLabel" id="helpButtonSpan" aria-live="polite" aria-atomic="true"><span class="assistiveText">Live chat:</span><span class="message">Napisz do nas</span></span></button></div></div><script id="inert-script" type="text/javascript" src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/inert.min.js"></script><script type="text/javascript" src="./Moduł_ 28. Websocket – natychmiastowa komunikacja_files/EmbeddedServiceConfig(1).jsonp"></script><div id="fb-root" class=" fb_reset"><div style="position: absolute; top: -10000px; width: 0px; height: 0px;"><div></div></div></div>
<script type="text/javascript" id="">window._tfa=window._tfa||[];window._tfa.push({notify:"event",name:"page_view",id:1209537});!function(a,b,d,c){document.getElementById(c)||(a.async=1,a.src=d,a.id=c,b.parentNode.insertBefore(a,b))}(document.createElement("script"),document.getElementsByTagName("script")[0],"//cdn.taboola.com/libtrc/unip/1209537/tfa.js","tb_tfa_script");</script>
<noscript>
  <img src="//trc.taboola.com/1209537/log/3/unip?en=page_view" width="0" height="0" style="display:none">
</noscript>


<script type="text/javascript" id="">window._adftrack=Array.isArray(window._adftrack)?window._adftrack:window._adftrack?[window._adftrack]:[];window._adftrack.push({pm:2049944});(function(){var a=document.createElement("script");a.type="text/javascript";a.async=!0;a.src="https://track.adform.net/serving/scripts/trackpoint/async/";var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)})();</script>
<noscript>
    <p style="margin:0;padding:0;border:0;">
        <img src="https://track.adform.net/Serving/TrackPoint/?pm=2049944" width="1" height="1" alt="">
    </p>
</noscript>

<script type="text/javascript" id="">(function(){window.__insp=window.__insp||[];__insp.push(["wid",794470694]);var c=function(){if("undefined"==typeof window.__inspld){window.__inspld=1;var a=document.createElement("script");a.type="text/javascript";a.async=!0;a.id="inspsync";a.src=("https:"==document.location.protocol?"https":"http")+"://cdn.inspectlet.com/inspectlet.js?wid\x3d794470694\x26r\x3d"+Math.floor((new Date).getTime()/36E5);var b=document.getElementsByTagName("script")[0];b.parentNode.insertBefore(a,b)}};setTimeout(c,0)})();</script>
</body></html>